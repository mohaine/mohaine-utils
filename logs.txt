SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/app/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/app/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/app/lib/log4j-slf4j-impl-2.19.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
log4j:WARN No appenders could be found for logger (org.apache.spark.SparkContext).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.spark.unsafe.Platform (file:/app/lib/spark-unsafe_2.12-3.3.0.jar) to constructor java.nio.DirectByteBuffer(long,int)
WARNING: Please consider reporting this to the maintainers of org.apache.spark.unsafe.Platform
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
2022-09-28T04:28:02.136799Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022270","time":"2308"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (2372a8e6dc785edd9da3de43232c6418f4586dd7a3f87ba32f1024bcb0a43adf)
2022-09-28T04:28:16.270893Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:28:16.304273Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T04:28:16.305178Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:28:16.311668Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T04:28:16.330180Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T04:28:16.332111Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T04:28:16.334644Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T04:28:16.336244Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T04:28:16.338022Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T04:28:16.339461Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:28:16.342396Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T04:28:16.344088Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T04:28:16.346887Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T04:28:16.348805Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T04:28:16.350276Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T04:28:16.354650Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T04:28:16.356900Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T04:28:16.358794Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T04:28:16.362103Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T04:28:17.359985Z - called http://score/api/keyed and received back 204
2022-09-28T04:28:17.360785Z - job completed in 15.23 seconds (2372a8e6dc785edd9da3de43232c6418f4586dd7a3f87ba32f1024bcb0a43adf)
2022-09-28T04:28:17.390341Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c0713800b7f9ac1de310dc0dd1b92b3be3f09102cf3d26702745d0ecd7ec73f3)
2022-09-28T04:28:19.760135Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:28:19.809394Z - running sql script pg/upsert_orders.sql
2022-09-28T04:28:19.810842Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:28:19.817812Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:28:19.820777Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:28:19.824418Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:28:19.826839Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:28:19.835493Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:28:19.842498Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:28:19.845061Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:28:19.847413Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:28:19.850547Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:28:19.859064Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:28:19.863155Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:28:19.865498Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:28:19.870307Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:28:19.938949Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:28:20.071836Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:28:20.073026Z - job completed in 2.68 seconds (c0713800b7f9ac1de310dc0dd1b92b3be3f09102cf3d26702745d0ecd7ec73f3)
2022-09-28T04:28:20.184786Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a4c63d5c016a0adad0b2517a3ace833b62bd4363f922cf546de9f260edcde9a7)
2022-09-28T04:28:22.064357Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:28:22.098073Z - running sql script pg/insert_tenders.sql
2022-09-28T04:28:22.099719Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:28:22.107715Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:28:22.111946Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:28:22.118746Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:28:22.130547Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:28:22.150086Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:28:22.152684Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:28:22.199920Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:28:23.922784Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:28:23.928685Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:28:23.931581Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:28:23.947109Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:28:23.949678Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:28:23.951969Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:28:23.962271Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:28:23.979827Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:28:23.982228Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:28:23.983380Z - job completed in 3.80 seconds (a4c63d5c016a0adad0b2517a3ace833b62bd4363f922cf546de9f260edcde9a7)
2022-09-28T04:30:02.132813Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2320"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (43ea555ceaaa463f10a60f81a6bca2172863d816e5e3cfb23b49fc506c188d13)
2022-09-28T04:30:04.567404Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:30:04.749265Z - running sql script pg/upsert_orders.sql
2022-09-28T04:30:04.749990Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:30:04.755924Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:30:04.759071Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:30:04.760948Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:30:04.764480Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:30:04.766521Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:30:04.768839Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:30:04.771389Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:30:04.772967Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:30:04.776012Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:30:04.778820Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:30:04.781333Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:30:04.783755Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:30:04.786930Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:30:04.789553Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:30:04.794205Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:30:04.795165Z - job completed in 2.66 seconds (43ea555ceaaa463f10a60f81a6bca2172863d816e5e3cfb23b49fc506c188d13)
2022-09-28T04:30:04.961179Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2320"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ee32f6baeb5343a8f150d52e23513c0a900d4176c44a53c064443266c7ae1e24)
2022-09-28T04:30:06.561556Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:30:06.587239Z - running sql script pg/insert_tenders.sql
2022-09-28T04:30:06.587349Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:30:06.592826Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:30:06.594587Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:30:06.596339Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:30:06.597738Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:30:06.599751Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:30:06.601431Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:30:06.604043Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:30:06.605972Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:30:06.607309Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:30:06.609232Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:30:06.611148Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:30:06.613222Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:30:06.615764Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:30:06.618240Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:30:06.620541Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:30:06.622546Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:30:06.623248Z - job completed in 1.66 seconds (ee32f6baeb5343a8f150d52e23513c0a900d4176c44a53c064443266c7ae1e24)
2022-09-28T04:32:02.087022Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2322"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b06875093aa5a1acdedf0eeb00659fb34da72c2b2a93d9aa15e152db377eb82c)
2022-09-28T04:32:03.174194Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:32:03.218972Z - running sql script pg/insert_tenders.sql
2022-09-28T04:32:03.220304Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:32:03.226301Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:32:03.228171Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:32:03.232427Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:32:03.238392Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:32:03.243396Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:32:03.244559Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:32:03.291325Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:32:03.293087Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:32:03.294398Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:32:03.296244Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:32:09.683898Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:32:09.720068Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:32:09.726265Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:32:10.335632Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:32:10.546691Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:32:10.563148Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:32:10.565689Z - job completed in 8.48 seconds (b06875093aa5a1acdedf0eeb00659fb34da72c2b2a93d9aa15e152db377eb82c)
2022-09-28T04:32:10.669522Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2322"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (10153043590979341d4e951da49e2552e75287918d697fdd6f127924c8db2c74)
2022-09-28T04:32:12.945833Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:32:12.974265Z - running sql script pg/upsert_orders.sql
2022-09-28T04:32:12.974564Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:32:12.980376Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:32:12.982314Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:32:12.983675Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:32:12.984961Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:32:12.986388Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:32:12.989026Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:32:12.990448Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:32:12.993484Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:32:12.995723Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:32:12.997935Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:32:12.999839Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:32:13.001211Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:32:13.003634Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:32:13.006883Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:32:13.011047Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:32:13.011863Z - job completed in 2.34 seconds (10153043590979341d4e951da49e2552e75287918d697fdd6f127924c8db2c74)
2022-09-28T04:34:02.079042Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2324"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (66d51db6cde962c36165dc3a64890f3c3c82cdd41688d9408776c4c8a39b4c08)
2022-09-28T04:34:03.708717Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:34:03.738698Z - running sql script pg/insert_tenders.sql
2022-09-28T04:34:03.738873Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:34:03.744814Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:34:03.746292Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:34:03.751259Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:34:03.755718Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:34:03.760614Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:34:03.761978Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:34:03.808550Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:34:03.812464Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:34:03.814224Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:34:03.816003Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:34:03.885739Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:34:03.914779Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:34:03.919280Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:34:04.136052Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:34:04.308454Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:34:04.314480Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:34:04.317234Z - job completed in 2.24 seconds (66d51db6cde962c36165dc3a64890f3c3c82cdd41688d9408776c4c8a39b4c08)
2022-09-28T04:34:04.406981Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2324"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8601c6aa32b451affd86b905c7a61f79d3ed9c39cf093a778ec515f45a0b7480)
2022-09-28T04:34:06.761328Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:34:06.803337Z - running sql script pg/upsert_orders.sql
2022-09-28T04:34:06.808095Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:34:06.813981Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:34:06.819061Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:34:06.821947Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:34:06.823895Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:34:06.829140Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:34:06.831370Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:34:06.834458Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:34:06.836804Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:34:06.840498Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:34:06.844941Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:34:06.850529Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:34:06.852860Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:34:06.855573Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:34:06.861063Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:34:06.868906Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:34:06.910481Z - job completed in 2.50 seconds (8601c6aa32b451affd86b905c7a61f79d3ed9c39cf093a778ec515f45a0b7480)
2022-09-28T04:36:02.189425Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2326"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (faa502ce595f8ca15f6642e437c557f804ebe38dd5a397aac8b4076cafdebc33)
2022-09-28T04:36:03.609661Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:36:03.639926Z - running sql script pg/insert_tenders.sql
2022-09-28T04:36:03.640210Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:36:03.647170Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:36:03.651052Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:36:03.657679Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:36:03.663681Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:36:03.671668Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:36:03.673279Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:36:03.720506Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:36:03.722794Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:36:03.725803Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:36:03.728077Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:36:03.797314Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:36:03.826158Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:36:03.831136Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:36:04.043796Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:36:04.224077Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:36:04.229821Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:36:04.230611Z - job completed in 2.04 seconds (faa502ce595f8ca15f6642e437c557f804ebe38dd5a397aac8b4076cafdebc33)
2022-09-28T04:36:04.299297Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2326"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (81c8c97decbe69494065bf5289493f549d9224435f9b0a479e42929af26c526f)
2022-09-28T04:36:06.934588Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:36:06.965422Z - running sql script pg/upsert_orders.sql
2022-09-28T04:36:06.965537Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:36:06.970679Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:36:06.972407Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:36:06.974696Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:36:06.978025Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:36:06.980443Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:36:06.982206Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:36:06.983377Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:36:06.984489Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:36:06.986584Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:36:06.988758Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:36:06.990733Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:36:06.991847Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:36:06.997164Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:36:07.000391Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:36:07.005023Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:36:07.005841Z - job completed in 2.71 seconds (81c8c97decbe69494065bf5289493f549d9224435f9b0a479e42929af26c526f)
2022-09-28T04:38:02.036878Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b35830ddc933fd075e39abb7fe42159206dd25bbadb1b9b480066e5f2f08fc12)
2022-09-28T04:38:03.530930Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:38:03.559561Z - running sql script pg/insert_tenders.sql
2022-09-28T04:38:03.559676Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:38:03.564344Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:38:03.566083Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:38:03.572502Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:38:03.576819Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:38:03.581628Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:38:03.583263Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:38:03.629857Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:38:03.632135Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:38:03.633482Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:38:03.635179Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:38:03.704641Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:38:03.734420Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:38:03.738629Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:38:03.952737Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:38:04.127174Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:38:04.132264Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:38:04.133055Z - job completed in 2.10 seconds (b35830ddc933fd075e39abb7fe42159206dd25bbadb1b9b480066e5f2f08fc12)
2022-09-28T04:38:04.186103Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8fb46de6f202cac540aef19e3fe5545813178c4e28daa31f2a324290d4ec3540)
2022-09-28T04:38:06.276345Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:38:06.300064Z - running sql script pg/upsert_orders.sql
2022-09-28T04:38:06.300243Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:38:06.305600Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:38:06.307186Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:38:06.308492Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:38:06.312092Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:38:06.314253Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:38:06.315825Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:38:06.316919Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:38:06.317910Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:38:06.319891Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:38:06.321893Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:38:06.323615Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:38:06.325082Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:38:06.327306Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:38:06.329841Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:38:06.334328Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:38:06.335242Z - job completed in 2.15 seconds (8fb46de6f202cac540aef19e3fe5545813178c4e28daa31f2a324290d4ec3540)
2022-09-28T04:38:06.360075Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022270","time":"2318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (41d87a53e0f2684430f866a7815f96002e15a376a626107b82eaa2f8d8a02fba)
2022-09-28T04:38:13.833363Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:38:13.864256Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T04:38:13.864345Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:38:13.870217Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T04:38:13.872176Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T04:38:13.874178Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T04:38:13.875729Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T04:38:13.877608Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T04:38:13.879585Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T04:38:13.881272Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:38:13.882694Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T04:38:13.884355Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T04:38:13.886679Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T04:38:13.888360Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T04:38:13.889462Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T04:38:13.892010Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T04:38:13.893745Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T04:38:13.895184Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T04:38:13.896826Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T04:38:13.992613Z - called http://score/api/keyed and received back 204
2022-09-28T04:38:13.992846Z - job completed in 7.63 seconds (41d87a53e0f2684430f866a7815f96002e15a376a626107b82eaa2f8d8a02fba)
2022-09-28T04:40:01.977914Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2330"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ce054e2827ba065f43233ea1f55727ea5aa11f7ab8644af469890f37b578b5fb)
2022-09-28T04:40:03.778610Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:40:03.800334Z - running sql script pg/upsert_orders.sql
2022-09-28T04:40:03.800495Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:40:03.805282Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:40:03.806857Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:40:03.810069Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:40:03.811597Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:40:03.814046Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:40:03.815497Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:40:03.817278Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:40:03.819758Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:40:03.822115Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:40:03.824292Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:40:03.825995Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:40:03.827130Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:40:03.828996Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:40:03.831224Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:40:03.835292Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:40:03.836444Z - job completed in 1.86 seconds (ce054e2827ba065f43233ea1f55727ea5aa11f7ab8644af469890f37b578b5fb)
2022-09-28T04:40:03.958338Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2330"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (64cd4ed3c32145784ff8fcce9bc6fc2e917fe88397454e3b14b7c79847a810db)
2022-09-28T04:40:06.242836Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:40:06.262816Z - running sql script pg/insert_tenders.sql
2022-09-28T04:40:06.262911Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:40:06.267231Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:40:06.268768Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:40:06.272946Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:40:06.276810Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:40:06.281762Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:40:06.283074Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:40:06.328851Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:40:06.330725Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:40:06.331899Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:40:06.334769Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:40:06.405291Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:40:06.434836Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:40:06.439839Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:40:06.656808Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:40:06.833168Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:40:06.838272Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:40:06.838944Z - job completed in 2.88 seconds (64cd4ed3c32145784ff8fcce9bc6fc2e917fe88397454e3b14b7c79847a810db)
2022-09-28T04:42:02.070543Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2332"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (68641b24ac7b24ff60a9828dce1c0086887e8c04cf5881cce73b1b6807050924)
2022-09-28T04:42:03.806920Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:42:03.829282Z - running sql script pg/upsert_orders.sql
2022-09-28T04:42:03.829596Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:42:03.835906Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:42:03.837595Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:42:03.842478Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:42:03.843881Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:42:03.846201Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:42:03.848567Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:42:03.850174Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:42:03.851694Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:42:03.854289Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:42:03.856882Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:42:03.858861Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:42:03.860312Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:42:03.862843Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:42:03.865026Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:42:03.869402Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:42:03.870082Z - job completed in 1.80 seconds (68641b24ac7b24ff60a9828dce1c0086887e8c04cf5881cce73b1b6807050924)
2022-09-28T04:42:03.907880Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2332"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a2fd07836c153123d444f1b1187d726a1660cb44f03fd1244f70c81eded445a1)
2022-09-28T04:42:05.268308Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:42:05.292996Z - running sql script pg/insert_tenders.sql
2022-09-28T04:42:05.293360Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:42:05.300938Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:42:05.302720Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:42:05.303827Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:42:05.304864Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:42:05.306418Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:42:05.307643Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:42:05.309936Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:42:05.311935Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:42:05.313787Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:42:05.315934Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:42:05.317664Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:42:05.318984Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:42:05.320664Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:42:05.322565Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:42:05.325019Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:42:05.327738Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:42:05.328348Z - job completed in 1.42 seconds (a2fd07836c153123d444f1b1187d726a1660cb44f03fd1244f70c81eded445a1)
2022-09-28T04:44:02.017002Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2334"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4e4278d17bd0a1958732d324fc67eb6fecaa0d2c449629f787accf71b548c04a)
2022-09-28T04:44:04.854461Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:44:04.891718Z - running sql script pg/insert_tenders.sql
2022-09-28T04:44:04.891825Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:44:04.904489Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:44:04.907449Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:44:04.909114Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:44:04.910874Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:44:04.913130Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:44:04.914599Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:44:04.916837Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:44:04.919803Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:44:04.921178Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:44:04.922584Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:44:04.924402Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:44:04.925986Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:44:04.928174Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:44:04.930245Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:44:04.935945Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:44:04.937505Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:44:04.938121Z - job completed in 2.92 seconds (4e4278d17bd0a1958732d324fc67eb6fecaa0d2c449629f787accf71b548c04a)
2022-09-28T04:44:05.043134Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2334"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a2699867b52a721afe5a8a1494263434b89fa188de965692cc06f6ecec2e09e8)
2022-09-28T04:44:07.072079Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:44:07.137109Z - running sql script pg/upsert_orders.sql
2022-09-28T04:44:07.137184Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:44:07.142674Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:44:07.145833Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:44:07.148088Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:44:07.150159Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:44:07.154510Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:44:07.156475Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:44:07.157789Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:44:07.159037Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:44:07.161181Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:44:07.163667Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:44:07.165550Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:44:07.166905Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:44:07.176360Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:44:07.178461Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:44:07.183076Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:44:07.183787Z - job completed in 2.14 seconds (a2699867b52a721afe5a8a1494263434b89fa188de965692cc06f6ecec2e09e8)
2022-09-28T04:46:02.105898Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2336"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (86864066998583d8ba643fa4313a0da0bc754ee79a1df67effa1b79197122095)
2022-09-28T04:46:04.073821Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:46:04.100432Z - running sql script pg/upsert_orders.sql
2022-09-28T04:46:04.101364Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:46:04.106325Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:46:04.107997Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:46:04.109262Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:46:04.110654Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:46:04.112192Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:46:04.113682Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:46:04.114861Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:46:04.115936Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:46:04.117919Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:46:04.120224Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:46:04.121774Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:46:04.123008Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:46:04.124830Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:46:04.126754Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:46:04.131380Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:46:04.131967Z - job completed in 2.03 seconds (86864066998583d8ba643fa4313a0da0bc754ee79a1df67effa1b79197122095)
2022-09-28T04:46:04.244250Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2336"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (28245ba7c4f133dfb24fa1362425d48b6cc7ed8879123712bf4704fadb45e39a)
2022-09-28T04:46:05.901185Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:46:05.924393Z - running sql script pg/insert_tenders.sql
2022-09-28T04:46:05.924831Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:46:05.930108Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:46:05.931663Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:46:05.932863Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:46:05.934016Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:46:05.935591Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:46:05.936686Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:46:05.939160Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:46:05.942158Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:46:05.943302Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:46:05.944759Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:46:05.946038Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:46:05.947451Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:46:05.948817Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:46:05.950896Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:46:05.952776Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:46:05.954606Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:46:05.955140Z - job completed in 1.71 seconds (28245ba7c4f133dfb24fa1362425d48b6cc7ed8879123712bf4704fadb45e39a)
2022-09-28T04:48:02.081094Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (eb4e4317a05fac2d5e9cd701ee819297a0b71acd9461394cd7d23bf0390b9abc)
2022-09-28T04:48:03.421421Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:48:03.469445Z - running sql script pg/insert_tenders.sql
2022-09-28T04:48:03.469512Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:48:03.474324Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:48:03.475872Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:48:03.478103Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:48:03.479313Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:48:03.480786Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:48:03.481905Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:48:03.484161Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:48:03.485758Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:48:03.487175Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:48:03.488610Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:48:03.490121Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:48:03.492213Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:48:03.493656Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:48:03.495641Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:48:03.497494Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:48:03.499310Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:48:03.500050Z - job completed in 1.42 seconds (eb4e4317a05fac2d5e9cd701ee819297a0b71acd9461394cd7d23bf0390b9abc)
2022-09-28T04:48:03.591108Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022270","time":"2328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (451571101387080083552bd0e31a87ad726ea1ab30471f5e51ffbd80dc5a84af)
2022-09-28T04:48:07.950041Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:48:07.986498Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T04:48:07.986563Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:48:07.991715Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T04:48:07.993513Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T04:48:07.994720Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T04:48:07.995963Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T04:48:07.997118Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T04:48:07.999649Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T04:48:08.001876Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:48:08.003071Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T04:48:08.006748Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T04:48:08.008765Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T04:48:08.010457Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T04:48:08.011685Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T04:48:08.014190Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T04:48:08.015410Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T04:48:08.016794Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T04:48:08.018423Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T04:48:08.094199Z - called http://score/api/keyed and received back 204
2022-09-28T04:48:08.094803Z - job completed in 4.50 seconds (451571101387080083552bd0e31a87ad726ea1ab30471f5e51ffbd80dc5a84af)
2022-09-28T04:48:08.197388Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0b5b8921ed2f3b3cdf21ad7700b15c2548c75ab5e994b0e335b7654fac699213)
2022-09-28T04:48:10.078135Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:48:10.115371Z - running sql script pg/upsert_orders.sql
2022-09-28T04:48:10.115436Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:48:10.121153Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:48:10.122674Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:48:10.124325Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:48:10.125798Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:48:10.127374Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:48:10.129805Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:48:10.132721Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:48:10.134827Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:48:10.137342Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:48:10.141151Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:48:10.142962Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:48:10.145908Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:48:10.149979Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:48:10.153239Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:48:10.157511Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:48:10.157942Z - job completed in 1.96 seconds (0b5b8921ed2f3b3cdf21ad7700b15c2548c75ab5e994b0e335b7654fac699213)
2022-09-28T04:50:02.173548Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2340"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ba5f205eddee163c7c038f0193af01751c3dc0a810aeb626e85e3a10dbce88a1)
2022-09-28T04:50:04.368469Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:50:04.388559Z - running sql script pg/upsert_orders.sql
2022-09-28T04:50:04.388624Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:50:04.394128Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:50:04.395821Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:50:04.396945Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:50:04.398128Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:50:04.399635Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:50:04.401370Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:50:04.402570Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:50:04.403964Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:50:04.406219Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:50:04.408510Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:50:04.410333Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:50:04.411860Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:50:04.414267Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:50:04.416554Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:50:04.421409Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:50:04.422041Z - job completed in 2.25 seconds (ba5f205eddee163c7c038f0193af01751c3dc0a810aeb626e85e3a10dbce88a1)
2022-09-28T04:50:04.602565Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2340"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (56a71528f7221f5def84b278917b9f194e7a1f665ab5ba8e84d9f1363789f501)
2022-09-28T04:50:05.976541Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:50:05.999070Z - running sql script pg/insert_tenders.sql
2022-09-28T04:50:05.999131Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:50:06.005122Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:50:06.006516Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:50:06.007675Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:50:06.009389Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:50:06.010918Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:50:06.011953Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:50:06.014131Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:50:06.015671Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:50:06.016830Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:50:06.018291Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:50:06.020441Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:50:06.021934Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:50:06.023373Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:50:06.025029Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:50:06.026833Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:50:06.028533Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:50:06.029146Z - job completed in 1.43 seconds (56a71528f7221f5def84b278917b9f194e7a1f665ab5ba8e84d9f1363789f501)
2022-09-28T04:52:02.070490Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2342"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a92ca446b22a234c42cfda3b529648ccbce41c57c10fc401f32b429502a18112)
2022-09-28T04:52:04.137698Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:52:04.160905Z - running sql script pg/upsert_orders.sql
2022-09-28T04:52:04.160960Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:52:04.166755Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:52:04.168414Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:52:04.169576Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:52:04.170713Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:52:04.172869Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:52:04.174528Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:52:04.175647Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:52:04.176786Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:52:04.179186Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:52:04.181884Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:52:04.183751Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:52:04.184814Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:52:04.186968Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:52:04.189486Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:52:04.195409Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:52:04.195959Z - job completed in 2.13 seconds (a92ca446b22a234c42cfda3b529648ccbce41c57c10fc401f32b429502a18112)
2022-09-28T04:52:04.219015Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2342"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5e65eb434aef66c8da4ee3d8ebf7c536fc341e74db60c3cb07c9e07d7d7c905e)
2022-09-28T04:52:05.638020Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:52:05.746978Z - running sql script pg/insert_tenders.sql
2022-09-28T04:52:05.747070Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:52:05.752181Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:52:05.753628Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:52:05.755138Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:52:05.756331Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:52:05.758264Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:52:05.759439Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:52:05.762409Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:52:05.765222Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:52:05.767498Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:52:05.769167Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:52:05.770547Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:52:05.772640Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:52:05.774705Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:52:05.779001Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:52:05.781361Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:52:05.783710Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:52:05.784434Z - job completed in 1.57 seconds (5e65eb434aef66c8da4ee3d8ebf7c536fc341e74db60c3cb07c9e07d7d7c905e)
2022-09-28T04:54:02.067746Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2344"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e6095ba7b845af2f2037040d74d013aed4c4d030459e86c0240dc479449a957f)
2022-09-28T04:54:03.372165Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:54:03.393636Z - running sql script pg/insert_tenders.sql
2022-09-28T04:54:03.393696Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:54:03.398269Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:54:03.399897Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:54:03.401144Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:54:03.402272Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:54:03.403869Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:54:03.405131Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:54:03.407767Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:54:03.409296Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:54:03.410347Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:54:03.411728Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:54:03.413158Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:54:03.414543Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:54:03.416012Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:54:03.417891Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:54:03.419755Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:54:03.421489Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:54:03.422052Z - job completed in 1.35 seconds (e6095ba7b845af2f2037040d74d013aed4c4d030459e86c0240dc479449a957f)
2022-09-28T04:54:03.522573Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2344"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (aafb2c5c91a2307981d1788e96702a1a198773b31b208f5187d411b11868467e)
2022-09-28T04:54:05.740135Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:54:05.786737Z - running sql script pg/upsert_orders.sql
2022-09-28T04:54:05.787028Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:54:05.792507Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:54:05.795660Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:54:05.796890Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:54:05.798498Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:54:05.800209Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:54:05.803694Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:54:05.805129Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:54:05.806874Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:54:05.809720Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:54:05.812359Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:54:05.814779Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:54:05.816110Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:54:05.823186Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:54:05.836105Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:54:05.843065Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:54:05.843639Z - job completed in 2.32 seconds (aafb2c5c91a2307981d1788e96702a1a198773b31b208f5187d411b11868467e)
2022-09-28T04:56:02.250939Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2346"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6cb2aa357b2ab46a13801832fdd864063f4ecd3131675ec3acfc90b46fa19e44)
2022-09-28T04:56:03.783434Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:56:03.820359Z - running sql script pg/insert_tenders.sql
2022-09-28T04:56:03.820427Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:56:03.826395Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:56:03.828549Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:56:03.830254Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:56:03.831848Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:56:03.833577Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:56:03.834811Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:56:03.837977Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:56:03.840021Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:56:03.841580Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:56:03.843464Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:56:03.845323Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:56:03.846692Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:56:03.848164Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:56:03.850216Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:56:03.852365Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:56:03.853929Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:56:03.854685Z - job completed in 1.60 seconds (6cb2aa357b2ab46a13801832fdd864063f4ecd3131675ec3acfc90b46fa19e44)
2022-09-28T04:56:03.939943Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2346"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0c81bb6c47a7e2cd88d82f1ade6ad4bbc1f57a1345fd68b8263181599166f583)
2022-09-28T04:56:05.911492Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:56:05.936563Z - running sql script pg/upsert_orders.sql
2022-09-28T04:56:05.936623Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:56:05.941947Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:56:05.943411Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:56:05.944406Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:56:05.945358Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:56:05.946692Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:56:05.948046Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:56:05.949005Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:56:05.949858Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:56:05.951703Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:56:05.953753Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:56:05.955257Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:56:05.956229Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:56:05.958144Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:56:05.960062Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:56:05.964011Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:56:05.964618Z - job completed in 2.03 seconds (0c81bb6c47a7e2cd88d82f1ade6ad4bbc1f57a1345fd68b8263181599166f583)
2022-09-28T04:58:02.108984Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b4c10a6180348fad77415222ac2285fc530ef5fbdd2a5f210dbbbf041f4e814d)
2022-09-28T04:58:03.984464Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:58:04.003217Z - running sql script pg/upsert_orders.sql
2022-09-28T04:58:04.003269Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:58:04.010722Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T04:58:04.012396Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T04:58:04.013976Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T04:58:04.015081Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T04:58:04.017129Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T04:58:04.018683Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:58:04.020056Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T04:58:04.021539Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T04:58:04.023770Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T04:58:04.026804Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T04:58:04.029469Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T04:58:04.030686Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T04:58:04.032828Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T04:58:04.034797Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T04:58:04.039026Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T04:58:04.039499Z - job completed in 1.93 seconds (b4c10a6180348fad77415222ac2285fc530ef5fbdd2a5f210dbbbf041f4e814d)
2022-09-28T04:58:04.103772Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (76c18af7b41ec685535f078c72af83c87de75f312ecf2108728de7cc3a71532e)
2022-09-28T04:58:05.398578Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:58:05.420258Z - running sql script pg/insert_tenders.sql
2022-09-28T04:58:05.420318Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T04:58:05.425158Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T04:58:05.426767Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T04:58:05.428022Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T04:58:05.429084Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T04:58:05.430504Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T04:58:05.431755Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T04:58:05.434123Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T04:58:05.435656Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T04:58:05.436720Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T04:58:05.438162Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T04:58:05.439593Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T04:58:05.440889Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T04:58:05.442164Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T04:58:05.443968Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T04:58:05.445884Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T04:58:05.447446Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T04:58:05.447980Z - job completed in 1.34 seconds (76c18af7b41ec685535f078c72af83c87de75f312ecf2108728de7cc3a71532e)
2022-09-28T04:58:05.532372Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022270","time":"2338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (467e6d772eaf073de5e3f25e6b6ba91855eeb91f436ec79c9df0c1f20cc25252)
2022-09-28T04:58:10.159807Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T04:58:10.194685Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T04:58:10.194801Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T04:58:10.199829Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T04:58:10.202055Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T04:58:10.203252Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T04:58:10.204284Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T04:58:10.205351Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T04:58:10.206816Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T04:58:10.208053Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T04:58:10.209144Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T04:58:10.210217Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T04:58:10.212228Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T04:58:10.214035Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T04:58:10.215168Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T04:58:10.217564Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T04:58:10.218680Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T04:58:10.219988Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T04:58:10.221732Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T04:58:10.301176Z - called http://score/api/keyed and received back 204
2022-09-28T04:58:10.301515Z - job completed in 4.77 seconds (467e6d772eaf073de5e3f25e6b6ba91855eeb91f436ec79c9df0c1f20cc25252)
2022-09-28T05:00:02.054263Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2350"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a72881c7f58163fbf743b34c41c538f1e7ef6da9dd2b1d3dfe9deecfa531d502)
2022-09-28T05:00:03.647338Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:00:03.700297Z - running sql script pg/insert_tenders.sql
2022-09-28T05:00:03.700951Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:00:03.706495Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:00:03.708725Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:00:03.710887Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:00:03.713435Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:00:03.716201Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:00:03.717921Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:00:03.721186Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:00:03.723008Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:00:03.724453Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:00:03.726111Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:00:03.727835Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:00:03.729899Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:00:03.731853Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:00:03.734586Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:00:03.738354Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:00:03.740977Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:00:03.741803Z - job completed in 1.69 seconds (a72881c7f58163fbf743b34c41c538f1e7ef6da9dd2b1d3dfe9deecfa531d502)
2022-09-28T05:00:03.797173Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2350"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d941139b8521684061cf5d441a64dfb459c9923cd5b143a6f690c8bc3cbf483a)
2022-09-28T05:00:05.947906Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:00:05.967205Z - running sql script pg/upsert_orders.sql
2022-09-28T05:00:05.967437Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:00:05.972692Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:00:05.974131Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:00:05.975143Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:00:05.976206Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:00:05.977678Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:00:05.979244Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:00:05.980303Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:00:05.981243Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:00:05.983428Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:00:05.985872Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:00:05.987662Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:00:05.988782Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:00:05.990480Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:00:05.992306Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:00:05.996353Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:00:05.997616Z - job completed in 2.20 seconds (d941139b8521684061cf5d441a64dfb459c9923cd5b143a6f690c8bc3cbf483a)
2022-09-28T05:02:02.127845Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2352"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7eee90744aa065a15493c2f254cf934a5e927253878643123622e727febc4c71)
2022-09-28T05:02:03.759455Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:02:03.778664Z - running sql script pg/insert_tenders.sql
2022-09-28T05:02:03.778718Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:02:03.783817Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:02:03.785385Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:02:03.786543Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:02:03.787873Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:02:03.789350Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:02:03.790339Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:02:03.792481Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:02:03.794137Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:02:03.795293Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:02:03.796820Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:02:03.798373Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:02:03.800248Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:02:03.801652Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:02:03.803417Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:02:03.805492Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:02:03.807178Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:02:03.807675Z - job completed in 1.68 seconds (7eee90744aa065a15493c2f254cf934a5e927253878643123622e727febc4c71)
2022-09-28T05:02:03.903705Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2352"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (176a915875bec1c4ad14563e64612fc8df306c26ce95af2dfae77177d5fbb5e2)
2022-09-28T05:02:05.615724Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:02:05.635110Z - running sql script pg/upsert_orders.sql
2022-09-28T05:02:05.635173Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:02:05.640017Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:02:05.641647Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:02:05.642803Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:02:05.644009Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:02:05.645377Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:02:05.646770Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:02:05.647860Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:02:05.648972Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:02:05.650885Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:02:05.653038Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:02:05.654704Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:02:05.655755Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:02:05.657758Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:02:05.663819Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:02:05.668150Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:02:05.669967Z - job completed in 1.77 seconds (176a915875bec1c4ad14563e64612fc8df306c26ce95af2dfae77177d5fbb5e2)
2022-09-28T05:04:02.168203Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2354"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d7d227859ba08dfbeb63591783be5791a9d8d511ba8bba61f3d9c7b81934524a)
2022-09-28T05:04:03.261660Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:04:03.282095Z - running sql script pg/insert_tenders.sql
2022-09-28T05:04:03.282169Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:04:03.286786Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:04:03.288282Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:04:03.289491Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:04:03.291092Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:04:03.293686Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:04:03.294678Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:04:03.297031Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:04:03.298874Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:04:03.299834Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:04:03.301373Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:04:03.302869Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:04:03.304303Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:04:03.305672Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:04:03.307522Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:04:03.309465Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:04:03.311114Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:04:03.311831Z - job completed in 1.14 seconds (d7d227859ba08dfbeb63591783be5791a9d8d511ba8bba61f3d9c7b81934524a)
2022-09-28T05:04:03.418862Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2354"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (16d59e729e7df83228dab66f95a19317ef67cb45d9b34d082b55d54626c9fecd)
2022-09-28T05:04:05.386027Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:04:05.436538Z - running sql script pg/upsert_orders.sql
2022-09-28T05:04:05.436957Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:04:05.442873Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:04:05.444534Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:04:05.445642Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:04:05.446774Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:04:05.448301Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:04:05.450126Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:04:05.451290Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:04:05.452335Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:04:05.454258Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:04:05.457271Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:04:05.459237Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:04:05.460474Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:04:05.463655Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:04:05.465814Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:04:05.469961Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:04:05.470627Z - job completed in 2.05 seconds (16d59e729e7df83228dab66f95a19317ef67cb45d9b34d082b55d54626c9fecd)
2022-09-28T05:06:02.107026Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2356"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fae37702a47c3cd244e54d10b9a19731d81cd1c6d05c1dea5162f01136b921f3)
2022-09-28T05:06:04.238996Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:06:04.263501Z - running sql script pg/upsert_orders.sql
2022-09-28T05:06:04.263586Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:06:04.269080Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:06:04.270845Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:06:04.272649Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:06:04.273812Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:06:04.275433Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:06:04.277211Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:06:04.278337Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:06:04.279329Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:06:04.281169Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:06:04.283276Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:06:04.284817Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:06:04.285735Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:06:04.287571Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:06:04.289431Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:06:04.293556Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:06:04.294131Z - job completed in 2.19 seconds (fae37702a47c3cd244e54d10b9a19731d81cd1c6d05c1dea5162f01136b921f3)
2022-09-28T05:06:04.352739Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2356"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dd8ca72c239e4e6e258555a2e6f8c76350db819dbdaec4b5db1115331ef8269e)
2022-09-28T05:06:08.102764Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:06:08.133726Z - running sql script pg/insert_tenders.sql
2022-09-28T05:06:08.133799Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:06:08.139132Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:06:08.141298Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:06:08.143291Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:06:08.144321Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:06:08.152193Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:06:08.157344Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:06:08.162638Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:06:08.164821Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:06:08.166107Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:06:08.167667Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:06:08.169462Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:06:08.171080Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:06:08.172582Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:06:08.174763Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:06:08.176812Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:06:08.180600Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:06:08.181303Z - job completed in 3.83 seconds (dd8ca72c239e4e6e258555a2e6f8c76350db819dbdaec4b5db1115331ef8269e)
2022-09-28T05:08:02.341673Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022270","time":"2348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (aeb5ccbef34ab8aa9fda8de6a16b7a1f12a9a237d9e2b1b9916bc33c75018b7e)
2022-09-28T05:08:07.966512Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:08:07.989137Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T05:08:07.989512Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:08:07.995361Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T05:08:07.997294Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T05:08:07.998917Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T05:08:08.000596Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T05:08:08.001996Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T05:08:08.003842Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T05:08:08.005703Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:08:08.007154Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T05:08:08.009955Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T05:08:08.014618Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T05:08:08.016857Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T05:08:08.018739Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T05:08:08.022423Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T05:08:08.024003Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T05:08:08.025453Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T05:08:08.027614Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T05:08:08.105318Z - called http://score/api/keyed and received back 204
2022-09-28T05:08:08.105576Z - job completed in 5.76 seconds (aeb5ccbef34ab8aa9fda8de6a16b7a1f12a9a237d9e2b1b9916bc33c75018b7e)
2022-09-28T05:08:08.194563Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022270","time":"2358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5a8401c11d394f983a9023d49f690ba671664334a1bf67905c5b578e7cbffd01)
2022-09-28T05:08:09.275102Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:08:09.307001Z - running sql script pg/insert_tenders.sql
2022-09-28T05:08:09.307096Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:08:09.313278Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:08:09.315108Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:08:09.316645Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:08:09.318142Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:08:09.320315Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:08:09.321683Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:08:09.324418Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:08:09.326340Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:08:09.327705Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:08:09.329430Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:08:09.331458Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:08:09.333153Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:08:09.334734Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:08:09.336733Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:08:09.338928Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:08:09.340936Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:08:09.341668Z - job completed in 1.15 seconds (5a8401c11d394f983a9023d49f690ba671664334a1bf67905c5b578e7cbffd01)
2022-09-28T05:08:09.408519Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022270","time":"2358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (67302a5e423167f87c4486a32ebec8a73b49a8c143616773a0957ed50cbdb084)
2022-09-28T05:08:11.168067Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:08:11.190808Z - running sql script pg/upsert_orders.sql
2022-09-28T05:08:11.190872Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:08:11.196151Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:08:11.197616Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:08:11.198803Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:08:11.200131Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:08:11.201544Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:08:11.202929Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:08:11.204194Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:08:11.205195Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:08:11.207239Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:08:11.209427Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:08:11.211201Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:08:11.212335Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:08:11.214817Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:08:11.221229Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:08:11.225512Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:08:11.226456Z - job completed in 1.82 seconds (67302a5e423167f87c4486a32ebec8a73b49a8c143616773a0957ed50cbdb084)
2022-09-28T05:10:02.141537Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0000"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5c99aae125ba649ce4436bb7ac13b8e9b803ded4d41244564263cbe08a912323)
2022-09-28T05:10:06.521010Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:10:06.543307Z - running sql script pg/upsert_orders.sql
2022-09-28T05:10:06.543365Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:10:06.548845Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:10:06.550241Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:10:06.552113Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:10:06.553366Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:10:06.554543Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:10:06.555796Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:10:06.556814Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:10:06.558094Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:10:06.560193Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:10:06.562247Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:10:06.563820Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:10:06.564957Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:10:06.566618Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:10:06.568377Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:10:06.572444Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:10:06.573034Z - job completed in 4.43 seconds (5c99aae125ba649ce4436bb7ac13b8e9b803ded4d41244564263cbe08a912323)
2022-09-28T05:10:06.610907Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0000"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8b7c96236706ba504e002bbe2d0a9082167902a7203267899bf9e15d9cf71b0c)
2022-09-28T05:10:07.937184Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:10:07.955804Z - running sql script pg/insert_tenders.sql
2022-09-28T05:10:07.956275Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:10:07.961760Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:10:07.964098Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:10:07.965935Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:10:07.967462Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:10:07.969540Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:10:07.971038Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:10:07.974070Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:10:07.975900Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:10:07.977496Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:10:07.979414Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:10:07.983415Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:10:07.985330Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:10:07.987182Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:10:07.990007Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:10:07.992737Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:10:07.996631Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:10:07.997402Z - job completed in 1.39 seconds (8b7c96236706ba504e002bbe2d0a9082167902a7203267899bf9e15d9cf71b0c)
2022-09-28T05:12:02.070673Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0002"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (08502a39a5f50bee4c2b5d1b9c7fc30d47ce28cb0458f706ec1f1f5ce79ff32f)
2022-09-28T05:12:03.514175Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:12:03.534016Z - running sql script pg/insert_tenders.sql
2022-09-28T05:12:03.534082Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:12:03.538993Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:12:03.540526Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:12:03.542112Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:12:03.543339Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:12:03.544993Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:12:03.548280Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:12:03.550719Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:12:03.552321Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:12:03.553439Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:12:03.554789Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:12:03.556239Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:12:03.557706Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:12:03.559432Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:12:03.561547Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:12:03.563433Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:12:03.564924Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:12:03.566866Z - job completed in 1.50 seconds (08502a39a5f50bee4c2b5d1b9c7fc30d47ce28cb0458f706ec1f1f5ce79ff32f)
2022-09-28T05:12:03.589018Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0002"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5dcda5d9f7be86648b1743b4aee7523dc70414410a9b15bc72d5c65c0453549d)
2022-09-28T05:12:05.378044Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:12:05.401518Z - running sql script pg/upsert_orders.sql
2022-09-28T05:12:05.401912Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:12:05.409519Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:12:05.411120Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:12:05.412634Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:12:05.425015Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:12:05.426511Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:12:05.429179Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:12:05.430690Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:12:05.433149Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:12:05.435417Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:12:05.437800Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:12:05.440139Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:12:05.441534Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:12:05.443758Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:12:05.446585Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:12:05.450949Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:12:05.451847Z - job completed in 1.86 seconds (5dcda5d9f7be86648b1743b4aee7523dc70414410a9b15bc72d5c65c0453549d)
2022-09-28T05:14:02.027048Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0004"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b3de91b35840d38ce5316091e7581ba57a54647b15883c66ebb7edd18448c5c8)
2022-09-28T05:14:04.309917Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:14:04.328076Z - running sql script pg/upsert_orders.sql
2022-09-28T05:14:04.328137Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:14:04.333147Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:14:04.334491Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:14:04.335873Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:14:04.336840Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:14:04.337998Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:14:04.339188Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:14:04.340008Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:14:04.340875Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:14:04.342599Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:14:04.344752Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:14:04.346561Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:14:04.347643Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:14:04.349556Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:14:04.351363Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:14:04.355216Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:14:04.355778Z - job completed in 2.33 seconds (b3de91b35840d38ce5316091e7581ba57a54647b15883c66ebb7edd18448c5c8)
2022-09-28T05:14:04.444998Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0004"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b87be65e241f464b251710fe291cb94d13a4cc2766e2c4ca3e013d95db102314)
2022-09-28T05:14:05.623164Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:14:05.641967Z - running sql script pg/insert_tenders.sql
2022-09-28T05:14:05.642299Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:14:05.646982Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:14:05.648922Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:14:05.653161Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:14:05.657810Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:14:05.662800Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:14:05.664506Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:14:05.738988Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:14:05.759806Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:14:05.761611Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:14:05.763779Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:14:05.843981Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:14:05.873702Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:14:05.899422Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:14:06.299997Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:14:06.550321Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:14:06.623620Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:14:06.624928Z - job completed in 2.18 seconds (b87be65e241f464b251710fe291cb94d13a4cc2766e2c4ca3e013d95db102314)
2022-09-28T05:16:02.047182Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0006"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (85acf7d994d1dd52debbac7fee9abe2a6178b67ab734b773ff4ac5acd4fe79cf)
2022-09-28T05:16:06.239590Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:16:06.266990Z - running sql script pg/insert_tenders.sql
2022-09-28T05:16:06.267514Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:16:06.275243Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:16:06.277950Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:16:06.282391Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:16:06.286558Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:16:06.292584Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:16:06.294561Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:16:06.342822Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:16:06.345693Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:16:06.350233Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:16:06.355261Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:16:06.425862Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:16:06.456353Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:16:06.463923Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:16:06.697262Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:16:06.893368Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:16:06.907783Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:16:06.909426Z - job completed in 4.86 seconds (85acf7d994d1dd52debbac7fee9abe2a6178b67ab734b773ff4ac5acd4fe79cf)
2022-09-28T05:16:06.956972Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0006"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a7a245dc018b5656e77859d65f6bba70622778386082ce89caa6006cb458a41b)
2022-09-28T05:16:10.680973Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:16:10.702392Z - running sql script pg/upsert_orders.sql
2022-09-28T05:16:10.702450Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:16:10.707570Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:16:10.710803Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:16:10.711989Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:16:10.713447Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:16:10.715659Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:16:10.717505Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:16:10.718810Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:16:10.720296Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:16:10.723259Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:16:10.726178Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:16:10.728361Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:16:10.730009Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:16:10.732363Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:16:10.734552Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:16:10.738835Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:16:10.739494Z - job completed in 3.78 seconds (a7a245dc018b5656e77859d65f6bba70622778386082ce89caa6006cb458a41b)
2022-09-28T05:18:02.210834Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0008"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (653e4e25458bd101d79fc8576df715141cc7d18d3edca004231bc4e88d191b30)
2022-09-28T05:18:04.159943Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:18:04.178700Z - running sql script pg/upsert_orders.sql
2022-09-28T05:18:04.179241Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:18:04.184562Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:18:04.189239Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:18:04.191271Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:18:04.196800Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:18:04.199891Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:18:04.208317Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:18:04.211310Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:18:04.212613Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:18:04.219124Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:18:04.230874Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:18:04.232619Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:18:04.233723Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:18:04.260258Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:18:04.816809Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:18:04.867080Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:18:04.867716Z - job completed in 2.66 seconds (653e4e25458bd101d79fc8576df715141cc7d18d3edca004231bc4e88d191b30)
2022-09-28T05:18:04.974994Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0008"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (41e97ca9304df315992559d87cc15c710849e1bc220be6c25a376ec854892b0c)
2022-09-28T05:18:06.256828Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:18:06.276579Z - running sql script pg/insert_tenders.sql
2022-09-28T05:18:06.276640Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:18:06.283452Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:18:06.284933Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:18:06.289927Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:18:06.294318Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:18:06.299902Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:18:06.301278Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:18:06.346452Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:18:06.347863Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:18:06.348872Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:18:06.350106Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:18:06.418239Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:18:06.447745Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:18:06.453278Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:18:06.686136Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:18:06.873339Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:18:06.878731Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:18:06.879137Z - job completed in 1.91 seconds (41e97ca9304df315992559d87cc15c710849e1bc220be6c25a376ec854892b0c)
2022-09-28T05:18:06.987243Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022270","time":"2358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (e2073106549fc8f497fcc05c6d8e3937d247ebf3f7b4cabb2cc3add6c20e6753)
2022-09-28T05:18:11.060033Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:18:11.096362Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T05:18:11.096569Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:18:11.102411Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T05:18:11.105434Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T05:18:11.109045Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T05:18:11.110834Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T05:18:11.112691Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T05:18:11.115713Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T05:18:11.118820Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:18:11.120351Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T05:18:11.121866Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T05:18:11.124946Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T05:18:11.127132Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T05:18:11.128895Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T05:18:11.131954Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T05:18:11.133177Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T05:18:11.134461Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T05:18:11.137073Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T05:18:11.227235Z - called http://score/api/keyed and received back 204
2022-09-28T05:18:11.227478Z - job completed in 4.24 seconds (e2073106549fc8f497fcc05c6d8e3937d247ebf3f7b4cabb2cc3add6c20e6753)
2022-09-28T05:20:02.174767Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0010"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a1ff208f94579c33e199a51aed787fc33c4d58507bcb4f768ee1e02dbe80e4aa)
2022-09-28T05:20:06.202910Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:20:06.224741Z - running sql script pg/upsert_orders.sql
2022-09-28T05:20:06.224787Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:20:06.229681Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:20:06.235253Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:20:06.236413Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:20:06.240157Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:20:06.241678Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:20:06.243269Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:20:06.244584Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:20:06.246164Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:20:06.252159Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:20:06.263587Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:20:06.265512Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:20:06.266584Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:20:06.271968Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:20:06.331156Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:20:06.339071Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:20:06.339615Z - job completed in 4.17 seconds (a1ff208f94579c33e199a51aed787fc33c4d58507bcb4f768ee1e02dbe80e4aa)
2022-09-28T05:20:06.358702Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0010"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (91a17847b5a15bf412408341193db0ffa191336e1e30633137c2b549ad06d4fa)
2022-09-28T05:20:07.641388Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:20:07.675681Z - running sql script pg/insert_tenders.sql
2022-09-28T05:20:07.675748Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:20:07.680804Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:20:07.682575Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:20:07.686597Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:20:07.690559Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:20:07.694668Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:20:07.695874Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:20:07.742003Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:20:07.743641Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:20:07.746484Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:20:07.747985Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:20:07.816506Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:20:07.846012Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:20:07.851493Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:20:08.075647Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:20:08.283271Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:20:08.288507Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:20:08.289089Z - job completed in 1.93 seconds (91a17847b5a15bf412408341193db0ffa191336e1e30633137c2b549ad06d4fa)
2022-09-28T05:22:02.242991Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0012"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d58bc5b12940ebca3e0168e5c590729d9b9e917bbbe42533efb6fbc9dc62dde2)
2022-09-28T05:22:04.857525Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:22:04.902694Z - running sql script pg/insert_tenders.sql
2022-09-28T05:22:04.902760Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:22:04.907228Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:22:04.908509Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:22:04.912576Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:22:04.917481Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:22:04.922738Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:22:04.924173Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:22:04.971932Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:22:04.975626Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:22:04.976840Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:22:04.978521Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:22:05.047516Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:22:05.077301Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:22:05.082741Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:22:05.308147Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:22:05.496325Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:22:05.501923Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:22:05.502363Z - job completed in 3.26 seconds (d58bc5b12940ebca3e0168e5c590729d9b9e917bbbe42533efb6fbc9dc62dde2)
2022-09-28T05:22:05.526493Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0012"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4ec21e22bfb2b1b8ef4ef34e786e363b1581676f7f8e0695ea3ba1cd925eb796)
2022-09-28T05:22:07.874453Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:22:07.894309Z - running sql script pg/upsert_orders.sql
2022-09-28T05:22:07.894394Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:22:07.898641Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:22:07.903616Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:22:07.904701Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:22:07.908269Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:22:07.909667Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:22:07.910995Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:22:07.911965Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:22:07.912909Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:22:07.918375Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:22:07.929391Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:22:07.931004Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:22:07.932089Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:22:07.937343Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:22:07.996085Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:22:08.002975Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:22:08.003589Z - job completed in 2.48 seconds (4ec21e22bfb2b1b8ef4ef34e786e363b1581676f7f8e0695ea3ba1cd925eb796)
2022-09-28T05:24:02.197585Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0014"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b8403485384a899d2fdff5552ee597df0827f7d4a9545b2862ee5db43e22ca78)
2022-09-28T05:24:04.124225Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:24:04.158142Z - running sql script pg/upsert_orders.sql
2022-09-28T05:24:04.158205Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:24:04.163482Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:24:04.168376Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:24:04.169552Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:24:04.173584Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:24:04.174946Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:24:04.176349Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:24:04.177549Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:24:04.178507Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:24:04.184228Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:24:04.195496Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:24:04.198305Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:24:04.199476Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:24:04.204740Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:24:04.274956Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:24:04.282329Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:24:04.282965Z - job completed in 2.09 seconds (b8403485384a899d2fdff5552ee597df0827f7d4a9545b2862ee5db43e22ca78)
2022-09-28T05:24:04.395892Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0014"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (db938d5c7c48e5821fdf18af303d8c6b0ca93f94128bd7dbe00249facaa90e6b)
2022-09-28T05:24:05.805177Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:24:05.824254Z - running sql script pg/insert_tenders.sql
2022-09-28T05:24:05.824309Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:24:05.829403Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:24:05.830635Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:24:05.831635Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:24:05.832836Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:24:05.834265Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:24:05.835202Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:24:05.837355Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:24:05.838715Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:24:05.839747Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:24:05.843376Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:24:05.844864Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:24:05.846352Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:24:05.848845Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:24:05.851047Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:24:05.852847Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:24:05.854599Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:24:05.861786Z - job completed in 1.46 seconds (db938d5c7c48e5821fdf18af303d8c6b0ca93f94128bd7dbe00249facaa90e6b)
2022-09-28T05:26:02.156811Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0016"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d61f207098e0762ad7d5ad542462ae96da3d5a207624cf270efd069442d87ca2)
2022-09-28T05:26:03.392622Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:26:03.419421Z - running sql script pg/insert_tenders.sql
2022-09-28T05:26:03.419494Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:26:03.424973Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:26:03.426404Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:26:03.427594Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:26:03.429037Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:26:03.430888Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:26:03.432047Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:26:03.435203Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:26:03.437221Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:26:03.438728Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:26:03.440578Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:26:03.442588Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:26:03.444814Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:26:03.446459Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:26:03.448669Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:26:03.450943Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:26:03.452926Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:26:03.453437Z - job completed in 1.30 seconds (d61f207098e0762ad7d5ad542462ae96da3d5a207624cf270efd069442d87ca2)
2022-09-28T05:26:03.569721Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0016"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f3619e3b277861a43bf81ae578295a4735dabf06b6fb017636ce77be0f9b138e)
2022-09-28T05:26:05.256091Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:26:05.276369Z - running sql script pg/upsert_orders.sql
2022-09-28T05:26:05.276434Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:26:05.281403Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:26:05.285820Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:26:05.286828Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:26:05.290517Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:26:05.291955Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:26:05.293412Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:26:05.294606Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:26:05.295647Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:26:05.301768Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:26:05.312849Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:26:05.314591Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:26:05.315565Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:26:05.321446Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:26:05.404644Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:26:05.412945Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:26:05.413509Z - job completed in 1.84 seconds (f3619e3b277861a43bf81ae578295a4735dabf06b6fb017636ce77be0f9b138e)
2022-09-28T05:28:02.030446Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0008"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (9e56994062d4fe1e0a2109fbba121cb5cf122ae057e204357188d61f6ffda7e5)
2022-09-28T05:28:06.791137Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:28:06.812517Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T05:28:06.812733Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:28:06.817847Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T05:28:06.821225Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T05:28:06.822874Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T05:28:06.824565Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T05:28:06.826055Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T05:28:06.832504Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T05:28:06.834272Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:28:06.835646Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T05:28:06.836897Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T05:28:06.838789Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T05:28:06.840491Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T05:28:06.841685Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T05:28:06.844136Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T05:28:06.845356Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T05:28:06.846504Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T05:28:06.848192Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T05:28:06.924553Z - called http://score/api/keyed and received back 204
2022-09-28T05:28:06.924696Z - job completed in 4.89 seconds (9e56994062d4fe1e0a2109fbba121cb5cf122ae057e204357188d61f6ffda7e5)
2022-09-28T05:28:06.967006Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0018"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c1a786788c9dfbb9a1575aebd289f727b7ad657fe9c015e2e03f6778d0499e39)
2022-09-28T05:28:08.182784Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:28:08.210201Z - running sql script pg/insert_tenders.sql
2022-09-28T05:28:08.210266Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:28:08.215285Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:28:08.217006Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:28:08.221440Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:28:08.225372Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:28:08.230820Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:28:08.231675Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:28:08.276754Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:28:08.278282Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:28:08.279186Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:28:08.280593Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:28:08.332284Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:28:08.355281Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:28:08.360248Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:28:08.641145Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:28:08.812345Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:28:08.820523Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:28:08.821168Z - job completed in 1.86 seconds (c1a786788c9dfbb9a1575aebd289f727b7ad657fe9c015e2e03f6778d0499e39)
2022-09-28T05:28:08.852135Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0018"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ce829d74468597bb92327ef1d13af077f44e64c54520fdad49fcede643da358a)
2022-09-28T05:28:10.705965Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:28:10.727063Z - running sql script pg/upsert_orders.sql
2022-09-28T05:28:10.727126Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:28:10.732154Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:28:10.733743Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:28:10.734845Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:28:10.736025Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:28:10.737517Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:28:10.739055Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:28:10.740080Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:28:10.741281Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:28:10.743260Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:28:10.747471Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:28:10.749385Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:28:10.750615Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:28:10.752607Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:28:10.755358Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:28:10.759427Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:28:10.760056Z - job completed in 1.91 seconds (ce829d74468597bb92327ef1d13af077f44e64c54520fdad49fcede643da358a)
2022-09-28T05:30:01.960794Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0020"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f4ceab5f4b475fa544dce087a30c96070319238e4b3af39c5607e0b6e09c87ca)
2022-09-28T05:30:03.318253Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:30:03.352019Z - running sql script pg/insert_tenders.sql
2022-09-28T05:30:03.352088Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:30:03.357245Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:30:03.358871Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:30:03.362909Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:30:03.366828Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:30:03.374760Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:30:03.376163Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:30:03.422875Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:30:03.424659Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:30:03.425681Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:30:03.427127Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:30:03.478129Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:30:03.501197Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:30:03.506068Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:30:03.723815Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:30:03.898862Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:30:03.904533Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:30:03.904948Z - job completed in 1.94 seconds (f4ceab5f4b475fa544dce087a30c96070319238e4b3af39c5607e0b6e09c87ca)
2022-09-28T05:30:03.932Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0020"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (bef4f02951dca96d6f14dec5812ad17480a94cadb22668307ae7bb2c7f1129ba)
2022-09-28T05:30:05.840945Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:30:05.862005Z - running sql script pg/upsert_orders.sql
2022-09-28T05:30:05.862605Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:30:05.867276Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:30:05.869887Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:30:05.871396Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:30:05.873352Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:30:05.875612Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:30:05.877153Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:30:05.878397Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:30:05.879630Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:30:05.881757Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:30:05.883911Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:30:05.885462Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:30:05.886511Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:30:05.888362Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:30:05.890209Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:30:05.894176Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:30:05.894578Z - job completed in 1.96 seconds (bef4f02951dca96d6f14dec5812ad17480a94cadb22668307ae7bb2c7f1129ba)
2022-09-28T05:32:02.347735Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0022"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (05ec71a14961206c4c85963a70045d14a8a204f75e13a5fcca924be5b3e79ddb)
2022-09-28T05:32:05.496426Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:32:05.520918Z - running sql script pg/insert_tenders.sql
2022-09-28T05:32:05.521004Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:32:05.526029Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:32:05.528004Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:32:05.531960Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:32:05.536291Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:32:05.542695Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:32:05.545095Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:32:05.591707Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:32:05.593361Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:32:05.594379Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:32:05.595670Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:32:05.646586Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:32:05.669512Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:32:05.674476Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:32:05.889249Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:32:06.065008Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:32:06.070143Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:32:06.070682Z - job completed in 3.72 seconds (05ec71a14961206c4c85963a70045d14a8a204f75e13a5fcca924be5b3e79ddb)
2022-09-28T05:32:06.120130Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0022"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0a10fd3b6d1d2c6d385ee74da68c5b0c726c4ae10e5228ad6639f15213a43dbb)
2022-09-28T05:32:08.335252Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:32:08.357549Z - running sql script pg/upsert_orders.sql
2022-09-28T05:32:08.358208Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:32:08.363639Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:32:08.365129Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:32:08.366209Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:32:08.367112Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:32:08.368348Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:32:08.370019Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:32:08.370954Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:32:08.371925Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:32:08.373967Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:32:08.376630Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:32:08.378439Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:32:08.379443Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:32:08.381441Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:32:08.383344Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:32:08.387435Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:32:08.388221Z - job completed in 2.27 seconds (0a10fd3b6d1d2c6d385ee74da68c5b0c726c4ae10e5228ad6639f15213a43dbb)
2022-09-28T05:34:02.112771Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0024"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (70ff1b2ab84cccac345849290114c8d372b6424afffd3ff4465aaa593207b9ed)
2022-09-28T05:34:03.857395Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:34:03.878266Z - running sql script pg/upsert_orders.sql
2022-09-28T05:34:03.878327Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:34:03.883308Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:34:03.884814Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:34:03.885973Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:34:03.887088Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:34:03.888321Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:34:03.889687Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:34:03.890582Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:34:03.891438Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:34:03.893645Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:34:03.895729Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:34:03.897342Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:34:03.898374Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:34:03.907619Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:34:03.909514Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:34:03.913595Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:34:03.913918Z - job completed in 1.80 seconds (70ff1b2ab84cccac345849290114c8d372b6424afffd3ff4465aaa593207b9ed)
2022-09-28T05:34:04.037Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0024"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ec3e350386fd866ca67fe0200d443277b7afce1ca6fc22e14f3e1f0aa21d18af)
2022-09-28T05:34:05.513721Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:34:05.533933Z - running sql script pg/insert_tenders.sql
2022-09-28T05:34:05.533981Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:34:05.539057Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:34:05.541339Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:34:05.545533Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:34:05.549585Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:34:05.555877Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:34:05.556984Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:34:05.604891Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:34:05.606971Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:34:05.608120Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:34:05.609487Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:34:05.660352Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:34:05.683263Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:34:05.687627Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:34:05.901494Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:34:06.077729Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:34:06.083019Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:34:06.083432Z - job completed in 2.05 seconds (ec3e350386fd866ca67fe0200d443277b7afce1ca6fc22e14f3e1f0aa21d18af)
2022-09-28T05:36:02.090312Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0026"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0cc9fc8173d615dd5ad8d7b917574036cb300ddd9624069c67f039c721af4df0)
2022-09-28T05:36:03.427949Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:36:03.453060Z - running sql script pg/insert_tenders.sql
2022-09-28T05:36:03.453120Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:36:03.457570Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:36:03.458860Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:36:03.462753Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:36:03.470682Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:36:03.475350Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:36:03.476384Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:36:03.521743Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:36:03.523133Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:36:03.524152Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:36:03.525635Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:36:03.577369Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:36:03.601361Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:36:03.607435Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:36:03.821467Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:36:03.996023Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:36:04.001681Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:36:04.002527Z - job completed in 1.91 seconds (0cc9fc8173d615dd5ad8d7b917574036cb300ddd9624069c67f039c721af4df0)
2022-09-28T05:36:04.033785Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0026"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c46ac49b0401a1642dba197c3e9c8d3df7efab94a3ccbfe4358285d4c5593cc8)
2022-09-28T05:36:05.792794Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:36:05.815747Z - running sql script pg/upsert_orders.sql
2022-09-28T05:36:05.815816Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:36:05.827778Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:36:05.829521Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:36:05.830801Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:36:05.831820Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:36:05.833381Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:36:05.834900Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:36:05.836088Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:36:05.837335Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:36:05.839378Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:36:05.841776Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:36:05.843179Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:36:05.844313Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:36:05.845907Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:36:05.847644Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:36:05.851908Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:36:05.852347Z - job completed in 1.82 seconds (c46ac49b0401a1642dba197c3e9c8d3df7efab94a3ccbfe4358285d4c5593cc8)
2022-09-28T05:38:02.113114Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0018"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (061dfcb89338b67f6f8b4f0dd59327dbb0186106a9be94709f59dc71502288d7)
2022-09-28T05:38:07.130164Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:38:07.149741Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T05:38:07.150211Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:38:07.155519Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T05:38:07.157199Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T05:38:07.158324Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T05:38:07.159371Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T05:38:07.161321Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T05:38:07.162561Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T05:38:07.163685Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:38:07.164672Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T05:38:07.165692Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T05:38:07.167436Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T05:38:07.169040Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T05:38:07.170072Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T05:38:07.172454Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T05:38:07.173652Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T05:38:07.175479Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T05:38:07.177204Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T05:38:07.254505Z - called http://score/api/keyed and received back 204
2022-09-28T05:38:07.254762Z - job completed in 5.14 seconds (061dfcb89338b67f6f8b4f0dd59327dbb0186106a9be94709f59dc71502288d7)
2022-09-28T05:38:07.381712Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0028"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b8e7e780e22bb4159dfa6d9383635e073fa08e4c41a422a34e4564e23cf313ef)
2022-09-28T05:38:09.571249Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:38:09.604692Z - running sql script pg/upsert_orders.sql
2022-09-28T05:38:09.604783Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:38:09.609469Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:38:09.610879Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:38:09.611913Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:38:09.612816Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:38:09.614099Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:38:09.615405Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:38:09.616319Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:38:09.617136Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:38:09.618856Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:38:09.620944Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:38:09.622366Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:38:09.623744Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:38:09.625375Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:38:09.626996Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:38:09.633015Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:38:09.639737Z - job completed in 2.26 seconds (b8e7e780e22bb4159dfa6d9383635e073fa08e4c41a422a34e4564e23cf313ef)
2022-09-28T05:38:09.782439Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0028"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c04982059a0d7a50c1f8bd7205e2647a05d43fc4f0a254c65c658df792023296)
2022-09-28T05:38:11.050771Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:38:11.073573Z - running sql script pg/insert_tenders.sql
2022-09-28T05:38:11.073920Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:38:11.080469Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:38:11.082365Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:38:11.084169Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:38:11.086054Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:38:11.088702Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:38:11.090610Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:38:11.093749Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:38:11.098140Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:38:11.100373Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:38:11.103174Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:38:11.105459Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:38:11.107662Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:38:11.110108Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:38:11.113486Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:38:11.116442Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:38:11.119080Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:38:11.119847Z - job completed in 1.34 seconds (c04982059a0d7a50c1f8bd7205e2647a05d43fc4f0a254c65c658df792023296)
2022-09-28T05:40:02.031493Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0030"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4c4f94529fe5dbb9f34fea82c673f0938fdd14a2396bf3d2e464d232447f9004)
2022-09-28T05:40:04.061674Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:40:04.086794Z - running sql script pg/upsert_orders.sql
2022-09-28T05:40:04.086860Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:40:04.092308Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:40:04.093768Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:40:04.094797Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:40:04.095780Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:40:04.097016Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:40:04.098456Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:40:04.099473Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:40:04.100465Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:40:04.102291Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:40:04.104525Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:40:04.106086Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:40:04.107104Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:40:04.109275Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:40:04.111017Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:40:04.115054Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:40:04.115503Z - job completed in 2.08 seconds (4c4f94529fe5dbb9f34fea82c673f0938fdd14a2396bf3d2e464d232447f9004)
2022-09-28T05:40:04.238931Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0030"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9a5c02effc48a3c3540a2049b941cf0fdb9ae1408f3216de174ac05782b65740)
2022-09-28T05:40:05.514707Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:40:05.533260Z - running sql script pg/insert_tenders.sql
2022-09-28T05:40:05.533324Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:40:05.538155Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:40:05.539737Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:40:05.541157Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:40:05.542418Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:40:05.543900Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:40:05.545041Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:40:05.547290Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:40:05.548991Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:40:05.550493Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:40:05.552263Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:40:05.553746Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:40:05.555255Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:40:05.556782Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:40:05.558736Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:40:05.560603Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:40:05.562326Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:40:05.562929Z - job completed in 1.32 seconds (9a5c02effc48a3c3540a2049b941cf0fdb9ae1408f3216de174ac05782b65740)
2022-09-28T05:42:02.089957Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0032"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (244d0038c584d939c47361ce251da21f66488c2b7a3629de01e5fb22fa126e60)
2022-09-28T05:42:04.311150Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:42:04.336177Z - running sql script pg/upsert_orders.sql
2022-09-28T05:42:04.336619Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:42:04.340985Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:42:04.342243Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:42:04.343204Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:42:04.344203Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:42:04.345342Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:42:04.346675Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:42:04.348071Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:42:04.348948Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:42:04.350700Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:42:04.352695Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:42:04.354187Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:42:04.355077Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:42:04.356808Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:42:04.358882Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:42:04.363036Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:42:04.363585Z - job completed in 2.27 seconds (244d0038c584d939c47361ce251da21f66488c2b7a3629de01e5fb22fa126e60)
2022-09-28T05:42:04.485036Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0032"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (250ef75925c1405343180d3c026e73f6e0094e84bf0cf880041e41291bccc6f6)
2022-09-28T05:42:05.593575Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:42:05.613207Z - running sql script pg/insert_tenders.sql
2022-09-28T05:42:05.613260Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:42:05.617921Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:42:05.620755Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:42:05.625059Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:42:05.626211Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:42:05.628045Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:42:05.629382Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:42:05.632294Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:42:05.639569Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:42:05.640798Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:42:05.642443Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:42:05.643634Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:42:05.644856Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:42:05.646386Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:42:05.648252Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:42:05.650376Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:42:05.651838Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:42:05.652364Z - job completed in 1.17 seconds (250ef75925c1405343180d3c026e73f6e0094e84bf0cf880041e41291bccc6f6)
2022-09-28T05:44:02.170294Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0034"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (18b35dcd679942e401e987a31b0c734345905263e2b2b04889b6ceef8c199ba9)
2022-09-28T05:44:04.255029Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:44:04.295022Z - running sql script pg/upsert_orders.sql
2022-09-28T05:44:04.295643Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:44:04.300833Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:44:04.302454Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:44:04.303817Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:44:04.307582Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:44:04.309424Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:44:04.311064Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:44:04.312479Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:44:04.314174Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:44:04.316478Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:44:04.319161Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:44:04.321085Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:44:04.322392Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:44:04.324606Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:44:04.327393Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:44:04.331795Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:44:04.333242Z - job completed in 2.16 seconds (18b35dcd679942e401e987a31b0c734345905263e2b2b04889b6ceef8c199ba9)
2022-09-28T05:44:04.430634Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0034"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fd015e49a80fdcba0ca3806bd443686b4695591e1dd194fbee1d42e8e72546a5)
2022-09-28T05:44:05.819015Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:44:05.846733Z - running sql script pg/insert_tenders.sql
2022-09-28T05:44:05.847343Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:44:05.853220Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:44:05.854827Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:44:05.856591Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:44:05.864790Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:44:05.866874Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:44:05.868398Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:44:05.870833Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:44:05.872760Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:44:05.874075Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:44:05.875988Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:44:05.877890Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:44:05.879492Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:44:05.881096Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:44:05.883218Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:44:05.891790Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:44:05.894047Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:44:05.895333Z - job completed in 1.47 seconds (fd015e49a80fdcba0ca3806bd443686b4695591e1dd194fbee1d42e8e72546a5)
2022-09-28T05:46:02.097455Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0036"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (cedc39627a4ef53cccabfc4a038bb8b6de3a2965a0f0af5e1503edaa051856ff)
2022-09-28T05:46:03.398453Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:46:03.429899Z - running sql script pg/insert_tenders.sql
2022-09-28T05:46:03.429964Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:46:03.434855Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:46:03.436192Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:46:03.437239Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:46:03.438126Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:46:03.439354Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:46:03.440166Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:46:03.442198Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:46:03.443668Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:46:03.444504Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:46:03.445942Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:46:03.447128Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:46:03.448369Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:46:03.449574Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:46:03.451300Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:46:03.453042Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:46:03.454532Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:46:03.455045Z - job completed in 1.36 seconds (cedc39627a4ef53cccabfc4a038bb8b6de3a2965a0f0af5e1503edaa051856ff)
2022-09-28T05:46:03.581103Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0036"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (42123fc5375577aa7702a5482dc3cf7f1d235dd24f9a017bf53c87caf84afd7d)
2022-09-28T05:46:05.804451Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:46:05.828162Z - running sql script pg/upsert_orders.sql
2022-09-28T05:46:05.828233Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:46:05.833927Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:46:05.835295Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:46:05.836930Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:46:05.838814Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:46:05.842065Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:46:05.844527Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:46:05.845841Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:46:05.849152Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:46:05.854207Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:46:05.856647Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:46:05.858579Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:46:05.860228Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:46:05.862488Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:46:05.867421Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:46:05.873414Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:46:05.873757Z - job completed in 2.29 seconds (42123fc5375577aa7702a5482dc3cf7f1d235dd24f9a017bf53c87caf84afd7d)
2022-09-28T05:48:02.082243Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0038"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c61b823633c7189d507f30ff257b16bdecf1bc9dec7e42aa2d4eaf4a46eecc6b)
2022-09-28T05:48:03.386410Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:48:03.412154Z - running sql script pg/insert_tenders.sql
2022-09-28T05:48:03.412216Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:48:03.417233Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:48:03.418603Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:48:03.419640Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:48:03.420736Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:48:03.422347Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:48:03.423436Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:48:03.431693Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:48:03.436514Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:48:03.439483Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:48:03.440979Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:48:03.442310Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:48:03.443685Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:48:03.445109Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:48:03.447058Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:48:03.448911Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:48:03.450433Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:48:03.450948Z - job completed in 1.37 seconds (c61b823633c7189d507f30ff257b16bdecf1bc9dec7e42aa2d4eaf4a46eecc6b)
2022-09-28T05:48:03.576786Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0038"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (217bf189968aad0d43ba600f7d68ffa3c190e894844ded652edea6ff8da1c185)
2022-09-28T05:48:05.588817Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:48:05.612017Z - running sql script pg/upsert_orders.sql
2022-09-28T05:48:05.612401Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:48:05.618312Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:48:05.619896Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:48:05.621247Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:48:05.622545Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:48:05.624040Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:48:05.625594Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:48:05.626782Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:48:05.627966Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:48:05.629973Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:48:05.632061Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:48:05.633722Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:48:05.634611Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:48:05.636445Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:48:05.638416Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:48:05.642463Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:48:05.642974Z - job completed in 2.07 seconds (217bf189968aad0d43ba600f7d68ffa3c190e894844ded652edea6ff8da1c185)
2022-09-28T05:48:05.671801Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0028"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (cb68080825cba59268545debc3869a695e0596c8a25b9c45585845cb76de6e94)
2022-09-28T05:48:10.778581Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:48:10.801520Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T05:48:10.801964Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:48:10.806396Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T05:48:10.809518Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T05:48:10.810953Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T05:48:10.812251Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T05:48:10.813864Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T05:48:10.815360Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T05:48:10.816714Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:48:10.818018Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T05:48:10.819612Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T05:48:10.821836Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T05:48:10.823628Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T05:48:10.824878Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T05:48:10.827614Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T05:48:10.829586Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T05:48:10.831062Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T05:48:10.833641Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T05:48:10.920998Z - called http://score/api/keyed and received back 204
2022-09-28T05:48:10.921119Z - job completed in 5.25 seconds (cb68080825cba59268545debc3869a695e0596c8a25b9c45585845cb76de6e94)
2022-09-28T05:50:02.128951Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0040"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (21aeea7700b19c7fdc3ff9565eccb1f03ad468fb2c8fca5474624d5056aab2ae)
2022-09-28T05:50:03.764316Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:50:03.799762Z - running sql script pg/insert_tenders.sql
2022-09-28T05:50:03.799841Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:50:03.805818Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:50:03.807139Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:50:03.808761Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:50:03.810033Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:50:03.811607Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:50:03.812683Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:50:03.815047Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:50:03.816675Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:50:03.817635Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:50:03.819097Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:50:03.820479Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:50:03.821857Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:50:03.823142Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:50:03.825113Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:50:03.827278Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:50:03.829179Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:50:03.831581Z - job completed in 1.70 seconds (21aeea7700b19c7fdc3ff9565eccb1f03ad468fb2c8fca5474624d5056aab2ae)
2022-09-28T05:50:03.965551Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0040"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a6459b3faf2da29e8f8a19f84cbb838c671579244990ad2364cf697e0556e2d9)
2022-09-28T05:50:06.047968Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:50:06.066775Z - running sql script pg/upsert_orders.sql
2022-09-28T05:50:06.066837Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:50:06.072906Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:50:06.074650Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:50:06.075948Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:50:06.077081Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:50:06.078669Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:50:06.080104Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:50:06.081463Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:50:06.082631Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:50:06.084912Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:50:06.087303Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:50:06.089153Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:50:06.090346Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:50:06.092237Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:50:06.094534Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:50:06.098925Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:50:06.099675Z - job completed in 2.13 seconds (a6459b3faf2da29e8f8a19f84cbb838c671579244990ad2364cf697e0556e2d9)
2022-09-28T05:52:02.100510Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0042"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c39661ff72716605901c4c5576b2163bb88f2ab386023192cd641ed94fc87826)
2022-09-28T05:52:03.770711Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:52:03.801622Z - running sql script pg/insert_tenders.sql
2022-09-28T05:52:03.801774Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:52:03.806206Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:52:03.807649Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:52:03.808769Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:52:03.809802Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:52:03.811332Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:52:03.812373Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:52:03.814593Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:52:03.816120Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:52:03.817118Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:52:03.818605Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:52:03.819874Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:52:03.821095Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:52:03.822400Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:52:03.824208Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:52:03.825908Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:52:03.827595Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:52:03.828287Z - job completed in 1.73 seconds (c39661ff72716605901c4c5576b2163bb88f2ab386023192cd641ed94fc87826)
2022-09-28T05:52:03.929503Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0042"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e602ef3d346b4866d280389f5a48c35ab457785a92417375bfd45e274bc7e788)
2022-09-28T05:52:06.027362Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:52:06.045175Z - running sql script pg/upsert_orders.sql
2022-09-28T05:52:06.045238Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:52:06.049824Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:52:06.051282Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:52:06.052406Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:52:06.053369Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:52:06.054566Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:52:06.055876Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:52:06.056817Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:52:06.058302Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:52:06.060153Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:52:06.062245Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:52:06.063730Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:52:06.064697Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:52:06.066476Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:52:06.068225Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:52:06.072321Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:52:06.072820Z - job completed in 2.14 seconds (e602ef3d346b4866d280389f5a48c35ab457785a92417375bfd45e274bc7e788)
2022-09-28T05:54:02.092408Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0044"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2293d4355001d2395d8c26b3c80ba8a21aacd7e9fea45c59fc1d3c44cf3071f5)
2022-09-28T05:54:04.412315Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:54:04.437947Z - running sql script pg/upsert_orders.sql
2022-09-28T05:54:04.438005Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:54:04.444548Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:54:04.446265Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:54:04.447464Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:54:04.451228Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:54:04.453041Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:54:04.455170Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:54:04.456337Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:54:04.457610Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:54:04.459810Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:54:04.463822Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:54:04.465827Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:54:04.467031Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:54:04.469390Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:54:04.471470Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:54:04.475761Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:54:04.476807Z - job completed in 2.38 seconds (2293d4355001d2395d8c26b3c80ba8a21aacd7e9fea45c59fc1d3c44cf3071f5)
2022-09-28T05:54:04.575453Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0044"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ebdaf458c0364f26b7f4b2fa3bc26c9b02d27f5d9f564a7c10b904ecfa6e6341)
2022-09-28T05:54:05.925354Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:54:05.943583Z - running sql script pg/insert_tenders.sql
2022-09-28T05:54:05.943642Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:54:05.948870Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:54:05.950073Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:54:05.950982Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:54:05.951880Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:54:05.953248Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:54:05.954241Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:54:05.956340Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:54:05.957760Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:54:05.961288Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:54:05.962652Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:54:05.963997Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:54:05.965132Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:54:05.966295Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:54:05.968013Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:54:05.969647Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:54:05.971217Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:54:05.971768Z - job completed in 1.40 seconds (ebdaf458c0364f26b7f4b2fa3bc26c9b02d27f5d9f564a7c10b904ecfa6e6341)
2022-09-28T05:56:02.120382Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0046"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (320a1e300fea2e06f06567d42ef81c7e81089057599b0b88df0e4dfdd2fa2e64)
2022-09-28T05:56:03.885929Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:56:03.914938Z - running sql script pg/upsert_orders.sql
2022-09-28T05:56:03.915002Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:56:03.920179Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:56:03.921843Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:56:03.922779Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:56:03.924033Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:56:03.925614Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:56:03.927217Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:56:03.928544Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:56:03.929529Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:56:03.931468Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:56:03.933728Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:56:03.935276Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:56:03.936296Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:56:03.937866Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:56:03.939814Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:56:03.943823Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:56:03.944431Z - job completed in 1.82 seconds (320a1e300fea2e06f06567d42ef81c7e81089057599b0b88df0e4dfdd2fa2e64)
2022-09-28T05:56:03.979895Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0046"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d9333af5a6970f9e338e7fcca9dfe978c7c44e9492e7c482478317bf25191081)
2022-09-28T05:56:05.286264Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:56:05.310225Z - running sql script pg/insert_tenders.sql
2022-09-28T05:56:05.310758Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:56:05.318381Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:56:05.320171Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:56:05.321498Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:56:05.323198Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:56:05.325339Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:56:05.326851Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:56:05.329677Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:56:05.331885Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:56:05.334164Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:56:05.336303Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:56:05.339672Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:56:05.341571Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:56:05.343705Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:56:05.346329Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:56:05.349191Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:56:05.351590Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:56:05.353129Z - job completed in 1.37 seconds (d9333af5a6970f9e338e7fcca9dfe978c7c44e9492e7c482478317bf25191081)
2022-09-28T05:58:02.182977Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0048"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7cc983150cf862e26f1efc2fce41364e319b3e158e0ded7273e18501bc3dbf8b)
2022-09-28T05:58:03.258245Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:58:03.277162Z - running sql script pg/insert_tenders.sql
2022-09-28T05:58:03.277215Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T05:58:03.281773Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T05:58:03.283388Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T05:58:03.284428Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T05:58:03.285408Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T05:58:03.286707Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T05:58:03.287604Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T05:58:03.290390Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T05:58:03.292139Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T05:58:03.293126Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T05:58:03.294313Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T05:58:03.295575Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T05:58:03.297305Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T05:58:03.298470Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T05:58:03.300102Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T05:58:03.301749Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T05:58:03.303187Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T05:58:03.303930Z - job completed in 1.12 seconds (7cc983150cf862e26f1efc2fce41364e319b3e158e0ded7273e18501bc3dbf8b)
2022-09-28T05:58:03.428623Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0038"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (ad345d60896c83a84be353ad07495104725e173d664f697b44373aec41463569)
2022-09-28T05:58:08.225089Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:58:08.253425Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T05:58:08.253491Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:58:08.258136Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T05:58:08.259964Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T05:58:08.261291Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T05:58:08.262456Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T05:58:08.263524Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T05:58:08.264921Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T05:58:08.266283Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:58:08.267524Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T05:58:08.269054Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T05:58:08.271051Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T05:58:08.272713Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T05:58:08.273772Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T05:58:08.276176Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T05:58:08.277279Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T05:58:08.278606Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T05:58:08.280292Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T05:58:08.354242Z - called http://score/api/keyed and received back 204
2022-09-28T05:58:08.355611Z - job completed in 4.93 seconds (ad345d60896c83a84be353ad07495104725e173d664f697b44373aec41463569)
2022-09-28T05:58:08.391269Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0048"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8fbdecd11b41d6f93328aa8a848277efa81b333deccacf20e5ac6edadf690373)
2022-09-28T05:58:10.371016Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T05:58:10.389381Z - running sql script pg/upsert_orders.sql
2022-09-28T05:58:10.389434Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T05:58:10.394050Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T05:58:10.395484Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T05:58:10.396494Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T05:58:10.397518Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T05:58:10.399095Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T05:58:10.400814Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T05:58:10.401795Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T05:58:10.402807Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T05:58:10.404634Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T05:58:10.407127Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T05:58:10.408706Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T05:58:10.409699Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T05:58:10.411448Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T05:58:10.413186Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T05:58:10.417223Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T05:58:10.417666Z - job completed in 2.03 seconds (8fbdecd11b41d6f93328aa8a848277efa81b333deccacf20e5ac6edadf690373)
2022-09-28T06:00:02.572619Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0050"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (22c329cdc15d04a081bafccd807c4b9467c95bf587405c1e8fa049e012460c1a)
2022-09-28T06:00:04.667380Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:00:04.685424Z - running sql script pg/upsert_orders.sql
2022-09-28T06:00:04.685608Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:00:04.689828Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:00:04.691393Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:00:04.700156Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:00:04.701414Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:00:04.702909Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:00:04.704452Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:00:04.705588Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:00:04.706698Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:00:04.708851Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:00:04.711093Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:00:04.712510Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:00:04.713357Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:00:04.715063Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:00:04.716759Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:00:04.720681Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:00:04.721295Z - job completed in 2.15 seconds (22c329cdc15d04a081bafccd807c4b9467c95bf587405c1e8fa049e012460c1a)
2022-09-28T06:00:04.737156Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0050"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e2b8fc0e286a175d1ccf9433204516989aae20126eb9ecc51ae691877292ad5f)
2022-09-28T06:00:05.836634Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:00:05.872052Z - running sql script pg/insert_tenders.sql
2022-09-28T06:00:05.872140Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:00:05.876734Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:00:05.878493Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:00:05.879963Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:00:05.880988Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:00:05.882712Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:00:05.883963Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:00:05.887014Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:00:05.888818Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:00:05.889743Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:00:05.891308Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:00:05.892979Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:00:05.894759Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:00:05.896431Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:00:05.898730Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:00:05.901398Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:00:05.904491Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:00:05.905396Z - job completed in 1.17 seconds (e2b8fc0e286a175d1ccf9433204516989aae20126eb9ecc51ae691877292ad5f)
2022-09-28T06:00:05.927568Z - received message {"source":{"kind":"jdbc","connectionName":"pg.conf","queryName":"pg/export_forecasting_dataset.sql"},"sink":{"kind":"csv","connectionName":"azure_blob.conf","path":"wasbs://data-science@stfsci01${environment}.blob.core.windows.net/pickup-forecasting-input/${today}","pathParameters":{"today":"2022-09-28"}}} (b17dc24a60235885130add5af0d7e36b3565c4e4506805366ad374f2829a8bfe)
2022-09-28T06:00:16.486902Z - job completed in 10.56 seconds (b17dc24a60235885130add5af0d7e36b3565c4e4506805366ad374f2829a8bfe)
2022-09-28T06:02:02.061621Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0052"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7e74cd55fe2259fc80fed4de5474cc7dfb175c3c66f48cf621e0740eb8ddf74d)
2022-09-28T06:02:04.469572Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:02:04.489996Z - running sql script pg/upsert_orders.sql
2022-09-28T06:02:04.490164Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:02:04.495940Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:02:04.497789Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:02:04.499732Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:02:04.501213Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:02:04.502855Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:02:04.504517Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:02:04.506328Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:02:04.508100Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:02:04.510436Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:02:04.513749Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:02:04.515683Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:02:04.517154Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:02:04.519607Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:02:04.522077Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:02:04.530177Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:02:04.531989Z - job completed in 2.47 seconds (7e74cd55fe2259fc80fed4de5474cc7dfb175c3c66f48cf621e0740eb8ddf74d)
2022-09-28T06:02:04.610881Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0052"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fc4f241038615a145ab1c1c222529da3704c8e989cd2f5d4d4de90a7284dd7a7)
2022-09-28T06:02:05.813035Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:02:05.844962Z - running sql script pg/insert_tenders.sql
2022-09-28T06:02:05.845035Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:02:05.849977Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:02:05.851216Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:02:05.852463Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:02:05.853411Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:02:05.854711Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:02:05.855651Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:02:05.857783Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:02:05.859163Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:02:05.860054Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:02:05.861495Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:02:05.862636Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:02:05.864585Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:02:05.866013Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:02:05.867875Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:02:05.869715Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:02:05.871297Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:02:05.871777Z - job completed in 1.26 seconds (fc4f241038615a145ab1c1c222529da3704c8e989cd2f5d4d4de90a7284dd7a7)
2022-09-28T06:04:02.079432Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0054"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (cb4d457b0eab7831cc4511210c9fbae8587f025879ef148e3c10395ff109cbd2)
2022-09-28T06:04:03.464302Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:04:03.481980Z - running sql script pg/insert_tenders.sql
2022-09-28T06:04:03.482048Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:04:03.486561Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:04:03.487792Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:04:03.488762Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:04:03.489719Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:04:03.491012Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:04:03.492041Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:04:03.494304Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:04:03.495890Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:04:03.497008Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:04:03.498417Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:04:03.499688Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:04:03.501130Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:04:03.502730Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:04:03.504808Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:04:03.508157Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:04:03.510003Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:04:03.510549Z - job completed in 1.43 seconds (cb4d457b0eab7831cc4511210c9fbae8587f025879ef148e3c10395ff109cbd2)
2022-09-28T06:04:03.580951Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0054"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (200157f0a6ed995ab27b2e9a37608575fe56a9932e71572bd1219655b77de17e)
2022-09-28T06:04:05.898331Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:04:05.937070Z - running sql script pg/upsert_orders.sql
2022-09-28T06:04:05.937135Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:04:05.941658Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:04:05.943089Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:04:05.944217Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:04:05.945275Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:04:05.946482Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:04:05.947749Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:04:05.948743Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:04:05.949639Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:04:05.951572Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:04:05.953885Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:04:05.955511Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:04:05.956625Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:04:05.960097Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:04:05.962307Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:04:05.966540Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:04:05.967068Z - job completed in 2.39 seconds (200157f0a6ed995ab27b2e9a37608575fe56a9932e71572bd1219655b77de17e)
2022-09-28T06:06:02.053925Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0056"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (556443eb3ef9e2214a0adbefbd26bbc5cae7577a7c47e661b0deb620e95e36cc)
2022-09-28T06:06:04.324992Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:06:04.344233Z - running sql script pg/upsert_orders.sql
2022-09-28T06:06:04.344277Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:06:04.348971Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:06:04.350365Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:06:04.351721Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:06:04.352824Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:06:04.353992Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:06:04.355471Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:06:04.356526Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:06:04.357553Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:06:04.359460Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:06:04.361671Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:06:04.363208Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:06:04.364236Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:06:04.366226Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:06:04.368190Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:06:04.372061Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:06:04.372462Z - job completed in 2.32 seconds (556443eb3ef9e2214a0adbefbd26bbc5cae7577a7c47e661b0deb620e95e36cc)
2022-09-28T06:06:04.403677Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0056"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (954df56cfb1c4aa03c90b46299ea61e2a3b38c94ebbed5497c4cc92057630dee)
2022-09-28T06:06:05.897814Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:06:05.929736Z - running sql script pg/insert_tenders.sql
2022-09-28T06:06:05.929794Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:06:05.935059Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:06:05.936634Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:06:05.938231Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:06:05.939652Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:06:05.941156Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:06:05.942317Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:06:05.944527Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:06:05.946113Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:06:05.947201Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:06:05.948710Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:06:05.950400Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:06:05.951828Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:06:05.957522Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:06:05.963524Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:06:05.966416Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:06:05.969421Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:06:05.970110Z - job completed in 1.57 seconds (954df56cfb1c4aa03c90b46299ea61e2a3b38c94ebbed5497c4cc92057630dee)
2022-09-28T06:08:02.161680Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0058"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fbe648f06bbd1dd1a1f012c2edae7f6aafd29eb91a08851fd0f0dae5ab63abaf)
2022-09-28T06:08:03.265546Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:08:03.286269Z - running sql script pg/insert_tenders.sql
2022-09-28T06:08:03.286323Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:08:03.290779Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:08:03.292221Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:08:03.293308Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:08:03.294555Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:08:03.295915Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:08:03.296876Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:08:03.299093Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:08:03.300692Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:08:03.301650Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:08:03.302936Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:08:03.304209Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:08:03.305528Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:08:03.307058Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:08:03.309060Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:08:03.311106Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:08:03.313049Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:08:03.313543Z - job completed in 1.15 seconds (fbe648f06bbd1dd1a1f012c2edae7f6aafd29eb91a08851fd0f0dae5ab63abaf)
2022-09-28T06:08:03.378642Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0058"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (424b4d10a0857633ce0aaee3f45ce4b961ccaccc338687a0ddf3f9c1ed2e40bd)
2022-09-28T06:08:05.446156Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:08:05.465653Z - running sql script pg/upsert_orders.sql
2022-09-28T06:08:05.466188Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:08:05.471696Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:08:05.473611Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:08:05.475068Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:08:05.476688Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:08:05.478695Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:08:05.480577Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:08:05.482199Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:08:05.483446Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:08:05.485728Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:08:05.488164Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:08:05.490074Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:08:05.491576Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:08:05.493932Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:08:05.496209Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:08:05.500481Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:08:05.501977Z - job completed in 2.12 seconds (424b4d10a0857633ce0aaee3f45ce4b961ccaccc338687a0ddf3f9c1ed2e40bd)
2022-09-28T06:08:05.575986Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0048"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (1d4f6702fb2fcd7728f859020d534663f642f82f346a0803854f9e78f2669739)
2022-09-28T06:08:11.328472Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:08:11.352343Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T06:08:11.352764Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:08:11.357957Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T06:08:11.359698Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T06:08:11.361023Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T06:08:11.362412Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T06:08:11.363694Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T06:08:11.365151Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T06:08:11.366471Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:08:11.373734Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T06:08:11.375117Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T06:08:11.377064Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T06:08:11.378710Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T06:08:11.379701Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T06:08:11.382360Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T06:08:11.383646Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T06:08:11.384839Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T06:08:11.386464Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T06:08:11.476347Z - called http://score/api/keyed and received back 204
2022-09-28T06:08:11.476663Z - job completed in 5.90 seconds (1d4f6702fb2fcd7728f859020d534663f642f82f346a0803854f9e78f2669739)
2022-09-28T06:10:02.083963Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0100"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (244d02287f381c5855c3a528d2721dfb02c1ac41705857c6f26d51bbe2acc4f7)
2022-09-28T06:10:04.714730Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:10:04.734901Z - running sql script pg/upsert_orders.sql
2022-09-28T06:10:04.735483Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:10:04.740798Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:10:04.742575Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:10:04.744058Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:10:04.752786Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:10:04.754048Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:10:04.755589Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:10:04.756737Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:10:04.758107Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:10:04.760155Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:10:04.762153Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:10:04.763689Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:10:04.764583Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:10:04.766274Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:10:04.768332Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:10:04.772361Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:10:04.772807Z - job completed in 2.69 seconds (244d02287f381c5855c3a528d2721dfb02c1ac41705857c6f26d51bbe2acc4f7)
2022-09-28T06:10:04.793358Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0100"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3024b7cd6177484c4702fffa5b8116648976cc04623a0f820953fe0c78e8fa42)
2022-09-28T06:10:05.857956Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:10:05.880545Z - running sql script pg/insert_tenders.sql
2022-09-28T06:10:05.880905Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:10:05.885720Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:10:05.887289Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:10:05.888647Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:10:05.890319Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:10:05.892069Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:10:05.893227Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:10:05.896446Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:10:05.899022Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:10:05.900784Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:10:05.902907Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:10:05.904357Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:10:05.907Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:10:05.908568Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:10:05.910299Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:10:05.912348Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:10:05.914156Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:10:05.914797Z - job completed in 1.12 seconds (3024b7cd6177484c4702fffa5b8116648976cc04623a0f820953fe0c78e8fa42)
2022-09-28T06:12:02.061234Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0102"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4867300f0ff04039a5fd4019f737bdb3b974bb311a4d3973a2959e2d4dc76a6c)
2022-09-28T06:12:04.264753Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:12:04.282428Z - running sql script pg/upsert_orders.sql
2022-09-28T06:12:04.282548Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:12:04.287840Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:12:04.289461Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:12:04.290494Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:12:04.291431Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:12:04.292706Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:12:04.293974Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:12:04.295020Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:12:04.295950Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:12:04.297794Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:12:04.299900Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:12:04.301599Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:12:04.302578Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:12:04.323794Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:12:04.326455Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:12:04.331971Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:12:04.332361Z - job completed in 2.27 seconds (4867300f0ff04039a5fd4019f737bdb3b974bb311a4d3973a2959e2d4dc76a6c)
2022-09-28T06:12:04.438937Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0102"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (11898d2954466457460bfb68532b1227f5981723016a04f08600e778b76503a4)
2022-09-28T06:12:05.592807Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:12:05.611126Z - running sql script pg/insert_tenders.sql
2022-09-28T06:12:05.611468Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:12:05.617556Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:12:05.619034Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:12:05.620226Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:12:05.621297Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:12:05.622750Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:12:05.623758Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:12:05.626087Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:12:05.627886Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:12:05.629140Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:12:05.631270Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:12:05.633423Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:12:05.635391Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:12:05.636941Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:12:05.639010Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:12:05.640755Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:12:05.642724Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:12:05.643193Z - job completed in 1.21 seconds (11898d2954466457460bfb68532b1227f5981723016a04f08600e778b76503a4)
2022-09-28T06:14:02.122617Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0104"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (268438d4abaf8189ab604974c1442f57b8b8d6241bad3e87a5c9879574886a0f)
2022-09-28T06:14:04.747158Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:14:04.770605Z - running sql script pg/upsert_orders.sql
2022-09-28T06:14:04.770654Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:14:04.775131Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:14:04.776528Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:14:04.777705Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:14:04.778823Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:14:04.780173Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:14:04.781546Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:14:04.782588Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:14:04.783473Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:14:04.785393Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:14:04.787394Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:14:04.789060Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:14:04.790142Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:14:04.791865Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:14:04.793729Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:14:04.797657Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:14:04.798174Z - job completed in 2.68 seconds (268438d4abaf8189ab604974c1442f57b8b8d6241bad3e87a5c9879574886a0f)
2022-09-28T06:14:05.011915Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0104"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fce9f93939172937ab9174a4f31415dde2c25fb8a2f582a8eb5248c370ac20e9)
2022-09-28T06:14:06.163836Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:14:06.184297Z - running sql script pg/insert_tenders.sql
2022-09-28T06:14:06.184354Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:14:06.188862Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:14:06.190392Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:14:06.191300Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:14:06.192288Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:14:06.193713Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:14:06.194553Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:14:06.196583Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:14:06.198138Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:14:06.198978Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:14:06.200271Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:14:06.201452Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:14:06.202617Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:14:06.203920Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:14:06.205892Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:14:06.207983Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:14:06.209750Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:14:06.210212Z - job completed in 1.20 seconds (fce9f93939172937ab9174a4f31415dde2c25fb8a2f582a8eb5248c370ac20e9)
2022-09-28T06:16:01.909939Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0106"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9c4c78388d1b3cc1a7ee0f31bfc5188e17506b027889fe29051fd39a74e66555)
2022-09-28T06:16:04.127841Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:16:04.147100Z - running sql script pg/upsert_orders.sql
2022-09-28T06:16:04.147458Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:16:04.152885Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:16:04.154339Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:16:04.155377Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:16:04.156455Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:16:04.157838Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:16:04.159180Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:16:04.160230Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:16:04.161144Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:16:04.163060Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:16:04.165761Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:16:04.167420Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:16:04.168352Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:16:04.169971Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:16:04.171760Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:16:04.176271Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:16:04.177507Z - job completed in 2.27 seconds (9c4c78388d1b3cc1a7ee0f31bfc5188e17506b027889fe29051fd39a74e66555)
2022-09-28T06:16:04.200140Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0106"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (040cdd55b4bde28f761c8370aa404365e2b7ddfda5aa69fea1e1b5e378f05025)
2022-09-28T06:16:05.805369Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:16:05.826303Z - running sql script pg/insert_tenders.sql
2022-09-28T06:16:05.826348Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:16:05.831268Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:16:05.832932Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:16:05.834210Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:16:05.835252Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:16:05.836712Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:16:05.837686Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:16:05.839777Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:16:05.841319Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:16:05.842266Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:16:05.843603Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:16:05.844883Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:16:05.846128Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:16:05.847468Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:16:05.849291Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:16:05.851297Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:16:05.854340Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:16:05.854799Z - job completed in 1.65 seconds (040cdd55b4bde28f761c8370aa404365e2b7ddfda5aa69fea1e1b5e378f05025)
2022-09-28T06:18:02.037139Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0108"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b853dc4c313a6ba2c49e75dabc698bb7d2c52e670b1a766b4da88b7cf670b81d)
2022-09-28T06:18:03.421022Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:18:03.438657Z - running sql script pg/insert_tenders.sql
2022-09-28T06:18:03.438707Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:18:03.443222Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:18:03.444658Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:18:03.445842Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:18:03.446931Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:18:03.448297Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:18:03.449337Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:18:03.451463Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:18:03.453704Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:18:03.454703Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:18:03.455923Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:18:03.457236Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:18:03.458555Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:18:03.460113Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:18:03.462215Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:18:03.464060Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:18:03.465560Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:18:03.466086Z - job completed in 1.43 seconds (b853dc4c313a6ba2c49e75dabc698bb7d2c52e670b1a766b4da88b7cf670b81d)
2022-09-28T06:18:03.493049Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0058"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (d4fc4d4a08c7e70b10a95ac3a15627e3a4af7cf08e39c4f149f7ab3cec55c924)
2022-09-28T06:18:10.121630Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:18:10.148538Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T06:18:10.148768Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:18:10.153883Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T06:18:10.155606Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T06:18:10.156642Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T06:18:10.157690Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T06:18:10.158761Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T06:18:10.160803Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T06:18:10.161924Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:18:10.163082Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T06:18:10.164134Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T06:18:10.167675Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T06:18:10.171459Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T06:18:10.178241Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T06:18:10.180542Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T06:18:10.181798Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T06:18:10.184563Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T06:18:10.186327Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T06:18:10.284320Z - called http://score/api/keyed and received back 204
2022-09-28T06:18:10.284694Z - job completed in 6.79 seconds (d4fc4d4a08c7e70b10a95ac3a15627e3a4af7cf08e39c4f149f7ab3cec55c924)
2022-09-28T06:18:10.313387Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0108"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (01962fb872a5700697bcd65492800927128365aeb16a50321b6dd7c81ae16bb0)
2022-09-28T06:18:12.738668Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:18:12.757631Z - running sql script pg/upsert_orders.sql
2022-09-28T06:18:12.758119Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:18:12.764767Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:18:12.766573Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:18:12.768207Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:18:12.769817Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:18:12.771685Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:18:12.773481Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:18:12.774969Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:18:12.776506Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:18:12.779037Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:18:12.781645Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:18:12.783915Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:18:12.785466Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:18:12.787571Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:18:12.789878Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:18:12.794153Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:18:12.794751Z - job completed in 2.48 seconds (01962fb872a5700697bcd65492800927128365aeb16a50321b6dd7c81ae16bb0)
2022-09-28T06:20:02.367384Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0110"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2e3fe3f00667abb1676468325b356bc1d5886e71dab74e71b68405161cd34e5d)
2022-09-28T06:20:03.931007Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:20:03.951961Z - running sql script pg/insert_tenders.sql
2022-09-28T06:20:03.952013Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:20:03.956617Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:20:03.957967Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:20:03.958916Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:20:03.959897Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:20:03.961318Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:20:03.962344Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:20:03.964361Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:20:03.965992Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:20:03.967045Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:20:03.968465Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:20:03.969971Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:20:03.971404Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:20:03.972767Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:20:03.974730Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:20:03.976533Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:20:03.978089Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:20:03.978564Z - job completed in 1.61 seconds (2e3fe3f00667abb1676468325b356bc1d5886e71dab74e71b68405161cd34e5d)
2022-09-28T06:20:04.036200Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0110"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d190aad5bff2762e47f278d821e4afa546d0e1f335fc33cba0d875d5ebfc791e)
2022-09-28T06:20:06.369645Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:20:06.389300Z - running sql script pg/upsert_orders.sql
2022-09-28T06:20:06.389359Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:20:06.394608Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:20:06.396686Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:20:06.398084Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:20:06.399227Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:20:06.402189Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:20:06.404238Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:20:06.405833Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:20:06.406991Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:20:06.409047Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:20:06.411390Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:20:06.413190Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:20:06.414330Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:20:06.416493Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:20:06.418202Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:20:06.422414Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:20:06.422979Z - job completed in 2.39 seconds (d190aad5bff2762e47f278d821e4afa546d0e1f335fc33cba0d875d5ebfc791e)
2022-09-28T06:22:01.876235Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0112"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9f9f1fb80402b5ba998aa2014efb159f78712211910930ce2566104a01d50424)
2022-09-28T06:22:04.114433Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:22:04.137264Z - running sql script pg/upsert_orders.sql
2022-09-28T06:22:04.137312Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:22:04.141968Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:22:04.143918Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:22:04.145568Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:22:04.147117Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:22:04.148539Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:22:04.151197Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:22:04.158489Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:22:04.161724Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:22:04.164983Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:22:04.169213Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:22:04.172102Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:22:04.174536Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:22:04.179208Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:22:04.182668Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:22:04.187794Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:22:04.188502Z - job completed in 2.31 seconds (9f9f1fb80402b5ba998aa2014efb159f78712211910930ce2566104a01d50424)
2022-09-28T06:22:04.211684Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0112"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d1c978f65879ec6ac54f1acf9476a0160a52084f0d31093e694900e8174c5059)
2022-09-28T06:22:05.212329Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:22:05.229977Z - running sql script pg/insert_tenders.sql
2022-09-28T06:22:05.230188Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:22:05.234915Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:22:05.236392Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:22:05.237533Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:22:05.238620Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:22:05.240221Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:22:05.241317Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:22:05.243467Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:22:05.245052Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:22:05.246330Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:22:05.247654Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:22:05.249299Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:22:05.250821Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:22:05.252097Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:22:05.254369Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:22:05.256181Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:22:05.257777Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:22:05.258187Z - job completed in 1.05 seconds (d1c978f65879ec6ac54f1acf9476a0160a52084f0d31093e694900e8174c5059)
2022-09-28T06:24:01.942957Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0114"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d5d38221af40c009bcf91fb41bab6dd61a155eb667da43339ca60a0e7d485720)
2022-09-28T06:24:03.330907Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:24:03.350198Z - running sql script pg/insert_tenders.sql
2022-09-28T06:24:03.350539Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:24:03.355661Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:24:03.357105Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:24:03.358298Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:24:03.359620Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:24:03.361273Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:24:03.362552Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:24:03.364951Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:24:03.366966Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:24:03.368061Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:24:03.369673Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:24:03.371258Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:24:03.372743Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:24:03.374236Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:24:03.376319Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:24:03.378437Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:24:03.380162Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:24:03.380742Z - job completed in 1.44 seconds (d5d38221af40c009bcf91fb41bab6dd61a155eb667da43339ca60a0e7d485720)
2022-09-28T06:24:03.419124Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0114"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (31ad3cc893590c791e786023571457aa666141e920637747f32a1367248bc649)
2022-09-28T06:24:05.816045Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:24:05.834638Z - running sql script pg/upsert_orders.sql
2022-09-28T06:24:05.834680Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:24:05.839175Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:24:05.840540Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:24:05.841546Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:24:05.842485Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:24:05.843745Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:24:05.845055Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:24:05.845971Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:24:05.846842Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:24:05.848698Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:24:05.850935Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:24:05.852370Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:24:05.853231Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:24:05.861429Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:24:05.863468Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:24:05.867460Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:24:05.867855Z - job completed in 2.45 seconds (31ad3cc893590c791e786023571457aa666141e920637747f32a1367248bc649)
2022-09-28T06:26:02.016094Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0116"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9cea13e7e3d04a692449757097e72429b62f14ea23a42aac8cb652d78b9275c5)
2022-09-28T06:26:04.401386Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:26:04.419613Z - running sql script pg/upsert_orders.sql
2022-09-28T06:26:04.419664Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:26:04.424816Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:26:04.426102Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:26:04.427284Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:26:04.428256Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:26:04.429390Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:26:04.430677Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:26:04.431707Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:26:04.432517Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:26:04.434345Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:26:04.436312Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:26:04.437979Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:26:04.438899Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:26:04.441033Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:26:04.442840Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:26:04.446795Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:26:04.447170Z - job completed in 2.43 seconds (9cea13e7e3d04a692449757097e72429b62f14ea23a42aac8cb652d78b9275c5)
2022-09-28T06:26:04.479102Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0116"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (59842cdeab997a50ddf54dc58ade5bf16d0543e1f7a71621379e65c5cd733f0a)
2022-09-28T06:26:05.694892Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:26:05.720244Z - running sql script pg/insert_tenders.sql
2022-09-28T06:26:05.720300Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:26:05.730887Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:26:05.732825Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:26:05.734686Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:26:05.736306Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:26:05.739313Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:26:05.740909Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:26:05.743382Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:26:05.745269Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:26:05.746588Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:26:05.748219Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:26:05.749521Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:26:05.751385Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:26:05.753547Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:26:05.756612Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:26:05.758315Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:26:05.761818Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:26:05.762188Z - job completed in 1.28 seconds (59842cdeab997a50ddf54dc58ade5bf16d0543e1f7a71621379e65c5cd733f0a)
2022-09-28T06:28:01.993734Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0118"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (22a0bf34cf19e59d80238d0a68fdd911adbcc8b9ff1df1a2d1f589ea14edf5b0)
2022-09-28T06:28:03.409894Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:28:03.441735Z - running sql script pg/insert_tenders.sql
2022-09-28T06:28:03.441794Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:28:03.446860Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:28:03.448271Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:28:03.449396Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:28:03.450252Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:28:03.451496Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:28:03.452759Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:28:03.455581Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:28:03.457836Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:28:03.458813Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:28:03.460976Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:28:03.462572Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:28:03.465209Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:28:03.467148Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:28:03.469516Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:28:03.471421Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:28:03.473303Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:28:03.473681Z - job completed in 1.48 seconds (22a0bf34cf19e59d80238d0a68fdd911adbcc8b9ff1df1a2d1f589ea14edf5b0)
2022-09-28T06:28:03.515351Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0108"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (0062e75d9dbf3ed4cf93e4f17069ec31ce7526581d869b7bb700309d7f1d8645)
2022-09-28T06:28:09.087139Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:28:09.110199Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T06:28:09.110242Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:28:09.115306Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T06:28:09.117267Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T06:28:09.118635Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T06:28:09.120667Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T06:28:09.122034Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T06:28:09.124384Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T06:28:09.126257Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:28:09.127491Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T06:28:09.129133Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T06:28:09.131592Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T06:28:09.133609Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T06:28:09.134759Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T06:28:09.139634Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T06:28:09.141813Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T06:28:09.143027Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T06:28:09.144626Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T06:28:09.221068Z - called http://score/api/keyed and received back 204
2022-09-28T06:28:09.221200Z - job completed in 5.71 seconds (0062e75d9dbf3ed4cf93e4f17069ec31ce7526581d869b7bb700309d7f1d8645)
2022-09-28T06:28:09.278614Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0118"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (08e5f2dfac6b417265622734988825df814f39349252d647958542b6e851e2d3)
2022-09-28T06:28:11.579208Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:28:11.618212Z - running sql script pg/upsert_orders.sql
2022-09-28T06:28:11.618275Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:28:11.623133Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:28:11.624845Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:28:11.626059Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:28:11.627159Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:28:11.628463Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:28:11.629674Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:28:11.630761Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:28:11.635589Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:28:11.637802Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:28:11.640021Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:28:11.641602Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:28:11.642544Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:28:11.644334Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:28:11.646363Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:28:11.650541Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:28:11.650933Z - job completed in 2.37 seconds (08e5f2dfac6b417265622734988825df814f39349252d647958542b6e851e2d3)
2022-09-28T06:30:02.409285Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0120"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (22ef7e6e70f0a7e4e0542ebd24fa4df731df893ad3f31fe3e038b6eec2a2001f)
2022-09-28T06:30:04.346174Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:30:04.365088Z - running sql script pg/upsert_orders.sql
2022-09-28T06:30:04.365135Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:30:04.370323Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:30:04.372016Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:30:04.373370Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:30:04.374630Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:30:04.376092Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:30:04.378420Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:30:04.381285Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:30:04.382574Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:30:04.384566Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:30:04.387343Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:30:04.389084Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:30:04.390344Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:30:04.392272Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:30:04.394293Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:30:04.398680Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:30:04.399803Z - job completed in 1.99 seconds (22ef7e6e70f0a7e4e0542ebd24fa4df731df893ad3f31fe3e038b6eec2a2001f)
2022-09-28T06:30:04.484883Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0120"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (96498e1a8f48310faca0a585318e53b77d3d7bc1dc4f2ad7141c3ed58faa71b3)
2022-09-28T06:30:05.384648Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:30:05.402701Z - running sql script pg/insert_tenders.sql
2022-09-28T06:30:05.402758Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:30:05.407307Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:30:05.409227Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:30:05.410253Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:30:05.411307Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:30:05.412627Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:30:05.413611Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:30:05.415723Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:30:05.417332Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:30:05.418348Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:30:05.423627Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:30:05.424994Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:30:05.426822Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:30:05.428125Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:30:05.430840Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:30:05.432462Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:30:05.433979Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:30:05.434228Z - job completed in 0.95 seconds (96498e1a8f48310faca0a585318e53b77d3d7bc1dc4f2ad7141c3ed58faa71b3)
2022-09-28T06:32:01.975068Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0122"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (17f20413916ffbf1822876fd076c4adcfb717f75da15c66df840030e1e8bbe83)
2022-09-28T06:32:04.246593Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:32:04.270576Z - running sql script pg/upsert_orders.sql
2022-09-28T06:32:04.270626Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:32:04.276672Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:32:04.278152Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:32:04.279113Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:32:04.280082Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:32:04.281386Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:32:04.282740Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:32:04.283752Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:32:04.284617Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:32:04.286579Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:32:04.288609Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:32:04.290463Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:32:04.291561Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:32:04.293429Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:32:04.295271Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:32:04.299096Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:32:04.299743Z - job completed in 2.32 seconds (17f20413916ffbf1822876fd076c4adcfb717f75da15c66df840030e1e8bbe83)
2022-09-28T06:32:04.366881Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0122"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b021507b484cabb5ec302c980f4000564a598b0054a089bebb82f4fb49d98a0c)
2022-09-28T06:32:05.768151Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:32:05.817883Z - running sql script pg/insert_tenders.sql
2022-09-28T06:32:05.818534Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:32:05.824175Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:32:05.829234Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:32:05.830829Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:32:05.832367Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:32:05.834280Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:32:05.836067Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:32:05.839219Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:32:05.841364Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:32:05.842978Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:32:05.844913Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:32:05.847570Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:32:05.849725Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:32:05.851692Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:32:05.853971Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:32:05.856357Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:32:05.858347Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:32:05.859106Z - job completed in 1.49 seconds (b021507b484cabb5ec302c980f4000564a598b0054a089bebb82f4fb49d98a0c)
2022-09-28T06:34:02.207307Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0124"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0a4f7c125f38c3b67bc9efc42a39351807ea35200a93e9025528fc09a280a1f3)
2022-09-28T06:34:04.368597Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:34:04.391288Z - running sql script pg/upsert_orders.sql
2022-09-28T06:34:04.392081Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:34:04.398193Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:34:04.400997Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:34:04.402550Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:34:04.403947Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:34:04.405362Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:34:04.406682Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:34:04.407783Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:34:04.408855Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:34:04.410966Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:34:04.412983Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:34:04.415670Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:34:04.416731Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:34:04.418571Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:34:04.420736Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:34:04.424975Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:34:04.425592Z - job completed in 2.22 seconds (0a4f7c125f38c3b67bc9efc42a39351807ea35200a93e9025528fc09a280a1f3)
2022-09-28T06:34:04.502889Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0124"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e161c91f141900204680386315a656106f858afd53310ac85d5aafdb2a5e874d)
2022-09-28T06:34:05.770512Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:34:05.817562Z - running sql script pg/insert_tenders.sql
2022-09-28T06:34:05.818053Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:34:05.822950Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:34:05.825118Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:34:05.826970Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:34:05.828237Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:34:05.829902Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:34:05.831293Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:34:05.834494Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:34:05.836287Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:34:05.837144Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:34:05.838562Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:34:05.839886Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:34:05.841238Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:34:05.842505Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:34:05.844566Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:34:05.846506Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:34:05.848005Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:34:05.848533Z - job completed in 1.35 seconds (e161c91f141900204680386315a656106f858afd53310ac85d5aafdb2a5e874d)
2022-09-28T06:36:01.836344Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0126"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (753143b66198ed63d7aab3af4fc934adab52c8f58637c39da5a160b97af6084f)
2022-09-28T06:36:03.738320Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:36:03.756560Z - running sql script pg/upsert_orders.sql
2022-09-28T06:36:03.756601Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:36:03.762606Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:36:03.764371Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:36:03.765566Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:36:03.767217Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:36:03.769174Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:36:03.771014Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:36:03.772601Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:36:03.774442Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:36:03.776797Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:36:03.779442Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:36:03.781388Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:36:03.782707Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:36:03.784956Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:36:03.787353Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:36:03.791925Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:36:03.792739Z - job completed in 1.96 seconds (753143b66198ed63d7aab3af4fc934adab52c8f58637c39da5a160b97af6084f)
2022-09-28T06:36:03.864335Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0126"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d07cc480385afe0c87de50fe543085f8ec7b6b16ec5977a3be7d17e9b1633937)
2022-09-28T06:36:05.156880Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:36:05.188025Z - running sql script pg/insert_tenders.sql
2022-09-28T06:36:05.188279Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:36:05.194548Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:36:05.196125Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:36:05.197949Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:36:05.199933Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:36:05.202036Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:36:05.203969Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:36:05.207920Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:36:05.209949Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:36:05.211353Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:36:05.213325Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:36:05.215375Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:36:05.217157Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:36:05.218881Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:36:05.221386Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:36:05.224841Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:36:05.226954Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:36:05.227954Z - job completed in 1.36 seconds (d07cc480385afe0c87de50fe543085f8ec7b6b16ec5977a3be7d17e9b1633937)
2022-09-28T06:38:01.985463Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0128"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d9d4e58cbc0c0cff6690e11c6e6a8cbab13db6a3b58390f3b738c3d9f4fd6021)
2022-09-28T06:38:03.957397Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:38:03.974341Z - running sql script pg/upsert_orders.sql
2022-09-28T06:38:03.974384Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:38:03.979510Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:38:03.980930Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:38:03.981840Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:38:03.982799Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:38:03.984168Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:38:03.985581Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:38:03.986513Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:38:03.987406Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:38:03.989242Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:38:03.991243Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:38:03.992795Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:38:03.993688Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:38:03.995515Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:38:03.997539Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:38:04.001377Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:38:04.001744Z - job completed in 2.02 seconds (d9d4e58cbc0c0cff6690e11c6e6a8cbab13db6a3b58390f3b738c3d9f4fd6021)
2022-09-28T06:38:04.117665Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0128"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ae7e590cf9669d1daf2629831312868e8b21c8905e8ebbdaa248beb5331c0272)
2022-09-28T06:38:05.161712Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:38:05.183754Z - running sql script pg/insert_tenders.sql
2022-09-28T06:38:05.183809Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:38:05.190173Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:38:05.191384Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:38:05.192398Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:38:05.193346Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:38:05.194568Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:38:05.195521Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:38:05.197561Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:38:05.198970Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:38:05.199810Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:38:05.201169Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:38:05.202629Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:38:05.204408Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:38:05.205991Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:38:05.207968Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:38:05.209975Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:38:05.211580Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:38:05.212138Z - job completed in 1.10 seconds (ae7e590cf9669d1daf2629831312868e8b21c8905e8ebbdaa248beb5331c0272)
2022-09-28T06:38:05.307661Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0118"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (6bb427848ac3f01254db6c9c70451be723299eb099680b38e2b0f50d1b0fa170)
2022-09-28T06:38:09.778091Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:38:09.798020Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T06:38:09.798085Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:38:09.803155Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T06:38:09.805178Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T06:38:09.806314Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T06:38:09.807188Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T06:38:09.808667Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T06:38:09.810254Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T06:38:09.811924Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:38:09.813431Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T06:38:09.814934Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T06:38:09.816860Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T06:38:09.818455Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T06:38:09.819956Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T06:38:09.823450Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T06:38:09.824543Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T06:38:09.826258Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T06:38:09.828731Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T06:38:09.901111Z - called http://score/api/keyed and received back 204
2022-09-28T06:38:09.901279Z - job completed in 4.59 seconds (6bb427848ac3f01254db6c9c70451be723299eb099680b38e2b0f50d1b0fa170)
2022-09-28T06:40:02.595691Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0130"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (425199423bf7a225fae5e1780d64d6305dc43462afe77073891aa1c03137f4cf)
2022-09-28T06:40:04.681959Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:40:04.719452Z - running sql script pg/upsert_orders.sql
2022-09-28T06:40:04.719514Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:40:04.749150Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:40:04.753953Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:40:04.755056Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:40:04.758838Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:40:04.760459Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:40:04.762165Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:40:04.763326Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:40:04.764187Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:40:04.770001Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:40:04.796366Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:40:04.798270Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:40:04.800044Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:40:04.821952Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:40:04.925665Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:40:04.963515Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:40:04.979818Z - job completed in 2.38 seconds (425199423bf7a225fae5e1780d64d6305dc43462afe77073891aa1c03137f4cf)
2022-09-28T06:40:05.067753Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0130"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b6bd73de0cd4527a529df8c10425a9fcd521718c2871e55f0b109c8c11b0010c)
2022-09-28T06:40:06.663125Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:40:06.685280Z - running sql script pg/insert_tenders.sql
2022-09-28T06:40:06.685453Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:40:06.689952Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:40:06.691258Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:40:06.692281Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:40:06.693269Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:40:06.694712Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:40:06.695621Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:40:06.697836Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:40:06.699421Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:40:06.700454Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:40:06.701749Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:40:06.703025Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:40:06.704403Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:40:06.705554Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:40:06.707376Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:40:06.709185Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:40:06.710581Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:40:06.710969Z - job completed in 1.64 seconds (b6bd73de0cd4527a529df8c10425a9fcd521718c2871e55f0b109c8c11b0010c)
2022-09-28T06:42:02.008589Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0132"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0a027599f5a461487147e919a3357908fa4e760bd961d1f0f15860e42574faab)
2022-09-28T06:42:03.111763Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:42:03.128803Z - running sql script pg/insert_tenders.sql
2022-09-28T06:42:03.128846Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:42:03.133911Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:42:03.135373Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:42:03.136594Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:42:03.137617Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:42:03.138965Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:42:03.140036Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:42:03.142224Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:42:03.144306Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:42:03.145305Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:42:03.146693Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:42:03.147988Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:42:03.149290Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:42:03.150667Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:42:03.152669Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:42:03.154518Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:42:03.156199Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:42:03.156785Z - job completed in 1.15 seconds (0a027599f5a461487147e919a3357908fa4e760bd961d1f0f15860e42574faab)
2022-09-28T06:42:03.245373Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0132"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (98db7840f0e11661b7435a10128948a34baf0c885450a0ddb7e8a5b97659988c)
2022-09-28T06:42:05.099588Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:42:05.125274Z - running sql script pg/upsert_orders.sql
2022-09-28T06:42:05.125648Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:42:05.131325Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:42:05.136447Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:42:05.137483Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:42:05.141931Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:42:05.145111Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:42:05.152331Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:42:05.153803Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:42:05.155057Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:42:05.161224Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:42:05.213742Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:42:05.215801Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:42:05.216885Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:42:05.237363Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:42:05.326020Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:42:05.345328Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:42:05.346366Z - job completed in 2.10 seconds (98db7840f0e11661b7435a10128948a34baf0c885450a0ddb7e8a5b97659988c)
2022-09-28T06:44:02.186704Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0134"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e7c9351b833b455c2ad131ef10ab09c37f327b51162c93738f3779dbb867f1fe)
2022-09-28T06:44:04.122903Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:44:04.141009Z - running sql script pg/upsert_orders.sql
2022-09-28T06:44:04.141071Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:44:04.146642Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:44:04.151415Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:44:04.152596Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:44:04.156533Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:44:04.158256Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:44:04.163220Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:44:04.164676Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:44:04.166181Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:44:04.172320Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:44:04.236183Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:44:04.237970Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:44:04.238810Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:44:04.258302Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:44:04.334616Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:44:04.365377Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:44:04.366093Z - job completed in 2.18 seconds (e7c9351b833b455c2ad131ef10ab09c37f327b51162c93738f3779dbb867f1fe)
2022-09-28T06:44:04.401281Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0134"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (50e25b3ff15470163a7992243b971e2238cde84431e0021a52a1122d190208ef)
2022-09-28T06:44:05.740645Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:44:05.764197Z - running sql script pg/insert_tenders.sql
2022-09-28T06:44:05.764275Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:44:05.768826Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:44:05.771079Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:44:05.772277Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:44:05.773216Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:44:05.774537Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:44:05.775464Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:44:05.777462Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:44:05.779327Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:44:05.781693Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:44:05.794513Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:44:05.795847Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:44:05.797320Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:44:05.798706Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:44:05.800275Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:44:05.802036Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:44:05.804059Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:44:05.804414Z - job completed in 1.40 seconds (50e25b3ff15470163a7992243b971e2238cde84431e0021a52a1122d190208ef)
2022-09-28T06:46:01.962441Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0136"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7e5995def6d02fd8c0cb8c426e629de55c709205822d1349af6a17883515cc6d)
2022-09-28T06:46:03.156722Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:46:03.182788Z - running sql script pg/insert_tenders.sql
2022-09-28T06:46:03.182857Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:46:03.188138Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:46:03.189408Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:46:03.190428Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:46:03.199977Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:46:03.201711Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:46:03.202627Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:46:03.204904Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:46:03.206233Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:46:03.207082Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:46:03.208362Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:46:03.209758Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:46:03.210884Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:46:03.212375Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:46:03.214791Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:46:03.216955Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:46:03.218795Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:46:03.219137Z - job completed in 1.26 seconds (7e5995def6d02fd8c0cb8c426e629de55c709205822d1349af6a17883515cc6d)
2022-09-28T06:46:03.353800Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0136"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6da29e60bea6848e3d2e099e8cda90889ea494879f9fdd7c7535fdad04d886a3)
2022-09-28T06:46:05.454935Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:46:05.480945Z - running sql script pg/upsert_orders.sql
2022-09-28T06:46:05.481010Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:46:05.488363Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:46:05.492717Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:46:05.494584Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:46:05.499451Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:46:05.501798Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:46:05.506482Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:46:05.507680Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:46:05.508895Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:46:05.515240Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:46:05.579403Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:46:05.581200Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:46:05.582153Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:46:05.591271Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:46:05.659486Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:46:05.669576Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:46:05.669956Z - job completed in 2.32 seconds (6da29e60bea6848e3d2e099e8cda90889ea494879f9fdd7c7535fdad04d886a3)
2022-09-28T06:48:02.006381Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0138"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8bb3b03807f84c17c076d49260f74dcc394a9e9144bcb4f33521579956c0cc4a)
2022-09-28T06:48:03.832625Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:48:03.853208Z - running sql script pg/upsert_orders.sql
2022-09-28T06:48:03.853682Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:48:03.859657Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:48:03.863787Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:48:03.865082Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:48:03.869100Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:48:03.870516Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:48:03.874439Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:48:03.875374Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:48:03.876209Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:48:03.882070Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:48:03.946322Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:48:03.947948Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:48:03.957383Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:48:03.964007Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:48:04.026717Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:48:04.035641Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:48:04.036836Z - job completed in 2.03 seconds (8bb3b03807f84c17c076d49260f74dcc394a9e9144bcb4f33521579956c0cc4a)
2022-09-28T06:48:04.067523Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0138"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (357f89b1dbfac6dc6c5c2e44cc5be6414e13746ef9f715357cb3c4b9b16275d9)
2022-09-28T06:48:05.274554Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:48:05.293600Z - running sql script pg/insert_tenders.sql
2022-09-28T06:48:05.293768Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:48:05.299143Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:48:05.300348Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:48:05.301487Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:48:05.302447Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:48:05.303786Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:48:05.304807Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:48:05.307158Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:48:05.308636Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:48:05.309551Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:48:05.311Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:48:05.312343Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:48:05.313558Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:48:05.314940Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:48:05.316870Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:48:05.318838Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:48:05.320607Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:48:05.321068Z - job completed in 1.25 seconds (357f89b1dbfac6dc6c5c2e44cc5be6414e13746ef9f715357cb3c4b9b16275d9)
2022-09-28T06:48:05.407686Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0128"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (5fb16890e11482757ba564169fdd10a941edf9924b4c74ef81bb2f7d76ed5cd2)
2022-09-28T06:48:09.756521Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:48:09.780917Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T06:48:09.781538Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:48:09.787566Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T06:48:09.790138Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T06:48:09.792365Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T06:48:09.794541Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T06:48:09.797973Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T06:48:09.799959Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T06:48:09.801939Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:48:09.803894Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T06:48:09.805632Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T06:48:09.808803Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T06:48:09.810636Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T06:48:09.812385Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T06:48:09.814995Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T06:48:09.816608Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T06:48:09.818847Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T06:48:09.820647Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T06:48:09.905659Z - called http://score/api/keyed and received back 204
2022-09-28T06:48:09.905881Z - job completed in 4.50 seconds (5fb16890e11482757ba564169fdd10a941edf9924b4c74ef81bb2f7d76ed5cd2)
2022-09-28T06:50:02.436001Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0140"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (51f04cbe3c0fc1bfbda958f6e56731e93ac477a886e434252d93df5399743d76)
2022-09-28T06:50:03.752980Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:50:03.771065Z - running sql script pg/insert_tenders.sql
2022-09-28T06:50:03.771101Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:50:03.776842Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:50:03.778790Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:50:03.782219Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:50:03.783581Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:50:03.784897Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:50:03.786076Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:50:03.788276Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:50:03.789900Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:50:03.791383Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:50:03.793207Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:50:03.794626Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:50:03.795906Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:50:03.797074Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:50:03.799281Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:50:03.801594Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:50:03.803994Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:50:03.804444Z - job completed in 1.37 seconds (51f04cbe3c0fc1bfbda958f6e56731e93ac477a886e434252d93df5399743d76)
2022-09-28T06:50:03.830418Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0140"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0fd01d7546fa365d1a0220e8360e69d4d0cc388f3f13121ab7a69f51ff815741)
2022-09-28T06:50:05.942373Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:50:05.959650Z - running sql script pg/upsert_orders.sql
2022-09-28T06:50:05.959692Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:50:05.964477Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:50:05.969316Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:50:05.970334Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:50:05.974153Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:50:05.975526Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:50:05.980081Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:50:05.981238Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:50:05.982303Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:50:05.987994Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:50:06.034586Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:50:06.036117Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:50:06.037184Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:50:06.043229Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:50:06.105980Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:50:06.114266Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:50:06.114787Z - job completed in 2.28 seconds (0fd01d7546fa365d1a0220e8360e69d4d0cc388f3f13121ab7a69f51ff815741)
2022-09-28T06:52:02.110483Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0142"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (51c200dbd4c65288ff53b25b435d8747c8c428806ce15f8306116360829b66a6)
2022-09-28T06:52:04.169564Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:52:04.189903Z - running sql script pg/upsert_orders.sql
2022-09-28T06:52:04.190041Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:52:04.194934Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:52:04.200132Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:52:04.201639Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:52:04.205905Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:52:04.207970Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:52:04.209475Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:52:04.213487Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:52:04.215077Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:52:04.221983Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:52:04.245001Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:52:04.247165Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:52:04.248559Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:52:04.254231Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:52:04.318528Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:52:04.326318Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:52:04.326633Z - job completed in 2.22 seconds (51c200dbd4c65288ff53b25b435d8747c8c428806ce15f8306116360829b66a6)
2022-09-28T06:52:04.355308Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0142"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2bb8399d31fa478315494a9d9eebd244d0db7ba13278bfe3e2781cbfc15f26d7)
2022-09-28T06:52:05.448126Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:52:05.466460Z - running sql script pg/insert_tenders.sql
2022-09-28T06:52:05.466502Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:52:05.470983Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:52:05.472303Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:52:05.473297Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:52:05.474202Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:52:05.475614Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:52:05.476399Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:52:05.478652Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:52:05.480154Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:52:05.481103Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:52:05.482656Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:52:05.483810Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:52:05.485024Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:52:05.486146Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:52:05.487770Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:52:05.489462Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:52:05.490948Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:52:05.491261Z - job completed in 1.14 seconds (2bb8399d31fa478315494a9d9eebd244d0db7ba13278bfe3e2781cbfc15f26d7)
2022-09-28T06:54:02.036858Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0144"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (87f15b4c1abdc3a717cd2177c3cc82ba66dda0e1bc85b90ee00097bdad2326d3)
2022-09-28T06:54:03.130903Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:54:03.152501Z - running sql script pg/insert_tenders.sql
2022-09-28T06:54:03.152548Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:54:03.157678Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:54:03.159358Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:54:03.160269Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:54:03.161640Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:54:03.163548Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:54:03.164467Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:54:03.167173Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:54:03.168776Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:54:03.169733Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:54:03.171110Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:54:03.172875Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:54:03.174901Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:54:03.176203Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:54:03.179057Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:54:03.181264Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:54:03.184094Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:54:03.184421Z - job completed in 1.15 seconds (87f15b4c1abdc3a717cd2177c3cc82ba66dda0e1bc85b90ee00097bdad2326d3)
2022-09-28T06:54:03.306135Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0144"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e2ed8b7a8d869009953bb5ab07cdbcc1511fa4ed87e0babe17b1e0eaca296f9b)
2022-09-28T06:54:05.160155Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:54:05.180641Z - running sql script pg/upsert_orders.sql
2022-09-28T06:54:05.180688Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:54:05.187494Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:54:05.188876Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:54:05.189868Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:54:05.190923Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:54:05.192166Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:54:05.193555Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:54:05.194418Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:54:05.195388Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:54:05.197098Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:54:05.199136Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:54:05.200727Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:54:05.201665Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:54:05.203446Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:54:05.205144Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:54:05.208871Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:54:05.209298Z - job completed in 1.90 seconds (e2ed8b7a8d869009953bb5ab07cdbcc1511fa4ed87e0babe17b1e0eaca296f9b)
2022-09-28T06:56:01.943962Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0146"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (29832ef4036c194f85e59855a15ac7a56ea679b4744b8128e84eb3bb1e9a2fcb)
2022-09-28T06:56:03.132292Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:56:03.149752Z - running sql script pg/insert_tenders.sql
2022-09-28T06:56:03.149806Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:56:03.154421Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:56:03.155744Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:56:03.156831Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:56:03.157812Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:56:03.159146Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:56:03.160057Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:56:03.162217Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:56:03.163609Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:56:03.164457Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:56:03.165700Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:56:03.166868Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:56:03.168041Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:56:03.169572Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:56:03.171292Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:56:03.172974Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:56:03.175492Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:56:03.176192Z - job completed in 1.23 seconds (29832ef4036c194f85e59855a15ac7a56ea679b4744b8128e84eb3bb1e9a2fcb)
2022-09-28T06:56:03.223739Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0146"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (993c02178fd625f22fa79e0d3a716e6d51008f736cd470e774bdf579acd2c25f)
2022-09-28T06:56:05.075742Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:56:05.094557Z - running sql script pg/upsert_orders.sql
2022-09-28T06:56:05.094622Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:56:05.099742Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:56:05.101377Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:56:05.102401Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:56:05.103362Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:56:05.104771Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:56:05.106221Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:56:05.107296Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:56:05.108386Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:56:05.110158Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:56:05.112301Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:56:05.114361Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:56:05.119719Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:56:05.121492Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:56:05.123562Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:56:05.127887Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:56:05.128523Z - job completed in 1.91 seconds (993c02178fd625f22fa79e0d3a716e6d51008f736cd470e774bdf579acd2c25f)
2022-09-28T06:58:01.931588Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0148"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fdc61f4a53c9a5585914e90812a6c7ad4776e156986a8d0d22a63e8e7f7c734a)
2022-09-28T06:58:03.283863Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:58:03.302752Z - running sql script pg/insert_tenders.sql
2022-09-28T06:58:03.302799Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T06:58:03.307608Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T06:58:03.308931Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T06:58:03.309901Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T06:58:03.310850Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T06:58:03.312319Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T06:58:03.313185Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T06:58:03.315590Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T06:58:03.317222Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T06:58:03.318297Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T06:58:03.319697Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T06:58:03.321045Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T06:58:03.322450Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T06:58:03.323866Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T06:58:03.325834Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T06:58:03.328316Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T06:58:03.329717Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T06:58:03.330147Z - job completed in 1.40 seconds (fdc61f4a53c9a5585914e90812a6c7ad4776e156986a8d0d22a63e8e7f7c734a)
2022-09-28T06:58:03.367021Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0148"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3579eb567a43f5f22d2785414069cdc806097794af89ee324465500a16f080c8)
2022-09-28T06:58:05.474783Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:58:05.494337Z - running sql script pg/upsert_orders.sql
2022-09-28T06:58:05.494406Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:58:05.499460Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T06:58:05.501131Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T06:58:05.502288Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T06:58:05.503674Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T06:58:05.505295Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T06:58:05.506768Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:58:05.507878Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T06:58:05.508977Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T06:58:05.511047Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T06:58:05.513424Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T06:58:05.515294Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T06:58:05.516557Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T06:58:05.518651Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T06:58:05.520782Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T06:58:05.526214Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T06:58:05.526677Z - job completed in 2.16 seconds (3579eb567a43f5f22d2785414069cdc806097794af89ee324465500a16f080c8)
2022-09-28T06:58:05.612713Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0138"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (b1f0b4823447861126e90af53bf6a667bbab121049c5cbfd56f7d144287e30b8)
2022-09-28T06:58:10.291083Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T06:58:10.313169Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T06:58:10.313215Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T06:58:10.317342Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T06:58:10.318904Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T06:58:10.319943Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T06:58:10.321595Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T06:58:10.322794Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T06:58:10.324151Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T06:58:10.325595Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T06:58:10.326733Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T06:58:10.327976Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T06:58:10.329984Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T06:58:10.331640Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T06:58:10.332860Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T06:58:10.335904Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T06:58:10.337074Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T06:58:10.338229Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T06:58:10.339721Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T06:58:10.448123Z - called http://score/api/keyed and received back 204
2022-09-28T06:58:10.448225Z - job completed in 4.84 seconds (b1f0b4823447861126e90af53bf6a667bbab121049c5cbfd56f7d144287e30b8)
2022-09-28T07:00:02.135729Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0150"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (59a8dc94af5ff24fbe208ee975a16ff8b17baed73e2cd754949f4b35d3ac692c)
2022-09-28T07:00:03.507975Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:00:03.527995Z - running sql script pg/insert_tenders.sql
2022-09-28T07:00:03.528196Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:00:03.532855Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:00:03.534491Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:00:03.535602Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:00:03.536653Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:00:03.538300Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:00:03.539270Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:00:03.541607Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:00:03.543097Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:00:03.543954Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:00:03.545177Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:00:03.548964Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:00:03.551362Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:00:03.552753Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:00:03.554360Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:00:03.555912Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:00:03.557315Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:00:03.557826Z - job completed in 1.42 seconds (59a8dc94af5ff24fbe208ee975a16ff8b17baed73e2cd754949f4b35d3ac692c)
2022-09-28T07:00:03.669929Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0150"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e3c0dad495c30728d22b90de8ff0c329c072797c643ae22b42a4cc6218f2bd47)
2022-09-28T07:00:05.891086Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:00:05.918481Z - running sql script pg/upsert_orders.sql
2022-09-28T07:00:05.918525Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:00:05.923059Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:00:05.924445Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:00:05.925458Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:00:05.926457Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:00:05.927637Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:00:05.928929Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:00:05.929971Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:00:05.930830Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:00:05.932734Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:00:05.934812Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:00:05.937604Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:00:05.938448Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:00:05.940083Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:00:05.941775Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:00:05.945770Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:00:05.946093Z - job completed in 2.28 seconds (e3c0dad495c30728d22b90de8ff0c329c072797c643ae22b42a4cc6218f2bd47)
2022-09-28T07:02:02.161226Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0152"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fa59058b9a7faf95b92d57e1a3712c4026275d476630843a5f190075ce2ca737)
2022-09-28T07:02:04.246473Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:02:04.281203Z - running sql script pg/upsert_orders.sql
2022-09-28T07:02:04.281256Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:02:04.285854Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:02:04.290350Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:02:04.291511Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:02:04.296048Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:02:04.298026Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:02:04.300011Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:02:04.301010Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:02:04.301975Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:02:04.308428Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:02:04.325239Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:02:04.326740Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:02:04.327709Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:02:04.335878Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:02:04.395120Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:02:04.404087Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:02:04.404990Z - job completed in 2.24 seconds (fa59058b9a7faf95b92d57e1a3712c4026275d476630843a5f190075ce2ca737)
2022-09-28T07:02:04.608654Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0152"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ef36375a34ad2fefda3d261e18e8ea9e1ef48b7a65d128bad8b0b06af0e82efb)
2022-09-28T07:02:05.728923Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:02:05.758398Z - running sql script pg/insert_tenders.sql
2022-09-28T07:02:05.759136Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:02:05.764468Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:02:05.765876Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:02:05.766970Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:02:05.767839Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:02:05.769155Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:02:05.770130Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:02:05.772257Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:02:05.773702Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:02:05.774795Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:02:05.776190Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:02:05.777454Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:02:05.778711Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:02:05.780261Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:02:05.783789Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:02:05.786847Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:02:05.788537Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:02:05.789112Z - job completed in 1.18 seconds (ef36375a34ad2fefda3d261e18e8ea9e1ef48b7a65d128bad8b0b06af0e82efb)
2022-09-28T07:04:02.007155Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0154"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (635c7f9ec70b7aed9df6e095db2b62eecf22af49c591e00a4193a2c42230a6e1)
2022-09-28T07:04:03.183947Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:04:03.201575Z - running sql script pg/insert_tenders.sql
2022-09-28T07:04:03.201970Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:04:03.207330Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:04:03.209206Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:04:03.210599Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:04:03.212318Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:04:03.217347Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:04:03.218680Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:04:03.221209Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:04:03.223119Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:04:03.226362Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:04:03.227998Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:04:03.229783Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:04:03.231228Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:04:03.232726Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:04:03.234762Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:04:03.236810Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:04:03.238350Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:04:03.238788Z - job completed in 1.23 seconds (635c7f9ec70b7aed9df6e095db2b62eecf22af49c591e00a4193a2c42230a6e1)
2022-09-28T07:04:03.291289Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0154"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2fd85a7f4f558896a4afa59f0ea66cfb53d31449837b5bc558259e86cb1c74a5)
2022-09-28T07:04:05.252877Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:04:05.275979Z - running sql script pg/upsert_orders.sql
2022-09-28T07:04:05.276032Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:04:05.281445Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:04:05.286253Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:04:05.287640Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:04:05.291857Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:04:05.293449Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:04:05.294871Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:04:05.295934Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:04:05.297252Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:04:05.303403Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:04:05.321274Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:04:05.322885Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:04:05.323904Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:04:05.329349Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:04:05.390258Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:04:05.398038Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:04:05.398481Z - job completed in 2.11 seconds (2fd85a7f4f558896a4afa59f0ea66cfb53d31449837b5bc558259e86cb1c74a5)
2022-09-28T07:06:01.929913Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0156"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0c20a889852c626d9e505179057e7ed7cbfa3b68ec8e23fe88c23df26a7657f0)
2022-09-28T07:06:04.050784Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:06:04.071906Z - running sql script pg/upsert_orders.sql
2022-09-28T07:06:04.071953Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:06:04.077197Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:06:04.082300Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:06:04.083578Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:06:04.087913Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:06:04.089436Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:06:04.090941Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:06:04.091973Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:06:04.093004Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:06:04.098673Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:06:04.115821Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:06:04.117807Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:06:04.119019Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:06:04.125119Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:06:04.185469Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:06:04.193394Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:06:04.193915Z - job completed in 2.26 seconds (0c20a889852c626d9e505179057e7ed7cbfa3b68ec8e23fe88c23df26a7657f0)
2022-09-28T07:06:04.273390Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0156"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f1081df35bec25a96efb0833baa11f530c2058106c71d4fd3a3f7b8b9713c7e7)
2022-09-28T07:06:05.207903Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:06:05.237138Z - running sql script pg/insert_tenders.sql
2022-09-28T07:06:05.237604Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:06:05.243628Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:06:05.247708Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:06:05.251655Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:06:05.253186Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:06:05.254950Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:06:05.256191Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:06:05.258400Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:06:05.260563Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:06:05.261743Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:06:05.263655Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:06:05.265976Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:06:05.267667Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:06:05.269088Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:06:05.271119Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:06:05.273141Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:06:05.274859Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:06:05.275290Z - job completed in 1.00 seconds (f1081df35bec25a96efb0833baa11f530c2058106c71d4fd3a3f7b8b9713c7e7)
2022-09-28T07:08:02.029936Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0148"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (2c4189ad3cd1026b8e20968cca5cb70e252720b1cd436af77dfb0c5886276f6d)
2022-09-28T07:08:06.755769Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:08:06.774801Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T07:08:06.774862Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:08:06.779674Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T07:08:06.781433Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T07:08:06.782475Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T07:08:06.783467Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T07:08:06.785003Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T07:08:06.786416Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T07:08:06.787827Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:08:06.789067Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T07:08:06.790128Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T07:08:06.792023Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T07:08:06.793607Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T07:08:06.794583Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T07:08:06.797038Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T07:08:06.798104Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T07:08:06.799377Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T07:08:06.801155Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T07:08:06.878876Z - called http://score/api/keyed and received back 204
2022-09-28T07:08:06.879258Z - job completed in 4.85 seconds (2c4189ad3cd1026b8e20968cca5cb70e252720b1cd436af77dfb0c5886276f6d)
2022-09-28T07:08:06.920601Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0158"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1a3bcde9e273a7498b4e050544328ee14022340ce347fd775a2012212f1a1168)
2022-09-28T07:08:08.136937Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:08:08.155376Z - running sql script pg/insert_tenders.sql
2022-09-28T07:08:08.155430Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:08:08.160669Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:08:08.162234Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:08:08.163706Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:08:08.164892Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:08:08.166640Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:08:08.167730Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:08:08.170059Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:08:08.171857Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:08:08.172974Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:08:08.174423Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:08:08.175981Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:08:08.177367Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:08:08.179104Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:08:08.181138Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:08:08.182875Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:08:08.189752Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:08:08.190138Z - job completed in 1.27 seconds (1a3bcde9e273a7498b4e050544328ee14022340ce347fd775a2012212f1a1168)
2022-09-28T07:08:08.215441Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0158"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (102cb1575f9089a762d261d1c1d8c70091a0f49809089b1b09e00ba4010a082a)
2022-09-28T07:08:10.815353Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:08:10.834692Z - running sql script pg/upsert_orders.sql
2022-09-28T07:08:10.834737Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:08:10.839170Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:08:10.843778Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:08:10.844718Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:08:10.848695Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:08:10.850218Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:08:10.851656Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:08:10.852642Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:08:10.853486Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:08:10.859298Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:08:10.876777Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:08:10.878767Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:08:10.879667Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:08:10.885305Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:08:10.945492Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:08:10.953093Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:08:10.953478Z - job completed in 2.74 seconds (102cb1575f9089a762d261d1c1d8c70091a0f49809089b1b09e00ba4010a082a)
2022-09-28T07:10:03.521354Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0200"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7c0a7235a614e10e372e9f5383e12f462a30d9f369f4f6ea7100a8c56e832ebe)
2022-09-28T07:10:05.858394Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:10:05.894003Z - running sql script pg/upsert_orders.sql
2022-09-28T07:10:05.894742Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:10:05.910930Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:10:05.919635Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:10:05.920945Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:10:05.927596Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:10:05.931016Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:10:05.933020Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:10:05.934440Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:10:05.935586Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:10:05.943741Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:10:05.962090Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:10:05.963720Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:10:05.964716Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:10:05.972183Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:10:06.031601Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:10:06.038749Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:10:06.039401Z - job completed in 2.52 seconds (7c0a7235a614e10e372e9f5383e12f462a30d9f369f4f6ea7100a8c56e832ebe)
2022-09-28T07:10:06.210440Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0200"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d93bac9408091dc635e9f8f66c6f5d7501fdf090b0d3d44f43b355978946323c)
2022-09-28T07:10:07.177342Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:10:07.197322Z - running sql script pg/insert_tenders.sql
2022-09-28T07:10:07.197498Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:10:07.202801Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:10:07.204749Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:10:07.206023Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:10:07.207235Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:10:07.208800Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:10:07.209919Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:10:07.212217Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:10:07.213915Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:10:07.215140Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:10:07.216726Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:10:07.218261Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:10:07.223148Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:10:07.224814Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:10:07.226926Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:10:07.231620Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:10:07.243595Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:10:07.255072Z - job completed in 1.03 seconds (d93bac9408091dc635e9f8f66c6f5d7501fdf090b0d3d44f43b355978946323c)
2022-09-28T07:12:02.049927Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0202"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (27fce5306cc2a8237688e14cf47979b772ca641ce572b7052544316c0f0007ab)
2022-09-28T07:12:04.002630Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:12:04.025482Z - running sql script pg/upsert_orders.sql
2022-09-28T07:12:04.025537Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:12:04.030260Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:12:04.031638Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:12:04.032671Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:12:04.033604Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:12:04.034774Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:12:04.036010Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:12:04.036944Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:12:04.037781Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:12:04.039522Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:12:04.041575Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:12:04.042912Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:12:04.043759Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:12:04.046105Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:12:04.047930Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:12:04.051642Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:12:04.052120Z - job completed in 2.00 seconds (27fce5306cc2a8237688e14cf47979b772ca641ce572b7052544316c0f0007ab)
2022-09-28T07:12:04.116485Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0202"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (773446e9baa96b289e6378c1129e8f48d632ec6e2a3679662435ddc12db37665)
2022-09-28T07:12:05.129857Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:12:05.151693Z - running sql script pg/insert_tenders.sql
2022-09-28T07:12:05.151745Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:12:05.156606Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:12:05.158395Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:12:05.159905Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:12:05.161510Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:12:05.163373Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:12:05.165445Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:12:05.168158Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:12:05.169988Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:12:05.171871Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:12:05.173758Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:12:05.177597Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:12:05.179591Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:12:05.181559Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:12:05.183895Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:12:05.186361Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:12:05.188280Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:12:05.188879Z - job completed in 1.07 seconds (773446e9baa96b289e6378c1129e8f48d632ec6e2a3679662435ddc12db37665)
2022-09-28T07:14:02.261471Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0204"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (229064ebecd04d2d00ddc8befb07efcf25ea415dab7c2bae0ec1bc667b420750)
2022-09-28T07:14:03.729339Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:14:03.750064Z - running sql script pg/insert_tenders.sql
2022-09-28T07:14:03.750117Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:14:03.754985Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:14:03.756212Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:14:03.757176Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:14:03.758141Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:14:03.759581Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:14:03.760695Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:14:03.762893Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:14:03.764392Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:14:03.765403Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:14:03.766767Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:14:03.768042Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:14:03.769472Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:14:03.770757Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:14:03.772713Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:14:03.774653Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:14:03.776330Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:14:03.776770Z - job completed in 1.52 seconds (229064ebecd04d2d00ddc8befb07efcf25ea415dab7c2bae0ec1bc667b420750)
2022-09-28T07:14:03.865194Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0204"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (caf7196619f929f3ed5e80aad5071c93c820fc075cbae1602f75384ccfe993fd)
2022-09-28T07:14:05.771925Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:14:05.803126Z - running sql script pg/upsert_orders.sql
2022-09-28T07:14:05.803180Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:14:05.809044Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:14:05.810795Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:14:05.811962Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:14:05.813428Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:14:05.814943Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:14:05.820431Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:14:05.821792Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:14:05.822637Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:14:05.825086Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:14:05.827208Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:14:05.828871Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:14:05.829731Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:14:05.831645Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:14:05.834215Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:14:05.838902Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:14:05.839228Z - job completed in 1.97 seconds (caf7196619f929f3ed5e80aad5071c93c820fc075cbae1602f75384ccfe993fd)
2022-09-28T07:16:02.010045Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0206"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3328e4b2d16e8bd8662d56a4fc98325403cc34fa0e2d6d4083478cafe912a77f)
2022-09-28T07:16:03.197294Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:16:03.228619Z - running sql script pg/insert_tenders.sql
2022-09-28T07:16:03.228678Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:16:03.236557Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:16:03.238737Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:16:03.240438Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:16:03.242267Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:16:03.244126Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:16:03.245466Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:16:03.247438Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:16:03.248759Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:16:03.249690Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:16:03.251180Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:16:03.252510Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:16:03.254418Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:16:03.255774Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:16:03.258186Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:16:03.260369Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:16:03.262096Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:16:03.262416Z - job completed in 1.25 seconds (3328e4b2d16e8bd8662d56a4fc98325403cc34fa0e2d6d4083478cafe912a77f)
2022-09-28T07:16:03.371238Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0206"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (bfad1379641331eb8c281d4eda679b45613959ce11af96adc4bb67829104439a)
2022-09-28T07:16:05.628756Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:16:05.649634Z - running sql script pg/upsert_orders.sql
2022-09-28T07:16:05.649680Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:16:05.654208Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:16:05.656154Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:16:05.657828Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:16:05.658909Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:16:05.660023Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:16:05.661260Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:16:05.662323Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:16:05.664494Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:16:05.666689Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:16:05.668633Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:16:05.671813Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:16:05.673025Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:16:05.674522Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:16:05.676351Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:16:05.680463Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:16:05.680796Z - job completed in 2.31 seconds (bfad1379641331eb8c281d4eda679b45613959ce11af96adc4bb67829104439a)
2022-09-28T07:18:02.054194Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0208"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (05efe821faa22cdcb0eb29b4ecc98e6cfdb5e009ceb873e85688839ce8059f0a)
2022-09-28T07:18:03.123695Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:18:03.142966Z - running sql script pg/insert_tenders.sql
2022-09-28T07:18:03.143021Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:18:03.147224Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:18:03.148458Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:18:03.149633Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:18:03.150551Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:18:03.151864Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:18:03.152801Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:18:03.154993Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:18:03.156561Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:18:03.157471Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:18:03.158796Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:18:03.160183Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:18:03.161375Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:18:03.162765Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:18:03.164622Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:18:03.166470Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:18:03.167972Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:18:03.168302Z - job completed in 1.11 seconds (05efe821faa22cdcb0eb29b4ecc98e6cfdb5e009ceb873e85688839ce8059f0a)
2022-09-28T07:18:03.278196Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0208"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e7321df1af378ed53e60837eeb17b19b910835843861ddfd8d4f8452cb7ad143)
2022-09-28T07:18:05.352179Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:18:05.371448Z - running sql script pg/upsert_orders.sql
2022-09-28T07:18:05.371497Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:18:05.376425Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:18:05.377858Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:18:05.378898Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:18:05.379816Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:18:05.381234Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:18:05.382652Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:18:05.383635Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:18:05.385220Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:18:05.387145Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:18:05.389323Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:18:05.391038Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:18:05.392089Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:18:05.393776Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:18:05.395641Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:18:05.399841Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:18:05.400227Z - job completed in 2.12 seconds (e7321df1af378ed53e60837eeb17b19b910835843861ddfd8d4f8452cb7ad143)
2022-09-28T07:18:05.443557Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0158"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (500141f459cf33b977934ec8de27d0103e904cefde1825d58605509fdf2945c5)
2022-09-28T07:18:09.590858Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:18:09.610609Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T07:18:09.610945Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:18:09.617218Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T07:18:09.619067Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T07:18:09.620581Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T07:18:09.627844Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T07:18:09.629436Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T07:18:09.630665Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T07:18:09.631716Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:18:09.632588Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T07:18:09.633768Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T07:18:09.635418Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T07:18:09.636975Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T07:18:09.638145Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T07:18:09.640717Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T07:18:09.641739Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T07:18:09.655781Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T07:18:09.658137Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T07:18:09.764027Z - called http://score/api/keyed and received back 204
2022-09-28T07:18:09.765043Z - job completed in 4.32 seconds (500141f459cf33b977934ec8de27d0103e904cefde1825d58605509fdf2945c5)
2022-09-28T07:20:03.157836Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0210"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ed3ae564ef8297b7cb125ccefac5a3bc047eb77c6272439375824ddd5f87efdb)
2022-09-28T07:20:04.885449Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:20:04.908840Z - running sql script pg/upsert_orders.sql
2022-09-28T07:20:04.908902Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:20:04.914352Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:20:04.915692Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:20:04.916633Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:20:04.917559Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:20:04.918737Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:20:04.920059Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:20:04.920872Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:20:04.921618Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:20:04.923313Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:20:04.925487Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:20:04.927043Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:20:04.927965Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:20:04.931997Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:20:04.934173Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:20:04.938665Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:20:04.939262Z - job completed in 1.78 seconds (ed3ae564ef8297b7cb125ccefac5a3bc047eb77c6272439375824ddd5f87efdb)
2022-09-28T07:20:04.962464Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0210"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (59201faa21c47cdc8f5f4ea393d4afcad90a12369d5713cc4cf872b7698fee85)
2022-09-28T07:20:06.251498Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:20:06.271716Z - running sql script pg/insert_tenders.sql
2022-09-28T07:20:06.272211Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:20:06.277331Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:20:06.279228Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:20:06.280822Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:20:06.281834Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:20:06.283393Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:20:06.284528Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:20:06.286877Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:20:06.288746Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:20:06.289732Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:20:06.291062Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:20:06.292400Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:20:06.293661Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:20:06.294862Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:20:06.296562Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:20:06.298485Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:20:06.300171Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:20:06.300573Z - job completed in 1.34 seconds (59201faa21c47cdc8f5f4ea393d4afcad90a12369d5713cc4cf872b7698fee85)
2022-09-28T07:22:02.313252Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0212"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7b2836d103d29dfb18440adc3e514e9388c8408e881a9c17ecde70c8297a0ff2)
2022-09-28T07:22:03.691463Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:22:03.718869Z - running sql script pg/insert_tenders.sql
2022-09-28T07:22:03.718925Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:22:03.723671Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:22:03.724896Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:22:03.725874Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:22:03.726804Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:22:03.728308Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:22:03.729252Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:22:03.731482Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:22:03.741Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:22:03.741850Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:22:03.743231Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:22:03.744448Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:22:03.745700Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:22:03.746934Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:22:03.748789Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:22:03.750570Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:22:03.752085Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:22:03.752554Z - job completed in 1.44 seconds (7b2836d103d29dfb18440adc3e514e9388c8408e881a9c17ecde70c8297a0ff2)
2022-09-28T07:22:03.783760Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0212"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (22c84fb0159b3763a60f3dfc15cb8f8a76c343cbb4d13e17b2f88d5134287b0a)
2022-09-28T07:22:05.913577Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:22:05.931700Z - running sql script pg/upsert_orders.sql
2022-09-28T07:22:05.931746Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:22:05.936590Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:22:05.938167Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:22:05.939202Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:22:05.940243Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:22:05.941896Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:22:05.943519Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:22:05.944727Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:22:05.945792Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:22:05.947698Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:22:05.949981Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:22:05.951692Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:22:05.952807Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:22:05.955Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:22:05.957034Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:22:05.961099Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:22:05.961490Z - job completed in 2.18 seconds (22c84fb0159b3763a60f3dfc15cb8f8a76c343cbb4d13e17b2f88d5134287b0a)
2022-09-28T07:24:02.365103Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0214"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (57bfba83bdf492d5265450ec4d6cc196bb245b68c2bab823230b72d6e31be709)
2022-09-28T07:24:03.564747Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:24:03.588759Z - running sql script pg/insert_tenders.sql
2022-09-28T07:24:03.588807Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:24:03.593306Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:24:03.594642Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:24:03.595910Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:24:03.596814Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:24:03.598117Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:24:03.599057Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:24:03.601143Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:24:03.602584Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:24:03.603526Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:24:03.604814Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:24:03.606163Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:24:03.607381Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:24:03.608469Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:24:03.610113Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:24:03.611643Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:24:03.613212Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:24:03.613518Z - job completed in 1.25 seconds (57bfba83bdf492d5265450ec4d6cc196bb245b68c2bab823230b72d6e31be709)
2022-09-28T07:24:03.652708Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0214"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (796b3e4d1ed2f80f0416e63a4f217b4e2bddf489042c44d023dd89e92f673526)
2022-09-28T07:24:05.378706Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:24:05.437144Z - running sql script pg/upsert_orders.sql
2022-09-28T07:24:05.437727Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:24:05.443329Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:24:05.445676Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:24:05.446943Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:24:05.447903Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:24:05.449574Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:24:05.450942Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:24:05.451854Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:24:05.452648Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:24:05.454701Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:24:05.457126Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:24:05.458611Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:24:05.459564Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:24:05.461255Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:24:05.462746Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:24:05.467250Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:24:05.467968Z - job completed in 1.82 seconds (796b3e4d1ed2f80f0416e63a4f217b4e2bddf489042c44d023dd89e92f673526)
2022-09-28T07:26:02.160443Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0216"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e7dd3bb96f39476ebadb038796aa7375714dab81b420f0d74102fa074e2ca23c)
2022-09-28T07:26:03.239329Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:26:03.289090Z - running sql script pg/insert_tenders.sql
2022-09-28T07:26:03.289148Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:26:03.294439Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:26:03.297064Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:26:03.300857Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:26:03.302748Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:26:03.304954Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:26:03.306490Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:26:03.310586Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:26:03.317086Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:26:03.318426Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:26:03.320113Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:26:03.321657Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:26:03.325488Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:26:03.329463Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:26:03.336207Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:26:03.338639Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:26:03.340718Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:26:03.341378Z - job completed in 1.18 seconds (e7dd3bb96f39476ebadb038796aa7375714dab81b420f0d74102fa074e2ca23c)
2022-09-28T07:26:03.387960Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0216"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (19ec0986a4920afa5ad913d695450740181d4f83b494fb8a76ed7afde6d5fc48)
2022-09-28T07:26:05.103723Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:26:05.123063Z - running sql script pg/upsert_orders.sql
2022-09-28T07:26:05.123118Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:26:05.128356Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:26:05.130142Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:26:05.131130Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:26:05.131967Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:26:05.133148Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:26:05.134514Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:26:05.135689Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:26:05.136592Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:26:05.138401Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:26:05.140585Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:26:05.142308Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:26:05.143349Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:26:05.145156Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:26:05.147085Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:26:05.151194Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:26:05.151730Z - job completed in 1.76 seconds (19ec0986a4920afa5ad913d695450740181d4f83b494fb8a76ed7afde6d5fc48)
2022-09-28T07:28:02.208904Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0218"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (61118e2a2321cf622ee48f3af21e5bf3262833ebee77012e910848bfea47d8fa)
2022-09-28T07:28:04.057247Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:28:04.078622Z - running sql script pg/upsert_orders.sql
2022-09-28T07:28:04.078684Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:28:04.083610Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:28:04.085180Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:28:04.086034Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:28:04.086970Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:28:04.089272Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:28:04.090885Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:28:04.091699Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:28:04.093061Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:28:04.094891Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:28:04.097218Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:28:04.099456Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:28:04.100377Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:28:04.102159Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:28:04.103796Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:28:04.108722Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:28:04.109680Z - job completed in 1.90 seconds (61118e2a2321cf622ee48f3af21e5bf3262833ebee77012e910848bfea47d8fa)
2022-09-28T07:28:04.180287Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0218"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a8d6d085e2718ddfab0021cf854698995f53aec02c5abe6dce6887bf70bfe03f)
2022-09-28T07:28:05.344708Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:28:05.371588Z - running sql script pg/insert_tenders.sql
2022-09-28T07:28:05.372207Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:28:05.377367Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:28:05.379016Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:28:05.382843Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:28:05.383882Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:28:05.385159Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:28:05.386068Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:28:05.388128Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:28:05.389745Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:28:05.390992Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:28:05.392160Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:28:05.393824Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:28:05.395268Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:28:05.396825Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:28:05.398589Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:28:05.400680Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:28:05.402150Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:28:05.402816Z - job completed in 1.22 seconds (a8d6d085e2718ddfab0021cf854698995f53aec02c5abe6dce6887bf70bfe03f)
2022-09-28T07:28:05.521076Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0208"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (1449b031a0a6bfc081cd19414276c11db62bf9e3e071381ab62bfe86fbc539b5)
2022-09-28T07:28:10.485685Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:28:10.506128Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T07:28:10.506193Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:28:10.510589Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T07:28:10.512846Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T07:28:10.513956Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T07:28:10.515660Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T07:28:10.516737Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T07:28:10.518160Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T07:28:10.519276Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:28:10.520347Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T07:28:10.521195Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T07:28:10.522921Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T07:28:10.524326Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T07:28:10.525925Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T07:28:10.528594Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T07:28:10.530369Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T07:28:10.531473Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T07:28:10.533454Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T07:28:10.612979Z - called http://score/api/keyed and received back 204
2022-09-28T07:28:10.613345Z - job completed in 5.09 seconds (1449b031a0a6bfc081cd19414276c11db62bf9e3e071381ab62bfe86fbc539b5)
2022-09-28T07:30:02.350378Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0220"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fe65785f341fa7296e6c76812de34ee79ab335ad999e5c0529d77d2b47ba4104)
2022-09-28T07:30:04.374040Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:30:04.396840Z - running sql script pg/upsert_orders.sql
2022-09-28T07:30:04.397495Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:30:04.404245Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:30:04.406270Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:30:04.407822Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:30:04.409792Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:30:04.411577Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:30:04.414149Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:30:04.415913Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:30:04.417468Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:30:04.420030Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:30:04.424380Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:30:04.427434Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:30:04.429072Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:30:04.431784Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:30:04.434889Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:30:04.439946Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:30:04.440446Z - job completed in 2.09 seconds (fe65785f341fa7296e6c76812de34ee79ab335ad999e5c0529d77d2b47ba4104)
2022-09-28T07:30:04.544316Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0220"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (23c26b3624f136dd36116c72702b3ede32fe327f9319dc28c3aae777216e42bf)
2022-09-28T07:30:05.660229Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:30:05.679917Z - running sql script pg/insert_tenders.sql
2022-09-28T07:30:05.679974Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:30:05.686014Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:30:05.687384Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:30:05.688398Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:30:05.689677Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:30:05.690907Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:30:05.691889Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:30:05.694012Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:30:05.695440Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:30:05.696436Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:30:05.697731Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:30:05.706113Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:30:05.707729Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:30:05.709132Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:30:05.711677Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:30:05.714161Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:30:05.716268Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:30:05.716785Z - job completed in 1.17 seconds (23c26b3624f136dd36116c72702b3ede32fe327f9319dc28c3aae777216e42bf)
2022-09-28T07:32:02.430482Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0222"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9883f80eb2b2970f1773a932e68491bb502b51594aa9b59231ef0382ad0a9b6f)
2022-09-28T07:32:03.932822Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:32:03.952854Z - running sql script pg/insert_tenders.sql
2022-09-28T07:32:03.952912Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:32:03.957974Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:32:03.959299Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:32:03.960249Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:32:03.961102Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:32:03.962436Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:32:03.963362Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:32:03.965500Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:32:03.966989Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:32:03.968036Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:32:03.969399Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:32:03.970567Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:32:03.971932Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:32:03.973224Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:32:03.975021Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:32:03.976714Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:32:03.978385Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:32:03.978878Z - job completed in 1.55 seconds (9883f80eb2b2970f1773a932e68491bb502b51594aa9b59231ef0382ad0a9b6f)
2022-09-28T07:32:04.026846Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0222"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8b298c9b0401644d613f0dff78731d7a53ff031137e312a8f7c416c1b90f11ac)
2022-09-28T07:32:06.409376Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:32:06.429579Z - running sql script pg/upsert_orders.sql
2022-09-28T07:32:06.429959Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:32:06.434560Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:32:06.436233Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:32:06.437623Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:32:06.439023Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:32:06.441062Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:32:06.442611Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:32:06.443848Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:32:06.444967Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:32:06.447012Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:32:06.449598Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:32:06.451476Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:32:06.453010Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:32:06.455043Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:32:06.457157Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:32:06.461419Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:32:06.462070Z - job completed in 2.44 seconds (8b298c9b0401644d613f0dff78731d7a53ff031137e312a8f7c416c1b90f11ac)
2022-09-28T07:34:02.086009Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0224"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (22438707f856bd5bbe7b88feb39231eec1d3d47d77113ed29a17787bf8182f1e)
2022-09-28T07:34:03.644237Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:34:03.661719Z - running sql script pg/insert_tenders.sql
2022-09-28T07:34:03.661827Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:34:03.666431Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:34:03.667840Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:34:03.668969Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:34:03.669913Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:34:03.672764Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:34:03.673936Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:34:03.676199Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:34:03.677562Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:34:03.678798Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:34:03.680224Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:34:03.681384Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:34:03.682639Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:34:03.684041Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:34:03.685851Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:34:03.687588Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:34:03.689136Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:34:03.689644Z - job completed in 1.60 seconds (22438707f856bd5bbe7b88feb39231eec1d3d47d77113ed29a17787bf8182f1e)
2022-09-28T07:34:03.735322Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0224"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (12443c6dc60a32a2ba5f7eae401833f42967ffafc8b6895004ab9cae11976c9e)
2022-09-28T07:34:05.570079Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:34:05.600496Z - running sql script pg/upsert_orders.sql
2022-09-28T07:34:05.601010Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:34:05.607518Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:34:05.609169Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:34:05.610445Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:34:05.611692Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:34:05.613089Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:34:05.614674Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:34:05.615593Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:34:05.616459Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:34:05.618210Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:34:05.620371Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:34:05.621967Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:34:05.622889Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:34:05.624582Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:34:05.626321Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:34:05.630447Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:34:05.631060Z - job completed in 1.90 seconds (12443c6dc60a32a2ba5f7eae401833f42967ffafc8b6895004ab9cae11976c9e)
2022-09-28T07:36:02.045059Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0226"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d5d1236e00894db76f85d03d4de9bbacbd15d5e1ed3884aeba68819e0092489d)
2022-09-28T07:36:03.169342Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:36:03.186874Z - running sql script pg/insert_tenders.sql
2022-09-28T07:36:03.186930Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:36:03.191817Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:36:03.193282Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:36:03.194169Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:36:03.195058Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:36:03.196322Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:36:03.197742Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:36:03.200082Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:36:03.201490Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:36:03.202312Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:36:03.203576Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:36:03.204682Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:36:03.205788Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:36:03.206886Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:36:03.208498Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:36:03.210453Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:36:03.212572Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:36:03.213103Z - job completed in 1.17 seconds (d5d1236e00894db76f85d03d4de9bbacbd15d5e1ed3884aeba68819e0092489d)
2022-09-28T07:36:03.309534Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0226"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3f05913e739f92247ab3dd2ee75a90e6b520fadf4c7fd921d932740f37aced83)
2022-09-28T07:36:04.806691Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:36:04.824747Z - running sql script pg/upsert_orders.sql
2022-09-28T07:36:04.825433Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:36:04.831259Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:36:04.834877Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:36:04.836121Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:36:04.837163Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:36:04.838461Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:36:04.839971Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:36:04.841086Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:36:04.842081Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:36:04.844558Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:36:04.846644Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:36:04.848196Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:36:04.849219Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:36:04.850894Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:36:04.852698Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:36:04.856772Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:36:04.857279Z - job completed in 1.55 seconds (3f05913e739f92247ab3dd2ee75a90e6b520fadf4c7fd921d932740f37aced83)
2022-09-28T07:38:02.249226Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0228"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4d3368550b34cd6d3cabeac0984657a0bbc4370ad3bc6114764c2e2a001dad9f)
2022-09-28T07:38:03.864701Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:38:03.887059Z - running sql script pg/upsert_orders.sql
2022-09-28T07:38:03.887114Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:38:03.893810Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:38:03.895127Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:38:03.896302Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:38:03.897659Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:38:03.899556Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:38:03.900809Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:38:03.901742Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:38:03.903286Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:38:03.905183Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:38:03.907216Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:38:03.914335Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:38:03.915316Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:38:03.916895Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:38:03.918511Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:38:03.922320Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:38:03.922643Z - job completed in 1.67 seconds (4d3368550b34cd6d3cabeac0984657a0bbc4370ad3bc6114764c2e2a001dad9f)
2022-09-28T07:38:04.007281Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0218"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (991a878de6fecf1caf91ede878c6bf0fa22f62c08fe94dab819147f420583b29)
2022-09-28T07:38:09.149285Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:38:09.180790Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T07:38:09.180836Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:38:09.186226Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T07:38:09.187936Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T07:38:09.190720Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T07:38:09.192045Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T07:38:09.192950Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T07:38:09.194326Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T07:38:09.195343Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:38:09.197038Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T07:38:09.198116Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T07:38:09.199848Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T07:38:09.201338Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T07:38:09.202726Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T07:38:09.206069Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T07:38:09.207085Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T07:38:09.208598Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T07:38:09.210303Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T07:38:09.288339Z - called http://score/api/keyed and received back 204
2022-09-28T07:38:09.288431Z - job completed in 5.28 seconds (991a878de6fecf1caf91ede878c6bf0fa22f62c08fe94dab819147f420583b29)
2022-09-28T07:38:09.311422Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0228"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1e1ad473034b645e67e906c1288adc8262f89ea30c4f5785e2553b97d44cef55)
2022-09-28T07:38:10.625948Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:38:10.650563Z - running sql script pg/insert_tenders.sql
2022-09-28T07:38:10.650621Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:38:10.657753Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:38:10.659656Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:38:10.660583Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:38:10.661591Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:38:10.663084Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:38:10.664337Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:38:10.666621Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:38:10.668106Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:38:10.668913Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:38:10.670261Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:38:10.671869Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:38:10.673038Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:38:10.674386Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:38:10.676526Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:38:10.678475Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:38:10.679893Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:38:10.680257Z - job completed in 1.37 seconds (1e1ad473034b645e67e906c1288adc8262f89ea30c4f5785e2553b97d44cef55)
2022-09-28T07:40:02.542673Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0230"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c5d0bd3aca73e9919ffddb5bfc8bce2796ac880dac2f5dd29f33230778b6cfa5)
2022-09-28T07:40:03.860225Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:40:03.879570Z - running sql script pg/insert_tenders.sql
2022-09-28T07:40:03.879843Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:40:03.884355Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:40:03.885592Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:40:03.886359Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:40:03.887197Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:40:03.888350Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:40:03.889018Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:40:03.891017Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:40:03.892276Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:40:03.893063Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:40:03.894148Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:40:03.895157Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:40:03.896109Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:40:03.897069Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:40:03.898577Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:40:03.900158Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:40:03.901590Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:40:03.901941Z - job completed in 1.36 seconds (c5d0bd3aca73e9919ffddb5bfc8bce2796ac880dac2f5dd29f33230778b6cfa5)
2022-09-28T07:40:03.958471Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0230"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (dd065dcb6466338a3095768f8ab11671534089a50c4944b137c9fae7f4cdb832)
2022-09-28T07:40:05.712709Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:40:05.767361Z - running sql script pg/upsert_orders.sql
2022-09-28T07:40:05.767412Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:40:05.772274Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:40:05.774658Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:40:05.775933Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:40:05.777217Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:40:05.778500Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:40:05.780886Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:40:05.783520Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:40:05.784783Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:40:05.786831Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:40:05.791664Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:40:05.793476Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:40:05.794627Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:40:05.796468Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:40:05.798897Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:40:05.802846Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:40:05.803190Z - job completed in 1.85 seconds (dd065dcb6466338a3095768f8ab11671534089a50c4944b137c9fae7f4cdb832)
2022-09-28T07:42:02.154422Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0232"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6afd34fb2a55b29dabfb4da806545a49da69151552200c447d35894086f7222e)
2022-09-28T07:42:03.068081Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:42:03.087785Z - running sql script pg/insert_tenders.sql
2022-09-28T07:42:03.087859Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:42:03.092676Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:42:03.095625Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:42:03.103609Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:42:03.105777Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:42:03.109726Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:42:03.115592Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:42:03.118233Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:42:03.120009Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:42:03.121454Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:42:03.122873Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:42:03.124102Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:42:03.125458Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:42:03.126958Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:42:03.128727Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:42:03.130464Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:42:03.131976Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:42:03.132310Z - job completed in 0.98 seconds (6afd34fb2a55b29dabfb4da806545a49da69151552200c447d35894086f7222e)
2022-09-28T07:42:03.198723Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0232"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (bdaba5463d648cc540b5e0cf76c05a04c250c8240d1605e186dcda9721e0afeb)
2022-09-28T07:42:04.944804Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:42:04.961117Z - running sql script pg/upsert_orders.sql
2022-09-28T07:42:04.961167Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:42:04.967629Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:42:04.969050Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:42:04.970144Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:42:04.971120Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:42:04.972358Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:42:04.973833Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:42:04.974958Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:42:04.975842Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:42:04.977601Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:42:04.979697Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:42:04.981172Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:42:04.982173Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:42:04.983801Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:42:04.985511Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:42:04.989495Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:42:04.989928Z - job completed in 1.79 seconds (bdaba5463d648cc540b5e0cf76c05a04c250c8240d1605e186dcda9721e0afeb)
2022-09-28T07:44:02.218228Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0234"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d2e2c3fae972a8449dcbb93c0e60c9f372c4a5d3eef4ed0ca3e1ee32de87062f)
2022-09-28T07:44:03.743185Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:44:03.761311Z - running sql script pg/insert_tenders.sql
2022-09-28T07:44:03.761361Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:44:03.766071Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:44:03.767301Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:44:03.768333Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:44:03.769219Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:44:03.770512Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:44:03.771440Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:44:03.773540Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:44:03.775137Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:44:03.776107Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:44:03.777521Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:44:03.778750Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:44:03.779977Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:44:03.781660Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:44:03.783404Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:44:03.785092Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:44:03.786520Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:44:03.786973Z - job completed in 1.57 seconds (d2e2c3fae972a8449dcbb93c0e60c9f372c4a5d3eef4ed0ca3e1ee32de87062f)
2022-09-28T07:44:03.824782Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0234"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (888578b5bcc3dd1f8f767c7ba6fa018b163b65c2ff32716e9bfb1df841c10613)
2022-09-28T07:44:05.994776Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:44:06.012837Z - running sql script pg/upsert_orders.sql
2022-09-28T07:44:06.014643Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:44:06.019840Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:44:06.021853Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:44:06.023417Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:44:06.025121Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:44:06.026572Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:44:06.028151Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:44:06.029421Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:44:06.030840Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:44:06.033067Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:44:06.035835Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:44:06.037386Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:44:06.038615Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:44:06.041016Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:44:06.043094Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:44:06.047865Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:44:06.048464Z - job completed in 2.22 seconds (888578b5bcc3dd1f8f767c7ba6fa018b163b65c2ff32716e9bfb1df841c10613)
2022-09-28T07:46:02.050850Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0236"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a83240eb4a3526049f364d176161f0a5c29526d5489f4aeac767b1eb34de9d06)
2022-09-28T07:46:04.343342Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:46:04.362251Z - running sql script pg/upsert_orders.sql
2022-09-28T07:46:04.362307Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:46:04.369798Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:46:04.371041Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:46:04.372127Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:46:04.372998Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:46:04.374077Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:46:04.376050Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:46:04.377038Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:46:04.378425Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:46:04.380141Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:46:04.382273Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:46:04.385081Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:46:04.386771Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:46:04.389041Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:46:04.391861Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:46:04.396238Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:46:04.396824Z - job completed in 2.35 seconds (a83240eb4a3526049f364d176161f0a5c29526d5489f4aeac767b1eb34de9d06)
2022-09-28T07:46:04.423906Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0236"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1e5bf3058c5fcc556944e77a4652b37b68bdd776964afbee148452231f49379a)
2022-09-28T07:46:05.492403Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:46:05.518138Z - running sql script pg/insert_tenders.sql
2022-09-28T07:46:05.518196Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:46:05.523756Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:46:05.525072Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:46:05.528848Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:46:05.532735Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:46:05.538962Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:46:05.540204Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:46:05.583346Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:46:05.592288Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:46:05.598120Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:46:05.600161Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:46:05.601579Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:46:05.602980Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:46:05.604342Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:46:05.605942Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:46:05.607687Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:46:05.609216Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:46:05.609799Z - job completed in 1.19 seconds (1e5bf3058c5fcc556944e77a4652b37b68bdd776964afbee148452231f49379a)
2022-09-28T07:48:02.068807Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0228"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (bbf9c497637f5e5d7e10df3fda196efd5b09f6a518e290569ac86f966fa64f27)
2022-09-28T07:48:06.640600Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:48:06.658155Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T07:48:06.658549Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:48:06.663822Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T07:48:06.665647Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T07:48:06.667031Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T07:48:06.668323Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T07:48:06.669697Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T07:48:06.671673Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T07:48:06.672954Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:48:06.674143Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T07:48:06.675262Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T07:48:06.677242Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T07:48:06.678923Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T07:48:06.680434Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T07:48:06.683091Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T07:48:06.684318Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T07:48:06.685664Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T07:48:06.688132Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T07:48:06.771375Z - called http://score/api/keyed and received back 204
2022-09-28T07:48:06.771673Z - job completed in 4.70 seconds (bbf9c497637f5e5d7e10df3fda196efd5b09f6a518e290569ac86f966fa64f27)
2022-09-28T07:48:06.809727Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0238"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2ea4a99d4d6eacc6e17422b73381607dfcc9a697df8f3c3c5c24d9bef7306511)
2022-09-28T07:48:08.003215Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:48:08.020484Z - running sql script pg/insert_tenders.sql
2022-09-28T07:48:08.020537Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:48:08.025250Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:48:08.026758Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:48:08.030650Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:48:08.034260Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:48:08.039520Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:48:08.040992Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:48:08.086466Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:48:08.094435Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:48:08.098206Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:48:08.099695Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:48:08.835716Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:48:08.916236Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:48:08.924085Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:48:09.146594Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:48:09.387613Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:48:09.413992Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:48:09.414617Z - job completed in 2.61 seconds (2ea4a99d4d6eacc6e17422b73381607dfcc9a697df8f3c3c5c24d9bef7306511)
2022-09-28T07:48:09.451500Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0238"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4b5db73225503993a8c48221adafe9c9b2ae060c280bb97af8c595a0212036b4)
2022-09-28T07:48:11.089495Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:48:11.106570Z - running sql script pg/upsert_orders.sql
2022-09-28T07:48:11.106629Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:48:11.112608Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:48:11.114124Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:48:11.115041Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:48:11.115958Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:48:11.117586Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:48:11.119494Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:48:11.120668Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:48:11.121704Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:48:11.124333Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:48:11.126678Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:48:11.128822Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:48:11.129789Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:48:11.131865Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:48:11.133553Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:48:11.137996Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:48:11.138516Z - job completed in 1.69 seconds (4b5db73225503993a8c48221adafe9c9b2ae060c280bb97af8c595a0212036b4)
2022-09-28T07:50:02.284598Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0240"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ab33bba53683dbec3129a54f953413b9b0906ba121a4e1170c927f57cbc51819)
2022-09-28T07:50:04.396148Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:50:04.417753Z - running sql script pg/upsert_orders.sql
2022-09-28T07:50:04.417810Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:50:04.422359Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:50:04.423666Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:50:04.424738Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:50:04.425858Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:50:04.426943Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:50:04.428273Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:50:04.429119Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:50:04.429983Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:50:04.431675Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:50:04.433636Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:50:04.435140Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:50:04.435937Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:50:04.437557Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:50:04.439480Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:50:04.443357Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:50:04.443912Z - job completed in 2.16 seconds (ab33bba53683dbec3129a54f953413b9b0906ba121a4e1170c927f57cbc51819)
2022-09-28T07:50:04.476019Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0240"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5eb9197b72517c70950a55ffe86d116a622f5846c1f30a436c189d4216f97d7b)
2022-09-28T07:50:05.922614Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:50:05.941374Z - running sql script pg/insert_tenders.sql
2022-09-28T07:50:05.941434Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:50:05.946179Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:50:05.947590Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:50:05.951644Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:50:05.955590Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:50:05.960005Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:50:05.960957Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:50:06.006823Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:50:06.015877Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:50:06.020216Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:50:06.021795Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:50:06.224045Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:50:06.305541Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:50:06.312035Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:50:06.541085Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:50:06.723487Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:50:06.729358Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:50:06.729738Z - job completed in 2.25 seconds (5eb9197b72517c70950a55ffe86d116a622f5846c1f30a436c189d4216f97d7b)
2022-09-28T07:52:02.055718Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0242"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (97e318bfb00364e9ebdac6e00f6abb05505dd6427fd027ba0c99a912fcc63008)
2022-09-28T07:52:03.387672Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:52:03.405896Z - running sql script pg/insert_tenders.sql
2022-09-28T07:52:03.405961Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:52:03.411329Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:52:03.412961Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:52:03.416774Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:52:03.421104Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:52:03.425880Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:52:03.429482Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:52:03.481197Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:52:03.489263Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:52:03.494401Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:52:03.495890Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:52:03.706088Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:52:03.787520Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:52:03.792285Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:52:04.014406Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:52:04.195276Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:52:04.201636Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:52:04.202016Z - job completed in 2.15 seconds (97e318bfb00364e9ebdac6e00f6abb05505dd6427fd027ba0c99a912fcc63008)
2022-09-28T07:52:04.331696Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0242"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fc9db862f0d35dd703a0618387a0bfca0acda6ed5e09a49d995a9d4387349640)
2022-09-28T07:52:06.123877Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:52:06.145867Z - running sql script pg/upsert_orders.sql
2022-09-28T07:52:06.146519Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:52:06.152733Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:52:06.154604Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:52:06.155644Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:52:06.156666Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:52:06.158028Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:52:06.159416Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:52:06.160418Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:52:06.161370Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:52:06.163920Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:52:06.166097Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:52:06.169312Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:52:06.170461Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:52:06.172753Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:52:06.174727Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:52:06.180838Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:52:06.181265Z - job completed in 1.85 seconds (fc9db862f0d35dd703a0618387a0bfca0acda6ed5e09a49d995a9d4387349640)
2022-09-28T07:54:02.181615Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0244"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7a55bacc3a00b8742c2a532b8d84442682e2e2bbe6667d3ecf162e2348cdcb50)
2022-09-28T07:54:04.230670Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:54:04.248738Z - running sql script pg/upsert_orders.sql
2022-09-28T07:54:04.248850Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:54:04.253207Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:54:04.254808Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:54:04.255726Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:54:04.256634Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:54:04.257933Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:54:04.259181Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:54:04.260264Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:54:04.261262Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:54:04.263183Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:54:04.265191Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:54:04.267407Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:54:04.268357Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:54:04.270702Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:54:04.272492Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:54:04.277179Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:54:04.277626Z - job completed in 2.11 seconds (7a55bacc3a00b8742c2a532b8d84442682e2e2bbe6667d3ecf162e2348cdcb50)
2022-09-28T07:54:04.381075Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0244"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f71e55ab769aa0118fa0c75a82e85c041b70a8ee692fbd6caccdcb101f69410f)
2022-09-28T07:54:05.979736Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:54:06.011581Z - running sql script pg/insert_tenders.sql
2022-09-28T07:54:06.011628Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:54:06.016248Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:54:06.017680Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:54:06.021754Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:54:06.025730Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:54:06.032100Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:54:06.033044Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:54:06.079295Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:54:06.087288Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:54:06.091413Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:54:06.094762Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:54:06.297510Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:54:06.378045Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:54:06.383195Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:54:06.604094Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:54:06.783241Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:54:06.788624Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:54:06.788991Z - job completed in 2.41 seconds (f71e55ab769aa0118fa0c75a82e85c041b70a8ee692fbd6caccdcb101f69410f)
2022-09-28T07:56:02.010800Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0246"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fb5de53312da013ce39ddef72597d5d145685aa65dd32370dc39d279c35e09a6)
2022-09-28T07:56:03.740262Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:56:03.768797Z - running sql script pg/upsert_orders.sql
2022-09-28T07:56:03.769465Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:56:03.775149Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:56:03.777063Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:56:03.778445Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:56:03.780611Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:56:03.782701Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:56:03.784757Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:56:03.786208Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:56:03.787794Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:56:03.790930Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:56:03.793367Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:56:03.795492Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:56:03.796940Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:56:03.799690Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:56:03.803657Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:56:03.807981Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:56:03.808512Z - job completed in 1.80 seconds (fb5de53312da013ce39ddef72597d5d145685aa65dd32370dc39d279c35e09a6)
2022-09-28T07:56:03.868269Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0246"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ba6ff410d1e2c2670a06b0890778bce7b431179397e4013b0eed9db7e57f21b3)
2022-09-28T07:56:05.029671Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:56:05.047127Z - running sql script pg/insert_tenders.sql
2022-09-28T07:56:05.047178Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:56:05.052Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:56:05.053371Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:56:05.057503Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:56:05.061392Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:56:05.065887Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:56:05.067728Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:56:05.115735Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:56:05.123812Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:56:05.127825Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:56:05.129384Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:56:05.331445Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:56:05.411499Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:56:05.416622Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:56:05.665476Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:56:05.854906Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:56:05.860912Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:56:05.861318Z - job completed in 1.99 seconds (ba6ff410d1e2c2670a06b0890778bce7b431179397e4013b0eed9db7e57f21b3)
2022-09-28T07:58:02.252539Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0248"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f630891171581afb32800df573377b7f550f3ec0a95b48d5ee0d11b46881e8c8)
2022-09-28T07:58:03.863232Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:58:03.898158Z - running sql script pg/upsert_orders.sql
2022-09-28T07:58:03.898214Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:58:03.902893Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T07:58:03.910079Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T07:58:03.911037Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T07:58:03.914870Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T07:58:03.916864Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T07:58:03.920971Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:58:03.921971Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T07:58:03.923064Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T07:58:03.931811Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T07:58:03.948527Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T07:58:03.950052Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T07:58:03.950960Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T07:58:03.958863Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T07:58:04.036535Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T07:58:04.054245Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T07:58:04.054822Z - job completed in 1.80 seconds (f630891171581afb32800df573377b7f550f3ec0a95b48d5ee0d11b46881e8c8)
2022-09-28T07:58:04.100964Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0238"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (79ab4a9ae87d66fb9deaf573c62857d0e6f02d2bc629df04adce482527f3790b)
2022-09-28T07:58:08.490441Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:58:08.507926Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T07:58:08.508004Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T07:58:08.512643Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T07:58:08.514342Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T07:58:08.515352Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T07:58:08.516239Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T07:58:08.517090Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T07:58:08.518209Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T07:58:08.519128Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T07:58:08.520048Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T07:58:08.520839Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T07:58:08.522472Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T07:58:08.523790Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T07:58:08.524650Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T07:58:08.527793Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T07:58:08.528745Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T07:58:08.529848Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T07:58:08.532307Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T07:58:08.616151Z - called http://score/api/keyed and received back 204
2022-09-28T07:58:08.616306Z - job completed in 4.52 seconds (79ab4a9ae87d66fb9deaf573c62857d0e6f02d2bc629df04adce482527f3790b)
2022-09-28T07:58:08.648077Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0248"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fea79fd368923671aa2e4172bddc72c88e65b3e5cb7482ea65531b6bf66f26a9)
2022-09-28T07:58:09.839347Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T07:58:09.856967Z - running sql script pg/insert_tenders.sql
2022-09-28T07:58:09.857019Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T07:58:09.861938Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T07:58:09.863177Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T07:58:09.864036Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T07:58:09.865071Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T07:58:09.866281Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T07:58:09.867396Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T07:58:09.869465Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T07:58:09.870944Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T07:58:09.871876Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T07:58:09.873253Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T07:58:09.874464Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T07:58:09.875768Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T07:58:09.877067Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T07:58:09.879001Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T07:58:09.880783Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T07:58:09.882307Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T07:58:09.882706Z - job completed in 1.23 seconds (fea79fd368923671aa2e4172bddc72c88e65b3e5cb7482ea65531b6bf66f26a9)
2022-09-28T08:00:02.476690Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0250"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ea91a17a273f5dbb28d097495bc71c8b82ef3c92ed02ad9cb58a50a88f7074d1)
2022-09-28T08:00:03.909783Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:00:03.934130Z - running sql script pg/insert_tenders.sql
2022-09-28T08:00:03.934175Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:00:03.939695Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:00:03.941130Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:00:03.942201Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:00:03.943064Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:00:03.944286Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:00:03.945187Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:00:03.947242Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:00:03.948758Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:00:03.949813Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:00:03.955596Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:00:03.963048Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:00:03.964422Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:00:03.966236Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:00:03.968719Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:00:03.977679Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:00:03.979652Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:00:03.980062Z - job completed in 1.51 seconds (ea91a17a273f5dbb28d097495bc71c8b82ef3c92ed02ad9cb58a50a88f7074d1)
2022-09-28T08:00:04.035670Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0250"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3c10c7adab8bcfa328076f67c39e9df855556ea9bdd6555e49db771d57e1b451)
2022-09-28T08:00:05.706311Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:00:05.736814Z - running sql script pg/upsert_orders.sql
2022-09-28T08:00:05.737576Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:00:05.742606Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:00:05.746966Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:00:05.748806Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:00:05.753366Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:00:05.754995Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:00:05.762105Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:00:05.763129Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:00:05.764096Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:00:05.770663Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:00:05.788666Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:00:05.790208Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:00:05.791277Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:00:05.797248Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:00:05.860971Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:00:05.868973Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:00:05.869407Z - job completed in 1.83 seconds (3c10c7adab8bcfa328076f67c39e9df855556ea9bdd6555e49db771d57e1b451)
2022-09-28T08:02:02.319647Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0252"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6c111b820bf9ecd02d1a208175cc4cf7404a96725ea6779558135b9c5644c790)
2022-09-28T08:02:04.918265Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:02:04.937005Z - running sql script pg/upsert_orders.sql
2022-09-28T08:02:04.937063Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:02:04.941816Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:02:04.946282Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:02:04.947257Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:02:04.951491Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:02:04.952913Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:02:04.957388Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:02:04.958244Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:02:04.958994Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:02:04.965633Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:02:04.985054Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:02:04.986558Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:02:04.987565Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:02:04.992971Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:02:05.055877Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:02:05.063481Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:02:05.064842Z - job completed in 2.75 seconds (6c111b820bf9ecd02d1a208175cc4cf7404a96725ea6779558135b9c5644c790)
2022-09-28T08:02:05.172690Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0252"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (082963a26ae0af34e8718a13b4f6ac3f19e2334740eefba105cb431fb4397d2f)
2022-09-28T08:02:06.365862Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:02:06.386805Z - running sql script pg/insert_tenders.sql
2022-09-28T08:02:06.387308Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:02:06.392726Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:02:06.394878Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:02:06.396533Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:02:06.397888Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:02:06.448098Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:02:06.450420Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:02:06.464304Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:02:06.502055Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:02:06.503703Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:02:06.505322Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:02:06.506718Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:02:06.508175Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:02:06.510862Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:02:06.513484Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:02:06.515768Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:02:06.521729Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:02:06.522362Z - job completed in 1.35 seconds (082963a26ae0af34e8718a13b4f6ac3f19e2334740eefba105cb431fb4397d2f)
2022-09-28T08:04:02.058872Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0254"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8624a7a4e6b41e21eb96e4ea2a6928b6d378e698762dd79750d7e89b4030e1e4)
2022-09-28T08:04:03.508099Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:04:03.548019Z - running sql script pg/insert_tenders.sql
2022-09-28T08:04:03.548080Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:04:03.553872Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:04:03.555773Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:04:03.557168Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:04:03.558819Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:04:03.560797Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:04:03.562317Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:04:03.566526Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:04:03.567999Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:04:03.569007Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:04:03.570451Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:04:03.572399Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:04:03.573655Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:04:03.575257Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:04:03.577396Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:04:03.579813Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:04:03.581123Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:04:03.581580Z - job completed in 1.52 seconds (8624a7a4e6b41e21eb96e4ea2a6928b6d378e698762dd79750d7e89b4030e1e4)
2022-09-28T08:04:03.701971Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0254"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ba98bc42b22f7b31261b13782be6b4085a05202a0b8015fd685ffe07e51de3be)
2022-09-28T08:04:05.693464Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:04:05.748023Z - running sql script pg/upsert_orders.sql
2022-09-28T08:04:05.748368Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:04:05.753912Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:04:05.759147Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:04:05.760931Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:04:05.765143Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:04:05.766875Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:04:05.771373Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:04:05.772547Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:04:05.773458Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:04:05.779763Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:04:05.806874Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:04:05.809095Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:04:05.810186Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:04:05.815302Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:04:05.890116Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:04:05.897810Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:04:05.898227Z - job completed in 2.20 seconds (ba98bc42b22f7b31261b13782be6b4085a05202a0b8015fd685ffe07e51de3be)
2022-09-28T08:06:02.105550Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0256"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5d067f76b2d67335e6525c86982e21524b94ba29ba8fd678736f7c00d31a498b)
2022-09-28T08:06:03.680762Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:06:03.700102Z - running sql script pg/upsert_orders.sql
2022-09-28T08:06:03.700148Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:06:03.705573Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:06:03.710688Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:06:03.712235Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:06:03.716295Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:06:03.718140Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:06:03.722441Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:06:03.723431Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:06:03.724599Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:06:03.730487Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:06:03.748415Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:06:03.750269Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:06:03.751690Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:06:03.757718Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:06:03.821309Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:06:03.829408Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:06:03.829896Z - job completed in 1.72 seconds (5d067f76b2d67335e6525c86982e21524b94ba29ba8fd678736f7c00d31a498b)
2022-09-28T08:06:04.083234Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0256"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (76a8406fff6f989cec055f640f9d1defad7a18ba94a4ada8ed6532f3574c413e)
2022-09-28T08:06:05.190983Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:06:05.213322Z - running sql script pg/insert_tenders.sql
2022-09-28T08:06:05.213452Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:06:05.219173Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:06:05.220807Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:06:05.222219Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:06:05.223651Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:06:05.225986Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:06:05.227239Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:06:05.229663Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:06:05.232902Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:06:05.239617Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:06:05.241510Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:06:05.243323Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:06:05.251644Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:06:05.254123Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:06:05.256170Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:06:05.258007Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:06:05.259542Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:06:05.260194Z - job completed in 1.18 seconds (76a8406fff6f989cec055f640f9d1defad7a18ba94a4ada8ed6532f3574c413e)
2022-09-28T08:08:02.154658Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0248"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (929a16916ed788f63b043520f984ca38148a37e1d4f390c67e88153fe86a1614)
2022-09-28T08:08:06.519330Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:08:06.538893Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T08:08:06.538948Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:08:06.546552Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T08:08:06.548236Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T08:08:06.549441Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T08:08:06.550327Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T08:08:06.551431Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T08:08:06.552703Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T08:08:06.553694Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:08:06.554731Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T08:08:06.555657Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T08:08:06.557407Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T08:08:06.558935Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T08:08:06.559969Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T08:08:06.562466Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T08:08:06.563794Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T08:08:06.565097Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T08:08:06.566839Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T08:08:06.640801Z - called http://score/api/keyed and received back 204
2022-09-28T08:08:06.640908Z - job completed in 4.49 seconds (929a16916ed788f63b043520f984ca38148a37e1d4f390c67e88153fe86a1614)
2022-09-28T08:08:06.697411Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0258"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (17fbecfc55c84c74d5201d25bacae7c232000dade7c3e78c64f9da4644ed916a)
2022-09-28T08:08:07.972259Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:08:07.989949Z - running sql script pg/insert_tenders.sql
2022-09-28T08:08:07.990438Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:08:07.995706Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:08:07.997589Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:08:08.002328Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:08:08.007673Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:08:08.013375Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:08:08.014464Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:08:08.057414Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:08:08.066508Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:08:08.070718Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:08:08.075146Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:08:08.080897Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:08:08.086405Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:08:08.088322Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:08:08.091648Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:08:08.093711Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:08:08.095742Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:08:08.096636Z - job completed in 1.40 seconds (17fbecfc55c84c74d5201d25bacae7c232000dade7c3e78c64f9da4644ed916a)
2022-09-28T08:08:08.190418Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0258"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (233bff7df9f63df7ee0d4e6e7ff1b4bb8c975a56ce3c10661fd7c24e27546bf8)
2022-09-28T08:08:10.162196Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:08:10.192948Z - running sql script pg/upsert_orders.sql
2022-09-28T08:08:10.193675Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:08:10.198685Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:08:10.201177Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:08:10.202141Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:08:10.205378Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:08:10.206813Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:08:10.208383Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:08:10.209371Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:08:10.210273Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:08:10.212191Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:08:10.214398Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:08:10.215981Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:08:10.216955Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:08:10.218544Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:08:10.220443Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:08:10.225358Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:08:10.225931Z - job completed in 2.04 seconds (233bff7df9f63df7ee0d4e6e7ff1b4bb8c975a56ce3c10661fd7c24e27546bf8)
2022-09-28T08:10:02.338245Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0300"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (474ebcdb6bb330cbb3a11d159de87abbe6c46589c30224f43b0ac1586b6ceb55)
2022-09-28T08:10:04.348177Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:10:04.370547Z - running sql script pg/upsert_orders.sql
2022-09-28T08:10:04.370600Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:10:04.375227Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:10:04.376757Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:10:04.378023Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:10:04.381049Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:10:04.382338Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:10:04.383754Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:10:04.384885Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:10:04.385917Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:10:04.387850Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:10:04.389927Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:10:04.391643Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:10:04.392641Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:10:04.394334Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:10:04.396134Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:10:04.400026Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:10:04.400437Z - job completed in 2.06 seconds (474ebcdb6bb330cbb3a11d159de87abbe6c46589c30224f43b0ac1586b6ceb55)
2022-09-28T08:10:04.423432Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0300"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6dc3ad8621e2906250dac429f41573bcf3c3e881061be45b3d13e2d5878a4046)
2022-09-28T08:10:05.747908Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:10:05.774436Z - running sql script pg/insert_tenders.sql
2022-09-28T08:10:05.775254Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:10:05.780427Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:10:05.782059Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:10:05.786145Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:10:05.790272Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:10:05.794719Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:10:05.796369Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:10:05.840340Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:10:05.849364Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:10:05.853346Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:10:05.854708Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:10:05.855872Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:10:05.857034Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:10:05.858317Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:10:05.860492Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:10:05.862114Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:10:05.863753Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:10:05.864234Z - job completed in 1.44 seconds (6dc3ad8621e2906250dac429f41573bcf3c3e881061be45b3d13e2d5878a4046)
2022-09-28T08:12:02.174708Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0302"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a12bab7031eaa33a55e77b79dacf136960ba9a0d7c94c05cffe401ea4519d6ea)
2022-09-28T08:12:03.517722Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:12:03.536065Z - running sql script pg/insert_tenders.sql
2022-09-28T08:12:03.536129Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:12:03.542231Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:12:03.544654Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:12:03.548918Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:12:03.553395Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:12:03.558984Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:12:03.560543Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:12:03.603768Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:12:03.611762Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:12:03.618740Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:12:03.621170Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:12:03.622692Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:12:03.624792Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:12:03.627084Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:12:03.629314Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:12:03.631262Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:12:03.634462Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:12:03.634866Z - job completed in 1.46 seconds (a12bab7031eaa33a55e77b79dacf136960ba9a0d7c94c05cffe401ea4519d6ea)
2022-09-28T08:12:03.752928Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0302"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (76f42cdedb745eba94c3150b952d449d446ace93247d9f9a03a182ae6988b185)
2022-09-28T08:12:05.732206Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:12:05.753759Z - running sql script pg/upsert_orders.sql
2022-09-28T08:12:05.753808Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:12:05.759190Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:12:05.761616Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:12:05.762498Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:12:05.763398Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:12:05.764618Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:12:05.765913Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:12:05.766777Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:12:05.767618Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:12:05.769350Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:12:05.771225Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:12:05.772716Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:12:05.773690Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:12:05.775205Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:12:05.776847Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:12:05.786961Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:12:05.787313Z - job completed in 2.04 seconds (76f42cdedb745eba94c3150b952d449d446ace93247d9f9a03a182ae6988b185)
2022-09-28T08:14:02.123769Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0304"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (35eb3344d56652d4f92aac937cfb492ce0e05abfbdb78d1642c3f697b448e484)
2022-09-28T08:14:04.028770Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:14:04.051080Z - running sql script pg/upsert_orders.sql
2022-09-28T08:14:04.051139Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:14:04.056563Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:14:04.063673Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:14:04.069876Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:14:04.070960Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:14:04.072315Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:14:04.073819Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:14:04.074754Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:14:04.075483Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:14:04.077289Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:14:04.079357Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:14:04.080710Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:14:04.081561Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:14:04.083289Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:14:04.084929Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:14:04.088988Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:14:04.089456Z - job completed in 1.97 seconds (35eb3344d56652d4f92aac937cfb492ce0e05abfbdb78d1642c3f697b448e484)
2022-09-28T08:14:04.219502Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0304"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8bffc62255d90e7a0e675b9825850cf483efc98a9d9ba6094ef44fec8bc08555)
2022-09-28T08:14:05.330600Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:14:05.349657Z - running sql script pg/insert_tenders.sql
2022-09-28T08:14:05.349711Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:14:05.355236Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:14:05.359638Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:14:05.365629Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:14:05.370051Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:14:05.375162Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:14:05.376334Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:14:05.419067Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:14:05.426820Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:14:05.431638Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:14:05.434428Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:14:05.435508Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:14:05.437316Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:14:05.438642Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:14:05.440361Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:14:05.443436Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:14:05.445123Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:14:05.445858Z - job completed in 1.23 seconds (8bffc62255d90e7a0e675b9825850cf483efc98a9d9ba6094ef44fec8bc08555)
2022-09-28T08:16:02.274979Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0306"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4846937eea1a9ec225f0378283cc298f1a099ffd57499ef82be6e4289dab5a80)
2022-09-28T08:16:03.415074Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:16:03.434357Z - running sql script pg/insert_tenders.sql
2022-09-28T08:16:03.434422Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:16:03.440421Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:16:03.442775Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:16:03.449573Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:16:03.455980Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:16:03.461336Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:16:03.462427Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:16:03.505186Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:16:03.513426Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:16:03.518229Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:16:03.520326Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:16:03.521989Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:16:03.523477Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:16:03.525179Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:16:03.527182Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:16:03.529572Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:16:03.531339Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:16:03.531844Z - job completed in 1.26 seconds (4846937eea1a9ec225f0378283cc298f1a099ffd57499ef82be6e4289dab5a80)
2022-09-28T08:16:03.608938Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0306"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1168d0f225bcd2463222c8a2bc0535c9d7dfc3c634dc68573882a624513fa2dc)
2022-09-28T08:16:05.403802Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:16:05.425073Z - running sql script pg/upsert_orders.sql
2022-09-28T08:16:05.425130Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:16:05.430743Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:16:05.432273Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:16:05.433809Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:16:05.435454Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:16:05.437761Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:16:05.439410Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:16:05.440993Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:16:05.442444Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:16:05.445011Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:16:05.447126Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:16:05.448728Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:16:05.449882Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:16:05.451789Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:16:05.453623Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:16:05.457685Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:16:05.458358Z - job completed in 1.85 seconds (1168d0f225bcd2463222c8a2bc0535c9d7dfc3c634dc68573882a624513fa2dc)
2022-09-28T08:18:02.089836Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0308"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8895a65190c2d52a014c4758c49e3d587443b7408a2365b161fed88fca0b6da1)
2022-09-28T08:18:03.504321Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:18:03.525376Z - running sql script pg/insert_tenders.sql
2022-09-28T08:18:03.525644Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:18:03.531087Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:18:03.532517Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:18:03.534168Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:18:03.535510Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:18:03.537148Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:18:03.538242Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:18:03.547736Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:18:03.549474Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:18:03.550440Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:18:03.551936Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:18:03.553212Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:18:03.554839Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:18:03.556160Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:18:03.557886Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:18:03.560077Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:18:03.561880Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:18:03.567578Z - job completed in 1.48 seconds (8895a65190c2d52a014c4758c49e3d587443b7408a2365b161fed88fca0b6da1)
2022-09-28T08:18:03.611885Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0308"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (47307cf12c8d13c207c2a868622b633e3d11dfc3da446a5f8857e2d85cb5b9c6)
2022-09-28T08:18:05.403895Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:18:05.439070Z - running sql script pg/upsert_orders.sql
2022-09-28T08:18:05.439127Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:18:05.443994Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:18:05.445401Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:18:05.446366Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:18:05.447283Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:18:05.448951Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:18:05.450183Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:18:05.451469Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:18:05.452326Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:18:05.454295Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:18:05.456539Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:18:05.458607Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:18:05.459764Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:18:05.461362Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:18:05.463109Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:18:05.468057Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:18:05.468940Z - job completed in 1.86 seconds (47307cf12c8d13c207c2a868622b633e3d11dfc3da446a5f8857e2d85cb5b9c6)
2022-09-28T08:18:05.520199Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0258"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (0c58f4226cd9c4aa2f7a1a0897dff71c1fa766be121f561cfbc4c5fb5836714c)
2022-09-28T08:18:10.789843Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:18:10.813715Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T08:18:10.813779Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:18:10.818219Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T08:18:10.820399Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T08:18:10.821766Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T08:18:10.822851Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T08:18:10.823659Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T08:18:10.824943Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T08:18:10.825944Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:18:10.826812Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T08:18:10.827618Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T08:18:10.829333Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T08:18:10.831294Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T08:18:10.832140Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T08:18:10.834422Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T08:18:10.835692Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T08:18:10.836767Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T08:18:10.838197Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T08:18:10.914322Z - called http://score/api/keyed and received back 204
2022-09-28T08:18:10.914451Z - job completed in 5.39 seconds (0c58f4226cd9c4aa2f7a1a0897dff71c1fa766be121f561cfbc4c5fb5836714c)
2022-09-28T08:20:02.732862Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0310"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1b9db876a55fb12e846cbbfa6500d5090b55bc074a2149ec4d6e6a0a6fdb0680)
2022-09-28T08:20:04.033352Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:20:04.049943Z - running sql script pg/insert_tenders.sql
2022-09-28T08:20:04.050001Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:20:04.054564Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:20:04.055772Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:20:04.056589Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:20:04.057370Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:20:04.058601Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:20:04.059577Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:20:04.062003Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:20:04.063625Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:20:04.064493Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:20:04.065707Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:20:04.066871Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:20:04.067898Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:20:04.069005Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:20:04.070624Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:20:04.072195Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:20:04.073734Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:20:04.074044Z - job completed in 1.34 seconds (1b9db876a55fb12e846cbbfa6500d5090b55bc074a2149ec4d6e6a0a6fdb0680)
2022-09-28T08:20:04.134941Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0310"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (26cf9b6ce12408ddde66f56ccb8581105d860259f77457236205995f407f2df7)
2022-09-28T08:20:05.753547Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:20:05.773117Z - running sql script pg/upsert_orders.sql
2022-09-28T08:20:05.773161Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:20:05.778214Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:20:05.780123Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:20:05.782180Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:20:05.784160Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:20:05.785944Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:20:05.788067Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:20:05.789622Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:20:05.791959Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:20:05.793690Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:20:05.797821Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:20:05.801809Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:20:05.803287Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:20:05.804920Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:20:05.806931Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:20:05.810959Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:20:05.811316Z - job completed in 1.68 seconds (26cf9b6ce12408ddde66f56ccb8581105d860259f77457236205995f407f2df7)
2022-09-28T08:22:02.159619Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0312"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (337fb76d6980611c9f78f7a002b350542a246cf30bf186b640434a20676b0ce7)
2022-09-28T08:22:04.324852Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:22:04.342050Z - running sql script pg/upsert_orders.sql
2022-09-28T08:22:04.342098Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:22:04.346610Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:22:04.348028Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:22:04.348925Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:22:04.349850Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:22:04.351115Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:22:04.352380Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:22:04.353160Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:22:04.354061Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:22:04.355891Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:22:04.358100Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:22:04.359501Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:22:04.360519Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:22:04.362348Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:22:04.364759Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:22:04.373182Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:22:04.373526Z - job completed in 2.21 seconds (337fb76d6980611c9f78f7a002b350542a246cf30bf186b640434a20676b0ce7)
2022-09-28T08:22:04.492760Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0312"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6ef037cdb6f907652d3dd9031017f637e23206e26ca01f44707405992c110e0d)
2022-09-28T08:22:05.823448Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:22:05.853862Z - running sql script pg/insert_tenders.sql
2022-09-28T08:22:05.854067Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:22:05.858614Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:22:05.859909Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:22:05.861475Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:22:05.862806Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:22:05.864775Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:22:05.865874Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:22:05.869053Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:22:05.871063Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:22:05.872316Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:22:05.874299Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:22:05.876123Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:22:05.877512Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:22:05.878907Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:22:05.881327Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:22:05.883643Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:22:05.885666Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:22:05.886228Z - job completed in 1.40 seconds (6ef037cdb6f907652d3dd9031017f637e23206e26ca01f44707405992c110e0d)
2022-09-28T08:24:01.941008Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0314"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4bf3573279bb8c27edc9321d3b573b9d97f43a8a8ed28b28d797d6a0a59781a5)
2022-09-28T08:24:03.068538Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:24:03.088044Z - running sql script pg/insert_tenders.sql
2022-09-28T08:24:03.088087Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:24:03.099344Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:24:03.100787Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:24:03.105204Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:24:03.118879Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:24:03.123774Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:24:03.124816Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:24:03.164054Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:24:03.171814Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:24:03.175853Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:24:03.177351Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:24:03.178610Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:24:03.179844Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:24:03.180969Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:24:03.183313Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:24:03.185234Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:24:03.187111Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:24:03.187636Z - job completed in 1.25 seconds (4bf3573279bb8c27edc9321d3b573b9d97f43a8a8ed28b28d797d6a0a59781a5)
2022-09-28T08:24:03.300273Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0314"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (069a4134933f9cfac89f736dd3dea0b052c212dfe32dd317a9d3b73483467938)
2022-09-28T08:24:05.405700Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:24:05.428495Z - running sql script pg/upsert_orders.sql
2022-09-28T08:24:05.428533Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:24:05.433232Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:24:05.434733Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:24:05.435913Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:24:05.436834Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:24:05.437966Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:24:05.439244Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:24:05.440086Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:24:05.441114Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:24:05.442993Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:24:05.444959Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:24:05.446583Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:24:05.447431Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:24:05.449138Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:24:05.451140Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:24:05.455636Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:24:05.456296Z - job completed in 2.16 seconds (069a4134933f9cfac89f736dd3dea0b052c212dfe32dd317a9d3b73483467938)
2022-09-28T08:26:02.076022Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0316"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8389d6a9f520f2ab9fa107969892f19dea158d809573342db197819ae08e4183)
2022-09-28T08:26:02.971161Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:26:03.012184Z - running sql script pg/insert_tenders.sql
2022-09-28T08:26:03.012230Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:26:03.017169Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:26:03.020417Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:26:03.027590Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:26:03.035644Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:26:03.043602Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:26:03.047580Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:26:03.091665Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:26:03.100721Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:26:03.105251Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:26:03.106811Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:26:03.108019Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:26:03.109487Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:26:03.110825Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:26:03.113083Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:26:03.114892Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:26:03.116919Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:26:03.117245Z - job completed in 1.04 seconds (8389d6a9f520f2ab9fa107969892f19dea158d809573342db197819ae08e4183)
2022-09-28T08:26:03.160543Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0316"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8efe65137448bba2cb44b7aab4da598c2e1b4dc5dfd4859a5f328e7207414995)
2022-09-28T08:26:04.957933Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:26:04.977870Z - running sql script pg/upsert_orders.sql
2022-09-28T08:26:04.977910Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:26:04.982933Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:26:04.984310Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:26:04.985314Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:26:04.986306Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:26:04.987427Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:26:04.988560Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:26:04.989423Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:26:04.990301Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:26:04.992333Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:26:04.994583Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:26:04.996193Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:26:04.997103Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:26:05.001757Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:26:05.003568Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:26:05.007961Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:26:05.008506Z - job completed in 1.85 seconds (8efe65137448bba2cb44b7aab4da598c2e1b4dc5dfd4859a5f328e7207414995)
2022-09-28T08:28:02.351762Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (065f04cc2be8405f254b1ad9db3e00e76d8f748c1fbf775fa15dcb5db54b617b)
2022-09-28T08:28:03.393845Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:28:03.410736Z - running sql script pg/insert_tenders.sql
2022-09-28T08:28:03.410777Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:28:03.415073Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:28:03.416297Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:28:03.420542Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:28:03.424245Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:28:03.428766Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:28:03.429712Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:28:03.468270Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:28:03.476165Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:28:03.480211Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:28:03.482021Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:28:03.484124Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:28:03.487617Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:28:03.488917Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:28:03.490622Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:28:03.492307Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:28:03.493698Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:28:03.494155Z - job completed in 1.14 seconds (065f04cc2be8405f254b1ad9db3e00e76d8f748c1fbf775fa15dcb5db54b617b)
2022-09-28T08:28:03.516653Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0308"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (6011b5a9ec8a81891ad747baf916a8e4edd5590b8ef9e0ad8b2198644a22f4c5)
2022-09-28T08:28:08.141080Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:28:08.158201Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T08:28:08.158233Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:28:08.163024Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T08:28:08.164679Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T08:28:08.166755Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T08:28:08.168399Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T08:28:08.169419Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T08:28:08.170659Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T08:28:08.171822Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:28:08.172856Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T08:28:08.173774Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T08:28:08.175461Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T08:28:08.176869Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T08:28:08.177816Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T08:28:08.180188Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T08:28:08.181247Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T08:28:08.182337Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T08:28:08.184052Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T08:28:08.295355Z - called http://score/api/keyed and received back 204
2022-09-28T08:28:08.295594Z - job completed in 4.78 seconds (6011b5a9ec8a81891ad747baf916a8e4edd5590b8ef9e0ad8b2198644a22f4c5)
2022-09-28T08:28:08.392314Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5d94dc2b91cbd00d58d8d3f02122d44cd3cd5742431478fe98ae7b3aa1b207f4)
2022-09-28T08:28:10.136764Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:28:10.161378Z - running sql script pg/upsert_orders.sql
2022-09-28T08:28:10.161864Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:28:10.166946Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:28:10.169494Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:28:10.170869Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:28:10.173714Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:28:10.175907Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:28:10.177459Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:28:10.178626Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:28:10.179760Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:28:10.181526Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:28:10.184020Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:28:10.185969Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:28:10.186780Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:28:10.188712Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:28:10.191298Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:28:10.195614Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:28:10.196004Z - job completed in 1.80 seconds (5d94dc2b91cbd00d58d8d3f02122d44cd3cd5742431478fe98ae7b3aa1b207f4)
2022-09-28T08:30:02.318792Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0320"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ff299636ada45d93f096f9ce50fe7d3e656ce8a4ce306e47e260616d32386e94)
2022-09-28T08:30:03.646580Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:30:03.672325Z - running sql script pg/insert_tenders.sql
2022-09-28T08:30:03.673101Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:30:03.684697Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:30:03.686567Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:30:03.691361Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:30:03.701743Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:30:03.715110Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:30:03.725212Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:30:03.765349Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:30:03.772956Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:30:03.777786Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:30:03.779201Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:30:03.780898Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:30:03.782284Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:30:03.783976Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:30:03.786487Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:30:03.788173Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:30:03.790826Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:30:03.792017Z - job completed in 1.47 seconds (ff299636ada45d93f096f9ce50fe7d3e656ce8a4ce306e47e260616d32386e94)
2022-09-28T08:30:03.828187Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0320"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (cd8f6cad2c7f3a0e94638d78c11effaab19ba34b1c59c343e35efcab77e300a7)
2022-09-28T08:30:05.453202Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:30:05.471162Z - running sql script pg/upsert_orders.sql
2022-09-28T08:30:05.471327Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:30:05.475657Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:30:05.477341Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:30:05.478913Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:30:05.480651Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:30:05.482053Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:30:05.483460Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:30:05.484519Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:30:05.485328Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:30:05.487612Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:30:05.489970Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:30:05.491498Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:30:05.492910Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:30:05.494737Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:30:05.496531Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:30:05.500454Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:30:05.501051Z - job completed in 1.67 seconds (cd8f6cad2c7f3a0e94638d78c11effaab19ba34b1c59c343e35efcab77e300a7)
2022-09-28T08:32:01.980536Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0322"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c15f7ca7b0242673f2b265c971217b61e05af77b46fde58ebd262a5bab4a4e85)
2022-09-28T08:32:03.631778Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:32:03.648946Z - running sql script pg/upsert_orders.sql
2022-09-28T08:32:03.648992Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:32:03.653624Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:32:03.654878Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:32:03.655999Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:32:03.656877Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:32:03.658029Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:32:03.659375Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:32:03.660351Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:32:03.661290Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:32:03.662987Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:32:03.665060Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:32:03.666477Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:32:03.667463Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:32:03.669093Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:32:03.670728Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:32:03.674600Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:32:03.675007Z - job completed in 1.69 seconds (c15f7ca7b0242673f2b265c971217b61e05af77b46fde58ebd262a5bab4a4e85)
2022-09-28T08:32:03.717969Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0322"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (81f713d0165c97b7e02c034203ec78316022bc76c95046a3becf7d4b17040ae4)
2022-09-28T08:32:04.538357Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:32:04.557595Z - running sql script pg/insert_tenders.sql
2022-09-28T08:32:04.557892Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:32:04.565979Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:32:04.567431Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:32:04.571559Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:32:04.575619Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:32:04.583790Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:32:04.587708Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:32:04.648127Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:32:04.669324Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:32:04.674380Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:32:04.676472Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:32:04.679636Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:32:04.691779Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:32:04.695029Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:32:04.698339Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:32:04.703654Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:32:04.705569Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:32:04.706121Z - job completed in 0.99 seconds (81f713d0165c97b7e02c034203ec78316022bc76c95046a3becf7d4b17040ae4)
2022-09-28T08:34:02.130619Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0324"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0fb1c8323bb1ab4252024d2e525c9de87ebb19c51ff2643885e533f1248e50b1)
2022-09-28T08:34:03.794382Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:34:03.812444Z - running sql script pg/upsert_orders.sql
2022-09-28T08:34:03.812478Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:34:03.818211Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:34:03.820250Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:34:03.821316Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:34:03.822351Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:34:03.823638Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:34:03.825346Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:34:03.826687Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:34:03.827803Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:34:03.830225Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:34:03.832392Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:34:03.834087Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:34:03.835379Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:34:03.837472Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:34:03.839901Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:34:03.844431Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:34:03.844917Z - job completed in 1.71 seconds (0fb1c8323bb1ab4252024d2e525c9de87ebb19c51ff2643885e533f1248e50b1)
2022-09-28T08:34:03.871677Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0324"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a41760f46fa266de70fbdef041b478860072cb1412c835fa744dd1d49b8f69b1)
2022-09-28T08:34:05.077260Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:34:05.095511Z - running sql script pg/insert_tenders.sql
2022-09-28T08:34:05.095582Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:34:05.100553Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:34:05.102497Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:34:05.106571Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:34:05.110521Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:34:05.115739Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:34:05.116988Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:34:05.160448Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:34:05.169775Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:34:05.174446Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:34:05.175984Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:34:05.177814Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:34:05.179125Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:34:05.182192Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:34:05.183872Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:34:05.185457Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:34:05.186906Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:34:05.187449Z - job completed in 1.32 seconds (a41760f46fa266de70fbdef041b478860072cb1412c835fa744dd1d49b8f69b1)
2022-09-28T08:36:02.067026Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0326"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5a85f02a797b5c4cb162e19ae10565184e03ddf6c87a01ff91e3ceb84c4aa273)
2022-09-28T08:36:03.234808Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:36:03.263820Z - running sql script pg/insert_tenders.sql
2022-09-28T08:36:03.263890Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:36:03.273870Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:36:03.276950Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:36:03.281266Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:36:03.286390Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:36:03.294833Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:36:03.296622Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:36:03.344235Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:36:03.346714Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:36:03.347663Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:36:03.349764Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:36:03.390699Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:36:03.406196Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:36:03.420968Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:36:03.510674Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:36:03.691980Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:36:03.695298Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:36:03.695678Z - job completed in 1.63 seconds (5a85f02a797b5c4cb162e19ae10565184e03ddf6c87a01ff91e3ceb84c4aa273)
2022-09-28T08:36:03.735308Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0326"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (44b06ef66b1fb570eaf22779b3967ca433b491344ace94caef7ddddbd9cdcc4e)
2022-09-28T08:36:05.278300Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:36:05.294680Z - running sql script pg/upsert_orders.sql
2022-09-28T08:36:05.294740Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:36:05.300050Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:36:05.301508Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:36:05.302657Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:36:05.303779Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:36:05.305041Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:36:05.306400Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:36:05.307344Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:36:05.308313Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:36:05.311636Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:36:05.313946Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:36:05.315664Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:36:05.317051Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:36:05.318787Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:36:05.320530Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:36:05.324556Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:36:05.325038Z - job completed in 1.59 seconds (44b06ef66b1fb570eaf22779b3967ca433b491344ace94caef7ddddbd9cdcc4e)
2022-09-28T08:38:02.011474Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1c77dbc1d5b0bfc62b491f84327be23527f9f7e2b19e08ed146ed3b3963c29fa)
2022-09-28T08:38:03.698069Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:38:03.715892Z - running sql script pg/insert_tenders.sql
2022-09-28T08:38:03.716093Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:38:03.720891Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:38:03.722404Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:38:03.728753Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:38:03.733551Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:38:03.738746Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:38:03.739806Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:38:03.785532Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:38:03.787116Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:38:03.788582Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:38:03.791504Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:38:03.833885Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:38:03.853192Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:38:03.857653Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:38:03.946365Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:38:04.119412Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:38:04.121205Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:38:04.121810Z - job completed in 2.11 seconds (1c77dbc1d5b0bfc62b491f84327be23527f9f7e2b19e08ed146ed3b3963c29fa)
2022-09-28T08:38:04.220049Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (78d9fdb2e4a7e26c9107cf51375c7b01da01f4cffb988da7de90dfd5ed239f4b)
2022-09-28T08:38:06.201272Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:38:06.217895Z - running sql script pg/upsert_orders.sql
2022-09-28T08:38:06.217940Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:38:06.222693Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:38:06.223985Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:38:06.224936Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:38:06.225934Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:38:06.227082Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:38:06.228630Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:38:06.229603Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:38:06.230422Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:38:06.232346Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:38:06.234362Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:38:06.235753Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:38:06.236549Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:38:06.238359Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:38:06.239953Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:38:06.243852Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:38:06.244277Z - job completed in 2.03 seconds (78d9fdb2e4a7e26c9107cf51375c7b01da01f4cffb988da7de90dfd5ed239f4b)
2022-09-28T08:38:06.363514Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (2236e7a707c0b433b56ff2259ab338690d30b98665c5730101a1c728d2171287)
2022-09-28T08:38:11.784522Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:38:11.803475Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T08:38:11.803520Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:38:11.808071Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T08:38:11.809629Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T08:38:11.810665Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T08:38:11.811968Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T08:38:11.812909Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T08:38:11.814201Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T08:38:11.815074Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:38:11.816048Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T08:38:11.817042Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T08:38:11.818722Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T08:38:11.820063Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T08:38:11.820995Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T08:38:11.823178Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T08:38:11.824198Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T08:38:11.825490Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T08:38:11.827117Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T08:38:11.903883Z - called http://score/api/keyed and received back 204
2022-09-28T08:38:11.904281Z - job completed in 5.54 seconds (2236e7a707c0b433b56ff2259ab338690d30b98665c5730101a1c728d2171287)
2022-09-28T08:40:02.370823Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0330"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (22864838d9067c0e66a9da233da409206d98c8dab07014cd0cd906fa1e1e5aa9)
2022-09-28T08:40:03.740122Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:40:03.760263Z - running sql script pg/insert_tenders.sql
2022-09-28T08:40:03.760300Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:40:03.765347Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:40:03.766709Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:40:03.770827Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:40:03.774749Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:40:03.784952Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:40:03.786031Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:40:03.831030Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:40:03.832505Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:40:03.833403Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:40:03.834572Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:40:03.875362Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:40:03.893535Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:40:03.897894Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:40:03.986078Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:40:04.159075Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:40:04.160930Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:40:04.161489Z - job completed in 1.79 seconds (22864838d9067c0e66a9da233da409206d98c8dab07014cd0cd906fa1e1e5aa9)
2022-09-28T08:40:04.178638Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0330"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a6cdfcdb5ff4e0a1a5c6aabeb155000b2ba6720f6e5d52e8c6d5d92708d9be63)
2022-09-28T08:40:05.841250Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:40:05.859181Z - running sql script pg/upsert_orders.sql
2022-09-28T08:40:05.859461Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:40:05.864349Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:40:05.869271Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:40:05.873765Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:40:05.878570Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:40:05.880272Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:40:05.884803Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:40:05.887284Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:40:05.888585Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:40:05.894856Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:40:05.908419Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:40:05.909924Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:40:05.910950Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:40:05.918019Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:40:05.980913Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:40:05.993365Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:40:05.993944Z - job completed in 1.82 seconds (a6cdfcdb5ff4e0a1a5c6aabeb155000b2ba6720f6e5d52e8c6d5d92708d9be63)
2022-09-28T08:42:01.974798Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0332"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f71273fde26d4f3c49c5e7d961c60413669ad72e4c692d32655f956a6c823c06)
2022-09-28T08:42:03.814525Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:42:03.833834Z - running sql script pg/upsert_orders.sql
2022-09-28T08:42:03.833890Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:42:03.838250Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:42:03.843215Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:42:03.844701Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:42:03.848899Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:42:03.850655Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:42:03.854858Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:42:03.855903Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:42:03.856956Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:42:03.862569Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:42:03.875127Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:42:03.876931Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:42:03.878022Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:42:03.883296Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:42:03.946014Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:42:03.953322Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:42:03.953778Z - job completed in 1.98 seconds (f71273fde26d4f3c49c5e7d961c60413669ad72e4c692d32655f956a6c823c06)
2022-09-28T08:42:04.030106Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0332"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7d45c1158b0a6a3f79128865f3a1fac9b70e58e2d2291b0673bafb25e48e8360)
2022-09-28T08:42:04.878153Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:42:04.897828Z - running sql script pg/insert_tenders.sql
2022-09-28T08:42:04.897867Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:42:04.902597Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:42:04.904216Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:42:04.908222Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:42:04.912425Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:42:04.918062Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:42:04.918959Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:42:04.964907Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:42:04.966405Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:42:04.967311Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:42:04.968651Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:42:05.009904Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:42:05.028971Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:42:05.036370Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:42:05.128835Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:42:05.308893Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:42:05.310965Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:42:05.311583Z - job completed in 1.28 seconds (7d45c1158b0a6a3f79128865f3a1fac9b70e58e2d2291b0673bafb25e48e8360)
2022-09-28T08:44:02.234557Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0334"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f35479610cab664d520da7d4fd22df5ad2cdb2286f69ac49c39767676e42a857)
2022-09-28T08:44:04.095294Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:44:04.113577Z - running sql script pg/upsert_orders.sql
2022-09-28T08:44:04.113616Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:44:04.118014Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:44:04.122371Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:44:04.123569Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:44:04.127361Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:44:04.128733Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:44:04.133040Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:44:04.134814Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:44:04.135776Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:44:04.142221Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:44:04.153718Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:44:04.155280Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:44:04.156288Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:44:04.161516Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:44:04.224947Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:44:04.233839Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:44:04.234423Z - job completed in 2.00 seconds (f35479610cab664d520da7d4fd22df5ad2cdb2286f69ac49c39767676e42a857)
2022-09-28T08:44:04.265197Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0334"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9c952e42cafd0f47c0a60dacfc5e1a581040b4ae47aa497910b3e473f2843eba)
2022-09-28T08:44:05.297513Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:44:05.315277Z - running sql script pg/insert_tenders.sql
2022-09-28T08:44:05.315310Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:44:05.319438Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:44:05.320844Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:44:05.322922Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:44:05.323800Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:44:05.325108Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:44:05.326083Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:44:05.328175Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:44:05.329808Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:44:05.330733Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:44:05.332093Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:44:05.333358Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:44:05.335201Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:44:05.336812Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:44:05.338764Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:44:05.340413Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:44:05.341844Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:44:05.342271Z - job completed in 1.08 seconds (9c952e42cafd0f47c0a60dacfc5e1a581040b4ae47aa497910b3e473f2843eba)
2022-09-28T08:46:02.017050Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0336"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (464662aa8b5f8887fee41b6896aea3f64b3dbcb927dbd477f15371a2004d1da3)
2022-09-28T08:46:04.073523Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:46:04.093445Z - running sql script pg/upsert_orders.sql
2022-09-28T08:46:04.093679Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:46:04.099019Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:46:04.105751Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:46:04.107565Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:46:04.111848Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:46:04.113894Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:46:04.119152Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:46:04.120904Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:46:04.122367Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:46:04.129271Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:46:04.141311Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:46:04.142897Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:46:04.144036Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:46:04.149389Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:46:04.212057Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:46:04.219702Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:46:04.220166Z - job completed in 2.20 seconds (464662aa8b5f8887fee41b6896aea3f64b3dbcb927dbd477f15371a2004d1da3)
2022-09-28T08:46:04.246067Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0336"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b5da8340d81673e13ce2a99c3443d98a31bf41160afacd9a9daa315b8f409c03)
2022-09-28T08:46:05.106456Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:46:05.122817Z - running sql script pg/insert_tenders.sql
2022-09-28T08:46:05.122852Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:46:05.127778Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:46:05.129212Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:46:05.130251Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:46:05.131138Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:46:05.132399Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:46:05.133234Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:46:05.135394Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:46:05.137324Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:46:05.138336Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:46:05.139866Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:46:05.141621Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:46:05.143209Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:46:05.144413Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:46:05.146277Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:46:05.147883Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:46:05.149486Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:46:05.149949Z - job completed in 0.90 seconds (b5da8340d81673e13ce2a99c3443d98a31bf41160afacd9a9daa315b8f409c03)
2022-09-28T08:48:01.994907Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1bd91c595c7902bf2cb3a436bc599120f9a7988ea51ad2d246f088c13870d865)
2022-09-28T08:48:03.678857Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:48:03.696644Z - running sql script pg/insert_tenders.sql
2022-09-28T08:48:03.696672Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:48:03.702745Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:48:03.704804Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:48:03.706170Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:48:03.707382Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:48:03.709077Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:48:03.710160Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:48:03.712619Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:48:03.713973Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:48:03.714768Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:48:03.716082Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:48:03.717710Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:48:03.719051Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:48:03.720583Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:48:03.722448Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:48:03.724571Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:48:03.726080Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:48:03.726420Z - job completed in 1.73 seconds (1bd91c595c7902bf2cb3a436bc599120f9a7988ea51ad2d246f088c13870d865)
2022-09-28T08:48:03.763939Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (ae4b276ad346b60fa2d993d33b2ac4d182f7d9a8cf63186398aa7eaf3ba27338)
2022-09-28T08:48:08.516526Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:48:08.539879Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T08:48:08.540179Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:48:08.544799Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T08:48:08.546435Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T08:48:08.551658Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T08:48:08.557826Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T08:48:08.560934Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T08:48:08.562880Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T08:48:08.564472Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:48:08.565346Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T08:48:08.566209Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T08:48:08.567918Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T08:48:08.569529Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T08:48:08.570344Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T08:48:08.572522Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T08:48:08.573902Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T08:48:08.574995Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T08:48:08.576584Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T08:48:08.695879Z - called http://score/api/keyed and received back 204
2022-09-28T08:48:08.696320Z - job completed in 4.93 seconds (ae4b276ad346b60fa2d993d33b2ac4d182f7d9a8cf63186398aa7eaf3ba27338)
2022-09-28T08:48:08.826715Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3421287dff141627fa9bd047bf4a3d0f33e78bf3f763e3c26ee296cf6cb56611)
2022-09-28T08:48:10.428287Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:48:10.450727Z - running sql script pg/upsert_orders.sql
2022-09-28T08:48:10.450779Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:48:10.454798Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:48:10.459138Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:48:10.460157Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:48:10.464153Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:48:10.465484Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:48:10.469656Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:48:10.470746Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:48:10.471701Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:48:10.477552Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:48:10.488787Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:48:10.490267Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:48:10.491101Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:48:10.495841Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:48:10.558906Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:48:10.566348Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:48:10.567014Z - job completed in 1.74 seconds (3421287dff141627fa9bd047bf4a3d0f33e78bf3f763e3c26ee296cf6cb56611)
2022-09-28T08:50:02.364006Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0340"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ac81d900d5cd07d13bdf66818cb878a68507e76846d19c8886b16fa8a5b10d73)
2022-09-28T08:50:03.709443Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:50:03.738468Z - running sql script pg/insert_tenders.sql
2022-09-28T08:50:03.738509Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:50:03.743823Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:50:03.745412Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:50:03.746959Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:50:03.748042Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:50:03.749514Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:50:03.750541Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:50:03.753274Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:50:03.755362Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:50:03.756505Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:50:03.758044Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:50:03.759803Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:50:03.761396Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:50:03.762937Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:50:03.765177Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:50:03.767219Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:50:03.769216Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:50:03.769503Z - job completed in 1.41 seconds (ac81d900d5cd07d13bdf66818cb878a68507e76846d19c8886b16fa8a5b10d73)
2022-09-28T08:50:03.863866Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0340"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1c5d2b673eab6ae9b576061d9180ca5b1010d1da67dd5a8dc86a704d5438379a)
2022-09-28T08:50:05.494164Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:50:05.511043Z - running sql script pg/upsert_orders.sql
2022-09-28T08:50:05.511087Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:50:05.516154Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:50:05.517384Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:50:05.518483Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:50:05.519950Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:50:05.521536Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:50:05.523515Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:50:05.525312Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:50:05.526412Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:50:05.529225Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:50:05.532205Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:50:05.534044Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:50:05.534953Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:50:05.538696Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:50:05.540651Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:50:05.545644Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:50:05.545992Z - job completed in 1.68 seconds (1c5d2b673eab6ae9b576061d9180ca5b1010d1da67dd5a8dc86a704d5438379a)
2022-09-28T08:52:02.010027Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0342"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ffa6d410521b5e71607f9fa216ede36e60b6d5ef33d7a5142178791eb058475d)
2022-09-28T08:52:03.086435Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:52:03.103767Z - running sql script pg/insert_tenders.sql
2022-09-28T08:52:03.103800Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:52:03.108933Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:52:03.110494Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:52:03.111709Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:52:03.112854Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:52:03.114113Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:52:03.116180Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:52:03.118272Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:52:03.119783Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:52:03.121131Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:52:03.122614Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:52:03.124019Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:52:03.125350Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:52:03.126652Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:52:03.128521Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:52:03.130203Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:52:03.131723Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:52:03.132097Z - job completed in 1.12 seconds (ffa6d410521b5e71607f9fa216ede36e60b6d5ef33d7a5142178791eb058475d)
2022-09-28T08:52:03.153737Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0342"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (58280c5747812be2f62e7e4b2cf1fdccbb1dd915b1a0c14f565e521c86ae5e1a)
2022-09-28T08:52:05.146876Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:52:05.169237Z - running sql script pg/upsert_orders.sql
2022-09-28T08:52:05.169544Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:52:05.174452Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:52:05.179667Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:52:05.180989Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:52:05.182216Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:52:05.183682Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:52:05.185432Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:52:05.186630Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:52:05.187698Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:52:05.189584Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:52:05.192387Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:52:05.194526Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:52:05.196662Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:52:05.198970Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:52:05.201331Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:52:05.206148Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:52:05.206709Z - job completed in 2.05 seconds (58280c5747812be2f62e7e4b2cf1fdccbb1dd915b1a0c14f565e521c86ae5e1a)
2022-09-28T08:54:02.075200Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0344"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b030497ef7a163f3cc3488e88f7067601b25d119387e37359e6f7433ee4d132c)
2022-09-28T08:54:03.350954Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:54:03.367299Z - running sql script pg/insert_tenders.sql
2022-09-28T08:54:03.367334Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:54:03.373869Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:54:03.375164Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:54:03.376541Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:54:03.377470Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:54:03.379180Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:54:03.380720Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:54:03.382887Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:54:03.385368Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:54:03.386538Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:54:03.388065Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:54:03.389489Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:54:03.390978Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:54:03.392176Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:54:03.394169Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:54:03.395808Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:54:03.397248Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:54:03.397694Z - job completed in 1.32 seconds (b030497ef7a163f3cc3488e88f7067601b25d119387e37359e6f7433ee4d132c)
2022-09-28T08:54:03.449642Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0344"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3eeb574c2a00a1cbc16acbfe6c5f3f0a6abbb863f1d6ede1ba799ac0ae329830)
2022-09-28T08:54:05.093648Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:54:05.110338Z - running sql script pg/upsert_orders.sql
2022-09-28T08:54:05.110386Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:54:05.117187Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:54:05.118674Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:54:05.119767Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:54:05.120822Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:54:05.122012Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:54:05.123342Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:54:05.124510Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:54:05.125579Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:54:05.127487Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:54:05.129989Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:54:05.131615Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:54:05.132660Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:54:05.134385Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:54:05.136128Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:54:05.140215Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:54:05.140697Z - job completed in 1.69 seconds (3eeb574c2a00a1cbc16acbfe6c5f3f0a6abbb863f1d6ede1ba799ac0ae329830)
2022-09-28T08:56:02.460119Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0346"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ebee612ce4ce0a3f8e423148cc769906870bfb9ec52eeb40d36ee5e550e80062)
2022-09-28T08:56:03.895926Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:56:03.913092Z - running sql script pg/insert_tenders.sql
2022-09-28T08:56:03.913201Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:56:03.918233Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:56:03.919637Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:56:03.920676Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:56:03.921603Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:56:03.922911Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:56:03.925437Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:56:03.927671Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:56:03.929233Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:56:03.930054Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:56:03.931244Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:56:03.932279Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:56:03.933659Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:56:03.934727Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:56:03.936321Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:56:03.937926Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:56:03.939342Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:56:03.939864Z - job completed in 1.48 seconds (ebee612ce4ce0a3f8e423148cc769906870bfb9ec52eeb40d36ee5e550e80062)
2022-09-28T08:56:04.098747Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0346"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ab20b43d4d853a3bb7194508dae93f8ffa557bc49832138cd1550282fdd002b7)
2022-09-28T08:56:05.735978Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:56:05.778215Z - running sql script pg/upsert_orders.sql
2022-09-28T08:56:05.778258Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:56:05.783390Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:56:05.785554Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:56:05.787647Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:56:05.789250Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:56:05.791377Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:56:05.793269Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:56:05.794555Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:56:05.796644Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:56:05.798814Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:56:05.801215Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:56:05.804197Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:56:05.805397Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:56:05.806997Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:56:05.808668Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:56:05.812565Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:56:05.812923Z - job completed in 1.71 seconds (ab20b43d4d853a3bb7194508dae93f8ffa557bc49832138cd1550282fdd002b7)
2022-09-28T08:58:01.929515Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3eec81be72d1065b01f93c0f046b16179c7c3c6129d1618e626bbfdd42e18353)
2022-09-28T08:58:03.530435Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:58:03.548427Z - running sql script pg/upsert_orders.sql
2022-09-28T08:58:03.548741Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:58:03.554479Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T08:58:03.556739Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T08:58:03.557958Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T08:58:03.559226Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T08:58:03.560515Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T08:58:03.561864Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:58:03.563583Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T08:58:03.564516Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T08:58:03.571811Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T08:58:03.576836Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T08:58:03.580408Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T08:58:03.581310Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T08:58:03.583622Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T08:58:03.586024Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T08:58:03.590137Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T08:58:03.590498Z - job completed in 1.66 seconds (3eec81be72d1065b01f93c0f046b16179c7c3c6129d1618e626bbfdd42e18353)
2022-09-28T08:58:03.639133Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d93a70b77ed4fd10814b266b86c289e16e0cbb784fd86f4a3309c87e81f3fc1e)
2022-09-28T08:58:04.878699Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:58:04.906133Z - running sql script pg/insert_tenders.sql
2022-09-28T08:58:04.906173Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T08:58:04.912359Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T08:58:04.913873Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T08:58:04.914938Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T08:58:04.916489Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T08:58:04.919480Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T08:58:04.922577Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T08:58:04.925998Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T08:58:04.928120Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T08:58:04.929556Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T08:58:04.931069Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T08:58:04.932489Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T08:58:04.933749Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T08:58:04.935342Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T08:58:04.937858Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T08:58:04.940266Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T08:58:04.945351Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T08:58:04.945754Z - job completed in 1.31 seconds (d93a70b77ed4fd10814b266b86c289e16e0cbb784fd86f4a3309c87e81f3fc1e)
2022-09-28T08:58:05.040968Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (6f96e353c2b51251e69e75ee33d3ab0d58553c9a42130a50cf70ad7632a06910)
2022-09-28T08:58:10.234704Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T08:58:10.255875Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T08:58:10.255911Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T08:58:10.260496Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T08:58:10.262226Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T08:58:10.263260Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T08:58:10.264107Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T08:58:10.264988Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T08:58:10.266164Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T08:58:10.267141Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T08:58:10.267982Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T08:58:10.268829Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T08:58:10.270492Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T08:58:10.271788Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T08:58:10.272612Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T08:58:10.274885Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T08:58:10.275895Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T08:58:10.276927Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T08:58:10.278294Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T08:58:10.354048Z - called http://score/api/keyed and received back 204
2022-09-28T08:58:10.354527Z - job completed in 5.31 seconds (6f96e353c2b51251e69e75ee33d3ab0d58553c9a42130a50cf70ad7632a06910)
2022-09-28T09:00:02.148417Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0350"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c1da0b0c45ee2571e75749be593aa3836879657a4a7fa99790a031a297cb7475)
2022-09-28T09:00:04.003517Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:00:04.023817Z - running sql script pg/insert_tenders.sql
2022-09-28T09:00:04.023953Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:00:04.029391Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:00:04.030913Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:00:04.032615Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:00:04.034216Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:00:04.036098Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:00:04.037086Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:00:04.039443Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:00:04.041043Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:00:04.041990Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:00:04.043280Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:00:04.044594Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:00:04.045904Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:00:04.047307Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:00:04.049141Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:00:04.050909Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:00:04.052283Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:00:04.052738Z - job completed in 1.90 seconds (c1da0b0c45ee2571e75749be593aa3836879657a4a7fa99790a031a297cb7475)
2022-09-28T09:00:04.139768Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0350"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (bc402860ad8b5a58211909de5880ca1fcb1ace72a9bcb7b8b83e2685b4bcd91d)
2022-09-28T09:00:05.850Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:00:05.866755Z - running sql script pg/upsert_orders.sql
2022-09-28T09:00:05.866799Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:00:05.871198Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:00:05.872455Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:00:05.873393Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:00:05.874239Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:00:05.875371Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:00:05.876616Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:00:05.877437Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:00:05.878320Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:00:05.880344Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:00:05.883064Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:00:05.884559Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:00:05.885430Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:00:05.887235Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:00:05.888883Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:00:05.893003Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:00:05.893347Z - job completed in 1.75 seconds (bc402860ad8b5a58211909de5880ca1fcb1ace72a9bcb7b8b83e2685b4bcd91d)
2022-09-28T09:02:01.888001Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0352"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (70314a3ba4b4784ff5e458eea3cc1e10b96a800df221727b049b522dbf9c46d9)
2022-09-28T09:02:03.225682Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:02:03.247926Z - running sql script pg/insert_tenders.sql
2022-09-28T09:02:03.247960Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:02:03.253223Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:02:03.254653Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:02:03.255718Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:02:03.256816Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:02:03.258474Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:02:03.259409Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:02:03.265496Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:02:03.267472Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:02:03.268860Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:02:03.270983Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:02:03.272937Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:02:03.274546Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:02:03.276763Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:02:03.279038Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:02:03.281010Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:02:03.283133Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:02:03.283674Z - job completed in 1.40 seconds (70314a3ba4b4784ff5e458eea3cc1e10b96a800df221727b049b522dbf9c46d9)
2022-09-28T09:02:03.341875Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0352"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0d406a4b74993580e2a5f8045fc4c924e513ee2f28883482eda145e4cfa164ac)
2022-09-28T09:02:05.883662Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:02:05.904133Z - running sql script pg/upsert_orders.sql
2022-09-28T09:02:05.904265Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:02:05.913717Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:02:05.916097Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:02:05.917699Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:02:05.918931Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:02:05.923079Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:02:05.924852Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:02:05.925832Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:02:05.926690Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:02:05.928500Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:02:05.930561Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:02:05.932101Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:02:05.933050Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:02:05.934810Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:02:05.936663Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:02:05.944187Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:02:05.944673Z - job completed in 2.60 seconds (0d406a4b74993580e2a5f8045fc4c924e513ee2f28883482eda145e4cfa164ac)
2022-09-28T09:04:02.011225Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0354"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a4ffcf482520b080bad0206089265b26fc8aa14c68f5e58feb08fafcd295875e)
2022-09-28T09:04:04.383203Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:04:04.400563Z - running sql script pg/upsert_orders.sql
2022-09-28T09:04:04.400811Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:04:04.406190Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:04:04.408100Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:04:04.409311Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:04:04.410729Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:04:04.412228Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:04:04.413814Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:04:04.415027Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:04:04.416185Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:04:04.418674Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:04:04.420859Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:04:04.422590Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:04:04.423735Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:04:04.425532Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:04:04.427390Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:04:04.432122Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:04:04.432563Z - job completed in 2.42 seconds (a4ffcf482520b080bad0206089265b26fc8aa14c68f5e58feb08fafcd295875e)
2022-09-28T09:04:04.560215Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0354"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (09bd26c4996d78c160429cac738896cb345526a2b99f737e00b242fe9b4c1a95)
2022-09-28T09:04:05.751201Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:04:05.777768Z - running sql script pg/insert_tenders.sql
2022-09-28T09:04:05.777850Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:04:05.784623Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:04:05.787014Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:04:05.788125Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:04:05.789182Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:04:05.791150Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:04:05.792083Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:04:05.795360Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:04:05.799045Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:04:05.803165Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:04:05.839782Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:04:05.842028Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:04:05.847650Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:04:05.849367Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:04:05.856886Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:04:05.859419Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:04:05.861529Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:04:05.862105Z - job completed in 1.30 seconds (09bd26c4996d78c160429cac738896cb345526a2b99f737e00b242fe9b4c1a95)
2022-09-28T09:06:02.086966Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0356"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b5855b0a5619781ee452b917341ba99220f2ef228eb847b0267d079db8ad4af0)
2022-09-28T09:06:03.486464Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:06:03.503987Z - running sql script pg/insert_tenders.sql
2022-09-28T09:06:03.504034Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:06:03.511313Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:06:03.513460Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:06:03.515185Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:06:03.516518Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:06:03.518388Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:06:03.519439Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:06:03.522372Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:06:03.523952Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:06:03.525473Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:06:03.527922Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:06:03.529581Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:06:03.531506Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:06:03.533014Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:06:03.535287Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:06:03.537395Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:06:03.540069Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:06:03.540479Z - job completed in 1.45 seconds (b5855b0a5619781ee452b917341ba99220f2ef228eb847b0267d079db8ad4af0)
2022-09-28T09:06:03.643829Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0356"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0c88b9268f89827b989e700945c77db4e60af8d818a326d6ff8855b87299ee22)
2022-09-28T09:06:05.949046Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:06:05.969323Z - running sql script pg/upsert_orders.sql
2022-09-28T09:06:05.969368Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:06:05.974906Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:06:05.976519Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:06:05.977568Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:06:05.978564Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:06:05.979825Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:06:05.981267Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:06:05.982229Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:06:05.983102Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:06:05.984931Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:06:05.987051Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:06:05.988687Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:06:05.990017Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:06:05.991959Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:06:05.993673Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:06:05.997565Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:06:05.998032Z - job completed in 2.36 seconds (0c88b9268f89827b989e700945c77db4e60af8d818a326d6ff8855b87299ee22)
2022-09-28T09:08:01.985460Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (13539e2af67d8eb5a325d2987d8b85a8744de6523edf6152b243281c59c559ad)
2022-09-28T09:08:03.089654Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:08:03.122925Z - running sql script pg/insert_tenders.sql
2022-09-28T09:08:03.122979Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:08:03.129561Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:08:03.133092Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:08:03.137234Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:08:03.142151Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:08:03.146967Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:08:03.154088Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:08:03.202533Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:08:03.216699Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:08:03.221338Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:08:03.223584Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:08:03.225093Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:08:03.227283Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:08:03.228681Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:08:03.230675Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:08:03.233170Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:08:03.234670Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:08:03.235118Z - job completed in 1.25 seconds (13539e2af67d8eb5a325d2987d8b85a8744de6523edf6152b243281c59c559ad)
2022-09-28T09:08:03.271676Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (968520e25ff2372112ad6b33e6579cdfa48bb9b2e5fe51b9283c5a198090d10f)
2022-09-28T09:08:08.847760Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:08:08.866724Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T09:08:08.866760Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:08:08.871275Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T09:08:08.872818Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T09:08:08.873905Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T09:08:08.874769Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T09:08:08.876695Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T09:08:08.877938Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T09:08:08.878879Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:08:08.879793Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T09:08:08.880615Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T09:08:08.882300Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T09:08:08.883611Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T09:08:08.884515Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T09:08:08.886805Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T09:08:08.887689Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T09:08:08.888777Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T09:08:08.890150Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T09:08:08.969429Z - called http://score/api/keyed and received back 204
2022-09-28T09:08:08.970305Z - job completed in 5.70 seconds (968520e25ff2372112ad6b33e6579cdfa48bb9b2e5fe51b9283c5a198090d10f)
2022-09-28T09:08:08.994399Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (14e10ea52924a90824e05563e4d5dc76c218419b32d012fa17b1dfae0ba2dda3)
2022-09-28T09:08:11.351171Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:08:11.368281Z - running sql script pg/upsert_orders.sql
2022-09-28T09:08:11.368326Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:08:11.372930Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:08:11.374250Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:08:11.375201Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:08:11.376110Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:08:11.377156Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:08:11.378253Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:08:11.379044Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:08:11.379863Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:08:11.381519Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:08:11.383792Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:08:11.385161Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:08:11.385914Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:08:11.387561Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:08:11.389402Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:08:11.393546Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:08:11.393775Z - job completed in 2.40 seconds (14e10ea52924a90824e05563e4d5dc76c218419b32d012fa17b1dfae0ba2dda3)
2022-09-28T09:10:02.241142Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0400"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (db47aa253026a84d8b08af2e070a49eb7e05c871650114f361a7f8d309ac68fd)
2022-09-28T09:10:04.213689Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:10:04.240054Z - running sql script pg/upsert_orders.sql
2022-09-28T09:10:04.240606Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:10:04.247753Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:10:04.249495Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:10:04.250919Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:10:04.252450Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:10:04.255041Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:10:04.257755Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:10:04.259604Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:10:04.261191Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:10:04.263706Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:10:04.266268Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:10:04.268573Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:10:04.269913Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:10:04.274106Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:10:04.276322Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:10:04.280934Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:10:04.281579Z - job completed in 2.04 seconds (db47aa253026a84d8b08af2e070a49eb7e05c871650114f361a7f8d309ac68fd)
2022-09-28T09:10:04.393063Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0400"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ccd401efc9df29332e2bdc9894aa04f5650d1a132561486bf89cd558d9f33b1a)
2022-09-28T09:10:05.681916Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:10:05.702001Z - running sql script pg/insert_tenders.sql
2022-09-28T09:10:05.702045Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:10:05.706732Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:10:05.709044Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:10:05.714116Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:10:05.719268Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:10:05.723788Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:10:05.724833Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:10:05.769155Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:10:05.782844Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:10:05.787015Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:10:05.789063Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:10:05.793005Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:10:05.795265Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:10:05.797621Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:10:05.800195Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:10:05.802938Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:10:05.805286Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:10:05.806064Z - job completed in 1.41 seconds (ccd401efc9df29332e2bdc9894aa04f5650d1a132561486bf89cd558d9f33b1a)
2022-09-28T09:12:01.962154Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0402"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b89f1a47bfbc47b9fb5ba5f172dc0bb8a8be94fa4c6203a5ccc92fbcc5391a70)
2022-09-28T09:12:02.965982Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:12:02.987054Z - running sql script pg/insert_tenders.sql
2022-09-28T09:12:02.987108Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:12:02.992092Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:12:02.993545Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:12:02.997679Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:12:03.001693Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:12:03.007069Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:12:03.008786Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:12:03.058157Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:12:03.062160Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:12:03.063367Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:12:03.070578Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:12:03.270786Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:12:03.349561Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:12:03.355572Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:12:03.443042Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:12:03.638167Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:12:03.640317Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:12:03.640792Z - job completed in 1.68 seconds (b89f1a47bfbc47b9fb5ba5f172dc0bb8a8be94fa4c6203a5ccc92fbcc5391a70)
2022-09-28T09:12:03.755982Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0402"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (040669ba9e9173e3ad38679307675238d46ae49af0d2572acc156798e8e9c09a)
2022-09-28T09:12:05.948602Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:12:05.966198Z - running sql script pg/upsert_orders.sql
2022-09-28T09:12:05.966244Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:12:05.971077Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:12:05.972350Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:12:05.973283Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:12:05.974160Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:12:05.975256Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:12:05.976374Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:12:05.977317Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:12:05.979034Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:12:05.983218Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:12:05.985200Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:12:05.986663Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:12:05.987664Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:12:05.989576Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:12:05.991593Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:12:05.995718Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:12:05.996297Z - job completed in 2.24 seconds (040669ba9e9173e3ad38679307675238d46ae49af0d2572acc156798e8e9c09a)
2022-09-28T09:14:01.987629Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0404"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fb842ca1253d24883e1a1d4ab0bf50a5c5a60cb698e5247c2313148d5d3e93a6)
2022-09-28T09:14:03.827479Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:14:03.846519Z - running sql script pg/upsert_orders.sql
2022-09-28T09:14:03.846568Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:14:03.854456Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:14:03.855681Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:14:03.856726Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:14:03.857725Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:14:03.858898Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:14:03.860119Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:14:03.861040Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:14:03.861859Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:14:03.863503Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:14:03.865643Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:14:03.867086Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:14:03.867998Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:14:03.869615Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:14:03.871444Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:14:03.875604Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:14:03.876019Z - job completed in 1.89 seconds (fb842ca1253d24883e1a1d4ab0bf50a5c5a60cb698e5247c2313148d5d3e93a6)
2022-09-28T09:14:03.987093Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0404"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (26eafafb6ecfadeb58cefbc434ad95062da042032e5f9d2e46a48d3f874195a3)
2022-09-28T09:14:05.156137Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:14:05.188521Z - running sql script pg/insert_tenders.sql
2022-09-28T09:14:05.188565Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:14:05.193590Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:14:05.195108Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:14:05.199756Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:14:05.204005Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:14:05.209964Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:14:05.211687Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:14:05.258163Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:14:05.259839Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:14:05.260825Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:14:05.262351Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:14:05.459633Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:14:05.542263Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:14:05.548165Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:14:05.636613Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:14:05.817611Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:14:05.820996Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:14:05.821418Z - job completed in 1.83 seconds (26eafafb6ecfadeb58cefbc434ad95062da042032e5f9d2e46a48d3f874195a3)
2022-09-28T09:16:02.129317Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0406"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (22fa8f36a670b904f6dd25671b0b18873a63a389e5f6a64825c8d97874ec1487)
2022-09-28T09:16:04.259696Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:16:04.275849Z - running sql script pg/upsert_orders.sql
2022-09-28T09:16:04.276352Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:16:04.281022Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:16:04.282439Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:16:04.283497Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:16:04.284753Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:16:04.285866Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:16:04.287016Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:16:04.288025Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:16:04.288933Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:16:04.290649Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:16:04.293059Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:16:04.294663Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:16:04.295660Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:16:04.297921Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:16:04.299667Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:16:04.303914Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:16:04.304293Z - job completed in 2.18 seconds (22fa8f36a670b904f6dd25671b0b18873a63a389e5f6a64825c8d97874ec1487)
2022-09-28T09:16:04.357707Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0406"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fff4c1994d1c259f8f343fa9ac5bcf373bdc0506238f93755b59129d04adfd2d)
2022-09-28T09:16:05.433085Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:16:05.451784Z - running sql script pg/insert_tenders.sql
2022-09-28T09:16:05.451874Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:16:05.456858Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:16:05.458213Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:16:05.464043Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:16:05.468111Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:16:05.472789Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:16:05.473789Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:16:05.519298Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:16:05.520618Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:16:05.521471Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:16:05.522746Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:16:05.725231Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:16:05.806315Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:16:05.810975Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:16:05.897822Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:16:06.077794Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:16:06.079599Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:16:06.080153Z - job completed in 1.72 seconds (fff4c1994d1c259f8f343fa9ac5bcf373bdc0506238f93755b59129d04adfd2d)
2022-09-28T09:18:02.096439Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (caed0d0ae4cc1fca6f78aff0948188a02d8464f33e80ca5f91d95144203adbda)
2022-09-28T09:18:07.480771Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:18:07.498685Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T09:18:07.498720Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:18:07.503452Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T09:18:07.505089Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T09:18:07.506315Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T09:18:07.507735Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T09:18:07.509369Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T09:18:07.511272Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T09:18:07.512671Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:18:07.514023Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T09:18:07.514922Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T09:18:07.516731Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T09:18:07.518951Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T09:18:07.520410Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T09:18:07.523732Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T09:18:07.524734Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T09:18:07.526056Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T09:18:07.527921Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T09:18:07.606720Z - called http://score/api/keyed and received back 204
2022-09-28T09:18:07.606861Z - job completed in 5.51 seconds (caed0d0ae4cc1fca6f78aff0948188a02d8464f33e80ca5f91d95144203adbda)
2022-09-28T09:18:07.633059Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0408"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (49de98656a74605be86a2c3662b80cae4daad1dc5086543eacab5c4ca5ea1f01)
2022-09-28T09:18:08.926174Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:18:08.946484Z - running sql script pg/insert_tenders.sql
2022-09-28T09:18:08.946540Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:18:08.951460Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:18:08.953254Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:18:08.960715Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:18:08.964446Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:18:08.969024Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:18:08.970044Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:18:09.053924Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:18:09.116191Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:18:09.122806Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:18:09.124473Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:18:09.125783Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:18:09.127098Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:18:09.128463Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:18:09.130269Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:18:09.131949Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:18:09.133448Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:18:09.134096Z - job completed in 1.50 seconds (49de98656a74605be86a2c3662b80cae4daad1dc5086543eacab5c4ca5ea1f01)
2022-09-28T09:18:09.175852Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0408"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a5320d49238996ec8d08e56743f177526caa7fe7bc45171c7849345fc3e2553a)
2022-09-28T09:18:11.204347Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:18:11.226932Z - running sql script pg/upsert_orders.sql
2022-09-28T09:18:11.226963Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:18:11.232002Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:18:11.233457Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:18:11.237552Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:18:11.238770Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:18:11.239874Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:18:11.241047Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:18:11.241941Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:18:11.242760Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:18:11.244509Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:18:11.246419Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:18:11.247842Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:18:11.248680Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:18:11.250408Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:18:11.252140Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:18:11.255996Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:18:11.256478Z - job completed in 2.08 seconds (a5320d49238996ec8d08e56743f177526caa7fe7bc45171c7849345fc3e2553a)
2022-09-28T09:20:02.455757Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0410"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (60cf204bc6af449932c173b78b5681827dfcbeb248d6859b3be77a36341e7db9)
2022-09-28T09:20:04.797089Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:20:04.817462Z - running sql script pg/upsert_orders.sql
2022-09-28T09:20:04.817508Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:20:04.822529Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:20:04.824571Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:20:04.825594Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:20:04.828051Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:20:04.829355Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:20:04.830767Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:20:04.831941Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:20:04.833854Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:20:04.835637Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:20:04.837565Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:20:04.838932Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:20:04.840132Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:20:04.841891Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:20:04.843665Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:20:04.861729Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:20:04.862143Z - job completed in 2.41 seconds (60cf204bc6af449932c173b78b5681827dfcbeb248d6859b3be77a36341e7db9)
2022-09-28T09:20:04.970781Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0410"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3f6a177c859f5c74234eb2d918ca87e97f357088b865c1cb1d0fee071207697c)
2022-09-28T09:20:06.465958Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:20:06.482075Z - running sql script pg/insert_tenders.sql
2022-09-28T09:20:06.482137Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:20:06.486428Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:20:06.487652Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:20:06.491627Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:20:06.495620Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:20:06.500158Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:20:06.501105Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:20:06.540732Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:20:06.568401Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:20:06.572355Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:20:06.573774Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:20:06.574997Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:20:06.576186Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:20:06.577373Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:20:06.579001Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:20:06.580819Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:20:06.582440Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:20:06.582992Z - job completed in 1.61 seconds (3f6a177c859f5c74234eb2d918ca87e97f357088b865c1cb1d0fee071207697c)
2022-09-28T09:22:01.962259Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0412"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1bce5a8739bbcaa0b5700747d6a956da8495b2753f7189e06db358392978a9a6)
2022-09-28T09:22:02.901655Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:22:02.921539Z - running sql script pg/insert_tenders.sql
2022-09-28T09:22:02.921578Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:22:02.926349Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:22:02.927909Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:22:02.933645Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:22:02.942227Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:22:02.951967Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:22:02.953328Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:22:02.993016Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:22:03.019953Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:22:03.023863Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:22:03.025638Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:22:03.027076Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:22:03.028632Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:22:03.029794Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:22:03.031751Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:22:03.033549Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:22:03.037001Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:22:03.037255Z - job completed in 1.08 seconds (1bce5a8739bbcaa0b5700747d6a956da8495b2753f7189e06db358392978a9a6)
2022-09-28T09:22:03.079257Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0412"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4eef963ad66874ea8f98d13c2fffd01aa41b02bcaffa45370ad22b4ebb3487df)
2022-09-28T09:22:05.005327Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:22:05.023782Z - running sql script pg/upsert_orders.sql
2022-09-28T09:22:05.023824Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:22:05.027994Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:22:05.029317Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:22:05.030299Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:22:05.031185Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:22:05.032266Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:22:05.033398Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:22:05.034263Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:22:05.035103Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:22:05.036905Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:22:05.038989Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:22:05.040532Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:22:05.041840Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:22:05.043700Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:22:05.045374Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:22:05.049296Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:22:05.049809Z - job completed in 1.97 seconds (4eef963ad66874ea8f98d13c2fffd01aa41b02bcaffa45370ad22b4ebb3487df)
2022-09-28T09:24:01.871333Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0414"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8674b6e0c14e9f6ef3b71b865fe123350b3649893156a313d07517c4de83f0c3)
2022-09-28T09:24:03.203310Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:24:03.222866Z - running sql script pg/insert_tenders.sql
2022-09-28T09:24:03.222899Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:24:03.227790Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:24:03.229898Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:24:03.234244Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:24:03.238035Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:24:03.243489Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:24:03.244546Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:24:03.287280Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:24:03.335211Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:24:03.340286Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:24:03.342847Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:24:03.344738Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:24:03.346289Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:24:03.347758Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:24:03.350163Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:24:03.353394Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:24:03.355183Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:24:03.355768Z - job completed in 1.48 seconds (8674b6e0c14e9f6ef3b71b865fe123350b3649893156a313d07517c4de83f0c3)
2022-09-28T09:24:03.404812Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0414"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f57e5199b89c382fffa8735d25399fd34e7b7b86262aa1378e2376eadf4ff61e)
2022-09-28T09:24:06.011196Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:24:06.027830Z - running sql script pg/upsert_orders.sql
2022-09-28T09:24:06.027875Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:24:06.032563Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:24:06.033881Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:24:06.034800Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:24:06.035747Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:24:06.036893Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:24:06.038020Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:24:06.038875Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:24:06.040205Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:24:06.041965Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:24:06.044005Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:24:06.045382Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:24:06.046165Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:24:06.047785Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:24:06.049516Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:24:06.053481Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:24:06.053942Z - job completed in 2.65 seconds (f57e5199b89c382fffa8735d25399fd34e7b7b86262aa1378e2376eadf4ff61e)
2022-09-28T09:26:01.995729Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0416"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b6e6f105702593d8cba28eeb938c6a52e8d339e4fe277123b177f7f6e8018e25)
2022-09-28T09:26:04.021478Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:26:04.040238Z - running sql script pg/upsert_orders.sql
2022-09-28T09:26:04.040284Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:26:04.046413Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:26:04.047736Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:26:04.048572Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:26:04.049448Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:26:04.050690Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:26:04.051935Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:26:04.052897Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:26:04.053787Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:26:04.055611Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:26:04.057642Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:26:04.060344Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:26:04.061368Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:26:04.063284Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:26:04.065034Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:26:04.069588Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:26:04.070058Z - job completed in 2.08 seconds (b6e6f105702593d8cba28eeb938c6a52e8d339e4fe277123b177f7f6e8018e25)
2022-09-28T09:26:04.181678Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0416"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (498aadbdcab6cc84b958d50a7b6b3fab79849533f37bb854f18cd8ea22fef777)
2022-09-28T09:26:05.380397Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:26:05.397582Z - running sql script pg/insert_tenders.sql
2022-09-28T09:26:05.397617Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:26:05.402590Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:26:05.403785Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:26:05.407663Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:26:05.411418Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:26:05.416367Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:26:05.417378Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:26:05.464104Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:26:05.508375Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:26:05.512854Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:26:05.514498Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:26:05.715447Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:26:05.799791Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:26:05.805612Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:26:05.895319Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:26:06.069985Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:26:06.072290Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:26:06.073026Z - job completed in 1.89 seconds (498aadbdcab6cc84b958d50a7b6b3fab79849533f37bb854f18cd8ea22fef777)
2022-09-28T09:28:02.082969Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0418"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ce9f7270e2e082d65a538e0b4e79c7f91777d759ad0494cb3e374488e0cd96c5)
2022-09-28T09:28:03.432721Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:28:03.459061Z - running sql script pg/insert_tenders.sql
2022-09-28T09:28:03.459101Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:28:03.463650Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:28:03.465245Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:28:03.470304Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:28:03.474532Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:28:03.479485Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:28:03.480725Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:28:03.528602Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:28:03.550874Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:28:03.554931Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:28:03.556361Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:28:03.751673Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:28:03.831496Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:28:03.836030Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:28:03.922508Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:28:04.117498Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:28:04.119509Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:28:04.120111Z - job completed in 2.04 seconds (ce9f7270e2e082d65a538e0b4e79c7f91777d759ad0494cb3e374488e0cd96c5)
2022-09-28T09:28:04.205142Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0418"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6acbaebca76ae9c617dea0fcac82a72388244475fa3fa77ffbebe3f2ceaeca88)
2022-09-28T09:28:06.588229Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:28:06.616567Z - running sql script pg/upsert_orders.sql
2022-09-28T09:28:06.616668Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:28:06.621528Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:28:06.631610Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:28:06.633378Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:28:06.634716Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:28:06.636763Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:28:06.638567Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:28:06.639915Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:28:06.641050Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:28:06.643050Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:28:06.645286Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:28:06.646794Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:28:06.647608Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:28:06.650640Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:28:06.652591Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:28:06.656562Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:28:06.657488Z - job completed in 2.45 seconds (6acbaebca76ae9c617dea0fcac82a72388244475fa3fa77ffbebe3f2ceaeca88)
2022-09-28T09:28:06.777685Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0408"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (e50eaf8a255e4b8b5c7f911c4a983afc5a2025eae3fa2e2f5bf7f0e3223a6558)
2022-09-28T09:28:12.513836Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:28:12.541317Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T09:28:12.541668Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:28:12.546382Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T09:28:12.548580Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T09:28:12.550048Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T09:28:12.551125Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T09:28:12.553006Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T09:28:12.554797Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T09:28:12.556271Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:28:12.557387Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T09:28:12.559245Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T09:28:12.561221Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T09:28:12.563275Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T09:28:12.564913Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T09:28:12.568463Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T09:28:12.571038Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T09:28:12.572950Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T09:28:12.579352Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T09:28:12.703966Z - called http://score/api/keyed and received back 204
2022-09-28T09:28:12.704069Z - job completed in 5.93 seconds (e50eaf8a255e4b8b5c7f911c4a983afc5a2025eae3fa2e2f5bf7f0e3223a6558)
2022-09-28T09:30:02.029210Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0420"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9ed5cdb823a0032d5e996452c4d4c9e6366cad9318a76ac6c6a7768fa57dde47)
2022-09-28T09:30:03.511970Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:30:03.607259Z - running sql script pg/insert_tenders.sql
2022-09-28T09:30:03.607834Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:30:03.621176Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:30:03.626398Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:30:03.639715Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:30:03.644082Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:30:03.648938Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:30:03.650511Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:30:03.699617Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:30:03.724502Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:30:03.729335Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:30:03.732528Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:30:03.931692Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:30:04.012749Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:30:04.017889Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:30:04.132670Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:30:04.309171Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:30:04.311309Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:30:04.311947Z - job completed in 2.28 seconds (9ed5cdb823a0032d5e996452c4d4c9e6366cad9318a76ac6c6a7768fa57dde47)
2022-09-28T09:30:04.386346Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0420"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0d99e1d0331c65a704f41e948bdb60203f93c9508b5da5562096de3995cf6df8)
2022-09-28T09:30:06.522501Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:30:06.541582Z - running sql script pg/upsert_orders.sql
2022-09-28T09:30:06.541867Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:30:06.547077Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:30:06.548519Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:30:06.549628Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:30:06.550921Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:30:06.553519Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:30:06.555195Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:30:06.556391Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:30:06.557525Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:30:06.559595Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:30:06.561765Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:30:06.563619Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:30:06.566040Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:30:06.567826Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:30:06.569996Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:30:06.574222Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:30:06.574815Z - job completed in 2.19 seconds (0d99e1d0331c65a704f41e948bdb60203f93c9508b5da5562096de3995cf6df8)
2022-09-28T09:32:01.898266Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0422"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c6097cbb6a10d43f29fdcaa9ca9a4d41c9a30a1c06b35c9427d9747716582262)
2022-09-28T09:32:03.335506Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:32:03.354207Z - running sql script pg/insert_tenders.sql
2022-09-28T09:32:03.354255Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:32:03.359199Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:32:03.360637Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:32:03.365212Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:32:03.369567Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:32:03.374943Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:32:03.376783Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:32:03.424890Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:32:03.460190Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:32:03.465594Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:32:03.467168Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:32:03.665245Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:32:03.745249Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:32:03.750006Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:32:03.843647Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:32:04.035157Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:32:04.038410Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:32:04.038748Z - job completed in 2.14 seconds (c6097cbb6a10d43f29fdcaa9ca9a4d41c9a30a1c06b35c9427d9747716582262)
2022-09-28T09:32:04.112037Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0422"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0987dcc8a4f839703922f3df865de896024d65f5d53bfcf3da8338e5ad63baf5)
2022-09-28T09:32:06.236465Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:32:06.252644Z - running sql script pg/upsert_orders.sql
2022-09-28T09:32:06.252685Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:32:06.257665Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:32:06.259020Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:32:06.260052Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:32:06.260824Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:32:06.262038Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:32:06.263218Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:32:06.264065Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:32:06.265070Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:32:06.266785Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:32:06.268760Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:32:06.270137Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:32:06.270957Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:32:06.272569Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:32:06.274288Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:32:06.278287Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:32:06.278601Z - job completed in 2.17 seconds (0987dcc8a4f839703922f3df865de896024d65f5d53bfcf3da8338e5ad63baf5)
2022-09-28T09:34:01.900452Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0424"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2513cf042e11f70df79a34e25f0dfa4986d9c646adfc282ad26860e2dc3b21b5)
2022-09-28T09:34:03.939664Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:34:03.956307Z - running sql script pg/upsert_orders.sql
2022-09-28T09:34:03.956339Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:34:03.961352Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:34:03.962959Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:34:03.963938Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:34:03.965052Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:34:03.966362Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:34:03.967651Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:34:03.968595Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:34:03.969487Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:34:03.971496Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:34:03.973682Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:34:03.975311Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:34:03.976120Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:34:03.977832Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:34:03.980336Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:34:03.984566Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:34:03.985022Z - job completed in 2.08 seconds (2513cf042e11f70df79a34e25f0dfa4986d9c646adfc282ad26860e2dc3b21b5)
2022-09-28T09:34:04.027638Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0424"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d56e71bf883ce2048877002b1bca98b2aaff88413e555fe852658aec15d82feb)
2022-09-28T09:34:05.210559Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:34:05.230341Z - running sql script pg/insert_tenders.sql
2022-09-28T09:34:05.230417Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:34:05.235286Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:34:05.236666Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:34:05.240565Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:34:05.244730Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:34:05.252839Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:34:05.253975Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:34:05.297353Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:34:05.319216Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:34:05.324082Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:34:05.326429Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:34:05.329319Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:34:05.330622Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:34:05.332203Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:34:05.334865Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:34:05.337021Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:34:05.339309Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:34:05.340255Z - job completed in 1.31 seconds (d56e71bf883ce2048877002b1bca98b2aaff88413e555fe852658aec15d82feb)
2022-09-28T09:36:02.056999Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0426"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e39d66fbe980502190ac11b69b0e9ba5844bd1a93b33b2a52893bd6bd7dc55dc)
2022-09-28T09:36:04.078013Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:36:04.098682Z - running sql script pg/upsert_orders.sql
2022-09-28T09:36:04.098722Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:36:04.103617Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:36:04.105097Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:36:04.106527Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:36:04.108021Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:36:04.109784Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:36:04.111831Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:36:04.113114Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:36:04.114547Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:36:04.116392Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:36:04.118701Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:36:04.120237Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:36:04.121647Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:36:04.123986Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:36:04.125752Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:36:04.130561Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:36:04.130973Z - job completed in 2.07 seconds (e39d66fbe980502190ac11b69b0e9ba5844bd1a93b33b2a52893bd6bd7dc55dc)
2022-09-28T09:36:04.258783Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0426"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dea5c83ea09e16d04051e3771281a85beaf6bde3d5b9294284556fb4ec4c7ed8)
2022-09-28T09:36:05.438272Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:36:05.458694Z - running sql script pg/insert_tenders.sql
2022-09-28T09:36:05.458733Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:36:05.464091Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:36:05.465270Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:36:05.469541Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:36:05.473630Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:36:05.478490Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:36:05.479474Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:36:05.524615Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:36:05.532844Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:36:05.536953Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:36:05.538804Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:36:05.733271Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:36:05.815694Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:36:05.846556Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:36:05.934765Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:36:06.110046Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:36:06.112388Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:36:06.113294Z - job completed in 1.85 seconds (dea5c83ea09e16d04051e3771281a85beaf6bde3d5b9294284556fb4ec4c7ed8)
2022-09-28T09:38:02.106258Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0418"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (153845b179cdaa29f2f0ba39f3b39634db6fff4babcc7f3b88421fa1aaa2ace0)
2022-09-28T09:38:07.530518Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:38:07.548278Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T09:38:07.548324Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:38:07.553447Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T09:38:07.555332Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T09:38:07.556355Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T09:38:07.557487Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T09:38:07.559032Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T09:38:07.560423Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T09:38:07.561799Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:38:07.562937Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T09:38:07.563787Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T09:38:07.565915Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T09:38:07.568187Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T09:38:07.570125Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T09:38:07.573308Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T09:38:07.574278Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T09:38:07.575473Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T09:38:07.577069Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T09:38:07.652648Z - called http://score/api/keyed and received back 204
2022-09-28T09:38:07.652904Z - job completed in 5.55 seconds (153845b179cdaa29f2f0ba39f3b39634db6fff4babcc7f3b88421fa1aaa2ace0)
2022-09-28T09:38:07.702369Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0428"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (39f89ae3563323f3e276a654b96a5d887e1e54bb9095863bf14289c3c29c3211)
2022-09-28T09:38:08.767979Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:38:08.784349Z - running sql script pg/insert_tenders.sql
2022-09-28T09:38:08.784393Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:38:08.790059Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:38:08.791426Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:38:08.795691Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:38:08.800100Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:38:08.804505Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:38:08.805850Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:38:08.852368Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:38:08.860419Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:38:08.864295Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:38:08.865776Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:38:09.061003Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:38:09.141152Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:38:09.146756Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:38:09.234024Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:38:09.415992Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:38:09.417861Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:38:09.418397Z - job completed in 1.72 seconds (39f89ae3563323f3e276a654b96a5d887e1e54bb9095863bf14289c3c29c3211)
2022-09-28T09:38:09.502246Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0428"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (42e0ddd7f4d71c2ec59b009ab9adda118903da3493108bf18934f0a0d4d1b633)
2022-09-28T09:38:11.607326Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:38:11.624885Z - running sql script pg/upsert_orders.sql
2022-09-28T09:38:11.624930Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:38:11.629940Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:38:11.631375Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:38:11.632489Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:38:11.633505Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:38:11.634764Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:38:11.636116Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:38:11.637057Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:38:11.638016Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:38:11.639824Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:38:11.642207Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:38:11.643716Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:38:11.644839Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:38:11.646903Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:38:11.648780Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:38:11.652836Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:38:11.653185Z - job completed in 2.15 seconds (42e0ddd7f4d71c2ec59b009ab9adda118903da3493108bf18934f0a0d4d1b633)
2022-09-28T09:40:02.450660Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0430"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (02f79c85dddf7397fcfce44623c52ef783b65b7b0849bc06eb2447d6797cd445)
2022-09-28T09:40:03.969737Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:40:03.988932Z - running sql script pg/insert_tenders.sql
2022-09-28T09:40:03.988983Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:40:03.994375Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:40:03.995657Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:40:03.999401Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:40:04.003843Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:40:04.008336Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:40:04.009874Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:40:04.056353Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:40:04.069726Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:40:04.074106Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:40:04.075881Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:40:04.275071Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:40:04.413327Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:40:04.418303Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:40:04.510269Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:40:04.692470Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:40:04.694289Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:40:04.694787Z - job completed in 2.24 seconds (02f79c85dddf7397fcfce44623c52ef783b65b7b0849bc06eb2447d6797cd445)
2022-09-28T09:40:04.723266Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0430"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (787b753ebed9210a756ec3121651cb7f5460b7bf26140ef746b123779e72eb23)
2022-09-28T09:40:06.969025Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:40:06.994238Z - running sql script pg/upsert_orders.sql
2022-09-28T09:40:06.994271Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:40:06.998696Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:40:07.002568Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:40:07.004041Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:40:07.005240Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:40:07.006360Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:40:07.007871Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:40:07.010113Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:40:07.011611Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:40:07.013884Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:40:07.016486Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:40:07.018720Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:40:07.019810Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:40:07.021678Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:40:07.025326Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:40:07.029654Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:40:07.030217Z - job completed in 2.31 seconds (787b753ebed9210a756ec3121651cb7f5460b7bf26140ef746b123779e72eb23)
2022-09-28T09:42:01.928875Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0432"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f5935a39d90ad8574609850a2e600505a3a74e3561d67cdac2441c246c06e00a)
2022-09-28T09:42:04.075615Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:42:04.100077Z - running sql script pg/upsert_orders.sql
2022-09-28T09:42:04.100187Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:42:04.104739Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:42:04.108604Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:42:04.109669Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:42:04.113410Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:42:04.114832Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:42:04.118669Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:42:04.119571Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:42:04.120477Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:42:04.126412Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:42:04.137745Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:42:04.139484Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:42:04.140743Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:42:04.147672Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:42:04.210757Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:42:04.221631Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:42:04.222229Z - job completed in 2.29 seconds (f5935a39d90ad8574609850a2e600505a3a74e3561d67cdac2441c246c06e00a)
2022-09-28T09:42:04.303645Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0432"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f9fc3a4fa74a9e31b299c701e6abddf5047ad03c03a7c25a890cf3468cda5e78)
2022-09-28T09:42:05.600949Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:42:05.620094Z - running sql script pg/insert_tenders.sql
2022-09-28T09:42:05.620787Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:42:05.625580Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:42:05.627119Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:42:05.631219Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:42:05.635015Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:42:05.639826Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:42:05.641236Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:42:05.687251Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:42:05.695565Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:42:05.699081Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:42:05.700931Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:42:05.742226Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:42:05.761119Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:42:05.766521Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:42:05.983221Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:42:06.156412Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:42:06.161433Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:42:06.161992Z - job completed in 1.86 seconds (f9fc3a4fa74a9e31b299c701e6abddf5047ad03c03a7c25a890cf3468cda5e78)
2022-09-28T09:44:01.945889Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0434"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a949c7266b84cfba72e84f14f3a7c2148aa9b114f050ab7cb8be4c66a22ff5f2)
2022-09-28T09:44:03.252496Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:44:03.285737Z - running sql script pg/insert_tenders.sql
2022-09-28T09:44:03.285802Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:44:03.290710Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:44:03.292108Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:44:03.295968Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:44:03.300600Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:44:03.305719Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:44:03.306769Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:44:03.353544Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:44:03.362026Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:44:03.367470Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:44:03.368816Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:44:03.411645Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:44:03.431356Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:44:03.436656Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:44:03.656924Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:44:03.822618Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:44:03.828727Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:44:03.829284Z - job completed in 1.88 seconds (a949c7266b84cfba72e84f14f3a7c2148aa9b114f050ab7cb8be4c66a22ff5f2)
2022-09-28T09:44:03.902233Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0434"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9e804ccf3090fed941fca8bf3f83d5296d97247383bf21b667e568f61a6ee2a8)
2022-09-28T09:44:06.144551Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:44:06.164539Z - running sql script pg/upsert_orders.sql
2022-09-28T09:44:06.164589Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:44:06.170085Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:44:06.175510Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:44:06.176696Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:44:06.181335Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:44:06.183397Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:44:06.189454Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:44:06.191066Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:44:06.192553Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:44:06.199027Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:44:06.210087Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:44:06.211696Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:44:06.213136Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:44:06.218588Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:44:06.278833Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:44:06.286829Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:44:06.287245Z - job completed in 2.39 seconds (9e804ccf3090fed941fca8bf3f83d5296d97247383bf21b667e568f61a6ee2a8)
2022-09-28T09:46:02.046904Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0436"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7f4a40afa55178b7633a4d1f54ef90fe48ce1881482e475f49d71914d42b5f5e)
2022-09-28T09:46:03.991572Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:46:04.011524Z - running sql script pg/upsert_orders.sql
2022-09-28T09:46:04.011605Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:46:04.017748Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:46:04.022111Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:46:04.023043Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:46:04.026961Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:46:04.028487Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:46:04.032815Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:46:04.033660Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:46:04.034522Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:46:04.040170Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:46:04.051356Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:46:04.052848Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:46:04.053669Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:46:04.060021Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:46:04.119413Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:46:04.126974Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:46:04.128149Z - job completed in 2.08 seconds (7f4a40afa55178b7633a4d1f54ef90fe48ce1881482e475f49d71914d42b5f5e)
2022-09-28T09:46:04.187475Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0436"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e21a4930512b308599202f6be5642246019dc139e766769bfb1fce996adec419)
2022-09-28T09:46:05.288455Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:46:05.304661Z - running sql script pg/insert_tenders.sql
2022-09-28T09:46:05.304711Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:46:05.309453Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:46:05.310903Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:46:05.314538Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:46:05.321287Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:46:05.326632Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:46:05.327716Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:46:05.373606Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:46:05.381640Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:46:05.389147Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:46:05.391363Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:46:05.432475Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:46:05.450781Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:46:05.456619Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:46:05.691237Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:46:05.859331Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:46:05.864367Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:46:05.865277Z - job completed in 1.68 seconds (e21a4930512b308599202f6be5642246019dc139e766769bfb1fce996adec419)
2022-09-28T09:48:02.146752Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0438"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e7f81d88540a4edb537823f4a6e4d296058b55d4a7292fe1eb7c17c7d2cfa07f)
2022-09-28T09:48:03.762702Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:48:03.780673Z - running sql script pg/upsert_orders.sql
2022-09-28T09:48:03.780728Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:48:03.785548Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:48:03.789862Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:48:03.790980Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:48:03.794596Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:48:03.796210Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:48:03.800738Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:48:03.801869Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:48:03.802735Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:48:03.809404Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:48:03.820638Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:48:03.822339Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:48:03.823370Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:48:03.829514Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:48:03.892520Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:48:03.899214Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:48:03.899725Z - job completed in 1.75 seconds (e7f81d88540a4edb537823f4a6e4d296058b55d4a7292fe1eb7c17c7d2cfa07f)
2022-09-28T09:48:03.971896Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0438"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8e78c1f51de471e7338dfb4767b017b0ceb017823899ca2a1dd9b89a4e0c3637)
2022-09-28T09:48:05.306635Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:48:05.324399Z - running sql script pg/insert_tenders.sql
2022-09-28T09:48:05.324434Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:48:05.329317Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:48:05.331178Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:48:05.336131Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:48:05.340747Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:48:05.345906Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:48:05.346961Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:48:05.392576Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:48:05.400751Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:48:05.404706Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:48:05.406082Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:48:05.446938Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:48:05.465529Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:48:05.470885Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:48:05.709841Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:48:05.885460Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:48:05.890512Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:48:05.891024Z - job completed in 1.92 seconds (8e78c1f51de471e7338dfb4767b017b0ceb017823899ca2a1dd9b89a4e0c3637)
2022-09-28T09:48:05.973236Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0428"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (fde2a43ff63226f405ec525ae6b8b8a0a4fe18d3f23699f502f2c5eed64f623a)
2022-09-28T09:48:10.656213Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:48:10.672942Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T09:48:10.672980Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:48:10.677309Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T09:48:10.678971Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T09:48:10.679923Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T09:48:10.681213Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T09:48:10.682227Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T09:48:10.683746Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T09:48:10.685021Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:48:10.686243Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T09:48:10.687438Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T09:48:10.689067Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T09:48:10.690932Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T09:48:10.692153Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T09:48:10.694895Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T09:48:10.696130Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T09:48:10.697141Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T09:48:10.698702Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T09:48:10.778244Z - called http://score/api/keyed and received back 204
2022-09-28T09:48:10.778330Z - job completed in 4.81 seconds (fde2a43ff63226f405ec525ae6b8b8a0a4fe18d3f23699f502f2c5eed64f623a)
2022-09-28T09:50:02.135936Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0440"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a6be66f796559a472055de4712437e3923229eac3949dda88be3714792d23880)
2022-09-28T09:50:06.526444Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:50:06.542649Z - running sql script pg/insert_tenders.sql
2022-09-28T09:50:06.542695Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:50:06.547244Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:50:06.548491Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:50:06.554448Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:50:06.558256Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:50:06.562926Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:50:06.563839Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:50:06.610824Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:50:06.612473Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:50:06.613264Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:50:06.614611Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:50:06.655827Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:50:06.674540Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:50:06.679140Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:50:06.897977Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:50:07.071906Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:50:07.077100Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:50:07.077496Z - job completed in 4.94 seconds (a6be66f796559a472055de4712437e3923229eac3949dda88be3714792d23880)
2022-09-28T09:50:07.196900Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0440"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6da257c61442fc2af3485b9545f20c3dc4c1a9095210d5030b549487c4dc037f)
2022-09-28T09:50:09.659516Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:50:09.676565Z - running sql script pg/upsert_orders.sql
2022-09-28T09:50:09.676610Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:50:09.681344Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:50:09.686308Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:50:09.687394Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:50:09.691287Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:50:09.692621Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:50:09.697051Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:50:09.698027Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:50:09.698957Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:50:09.705330Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:50:09.716491Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:50:09.718133Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:50:09.719031Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:50:09.724282Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:50:09.784258Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:50:09.791789Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:50:09.792300Z - job completed in 2.60 seconds (6da257c61442fc2af3485b9545f20c3dc4c1a9095210d5030b549487c4dc037f)
2022-09-28T09:52:02.127006Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0442"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (03451fc0f57cfc021fece6cd001499d4f0de3de95d1a077f220a0692036f0750)
2022-09-28T09:52:04.452624Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:52:04.469255Z - running sql script pg/upsert_orders.sql
2022-09-28T09:52:04.469283Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:52:04.473994Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:52:04.475844Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:52:04.476823Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:52:04.477905Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:52:04.479266Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:52:04.480666Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:52:04.481831Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:52:04.482814Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:52:04.484768Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:52:04.486855Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:52:04.488405Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:52:04.489378Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:52:04.491052Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:52:04.492791Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:52:04.496792Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:52:04.497151Z - job completed in 2.37 seconds (03451fc0f57cfc021fece6cd001499d4f0de3de95d1a077f220a0692036f0750)
2022-09-28T09:52:04.535962Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0442"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dc353c0ac1c7b73ee5ae714afd8988b22cb04c7b6600377157e72b5fabbd7efb)
2022-09-28T09:52:05.696381Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:52:05.736816Z - running sql script pg/insert_tenders.sql
2022-09-28T09:52:05.736855Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:52:05.741490Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:52:05.744237Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:52:05.745291Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:52:05.746168Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:52:05.749325Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:52:05.750955Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:52:05.753319Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:52:05.755040Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:52:05.756067Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:52:05.757483Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:52:05.759371Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:52:05.760650Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:52:05.761942Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:52:05.763861Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:52:05.765657Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:52:05.767609Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:52:05.768210Z - job completed in 1.23 seconds (dc353c0ac1c7b73ee5ae714afd8988b22cb04c7b6600377157e72b5fabbd7efb)
2022-09-28T09:54:01.962129Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0444"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (88fe8355c6cdada7d42605e0bb9e240e4f8030bc879eb33add3cea789efbccd5)
2022-09-28T09:54:03.108125Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:54:03.127329Z - running sql script pg/insert_tenders.sql
2022-09-28T09:54:03.127363Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:54:03.132097Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:54:03.133713Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:54:03.134845Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:54:03.136374Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:54:03.138626Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:54:03.140552Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:54:03.143117Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:54:03.144815Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:54:03.145936Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:54:03.147384Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:54:03.149006Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:54:03.150290Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:54:03.151652Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:54:03.153327Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:54:03.155619Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:54:03.157856Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:54:03.158355Z - job completed in 1.20 seconds (88fe8355c6cdada7d42605e0bb9e240e4f8030bc879eb33add3cea789efbccd5)
2022-09-28T09:54:03.286955Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0444"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6083d22cddcbdd2af137ff6d96ef75f836ad596909439416c816a2313215e11a)
2022-09-28T09:54:05.419691Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:54:05.436242Z - running sql script pg/upsert_orders.sql
2022-09-28T09:54:05.436271Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:54:05.441287Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:54:05.442642Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:54:05.443749Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:54:05.444712Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:54:05.445733Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:54:05.446946Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:54:05.447996Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:54:05.449592Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:54:05.451627Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:54:05.453803Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:54:05.455437Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:54:05.456415Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:54:05.458170Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:54:05.460298Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:54:05.464198Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:54:05.464549Z - job completed in 2.18 seconds (6083d22cddcbdd2af137ff6d96ef75f836ad596909439416c816a2313215e11a)
2022-09-28T09:56:01.843912Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0446"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a52a333c89d27bd6fc20b5bfb407c9af1fd6b5da580e6b4ab998b952a47f8065)
2022-09-28T09:56:03.927920Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:56:03.944892Z - running sql script pg/upsert_orders.sql
2022-09-28T09:56:03.944920Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:56:03.950056Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:56:03.951459Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:56:03.952388Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:56:03.953191Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:56:03.954336Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:56:03.955760Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:56:03.956735Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:56:03.957560Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:56:03.959843Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:56:03.961960Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:56:03.963480Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:56:03.964501Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:56:03.966093Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:56:03.967812Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:56:03.971649Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:56:03.972086Z - job completed in 2.13 seconds (a52a333c89d27bd6fc20b5bfb407c9af1fd6b5da580e6b4ab998b952a47f8065)
2022-09-28T09:56:03.995448Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0446"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c022da0f95f1b228f009e46cf9edf5a7c1e05312cf016af34e5cbf59713df9c0)
2022-09-28T09:56:05.345653Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:56:05.409313Z - running sql script pg/insert_tenders.sql
2022-09-28T09:56:05.409361Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:56:05.415325Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:56:05.416772Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:56:05.418610Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:56:05.420253Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:56:05.422019Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:56:05.423446Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:56:05.426841Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:56:05.430384Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:56:05.431736Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:56:05.433820Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:56:05.435636Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:56:05.436917Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:56:05.438289Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:56:05.440685Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:56:05.442420Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:56:05.447598Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:56:05.447931Z - job completed in 1.45 seconds (c022da0f95f1b228f009e46cf9edf5a7c1e05312cf016af34e5cbf59713df9c0)
2022-09-28T09:58:02.035372Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0448"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (865b5239fbc30812108c2880746d68df815b45ffbd4599271e27fa15ead5013f)
2022-09-28T09:58:04.800145Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:58:04.817271Z - running sql script pg/upsert_orders.sql
2022-09-28T09:58:04.817316Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:58:04.821870Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T09:58:04.823262Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T09:58:04.824323Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T09:58:04.825331Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T09:58:04.826504Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T09:58:04.827671Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:58:04.828866Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T09:58:04.829815Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T09:58:04.831526Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T09:58:04.833613Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T09:58:04.835233Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T09:58:04.836269Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T09:58:04.838299Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T09:58:04.840293Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T09:58:04.844300Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T09:58:04.844763Z - job completed in 2.81 seconds (865b5239fbc30812108c2880746d68df815b45ffbd4599271e27fa15ead5013f)
2022-09-28T09:58:04.916616Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0438"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (7c7b32a1bd2d8f7625cc07ac700be7d533c890afa9920f43782e8a99067a1326)
2022-09-28T09:58:09.746551Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:58:09.764518Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T09:58:09.764551Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T09:58:09.769218Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T09:58:09.770761Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T09:58:09.771620Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T09:58:09.772430Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T09:58:09.773291Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T09:58:09.774439Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T09:58:09.775234Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T09:58:09.775996Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T09:58:09.776800Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T09:58:09.778654Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T09:58:09.779986Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T09:58:09.781120Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T09:58:09.783478Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T09:58:09.784400Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T09:58:09.785461Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T09:58:09.787009Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T09:58:09.864973Z - called http://score/api/keyed and received back 204
2022-09-28T09:58:09.865065Z - job completed in 4.95 seconds (7c7b32a1bd2d8f7625cc07ac700be7d533c890afa9920f43782e8a99067a1326)
2022-09-28T09:58:09.900079Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0448"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (38dd3d7cb36ab362ffb62004d3fb87a7bc2a4bb21671f51f8ec370764c930ff9)
2022-09-28T09:58:11.169161Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T09:58:11.185747Z - running sql script pg/insert_tenders.sql
2022-09-28T09:58:11.185781Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T09:58:11.190314Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T09:58:11.191728Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T09:58:11.192747Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T09:58:11.193632Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T09:58:11.195041Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T09:58:11.196155Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T09:58:11.198270Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T09:58:11.199696Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T09:58:11.200696Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T09:58:11.201977Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T09:58:11.203226Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T09:58:11.205913Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T09:58:11.207141Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T09:58:11.208839Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T09:58:11.210464Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T09:58:11.211854Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T09:58:11.212423Z - job completed in 1.31 seconds (38dd3d7cb36ab362ffb62004d3fb87a7bc2a4bb21671f51f8ec370764c930ff9)
2022-09-28T10:00:02.550073Z - received message {"source":{"kind":"csv","connectionName":"azure_blob.conf","path":"wasbs://data-science@stfsci01${environment}.blob.core.windows.net/demand-forecasting/forecast-outputs/${forecastDate}","pathParameters":{"forecastDate":"2022-09-28"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_prediction_v2"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_forecast_rows_v2.sql","queryParameters":{"forecastDate":"2022-09-28"}}}]} (0802a0a15393abd1bf73a50303ac9f78d43a98a1a236156dab9e0ee84d60aae2)
2022-09-28T10:00:06.634971Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:00:06.660185Z - running sql script pg/insert_forecast_rows_v2.sql
2022-09-28T10:00:06.660841Z - (statement 1 of 6) - -- Add new column to hold contract rate. ALTER TAB
2022-09-28T10:00:06.665654Z - (statement 2 of 6) -  -- Update rates on awarded lanes. UPDATE stage.ra
2022-09-28T10:00:06.865132Z - (statement 3 of 6) -  -- Update rates on non-committed freight. WITH co
2022-09-28T10:00:06.985991Z - (statement 4 of 6) -  -- insert new forecasts insert into pickup_foreca
2022-09-28T10:00:09.399633Z - (statement 5 of 6) -  -- Insert into forecast log but only if we wrote
2022-09-28T10:00:09.418652Z - (statement 6 of 6) -  -- Delete old pickup forecast records: these are
2022-09-28T10:00:09.807208Z - sql script pg/insert_forecast_rows_v2.sql ran successfully
2022-09-28T10:00:09.807983Z - job completed in 7.26 seconds (0802a0a15393abd1bf73a50303ac9f78d43a98a1a236156dab9e0ee84d60aae2)
2022-09-28T10:00:09.910367Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0450"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f457c1be3223d11e01ef379467d9ddfeaa685c3d46bd0d6842af3c552027e9ae)
2022-09-28T10:00:11.052537Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:00:11.069001Z - running sql script pg/insert_tenders.sql
2022-09-28T10:00:11.069056Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:00:11.073817Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:00:11.075138Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:00:11.076218Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:00:11.077168Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:00:11.078763Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:00:11.079693Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:00:11.081826Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:00:11.083366Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:00:11.084334Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:00:11.085972Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:00:11.087278Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:00:11.088572Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:00:11.089753Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:00:11.091614Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:00:11.093401Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:00:11.095273Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:00:11.095669Z - job completed in 1.19 seconds (f457c1be3223d11e01ef379467d9ddfeaa685c3d46bd0d6842af3c552027e9ae)
2022-09-28T10:00:11.160062Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0450"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a02b8a76c4b71e6caeebc9f50f771b99339a2fbae3ae3096af17de03feb620cc)
2022-09-28T10:00:13.525669Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:00:13.557608Z - running sql script pg/upsert_orders.sql
2022-09-28T10:00:13.557668Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:00:13.563819Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:00:13.573109Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:00:13.574666Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:00:13.578836Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:00:13.580848Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:00:13.585539Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:00:13.592012Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:00:13.593267Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:00:13.600081Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:00:13.614824Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:00:13.616604Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:00:13.617471Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:00:13.623351Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:00:13.682934Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:00:13.696323Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:00:13.697393Z - job completed in 2.54 seconds (a02b8a76c4b71e6caeebc9f50f771b99339a2fbae3ae3096af17de03feb620cc)
2022-09-28T10:02:02.320753Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0452"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6b5355f81cb05a83d36c7426b7dd49d02c2f393ef182452e83e6f43d0a8225d4)
2022-09-28T10:02:07.681448Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:02:07.700716Z - running sql script pg/upsert_orders.sql
2022-09-28T10:02:07.700852Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:02:07.706447Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:02:07.710911Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:02:07.711925Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:02:07.715905Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:02:07.717698Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:02:07.722243Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:02:07.723316Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:02:07.724277Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:02:07.733707Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:02:07.762261Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:02:07.763987Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:02:07.765129Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:02:07.775834Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:02:07.865478Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:02:07.876607Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:02:07.877237Z - job completed in 5.56 seconds (6b5355f81cb05a83d36c7426b7dd49d02c2f393ef182452e83e6f43d0a8225d4)
2022-09-28T10:02:07.971244Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0452"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (38f4ad6b4c9d613a7898f695c8762be852c50b7720251c8f2e640b691748205d)
2022-09-28T10:02:09.412578Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:02:09.432157Z - running sql script pg/insert_tenders.sql
2022-09-28T10:02:09.432448Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:02:09.438547Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:02:09.445545Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:02:09.449900Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:02:09.454449Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:02:09.459424Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:02:09.463699Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:02:09.506091Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:02:09.511775Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:02:09.517225Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:02:09.518856Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:02:09.533682Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:02:09.551682Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:02:09.557199Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:02:09.773260Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:02:09.940033Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:02:09.946219Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:02:09.946887Z - job completed in 1.98 seconds (38f4ad6b4c9d613a7898f695c8762be852c50b7720251c8f2e640b691748205d)
2022-09-28T10:04:02.012402Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0454"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e03727c7382e75fefe604002f7f3056c7be1c1278335a8042aa13ebe1d612ac6)
2022-09-28T10:04:03.288649Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:04:03.308722Z - running sql script pg/insert_tenders.sql
2022-09-28T10:04:03.308761Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:04:03.313943Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:04:03.315321Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:04:03.319406Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:04:03.324238Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:04:03.330196Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:04:03.331894Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:04:03.374794Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:04:03.377205Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:04:03.378382Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:04:03.379872Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:04:03.397002Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:04:03.407784Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:04:03.413631Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:04:03.636294Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:04:03.805303Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:04:03.810568Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:04:03.811347Z - job completed in 1.80 seconds (e03727c7382e75fefe604002f7f3056c7be1c1278335a8042aa13ebe1d612ac6)
2022-09-28T10:04:03.857502Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0454"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c23842d9e6222d2f07761fe3fae74178e2238676949e40ec378bde8a56c4d4a0)
2022-09-28T10:04:06.160841Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:04:06.177313Z - running sql script pg/upsert_orders.sql
2022-09-28T10:04:06.177349Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:04:06.183190Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:04:06.188117Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:04:06.189127Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:04:06.193165Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:04:06.194952Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:04:06.200231Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:04:06.201243Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:04:06.202391Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:04:06.208932Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:04:06.226455Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:04:06.228951Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:04:06.229929Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:04:06.235133Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:04:06.295027Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:04:06.302575Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:04:06.303082Z - job completed in 2.45 seconds (c23842d9e6222d2f07761fe3fae74178e2238676949e40ec378bde8a56c4d4a0)
2022-09-28T10:06:01.934966Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0456"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (38ceeea83d992dc93533dc738e0894c81bc7e40b67ad01b2246e024733ef077b)
2022-09-28T10:06:03.311136Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:06:03.327185Z - running sql script pg/insert_tenders.sql
2022-09-28T10:06:03.327217Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:06:03.332829Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:06:03.334483Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:06:03.338947Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:06:03.343622Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:06:03.348676Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:06:03.349765Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:06:03.393420Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:06:03.395361Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:06:03.396848Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:06:03.399087Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:06:03.415206Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:06:03.424683Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:06:03.430154Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:06:03.649314Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:06:03.819041Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:06:03.824421Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:06:03.824795Z - job completed in 1.89 seconds (38ceeea83d992dc93533dc738e0894c81bc7e40b67ad01b2246e024733ef077b)
2022-09-28T10:06:03.844127Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0456"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6808533e8a86b4710034e4be5328a00686c1762096c5c894f7538e3129c53274)
2022-09-28T10:06:06.873811Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:06:06.893163Z - running sql script pg/upsert_orders.sql
2022-09-28T10:06:06.893675Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:06:06.899051Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:06:06.904399Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:06:06.905610Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:06:06.910098Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:06:06.911643Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:06:06.916042Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:06:06.917182Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:06:06.918111Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:06:06.924140Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:06:06.942081Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:06:06.943672Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:06:06.944561Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:06:06.950398Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:06:07.021970Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:06:07.030446Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:06:07.030904Z - job completed in 3.19 seconds (6808533e8a86b4710034e4be5328a00686c1762096c5c894f7538e3129c53274)
2022-09-28T10:08:01.960934Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0458"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3104e2b2a1dd9280022dc23741156f21976d5e352469b240377795963db4369e)
2022-09-28T10:08:03.281325Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:08:03.300128Z - running sql script pg/insert_tenders.sql
2022-09-28T10:08:03.300173Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:08:03.304963Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:08:03.306713Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:08:03.311250Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:08:03.315283Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:08:03.320155Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:08:03.321778Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:08:03.364536Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:08:03.366505Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:08:03.367509Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:08:03.369261Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:08:03.384873Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:08:03.394858Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:08:03.400229Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:08:03.628218Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:08:03.798330Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:08:03.804923Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:08:03.805424Z - job completed in 1.85 seconds (3104e2b2a1dd9280022dc23741156f21976d5e352469b240377795963db4369e)
2022-09-28T10:08:03.843523Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0448"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (6559af04841b283de6d4595bfe5cde3fce971f79ded1bddeba769dc40951399f)
2022-09-28T10:08:09.653394Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:08:09.681980Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T10:08:09.682215Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:08:09.686946Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T10:08:09.688624Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T10:08:09.689784Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T10:08:09.690681Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T10:08:09.691639Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T10:08:09.692913Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T10:08:09.694023Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:08:09.694919Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T10:08:09.695972Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T10:08:09.697630Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T10:08:09.699158Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T10:08:09.700463Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T10:08:09.703097Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T10:08:09.704178Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T10:08:09.705591Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T10:08:09.707293Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T10:08:09.795670Z - called http://score/api/keyed and received back 204
2022-09-28T10:08:09.795771Z - job completed in 5.95 seconds (6559af04841b283de6d4595bfe5cde3fce971f79ded1bddeba769dc40951399f)
2022-09-28T10:08:09.830070Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0458"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (45e6ca84107988125b285f62a77c21c76818d74172fbf3c57d1aee237dd6625f)
2022-09-28T10:08:11.961417Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:08:11.978451Z - running sql script pg/upsert_orders.sql
2022-09-28T10:08:11.978486Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:08:11.983663Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:08:11.988044Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:08:11.988978Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:08:11.992945Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:08:11.994437Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:08:11.998811Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:08:12.000096Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:08:12.001126Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:08:12.007376Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:08:12.024490Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:08:12.026400Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:08:12.027667Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:08:12.035633Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:08:12.104427Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:08:12.112841Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:08:12.113454Z - job completed in 2.28 seconds (45e6ca84107988125b285f62a77c21c76818d74172fbf3c57d1aee237dd6625f)
2022-09-28T10:10:02.612940Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0500"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3236e480e38e90f60b207e645995eff59c81f44201f570fb4c4cab9a184377fa)
2022-09-28T10:10:06.038650Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:10:06.054023Z - running sql script pg/insert_tenders.sql
2022-09-28T10:10:06.054070Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:10:06.058936Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:10:06.060740Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:10:06.065361Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:10:06.069290Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:10:06.074754Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:10:06.076151Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:10:06.118790Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:10:06.120434Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:10:06.121470Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:10:06.122896Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:10:06.138848Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:10:06.147768Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:10:06.152728Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:10:06.372265Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:10:06.540755Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:10:06.546312Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:10:06.546849Z - job completed in 3.93 seconds (3236e480e38e90f60b207e645995eff59c81f44201f570fb4c4cab9a184377fa)
2022-09-28T10:10:06.657349Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0500"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (43690b2eb67cb81d2fbae76cdd5e12ec8b9a88ce626468e4e900d66601b55c77)
2022-09-28T10:10:08.739803Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:10:08.756456Z - running sql script pg/upsert_orders.sql
2022-09-28T10:10:08.756571Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:10:08.761342Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:10:08.763318Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:10:08.764315Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:10:08.765200Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:10:08.766483Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:10:08.767751Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:10:08.768589Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:10:08.769529Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:10:08.771487Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:10:08.773549Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:10:08.774972Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:10:08.775799Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:10:08.777402Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:10:08.779366Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:10:08.784201Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:10:08.784642Z - job completed in 2.13 seconds (43690b2eb67cb81d2fbae76cdd5e12ec8b9a88ce626468e4e900d66601b55c77)
2022-09-28T10:12:01.994239Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0502"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4ac1e79ee1d5c7854d83c03731e2e8428137c3c4ff91694cfe333c2938d48d23)
2022-09-28T10:12:03.603396Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:12:03.620430Z - running sql script pg/insert_tenders.sql
2022-09-28T10:12:03.620827Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:12:03.625287Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:12:03.626627Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:12:03.627649Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:12:03.628673Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:12:03.629968Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:12:03.630800Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:12:03.632885Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:12:03.634599Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:12:03.635618Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:12:03.636889Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:12:03.638379Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:12:03.640262Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:12:03.643456Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:12:03.645561Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:12:03.647464Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:12:03.649105Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:12:03.649701Z - job completed in 1.66 seconds (4ac1e79ee1d5c7854d83c03731e2e8428137c3c4ff91694cfe333c2938d48d23)
2022-09-28T10:12:03.678825Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0502"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e3f6e4e566510d4b9fa3fedde38806342694d3228d7eee9c99e065bffc122106)
2022-09-28T10:12:05.882328Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:12:05.905887Z - running sql script pg/upsert_orders.sql
2022-09-28T10:12:05.905929Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:12:05.910656Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:12:05.912088Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:12:05.913220Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:12:05.914122Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:12:05.915228Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:12:05.916358Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:12:05.917158Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:12:05.917994Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:12:05.920102Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:12:05.922032Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:12:05.924001Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:12:05.924911Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:12:05.926911Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:12:05.929034Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:12:05.933144Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:12:05.933638Z - job completed in 2.26 seconds (e3f6e4e566510d4b9fa3fedde38806342694d3228d7eee9c99e065bffc122106)
2022-09-28T10:14:02.038527Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0504"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (72298655f607c5490ced9343470d431bb0695af78b0b43d5d5b2d9a0ba7e2efd)
2022-09-28T10:14:03.977863Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:14:03.995328Z - running sql script pg/insert_tenders.sql
2022-09-28T10:14:03.995364Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:14:04.000443Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:14:04.001794Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:14:04.002895Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:14:04.003925Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:14:04.005250Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:14:04.006225Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:14:04.008365Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:14:04.009957Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:14:04.010861Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:14:04.013549Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:14:04.014975Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:14:04.016226Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:14:04.019429Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:14:04.021491Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:14:04.023518Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:14:04.025049Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:14:04.025502Z - job completed in 1.99 seconds (72298655f607c5490ced9343470d431bb0695af78b0b43d5d5b2d9a0ba7e2efd)
2022-09-28T10:14:04.079253Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0504"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (404590ee1bd8a527ea9503e4c2baba6efa3a1627be35916beb945f3df4efa16c)
2022-09-28T10:14:06.307280Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:14:06.324346Z - running sql script pg/upsert_orders.sql
2022-09-28T10:14:06.324389Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:14:06.328894Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:14:06.330312Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:14:06.331215Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:14:06.332127Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:14:06.333294Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:14:06.334522Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:14:06.335411Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:14:06.336241Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:14:06.338300Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:14:06.340283Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:14:06.341776Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:14:06.342705Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:14:06.344416Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:14:06.346053Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:14:06.349878Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:14:06.350379Z - job completed in 2.27 seconds (404590ee1bd8a527ea9503e4c2baba6efa3a1627be35916beb945f3df4efa16c)
2022-09-28T10:16:02.002482Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0506"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b27f778a1dfea141a3949f708b36f5512aa3f1127ddab92df2c6d48bdc86f695)
2022-09-28T10:16:03.398443Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:16:03.418413Z - running sql script pg/insert_tenders.sql
2022-09-28T10:16:03.418448Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:16:03.423889Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:16:03.425528Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:16:03.426966Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:16:03.428216Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:16:03.429723Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:16:03.430946Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:16:03.433043Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:16:03.434754Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:16:03.435911Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:16:03.437435Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:16:03.438787Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:16:03.440021Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:16:03.441301Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:16:03.443639Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:16:03.445524Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:16:03.447215Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:16:03.447643Z - job completed in 1.45 seconds (b27f778a1dfea141a3949f708b36f5512aa3f1127ddab92df2c6d48bdc86f695)
2022-09-28T10:16:03.483886Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0506"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (924db6e8805bc71090caf8e8cd740e3464e050004f4cdb723420900ecf1274ee)
2022-09-28T10:16:05.542254Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:16:05.557969Z - running sql script pg/upsert_orders.sql
2022-09-28T10:16:05.558028Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:16:05.568872Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:16:05.571160Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:16:05.576158Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:16:05.577229Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:16:05.578512Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:16:05.579723Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:16:05.580726Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:16:05.581680Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:16:05.583694Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:16:05.585922Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:16:05.587486Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:16:05.588396Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:16:05.590031Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:16:05.592246Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:16:05.596738Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:16:05.597008Z - job completed in 2.11 seconds (924db6e8805bc71090caf8e8cd740e3464e050004f4cdb723420900ecf1274ee)
2022-09-28T10:18:01.971642Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0458"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (ee583f030d1848ec8b5c94b36d9555fa84792282ae9faa55e918792b87c53dfd)
2022-09-28T10:18:07.204115Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:18:07.224868Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T10:18:07.224910Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:18:07.229555Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T10:18:07.231260Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T10:18:07.232191Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T10:18:07.233080Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T10:18:07.234036Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T10:18:07.235343Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T10:18:07.236347Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:18:07.237289Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T10:18:07.238081Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T10:18:07.239928Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T10:18:07.241393Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T10:18:07.242286Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T10:18:07.247665Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T10:18:07.249036Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T10:18:07.251648Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T10:18:07.253269Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T10:18:07.338990Z - called http://score/api/keyed and received back 204
2022-09-28T10:18:07.339623Z - job completed in 5.37 seconds (ee583f030d1848ec8b5c94b36d9555fa84792282ae9faa55e918792b87c53dfd)
2022-09-28T10:18:07.464358Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0508"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (53d7d1ffea5d639d012c6fba97d84664b94e7ea629997b0b38211e3471fc0647)
2022-09-28T10:18:08.746063Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:18:08.765980Z - running sql script pg/insert_tenders.sql
2022-09-28T10:18:08.766064Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:18:08.771517Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:18:08.772970Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:18:08.775009Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:18:08.776408Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:18:08.778745Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:18:08.779828Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:18:08.782227Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:18:08.783730Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:18:08.785160Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:18:08.787086Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:18:08.788354Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:18:08.789975Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:18:08.791877Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:18:08.794506Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:18:08.796681Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:18:08.798961Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:18:08.799508Z - job completed in 1.34 seconds (53d7d1ffea5d639d012c6fba97d84664b94e7ea629997b0b38211e3471fc0647)
2022-09-28T10:18:08.827079Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0508"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e1f016ceb6801161c1dbf8e81d9a410aa96e51156faa52af68ffac0c529d1e79)
2022-09-28T10:18:10.958370Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:18:10.975208Z - running sql script pg/upsert_orders.sql
2022-09-28T10:18:10.975247Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:18:10.982400Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:18:10.983731Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:18:10.984521Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:18:10.985438Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:18:10.986649Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:18:10.987832Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:18:10.988672Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:18:10.989479Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:18:10.991267Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:18:10.993326Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:18:10.994880Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:18:10.995626Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:18:10.997221Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:18:10.998898Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:18:11.002783Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:18:11.003356Z - job completed in 2.18 seconds (e1f016ceb6801161c1dbf8e81d9a410aa96e51156faa52af68ffac0c529d1e79)
2022-09-28T10:20:02.601270Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0510"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0aa7ad108a763bef5dc3d23f86c374bbedfc308d99655e2b5b1f90c6b93e1d4c)
2022-09-28T10:20:04.920958Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:20:04.938689Z - running sql script pg/upsert_orders.sql
2022-09-28T10:20:04.939168Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:20:04.947220Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:20:04.948719Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:20:04.949694Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:20:04.952744Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:20:04.954043Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:20:04.955432Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:20:04.956372Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:20:04.957197Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:20:04.959290Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:20:04.962116Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:20:04.963974Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:20:04.965248Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:20:04.967152Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:20:04.969225Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:20:04.974937Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:20:04.975844Z - job completed in 2.37 seconds (0aa7ad108a763bef5dc3d23f86c374bbedfc308d99655e2b5b1f90c6b93e1d4c)
2022-09-28T10:20:05.064023Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0510"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f1180eca4b44e4380624c038ca7fd669b7123cf098a04c183936ec1c1bcfce0e)
2022-09-28T10:20:06.468354Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:20:06.490849Z - running sql script pg/insert_tenders.sql
2022-09-28T10:20:06.490890Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:20:06.495637Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:20:06.496864Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:20:06.498090Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:20:06.499043Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:20:06.500209Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:20:06.501126Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:20:06.503212Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:20:06.504754Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:20:06.505621Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:20:06.506964Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:20:06.508075Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:20:06.509155Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:20:06.510544Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:20:06.512447Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:20:06.514571Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:20:06.519269Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:20:06.519828Z - job completed in 1.46 seconds (f1180eca4b44e4380624c038ca7fd669b7123cf098a04c183936ec1c1bcfce0e)
2022-09-28T10:22:01.985096Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0512"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b600a31ebcd8a98109ba36a9707e645a106b7aef7794e8c06a88e5c968ff4155)
2022-09-28T10:22:03.946343Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:22:03.963788Z - running sql script pg/upsert_orders.sql
2022-09-28T10:22:03.963831Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:22:03.968538Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:22:03.969807Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:22:03.970752Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:22:03.971690Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:22:03.972894Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:22:03.974230Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:22:03.975156Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:22:03.976040Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:22:03.977978Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:22:03.980009Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:22:03.981512Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:22:03.982438Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:22:03.984137Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:22:03.985943Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:22:03.990250Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:22:03.990634Z - job completed in 2.01 seconds (b600a31ebcd8a98109ba36a9707e645a106b7aef7794e8c06a88e5c968ff4155)
2022-09-28T10:22:04.057276Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0512"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (744739effc83700b2d0d04d253ed7e3ea0d87cc6f513447ee0dec9a86200f6c8)
2022-09-28T10:22:05.549199Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:22:05.567367Z - running sql script pg/insert_tenders.sql
2022-09-28T10:22:05.567407Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:22:05.574079Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:22:05.575321Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:22:05.576246Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:22:05.577171Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:22:05.578452Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:22:05.580030Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:22:05.582202Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:22:05.583719Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:22:05.584667Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:22:05.586206Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:22:05.587716Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:22:05.588963Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:22:05.590179Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:22:05.591977Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:22:05.593839Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:22:05.595606Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:22:05.596007Z - job completed in 1.54 seconds (744739effc83700b2d0d04d253ed7e3ea0d87cc6f513447ee0dec9a86200f6c8)
2022-09-28T10:24:01.991289Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0514"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4e1666a1363ed12a7227b36ed0d09f6d5aa90c55d8653a361408c6608e184974)
2022-09-28T10:24:03.552075Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:24:03.568734Z - running sql script pg/insert_tenders.sql
2022-09-28T10:24:03.568776Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:24:03.573084Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:24:03.574490Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:24:03.579821Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:24:03.583701Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:24:03.588130Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:24:03.589140Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:24:03.638606Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:24:03.640138Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:24:03.641073Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:24:03.642535Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:24:03.656492Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:24:03.665272Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:24:03.669713Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:24:03.886193Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:24:04.075123Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:24:04.086402Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:24:04.087202Z - job completed in 2.10 seconds (4e1666a1363ed12a7227b36ed0d09f6d5aa90c55d8653a361408c6608e184974)
2022-09-28T10:24:04.192319Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0514"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fb5105a6c54b34aea8d609e878efaa701c2699f6b0d8d6ad7a8b6b7e4fce1571)
2022-09-28T10:24:06.332840Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:24:06.349513Z - running sql script pg/upsert_orders.sql
2022-09-28T10:24:06.349551Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:24:06.354440Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:24:06.356020Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:24:06.357323Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:24:06.358619Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:24:06.360116Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:24:06.361766Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:24:06.363100Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:24:06.364642Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:24:06.366714Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:24:06.369024Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:24:06.370782Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:24:06.372205Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:24:06.374154Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:24:06.376468Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:24:06.380774Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:24:06.381429Z - job completed in 2.19 seconds (fb5105a6c54b34aea8d609e878efaa701c2699f6b0d8d6ad7a8b6b7e4fce1571)
2022-09-28T10:26:02.025299Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0516"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1bb683aa41da6ae897ec17360e064949599dc4d91aea3ecfe8e9edcc021076fd)
2022-09-28T10:26:03.922218Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:26:03.939795Z - running sql script pg/upsert_orders.sql
2022-09-28T10:26:03.939840Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:26:03.944608Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:26:03.945925Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:26:03.946843Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:26:03.947723Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:26:03.948869Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:26:03.950010Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:26:03.950971Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:26:03.951807Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:26:03.953915Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:26:03.956109Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:26:03.957717Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:26:03.958605Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:26:03.960443Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:26:03.962394Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:26:03.967055Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:26:03.967589Z - job completed in 1.94 seconds (1bb683aa41da6ae897ec17360e064949599dc4d91aea3ecfe8e9edcc021076fd)
2022-09-28T10:26:04.104886Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0516"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (cf60495fd52004c663a68d3b4b8ef153b8e476fc70dcf30cae792a9289314c8e)
2022-09-28T10:26:05.330800Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:26:05.347558Z - running sql script pg/insert_tenders.sql
2022-09-28T10:26:05.347684Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:26:05.352469Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:26:05.353791Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:26:05.357805Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:26:05.361699Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:26:05.366804Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:26:05.367834Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:26:05.414679Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:26:05.416220Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:26:05.417188Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:26:05.418501Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:26:05.432431Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:26:05.441520Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:26:05.446140Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:26:05.664707Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:26:05.840883Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:26:05.845991Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:26:05.846523Z - job completed in 1.74 seconds (cf60495fd52004c663a68d3b4b8ef153b8e476fc70dcf30cae792a9289314c8e)
2022-09-28T10:28:01.923275Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0508"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (30feb2ac4d444151887fe987fda4e708beb8e42ce3b9704f4021233d47694a59)
2022-09-28T10:28:06.902322Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:28:06.918612Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T10:28:06.918671Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:28:06.924305Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T10:28:06.925951Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T10:28:06.927062Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T10:28:06.927970Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T10:28:06.928891Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T10:28:06.930031Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T10:28:06.931013Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:28:06.931897Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T10:28:06.932877Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T10:28:06.934642Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T10:28:06.936594Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T10:28:06.937736Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T10:28:06.940030Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T10:28:06.941056Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T10:28:06.942246Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T10:28:06.944042Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T10:28:07.019333Z - called http://score/api/keyed and received back 204
2022-09-28T10:28:07.019417Z - job completed in 5.10 seconds (30feb2ac4d444151887fe987fda4e708beb8e42ce3b9704f4021233d47694a59)
2022-09-28T10:28:07.061050Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0518"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ea0d973fe37b1ff6d357b151854a69656183d169400745ead4256a73cdcc968e)
2022-09-28T10:28:08.887660Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:28:08.904770Z - running sql script pg/upsert_orders.sql
2022-09-28T10:28:08.904809Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:28:08.909113Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:28:08.910725Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:28:08.912038Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:28:08.913392Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:28:08.914916Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:28:08.916455Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:28:08.917760Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:28:08.918857Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:28:08.921313Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:28:08.923854Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:28:08.925721Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:28:08.926680Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:28:08.928476Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:28:08.930341Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:28:08.934476Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:28:08.934879Z - job completed in 1.87 seconds (ea0d973fe37b1ff6d357b151854a69656183d169400745ead4256a73cdcc968e)
2022-09-28T10:28:09.017370Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0518"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7f5938cd5a633af1a20dd5d7e58a042dff32deef55f4dde319e8fe78133d877e)
2022-09-28T10:28:10.268035Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:28:10.284928Z - running sql script pg/insert_tenders.sql
2022-09-28T10:28:10.284965Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:28:10.289931Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:28:10.291224Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:28:10.295698Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:28:10.300217Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:28:10.304812Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:28:10.305774Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:28:10.351443Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:28:10.353150Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:28:10.353951Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:28:10.355460Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:28:10.369309Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:28:10.378345Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:28:10.383492Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:28:10.600250Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:28:10.777478Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:28:10.782758Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:28:10.783472Z - job completed in 1.77 seconds (7f5938cd5a633af1a20dd5d7e58a042dff32deef55f4dde319e8fe78133d877e)
2022-09-28T10:30:02.184391Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0520"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (051c50548503eec51600fd443a3b8d178e806f1e0199487760e24c3eea81ef9b)
2022-09-28T10:30:05.424275Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:30:05.480688Z - running sql script pg/upsert_orders.sql
2022-09-28T10:30:05.480735Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:30:05.485898Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:30:05.487405Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:30:05.488457Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:30:05.489329Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:30:05.490500Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:30:05.491873Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:30:05.492898Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:30:05.494015Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:30:05.495926Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:30:05.498223Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:30:05.499955Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:30:05.500904Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:30:05.502581Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:30:05.504581Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:30:05.509307Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:30:05.509745Z - job completed in 3.33 seconds (051c50548503eec51600fd443a3b8d178e806f1e0199487760e24c3eea81ef9b)
2022-09-28T10:30:05.570788Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0520"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8f6cfd898b26adcb3532d1d8e990bec7f2a0fb62d01da7083d9d4e0833126420)
2022-09-28T10:30:06.687524Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:30:06.704234Z - running sql script pg/insert_tenders.sql
2022-09-28T10:30:06.704290Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:30:06.708494Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:30:06.709841Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:30:06.713864Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:30:06.717654Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:30:06.722024Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:30:06.722962Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:30:06.770108Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:30:06.771914Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:30:06.772755Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:30:06.774233Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:30:06.788104Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:30:06.797021Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:30:06.801439Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:30:07.016242Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:30:07.189830Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:30:07.194964Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:30:07.195513Z - job completed in 1.63 seconds (8f6cfd898b26adcb3532d1d8e990bec7f2a0fb62d01da7083d9d4e0833126420)
2022-09-28T10:32:02.166609Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0522"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f202cae6a928f8d76f52215b651f143b291b93948ad0e90b18dea8e0e5064772)
2022-09-28T10:32:03.380874Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:32:03.398347Z - running sql script pg/insert_tenders.sql
2022-09-28T10:32:03.398381Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:32:03.403691Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:32:03.405225Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:32:03.409484Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:32:03.413459Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:32:03.418267Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:32:03.419760Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:32:03.468843Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:32:03.470358Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:32:03.471809Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:32:03.473489Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:32:03.487405Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:32:03.497194Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:32:03.501685Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:32:03.724456Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:32:03.905998Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:32:03.912223Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:32:03.913262Z - job completed in 1.75 seconds (f202cae6a928f8d76f52215b651f143b291b93948ad0e90b18dea8e0e5064772)
2022-09-28T10:32:03.935622Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0522"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1c58b2b38ae76c63285c4a2b8e5ea8c81e6568e92eed562e8d04cfbcc4bd2611)
2022-09-28T10:32:06.182333Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:32:06.198778Z - running sql script pg/upsert_orders.sql
2022-09-28T10:32:06.198815Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:32:06.203907Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:32:06.205370Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:32:06.206417Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:32:06.207383Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:32:06.208681Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:32:06.210080Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:32:06.211478Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:32:06.212608Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:32:06.214521Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:32:06.216856Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:32:06.218452Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:32:06.219411Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:32:06.221143Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:32:06.223086Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:32:06.227862Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:32:06.228184Z - job completed in 2.29 seconds (1c58b2b38ae76c63285c4a2b8e5ea8c81e6568e92eed562e8d04cfbcc4bd2611)
2022-09-28T10:34:02.444613Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0524"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (465e24af50c510a73b2005ce8676a623620a7b98e50f5b9d5f90b6cc8c19d452)
2022-09-28T10:34:03.777316Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:34:03.797312Z - running sql script pg/insert_tenders.sql
2022-09-28T10:34:03.797371Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:34:03.803156Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:34:03.805174Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:34:03.806295Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:34:03.807418Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:34:03.809026Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:34:03.810020Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:34:03.812328Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:34:03.814523Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:34:03.816087Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:34:03.817712Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:34:03.819132Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:34:03.820699Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:34:03.822538Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:34:03.824750Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:34:03.826924Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:34:03.828533Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:34:03.828995Z - job completed in 1.38 seconds (465e24af50c510a73b2005ce8676a623620a7b98e50f5b9d5f90b6cc8c19d452)
2022-09-28T10:34:03.922598Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0524"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f9b82e27c7471e19c3a116d24a3964bf6ef6d0da038367be979d30934288ccc5)
2022-09-28T10:34:05.964699Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:34:05.983019Z - running sql script pg/upsert_orders.sql
2022-09-28T10:34:05.983068Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:34:05.988067Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:34:05.989659Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:34:05.990749Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:34:05.991742Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:34:05.993105Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:34:05.994596Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:34:05.995511Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:34:05.996414Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:34:05.998390Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:34:06.000643Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:34:06.002238Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:34:06.003217Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:34:06.005175Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:34:06.007234Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:34:06.011435Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:34:06.011885Z - job completed in 2.09 seconds (f9b82e27c7471e19c3a116d24a3964bf6ef6d0da038367be979d30934288ccc5)
2022-09-28T10:36:01.989129Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0526"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (428235c010d5301cc00c2297bef30287546c3a1a090755ac7970dafbcb95fcfe)
2022-09-28T10:36:04.297198Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:36:04.314773Z - running sql script pg/upsert_orders.sql
2022-09-28T10:36:04.314822Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:36:04.320163Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:36:04.324806Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:36:04.325886Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:36:04.330616Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:36:04.332008Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:36:04.333752Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:36:04.335304Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:36:04.336388Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:36:04.342780Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:36:04.364740Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:36:04.366983Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:36:04.367959Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:36:04.382023Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:36:04.448672Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:36:04.468295Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:36:04.468932Z - job completed in 2.48 seconds (428235c010d5301cc00c2297bef30287546c3a1a090755ac7970dafbcb95fcfe)
2022-09-28T10:36:04.597335Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0526"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8324a72aa325db020a47b1a8eb5abee213fa8f5eb607551aa442363e89cb512d)
2022-09-28T10:36:05.924368Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:36:05.942184Z - running sql script pg/insert_tenders.sql
2022-09-28T10:36:05.942238Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:36:05.947083Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:36:05.948371Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:36:05.949273Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:36:05.950167Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:36:05.952547Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:36:05.953563Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:36:05.955713Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:36:05.957200Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:36:05.958195Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:36:05.959870Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:36:05.961315Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:36:05.962612Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:36:05.963911Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:36:05.965937Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:36:05.967713Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:36:05.969247Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:36:05.969804Z - job completed in 1.37 seconds (8324a72aa325db020a47b1a8eb5abee213fa8f5eb607551aa442363e89cb512d)
2022-09-28T10:38:01.993938Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0528"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2bec1e881eb587f014f35502a5fb665611476da5ccb22826e996b1c9edb827b3)
2022-09-28T10:38:04.160865Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:38:04.181401Z - running sql script pg/upsert_orders.sql
2022-09-28T10:38:04.181440Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:38:04.186390Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:38:04.190713Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:38:04.191866Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:38:04.196269Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:38:04.197608Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:38:04.198912Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:38:04.199914Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:38:04.201022Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:38:04.207012Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:38:04.237058Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:38:04.238606Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:38:04.239631Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:38:04.247070Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:38:04.321026Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:38:04.332173Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:38:04.332600Z - job completed in 2.34 seconds (2bec1e881eb587f014f35502a5fb665611476da5ccb22826e996b1c9edb827b3)
2022-09-28T10:38:04.437215Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0528"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c649756cbe3232172d9b1233639ac773a59c1c6f04e5821fdaa6d11770907eea)
2022-09-28T10:38:05.518163Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:38:05.535095Z - running sql script pg/insert_tenders.sql
2022-09-28T10:38:05.535131Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:38:05.539901Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:38:05.541494Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:38:05.542634Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:38:05.543507Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:38:05.544735Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:38:05.545531Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:38:05.547820Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:38:05.549504Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:38:05.550455Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:38:05.551674Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:38:05.552877Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:38:05.554053Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:38:05.555186Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:38:05.556846Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:38:05.558422Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:38:05.559746Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:38:05.560148Z - job completed in 1.12 seconds (c649756cbe3232172d9b1233639ac773a59c1c6f04e5821fdaa6d11770907eea)
2022-09-28T10:38:05.636227Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0518"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (d9ce3e0259d10bb6dec82e84fcbd860376a1cc5060668734d7daabecf5787f72)
2022-09-28T10:38:11.005761Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:38:11.022653Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T10:38:11.022705Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:38:11.027768Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T10:38:11.029176Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T10:38:11.030172Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T10:38:11.031035Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T10:38:11.031990Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T10:38:11.033300Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T10:38:11.034371Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:38:11.035393Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T10:38:11.036257Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T10:38:11.037976Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T10:38:11.039580Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T10:38:11.040535Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T10:38:11.042961Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T10:38:11.044497Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T10:38:11.046184Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T10:38:11.047828Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T10:38:11.133020Z - called http://score/api/keyed and received back 204
2022-09-28T10:38:11.133524Z - job completed in 5.50 seconds (d9ce3e0259d10bb6dec82e84fcbd860376a1cc5060668734d7daabecf5787f72)
2022-09-28T10:40:02.323489Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0530"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ac488022b84fe3835b443378d6dd053a96ad8c0cc40bc19fc38d6b3b1236b59b)
2022-09-28T10:40:04.471945Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:40:04.490449Z - running sql script pg/upsert_orders.sql
2022-09-28T10:40:04.490950Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:40:04.496701Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:40:04.501372Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:40:04.503672Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:40:04.508100Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:40:04.509747Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:40:04.511302Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:40:04.512636Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:40:04.513780Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:40:04.520150Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:40:04.555214Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:40:04.559218Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:40:04.562525Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:40:04.585240Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:40:04.647562Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:40:04.655991Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:40:04.656280Z - job completed in 2.33 seconds (ac488022b84fe3835b443378d6dd053a96ad8c0cc40bc19fc38d6b3b1236b59b)
2022-09-28T10:40:04.759463Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0530"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (275648d18c23f1f550579621af32d4d0b7f7a79f087ec87f26d3fabe9b49c312)
2022-09-28T10:40:06.037079Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:40:06.057559Z - running sql script pg/insert_tenders.sql
2022-09-28T10:40:06.058091Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:40:06.064754Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:40:06.068719Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:40:06.073916Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:40:06.079015Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:40:06.083683Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:40:06.084929Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:40:06.124081Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:40:06.132083Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:40:06.136353Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:40:06.137989Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:40:06.139596Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:40:06.141195Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:40:06.142809Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:40:06.144709Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:40:06.146770Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:40:06.148510Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:40:06.149314Z - job completed in 1.39 seconds (275648d18c23f1f550579621af32d4d0b7f7a79f087ec87f26d3fabe9b49c312)
2022-09-28T10:42:02.128024Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0532"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (780677265ef6cff31a5258fb16e79977795762909ab85673dfe7fafa21665c88)
2022-09-28T10:42:03.425183Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:42:03.443253Z - running sql script pg/insert_tenders.sql
2022-09-28T10:42:03.443288Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:42:03.448688Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:42:03.450130Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:42:03.454221Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:42:03.457941Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:42:03.462625Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:42:03.463616Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:42:03.504452Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:42:03.512365Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:42:03.516567Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:42:03.518198Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:42:03.519766Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:42:03.521152Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:42:03.522431Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:42:03.524260Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:42:03.526180Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:42:03.527830Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:42:03.528268Z - job completed in 1.40 seconds (780677265ef6cff31a5258fb16e79977795762909ab85673dfe7fafa21665c88)
2022-09-28T10:42:03.611807Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0532"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9244cd208ef9405179eaf9f197203e4653848584768d935de32088cd29923817)
2022-09-28T10:42:05.563439Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:42:05.584504Z - running sql script pg/upsert_orders.sql
2022-09-28T10:42:05.584560Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:42:05.589521Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:42:05.594823Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:42:05.595874Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:42:05.602523Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:42:05.604073Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:42:05.605345Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:42:05.606355Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:42:05.607305Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:42:05.613090Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:42:05.647168Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:42:05.652735Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:42:05.656766Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:42:05.662499Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:42:05.731686Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:42:05.744426Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:42:05.744808Z - job completed in 2.13 seconds (9244cd208ef9405179eaf9f197203e4653848584768d935de32088cd29923817)
2022-09-28T10:44:01.988136Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0534"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (be7bb570cb8ed898e0ac466a856a0f4bc694e55c534ecfea9013ac0488780183)
2022-09-28T10:44:03.179062Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:44:03.201808Z - running sql script pg/insert_tenders.sql
2022-09-28T10:44:03.202750Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:44:03.207814Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:44:03.209180Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:44:03.216364Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:44:03.221372Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:44:03.226117Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:44:03.227111Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:44:03.266311Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:44:03.274865Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:44:03.279141Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:44:03.280623Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:44:03.282248Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:44:03.283790Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:44:03.285520Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:44:03.287499Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:44:03.290646Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:44:03.292449Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:44:03.292979Z - job completed in 1.30 seconds (be7bb570cb8ed898e0ac466a856a0f4bc694e55c534ecfea9013ac0488780183)
2022-09-28T10:44:03.348911Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0534"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (921d23068ddcb84e2e37cb9a089bce36cda29ce30159cc26e6b8839effd5f192)
2022-09-28T10:44:05.348163Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:44:05.366595Z - running sql script pg/upsert_orders.sql
2022-09-28T10:44:05.366651Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:44:05.371898Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:44:05.376406Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:44:05.377436Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:44:05.381337Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:44:05.382737Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:44:05.384198Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:44:05.385130Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:44:05.385958Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:44:05.391671Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:44:05.426854Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:44:05.432711Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:44:05.436949Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:44:05.442076Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:44:05.505603Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:44:05.514459Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:44:05.514968Z - job completed in 2.17 seconds (921d23068ddcb84e2e37cb9a089bce36cda29ce30159cc26e6b8839effd5f192)
2022-09-28T10:46:01.928062Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0536"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f538fa1601cdd60ac9aecd16a2b87e0b9a958400aac57d2b017740d49c5299fe)
2022-09-28T10:46:04.271028Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:46:04.288887Z - running sql script pg/upsert_orders.sql
2022-09-28T10:46:04.288935Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:46:04.294010Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:46:04.299198Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:46:04.300375Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:46:04.304309Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:46:04.305795Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:46:04.307094Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:46:04.308197Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:46:04.309152Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:46:04.315943Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:46:04.337139Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:46:04.342731Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:46:04.347168Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:46:04.353490Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:46:04.413443Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:46:04.421136Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:46:04.421598Z - job completed in 2.49 seconds (f538fa1601cdd60ac9aecd16a2b87e0b9a958400aac57d2b017740d49c5299fe)
2022-09-28T10:46:04.454974Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0536"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (053736d13fcda0f84cf9a591a2426289496a8728a00575afc28870c45fdbedbf)
2022-09-28T10:46:05.568519Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:46:05.593156Z - running sql script pg/insert_tenders.sql
2022-09-28T10:46:05.593206Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:46:05.598134Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:46:05.599675Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:46:05.603954Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:46:05.607925Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:46:05.612951Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:46:05.613914Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:46:05.657403Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:46:05.677130Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:46:05.681752Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:46:05.683212Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:46:05.684530Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:46:05.686219Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:46:05.687289Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:46:05.690156Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:46:05.691795Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:46:05.693291Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:46:05.693590Z - job completed in 1.24 seconds (053736d13fcda0f84cf9a591a2426289496a8728a00575afc28870c45fdbedbf)
2022-09-28T10:48:01.890701Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0538"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5a4a54c28f12152ee31eefea77c5b387899b0f76ecf0a4161fc406cd62956f59)
2022-09-28T10:48:03.543151Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:48:03.560366Z - running sql script pg/upsert_orders.sql
2022-09-28T10:48:03.560400Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:48:03.565235Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:48:03.569676Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:48:03.570795Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:48:03.574831Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:48:03.576677Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:48:03.577937Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:48:03.578827Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:48:03.583365Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:48:03.591624Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:48:03.599599Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:48:03.606440Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:48:03.612280Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:48:03.613909Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:48:03.615852Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:48:03.619741Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:48:03.620046Z - job completed in 1.73 seconds (5a4a54c28f12152ee31eefea77c5b387899b0f76ecf0a4161fc406cd62956f59)
2022-09-28T10:48:03.713253Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0538"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (022ee435e89887c07292af50bda3405c2d09919fd3313f83f2f6b5caa8703f30)
2022-09-28T10:48:04.724633Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:48:04.741684Z - running sql script pg/insert_tenders.sql
2022-09-28T10:48:04.741730Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:48:04.746584Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:48:04.748212Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:48:04.752522Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:48:04.756510Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:48:04.761112Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:48:04.762199Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:48:04.806061Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:48:04.823974Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:48:04.828283Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:48:04.829699Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:48:04.830913Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:48:04.832555Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:48:04.833750Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:48:04.835338Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:48:04.836952Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:48:04.838494Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:48:04.838922Z - job completed in 1.13 seconds (022ee435e89887c07292af50bda3405c2d09919fd3313f83f2f6b5caa8703f30)
2022-09-28T10:48:04.933053Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0528"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (315e0e424885c7cc379fb7c10124e29ebd9b9327120f8ec326f239808ce8e993)
2022-09-28T10:48:09.817887Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:48:09.837562Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T10:48:09.837877Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:48:09.846331Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T10:48:09.852554Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T10:48:09.857195Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T10:48:09.858573Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T10:48:09.863420Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T10:48:09.867834Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T10:48:09.869539Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:48:09.871361Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T10:48:09.872795Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T10:48:09.878986Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T10:48:09.883626Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T10:48:09.890459Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T10:48:09.893212Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T10:48:09.894807Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T10:48:09.896589Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T10:48:09.900718Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T10:48:10.015951Z - called http://score/api/keyed and received back 204
2022-09-28T10:48:10.016052Z - job completed in 5.08 seconds (315e0e424885c7cc379fb7c10124e29ebd9b9327120f8ec326f239808ce8e993)
2022-09-28T10:50:02.113702Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0540"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b5d02b4990a48c0322ef72a43937c3cb7749c1980d83c78a2d32206775f2afe2)
2022-09-28T10:50:03.503419Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:50:03.535026Z - running sql script pg/insert_tenders.sql
2022-09-28T10:50:03.535084Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:50:03.539959Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:50:03.541511Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:50:03.545849Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:50:03.550726Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:50:03.557585Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:50:03.558582Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:50:03.601253Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:50:03.614420Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:50:03.619008Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:50:03.620578Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:50:03.622389Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:50:03.624083Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:50:03.625299Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:50:03.627455Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:50:03.629269Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:50:03.631125Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:50:03.631598Z - job completed in 1.52 seconds (b5d02b4990a48c0322ef72a43937c3cb7749c1980d83c78a2d32206775f2afe2)
2022-09-28T10:50:03.649290Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0540"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ea9835ab8de2fffb08388a474acbe0011f10f24bf7ff469e9cc59ad05a097ee7)
2022-09-28T10:50:05.813926Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:50:05.841932Z - running sql script pg/upsert_orders.sql
2022-09-28T10:50:05.841982Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:50:05.849411Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:50:05.854688Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:50:05.855755Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:50:05.860290Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:50:05.862075Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:50:05.863473Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:50:05.864431Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:50:05.865282Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:50:05.873848Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:50:05.882207Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:50:05.890019Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:50:05.893995Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:50:05.896279Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:50:05.898054Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:50:05.902062Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:50:05.902511Z - job completed in 2.25 seconds (ea9835ab8de2fffb08388a474acbe0011f10f24bf7ff469e9cc59ad05a097ee7)
2022-09-28T10:52:02.066102Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0542"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (747366fa53be584c7b2c7054399cc18909f8817098d4ea6229074b333c2efd4f)
2022-09-28T10:52:03.858568Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:52:03.876337Z - running sql script pg/upsert_orders.sql
2022-09-28T10:52:03.876381Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:52:03.880880Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:52:03.882247Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:52:03.883228Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:52:03.884155Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:52:03.885355Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:52:03.886653Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:52:03.887638Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:52:03.888650Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:52:03.890458Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:52:03.892518Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:52:03.894278Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:52:03.895316Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:52:03.897342Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:52:03.899355Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:52:03.903626Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:52:03.904074Z - job completed in 1.84 seconds (747366fa53be584c7b2c7054399cc18909f8817098d4ea6229074b333c2efd4f)
2022-09-28T10:52:03.956107Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0542"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fef7d8c49e370494a7b465f2492cfbaec9b7810f222452d481b077eb87793efa)
2022-09-28T10:52:05.272661Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:52:05.298729Z - running sql script pg/insert_tenders.sql
2022-09-28T10:52:05.298776Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:52:05.304551Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:52:05.306123Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:52:05.310462Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:52:05.315071Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:52:05.319873Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:52:05.321234Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:52:05.367102Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:52:05.374953Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:52:05.379167Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:52:05.380829Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:52:05.576211Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:52:05.654032Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:52:05.659594Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:52:05.748559Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:52:05.924662Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:52:05.926624Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:52:05.927098Z - job completed in 1.97 seconds (fef7d8c49e370494a7b465f2492cfbaec9b7810f222452d481b077eb87793efa)
2022-09-28T10:54:01.946978Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0544"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fd03b425108a578b2954a8787583e7c6ab113499791d9604fa0e95db5ff79c13)
2022-09-28T10:54:04.225538Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:54:04.242564Z - running sql script pg/upsert_orders.sql
2022-09-28T10:54:04.243031Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:54:04.248378Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:54:04.250205Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:54:04.251470Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:54:04.252945Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:54:04.254436Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:54:04.255841Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:54:04.257019Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:54:04.258267Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:54:04.260371Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:54:04.262532Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:54:04.264113Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:54:04.265221Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:54:04.266773Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:54:04.268634Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:54:04.272705Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:54:04.273055Z - job completed in 2.33 seconds (fd03b425108a578b2954a8787583e7c6ab113499791d9604fa0e95db5ff79c13)
2022-09-28T10:54:04.295078Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0544"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1b867af38879e958cd7afe5cfcd83baa800da5deaf7c7fc5f17c7dc485939692)
2022-09-28T10:54:05.580214Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:54:05.599213Z - running sql script pg/insert_tenders.sql
2022-09-28T10:54:05.599278Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:54:05.607097Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:54:05.608439Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:54:05.612307Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:54:05.616526Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:54:05.622575Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:54:05.623629Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:54:05.671362Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:54:05.679554Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:54:05.683655Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:54:05.685621Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:54:05.881172Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:54:05.961757Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:54:05.969072Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:54:06.054752Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:54:06.227996Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:54:06.230006Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:54:06.230587Z - job completed in 1.94 seconds (1b867af38879e958cd7afe5cfcd83baa800da5deaf7c7fc5f17c7dc485939692)
2022-09-28T10:56:01.955692Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0546"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e1dd17e0e158ce45b4d8712d0c95a04eb33af69aec62def8d34b3614797c780e)
2022-09-28T10:56:03.672890Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:56:03.703773Z - running sql script pg/upsert_orders.sql
2022-09-28T10:56:03.703817Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:56:03.708599Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:56:03.712614Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:56:03.713801Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:56:03.717781Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:56:03.719599Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:56:03.725275Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:56:03.726246Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:56:03.727216Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:56:03.733179Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:56:03.776016Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:56:03.777785Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:56:03.778779Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:56:03.787645Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:56:03.853736Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:56:03.891657Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:56:03.892184Z - job completed in 1.94 seconds (e1dd17e0e158ce45b4d8712d0c95a04eb33af69aec62def8d34b3614797c780e)
2022-09-28T10:56:03.983799Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0546"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f9486adaf431b9ab86f2180024b677b0f235f4022c8b6ff0701f0ed626ec06a8)
2022-09-28T10:56:05.238412Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:56:05.255422Z - running sql script pg/insert_tenders.sql
2022-09-28T10:56:05.255496Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:56:05.260095Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:56:05.261347Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:56:05.265432Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:56:05.269566Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:56:05.274043Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:56:05.275150Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:56:05.320939Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:56:05.322692Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:56:05.323746Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:56:05.325500Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:56:05.339331Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:56:05.348643Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:56:05.355498Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:56:05.587212Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:56:05.764886Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:56:05.775029Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:56:05.775485Z - job completed in 1.79 seconds (f9486adaf431b9ab86f2180024b677b0f235f4022c8b6ff0701f0ed626ec06a8)
2022-09-28T10:58:01.978899Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0538"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (43adbf1c0358ede985fc1251e581442450f392b18c1eb3a0574e3a7d0db56537)
2022-09-28T10:58:06.374152Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:58:06.392494Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T10:58:06.392540Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:58:06.396963Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T10:58:06.398604Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T10:58:06.402665Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T10:58:06.403738Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T10:58:06.407415Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T10:58:06.411646Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T10:58:06.412790Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:58:06.414006Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T10:58:06.415056Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T10:58:06.420562Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T10:58:06.422257Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T10:58:06.425921Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T10:58:06.428416Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T10:58:06.429584Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T10:58:06.430795Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T10:58:06.432421Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T10:58:06.528068Z - called http://score/api/keyed and received back 204
2022-09-28T10:58:06.528255Z - job completed in 4.55 seconds (43adbf1c0358ede985fc1251e581442450f392b18c1eb3a0574e3a7d0db56537)
2022-09-28T10:58:06.585845Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0548"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (40289219afba8585793af33d43e9cc6c859516ad621fce77b0f9b3de08b3d01d)
2022-09-28T10:58:08.349099Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:58:08.369655Z - running sql script pg/upsert_orders.sql
2022-09-28T10:58:08.369691Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T10:58:08.375577Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T10:58:08.380324Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T10:58:08.381301Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T10:58:08.385377Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T10:58:08.386804Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T10:58:08.391052Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T10:58:08.394615Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T10:58:08.395576Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T10:58:08.402115Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T10:58:08.544974Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T10:58:08.551019Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T10:58:08.554958Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T10:58:08.567678Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T10:58:08.634931Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T10:58:08.645820Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T10:58:08.646305Z - job completed in 2.06 seconds (40289219afba8585793af33d43e9cc6c859516ad621fce77b0f9b3de08b3d01d)
2022-09-28T10:58:08.801406Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0548"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2cdc5a624139c0201b15d7b2ec2447f8627b4a8450d8bdcae03125f31b62e2d0)
2022-09-28T10:58:09.890758Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T10:58:09.928841Z - running sql script pg/insert_tenders.sql
2022-09-28T10:58:09.929950Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T10:58:09.940718Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T10:58:09.942536Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T10:58:09.949619Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T10:58:09.953942Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T10:58:09.959759Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T10:58:09.961121Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T10:58:10.007637Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T10:58:10.019085Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T10:58:10.023971Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T10:58:10.026282Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T10:58:10.088673Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T10:58:10.113753Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T10:58:10.137085Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T10:58:10.453691Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T10:58:10.646024Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T10:58:10.654341Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T10:58:10.654782Z - job completed in 1.85 seconds (2cdc5a624139c0201b15d7b2ec2447f8627b4a8450d8bdcae03125f31b62e2d0)
2022-09-28T11:00:02.192504Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0550"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d46bd0ce4be89984a9ed548a82b515cedbc692b4d7140f1b9e207792c616659b)
2022-09-28T11:00:04.157559Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:00:04.181826Z - running sql script pg/insert_tenders.sql
2022-09-28T11:00:04.181882Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:00:04.535632Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:00:04.553680Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:00:04.908145Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:00:05.189986Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:00:05.219061Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:00:05.220374Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:00:05.662247Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:00:05.970204Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:00:06.278802Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:00:06.281175Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:00:06.368399Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:00:06.439229Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:00:06.471581Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:00:08.151258Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:00:09.001372Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:00:09.528494Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:00:09.529088Z - job completed in 7.34 seconds (d46bd0ce4be89984a9ed548a82b515cedbc692b4d7140f1b9e207792c616659b)
2022-09-28T11:00:09.616127Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0550"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (33b77ea062fdb0de9995e1e5783b1e34041989bdf4e4acf1e568a636052fb0f4)
2022-09-28T11:00:13.371616Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:00:13.395086Z - running sql script pg/upsert_orders.sql
2022-09-28T11:00:13.395135Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:00:13.705369Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:00:14.107773Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:00:14.110777Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:00:14.477260Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:00:14.479744Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:00:14.803001Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:00:14.807964Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:00:14.809209Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:00:14.835484Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:00:15.514195Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:00:15.749381Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:00:15.754670Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:00:15.770226Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:00:16.209281Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:00:16.254257Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:00:16.254967Z - job completed in 6.64 seconds (33b77ea062fdb0de9995e1e5783b1e34041989bdf4e4acf1e568a636052fb0f4)
2022-09-28T11:02:02.212775Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0552"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (894a5bdd16c354ea9fc69deb0df6bf0516db807a8c0bc8150e1568fac1268a97)
2022-09-28T11:02:04.770970Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:02:04.790593Z - running sql script pg/upsert_orders.sql
2022-09-28T11:02:04.790636Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:02:04.795570Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:02:04.800337Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:02:04.801332Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:02:04.805699Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:02:04.807343Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:02:04.812235Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:02:04.813256Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:02:04.814276Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:02:04.822632Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:02:05.203887Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:02:05.251849Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:02:05.255863Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:02:05.262578Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:02:05.325853Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:02:05.334267Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:02:05.335817Z - job completed in 3.12 seconds (894a5bdd16c354ea9fc69deb0df6bf0516db807a8c0bc8150e1568fac1268a97)
2022-09-28T11:02:05.391459Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0552"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7a127a2fbb83f0f7d121ae1639b019f458dac26fe76b5cc01615017a16e40521)
2022-09-28T11:02:07.700270Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:02:07.719695Z - running sql script pg/insert_tenders.sql
2022-09-28T11:02:07.719823Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:02:07.728081Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:02:07.729562Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:02:07.735613Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:02:07.740298Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:02:07.746223Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:02:07.748456Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:02:07.795883Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:02:07.846944Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:02:07.851003Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:02:07.852593Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:02:07.866630Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:02:07.878264Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:02:07.888145Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:02:08.121804Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:02:08.310173Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:02:08.315913Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:02:08.316443Z - job completed in 2.93 seconds (7a127a2fbb83f0f7d121ae1639b019f458dac26fe76b5cc01615017a16e40521)
2022-09-28T11:04:01.979777Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0554"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fa4e28d9e413927bae5451cced519db944090b383b1dc962ce0b3c8949e326a3)
2022-09-28T11:04:04.093118Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:04:04.120517Z - running sql script pg/upsert_orders.sql
2022-09-28T11:04:04.120892Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:04:04.126492Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:04:04.131341Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:04:04.134410Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:04:04.139392Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:04:04.143807Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:04:04.148703Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:04:04.150099Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:04:04.151521Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:04:04.159756Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:04:04.375871Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:04:04.424058Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:04:04.428600Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:04:04.435176Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:04:04.498863Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:04:04.507929Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:04:04.508376Z - job completed in 2.53 seconds (fa4e28d9e413927bae5451cced519db944090b383b1dc962ce0b3c8949e326a3)
2022-09-28T11:04:04.599579Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0554"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (cb25efd8c58e559c463f547c2cd434690ec310cd282530274d0206cf140d2e91)
2022-09-28T11:04:05.791183Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:04:05.815820Z - running sql script pg/insert_tenders.sql
2022-09-28T11:04:05.815864Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:04:05.821256Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:04:05.823038Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:04:05.827771Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:04:05.832254Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:04:05.839876Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:04:05.840771Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:04:05.886259Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:04:05.937033Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:04:05.941327Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:04:05.942836Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:04:05.956779Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:04:05.966503Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:04:05.974819Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:04:06.208447Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:04:06.396443Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:04:06.402219Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:04:06.402697Z - job completed in 1.80 seconds (cb25efd8c58e559c463f547c2cd434690ec310cd282530274d0206cf140d2e91)
2022-09-28T11:06:02.058290Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0556"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5af6164ccdba786110527143d6009a38ae2f34a4a94ff7f0cc3f46df1ff97be3)
2022-09-28T11:06:03.906113Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:06:03.924769Z - running sql script pg/insert_tenders.sql
2022-09-28T11:06:03.924807Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:06:03.929868Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:06:03.931212Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:06:03.935916Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:06:03.940817Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:06:03.945792Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:06:03.947160Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:06:03.993096Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:06:04.044400Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:06:04.053021Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:06:04.054472Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:06:04.065170Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:06:04.073394Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:06:04.085660Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:06:04.322338Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:06:04.509958Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:06:04.516753Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:06:04.517551Z - job completed in 2.46 seconds (5af6164ccdba786110527143d6009a38ae2f34a4a94ff7f0cc3f46df1ff97be3)
2022-09-28T11:06:04.637854Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0556"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f0a79acba31cb7f80fe0fa5a6e44f8be042b392446ea9fbbc81ec1aa268fc250)
2022-09-28T11:06:06.872545Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:06:06.892701Z - running sql script pg/upsert_orders.sql
2022-09-28T11:06:06.892748Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:06:06.897690Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:06:06.903378Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:06:06.904493Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:06:06.909065Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:06:06.910526Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:06:06.915312Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:06:06.916279Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:06:06.917189Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:06:06.923933Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:06:07.106190Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:06:07.154039Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:06:07.158797Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:06:07.166536Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:06:07.230411Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:06:07.240441Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:06:07.240793Z - job completed in 2.60 seconds (f0a79acba31cb7f80fe0fa5a6e44f8be042b392446ea9fbbc81ec1aa268fc250)
2022-09-28T11:08:01.915705Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0558"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9bbe830c78d0b45147f4c6b7f81a37054d0659c1ce9a5b22dc627573f6cbe066)
2022-09-28T11:08:03.962984Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:08:03.980552Z - running sql script pg/upsert_orders.sql
2022-09-28T11:08:03.980608Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:08:03.985384Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:08:03.990571Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:08:03.991966Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:08:03.996772Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:08:03.998239Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:08:04.005318Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:08:04.006315Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:08:04.007504Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:08:04.014008Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:08:04.145243Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:08:04.235844Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:08:04.240225Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:08:04.247098Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:08:04.325919Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:08:04.335593Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:08:04.336122Z - job completed in 2.42 seconds (9bbe830c78d0b45147f4c6b7f81a37054d0659c1ce9a5b22dc627573f6cbe066)
2022-09-28T11:08:04.368557Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0558"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2c3a5ed2fc9ea048d35f47777de55cc4df7dbe9490906b94cca97e59d32344f5)
2022-09-28T11:08:05.441655Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:08:05.460721Z - running sql script pg/insert_tenders.sql
2022-09-28T11:08:05.461217Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:08:05.467633Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:08:05.469381Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:08:05.475661Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:08:05.488026Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:08:05.496637Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:08:05.497625Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:08:05.544743Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:08:05.595563Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:08:05.599633Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:08:05.601340Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:08:05.613052Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:08:05.621041Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:08:05.627703Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:08:05.855794Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:08:06.039776Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:08:06.046913Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:08:06.047376Z - job completed in 1.68 seconds (2c3a5ed2fc9ea048d35f47777de55cc4df7dbe9490906b94cca97e59d32344f5)
2022-09-28T11:08:06.083292Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0548"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (d30853aaa8cd25751e5dab3a23891004c5781e912f2efce2bf4faa1088469e09)
2022-09-28T11:08:11.572410Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:08:11.593930Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T11:08:11.594234Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:08:11.600376Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T11:08:11.602066Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T11:08:11.603107Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T11:08:11.603922Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T11:08:11.604779Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T11:08:11.606167Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T11:08:11.607106Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:08:11.607929Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T11:08:11.608716Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T11:08:11.610497Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T11:08:11.611776Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T11:08:11.612616Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T11:08:11.614958Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T11:08:11.615944Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T11:08:11.616914Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T11:08:11.618474Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T11:08:11.712644Z - called http://score/api/keyed and received back 204
2022-09-28T11:08:11.712801Z - job completed in 5.63 seconds (d30853aaa8cd25751e5dab3a23891004c5781e912f2efce2bf4faa1088469e09)
2022-09-28T11:10:02.650630Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0600"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e735588f600e6fa75cb79bc138a4604362783960709e1b2565397ece5e6f1378)
2022-09-28T11:10:03.948202Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:10:03.965061Z - running sql script pg/insert_tenders.sql
2022-09-28T11:10:03.965106Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:10:03.969926Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:10:03.971306Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:10:03.977263Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:10:03.981684Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:10:03.986036Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:10:03.986974Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:10:04.032998Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:10:04.035343Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:10:04.036558Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:10:04.038931Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:10:04.229213Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:10:04.306295Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:10:04.313109Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:10:04.524336Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:10:04.693040Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:10:04.694968Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:10:04.695325Z - job completed in 2.05 seconds (e735588f600e6fa75cb79bc138a4604362783960709e1b2565397ece5e6f1378)
2022-09-28T11:10:04.791246Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0600"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fedb2b41da0fa9e2df9df2978642336ecc628f607f669414531aef7d5da27adb)
2022-09-28T11:10:06.619409Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:10:06.639162Z - running sql script pg/upsert_orders.sql
2022-09-28T11:10:06.639205Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:10:06.644511Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:10:06.649370Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:10:06.650319Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:10:06.654577Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:10:06.655989Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:10:06.660540Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:10:06.661687Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:10:06.662925Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:10:06.668731Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:10:06.680483Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:10:06.681805Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:10:06.682744Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:10:06.689210Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:10:06.751661Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:10:06.761189Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:10:06.761629Z - job completed in 1.97 seconds (fedb2b41da0fa9e2df9df2978642336ecc628f607f669414531aef7d5da27adb)
2022-09-28T11:12:01.964094Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0602"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dbddedfff7d47be7297e413d09aad9f72f60896b7f3b8673560770b2277ab291)
2022-09-28T11:12:03.921993Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:12:03.941387Z - running sql script pg/insert_tenders.sql
2022-09-28T11:12:03.941417Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:12:03.946868Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:12:03.948733Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:12:03.953535Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:12:03.957938Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:12:03.963255Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:12:03.964530Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:12:04.009642Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:12:04.023513Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:12:04.028750Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:12:04.030798Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:12:04.222226Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:12:04.301387Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:12:04.307105Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:12:04.523735Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:12:04.703673Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:12:04.708189Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:12:04.708495Z - job completed in 2.74 seconds (dbddedfff7d47be7297e413d09aad9f72f60896b7f3b8673560770b2277ab291)
2022-09-28T11:12:04.742710Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0602"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ca87c0918ed1e90b798306fa7166373b48cc316e709b3c6cde5af9baaf47754a)
2022-09-28T11:12:06.741640Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:12:06.758741Z - running sql script pg/upsert_orders.sql
2022-09-28T11:12:06.758800Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:12:06.763616Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:12:06.768338Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:12:06.769613Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:12:06.773697Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:12:06.775229Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:12:06.776882Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:12:06.778016Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:12:06.779088Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:12:06.785117Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:12:06.796958Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:12:06.798689Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:12:06.799823Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:12:06.805567Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:12:06.869242Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:12:06.876913Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:12:06.877361Z - job completed in 2.14 seconds (ca87c0918ed1e90b798306fa7166373b48cc316e709b3c6cde5af9baaf47754a)
2022-09-28T11:14:02.020089Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0604"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d5932d1852cf998a40338d93021be63d7792a3977c42a8b7419bda2a6c310b63)
2022-09-28T11:14:03.962963Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:14:03.980223Z - running sql script pg/upsert_orders.sql
2022-09-28T11:14:03.980569Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:14:03.985690Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:14:03.990569Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:14:03.992134Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:14:03.996639Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:14:03.999269Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:14:04.000871Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:14:04.002332Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:14:04.003744Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:14:04.012521Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:14:04.023760Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:14:04.025344Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:14:04.026523Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:14:04.031574Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:14:04.095098Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:14:04.102379Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:14:04.102867Z - job completed in 2.08 seconds (d5932d1852cf998a40338d93021be63d7792a3977c42a8b7419bda2a6c310b63)
2022-09-28T11:14:04.188248Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0604"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ede4ab58f90b6858f315da7a94df8d844e5617470849847a2862b4558e5af6ee)
2022-09-28T11:14:05.426344Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:14:05.447081Z - running sql script pg/insert_tenders.sql
2022-09-28T11:14:05.447391Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:14:05.452957Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:14:05.454590Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:14:05.459464Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:14:05.464196Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:14:05.468686Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:14:05.470369Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:14:05.515819Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:14:05.529225Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:14:05.533192Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:14:05.534581Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:14:05.720198Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:14:05.798130Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:14:05.803010Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:14:06.016749Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:14:06.199322Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:14:06.205491Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:14:06.206026Z - job completed in 2.02 seconds (ede4ab58f90b6858f315da7a94df8d844e5617470849847a2862b4558e5af6ee)
2022-09-28T11:16:01.975454Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0606"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (82a84e78be14248997e5fc4de63cf68e8da5400d8ca402814feb151f953ea00c)
2022-09-28T11:16:03.933766Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:16:03.949850Z - running sql script pg/upsert_orders.sql
2022-09-28T11:16:03.949892Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:16:03.954773Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:16:03.958939Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:16:03.959825Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:16:03.963389Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:16:03.964729Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:16:03.969766Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:16:03.970694Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:16:03.971571Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:16:03.977649Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:16:04.003822Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:16:04.009580Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:16:04.015793Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:16:04.023424Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:16:04.088364Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:16:04.097830Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:16:04.098546Z - job completed in 2.12 seconds (82a84e78be14248997e5fc4de63cf68e8da5400d8ca402814feb151f953ea00c)
2022-09-28T11:16:04.130471Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0606"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4731c28b7ca43058e176d5407cdf1519f5782a74601ba4020b8f13e16a32352c)
2022-09-28T11:16:05.503140Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:16:05.520921Z - running sql script pg/insert_tenders.sql
2022-09-28T11:16:05.520963Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:16:05.525384Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:16:05.526837Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:16:05.530871Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:16:05.534540Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:16:05.538756Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:16:05.539676Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:16:05.584412Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:16:05.614983Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:16:05.619293Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:16:05.620745Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:16:05.807665Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:16:05.885520Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:16:05.891339Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:16:06.111984Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:16:06.289522Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:16:06.294975Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:16:06.295440Z - job completed in 2.17 seconds (4731c28b7ca43058e176d5407cdf1519f5782a74601ba4020b8f13e16a32352c)
2022-09-28T11:18:02.014583Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0608"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ea5834c8cb13e1d26ac86212b12f2dafcddfe1526119d08d7b013ffe968ceb41)
2022-09-28T11:18:03.232321Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:18:03.256344Z - running sql script pg/insert_tenders.sql
2022-09-28T11:18:03.256379Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:18:03.260696Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:18:03.262133Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:18:03.266601Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:18:03.270606Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:18:03.275355Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:18:03.276280Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:18:03.324642Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:18:03.358938Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:18:03.363115Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:18:03.364842Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:18:03.642565Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:18:03.737963Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:18:03.744613Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:18:03.963787Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:18:04.142423Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:18:04.147501Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:18:04.147943Z - job completed in 2.13 seconds (ea5834c8cb13e1d26ac86212b12f2dafcddfe1526119d08d7b013ffe968ceb41)
2022-09-28T11:18:04.261409Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0608"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e39f3591aee707e7616e2705379a6911222a2bff566e91acf7ab1d292b513ca3)
2022-09-28T11:18:05.902768Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:18:05.924372Z - running sql script pg/upsert_orders.sql
2022-09-28T11:18:05.924407Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:18:05.929117Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:18:05.933255Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:18:05.934330Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:18:05.937984Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:18:05.942477Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:18:05.946748Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:18:05.947900Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:18:05.948823Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:18:05.955001Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:18:05.980622Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:18:05.987236Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:18:05.991803Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:18:05.997133Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:18:06.060012Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:18:06.067277Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:18:06.067845Z - job completed in 1.81 seconds (e39f3591aee707e7616e2705379a6911222a2bff566e91acf7ab1d292b513ca3)
2022-09-28T11:18:06.135743Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0558"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (2793ad651a81d8168d085f257f6dc4332058d3772e33177552bafc60644756c5)
2022-09-28T11:18:10.622626Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:18:10.639370Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T11:18:10.639424Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:18:10.643912Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T11:18:10.645605Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T11:18:10.646645Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T11:18:10.648344Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T11:18:10.649328Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T11:18:10.650722Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T11:18:10.651746Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:18:10.652598Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T11:18:10.654080Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T11:18:10.656469Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T11:18:10.658468Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T11:18:10.659736Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T11:18:10.663378Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T11:18:10.664874Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T11:18:10.666413Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T11:18:10.675678Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T11:18:10.767117Z - called http://score/api/keyed and received back 204
2022-09-28T11:18:10.767668Z - job completed in 4.63 seconds (2793ad651a81d8168d085f257f6dc4332058d3772e33177552bafc60644756c5)
2022-09-28T11:20:02.297787Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0610"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (261208a299687b2020e5fa35b9c7fb5cf9b98e2ba59a91ddbb57e5207560fb97)
2022-09-28T11:20:04.251408Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:20:04.268638Z - running sql script pg/upsert_orders.sql
2022-09-28T11:20:04.268677Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:20:04.274495Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:20:04.279384Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:20:04.280271Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:20:04.284603Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:20:04.286680Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:20:04.291863Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:20:04.293343Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:20:04.294419Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:20:04.300375Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:20:04.330729Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:20:04.345304Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:20:04.348986Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:20:04.354460Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:20:04.417399Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:20:04.424929Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:20:04.425339Z - job completed in 2.13 seconds (261208a299687b2020e5fa35b9c7fb5cf9b98e2ba59a91ddbb57e5207560fb97)
2022-09-28T11:20:04.448804Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0610"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6339be9503a8bca577a12547bb7a95a4f870a6a5c8b4ac7813cbe81111388264)
2022-09-28T11:20:05.897059Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:20:05.921847Z - running sql script pg/insert_tenders.sql
2022-09-28T11:20:05.922043Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:20:05.927214Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:20:05.928801Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:20:05.934531Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:20:05.938993Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:20:05.943638Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:20:05.944775Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:20:05.991248Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:20:06.035787Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:20:06.043586Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:20:06.045119Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:20:06.274982Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:20:06.369493Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:20:06.375210Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:20:06.590134Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:20:06.768059Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:20:06.772876Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:20:06.773352Z - job completed in 2.33 seconds (6339be9503a8bca577a12547bb7a95a4f870a6a5c8b4ac7813cbe81111388264)
2022-09-28T11:22:01.956005Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0612"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7c2b8654e1de0f852280d5094e89067c996f9aca3b1840e1e486502a93cd46e8)
2022-09-28T11:22:03.327027Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:22:03.344342Z - running sql script pg/insert_tenders.sql
2022-09-28T11:22:03.344385Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:22:03.349056Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:22:03.350411Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:22:03.354739Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:22:03.359243Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:22:03.364146Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:22:03.365626Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:22:03.413773Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:22:03.464989Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:22:03.469439Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:22:03.471433Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:22:03.704583Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:22:03.795630Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:22:03.801688Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:22:04.017105Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:22:04.195342Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:22:04.200619Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:22:04.201071Z - job completed in 2.25 seconds (7c2b8654e1de0f852280d5094e89067c996f9aca3b1840e1e486502a93cd46e8)
2022-09-28T11:22:04.318589Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0612"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (83925844e065bb3bfa8cd747934d59f8d6956ea678ddc2ee4b4880d0b29a069b)
2022-09-28T11:22:06.863595Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:22:06.883134Z - running sql script pg/upsert_orders.sql
2022-09-28T11:22:06.883291Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:22:06.888154Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:22:06.892576Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:22:06.893633Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:22:06.898617Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:22:06.900159Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:22:06.903917Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:22:06.904924Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:22:06.905723Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:22:06.911471Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:22:06.966051Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:22:06.981009Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:22:06.985275Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:22:06.993472Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:22:07.059391Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:22:07.070364Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:22:07.070854Z - job completed in 2.75 seconds (83925844e065bb3bfa8cd747934d59f8d6956ea678ddc2ee4b4880d0b29a069b)
2022-09-28T11:24:01.930945Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0614"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b75025df4f6c062ccde582057b77059fe3ca5a4d1d73898cfc15a5a9278c3994)
2022-09-28T11:24:03.073788Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:24:03.105109Z - running sql script pg/insert_tenders.sql
2022-09-28T11:24:03.105625Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:24:03.110625Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:24:03.112335Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:24:03.117970Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:24:03.145317Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:24:03.153228Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:24:03.154355Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:24:03.200392Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:24:03.253155Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:24:03.258779Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:24:03.260667Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:24:03.491737Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:24:03.584302Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:24:03.589698Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:24:03.805447Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:24:03.983856Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:24:03.988487Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:24:03.988942Z - job completed in 2.06 seconds (b75025df4f6c062ccde582057b77059fe3ca5a4d1d73898cfc15a5a9278c3994)
2022-09-28T11:24:04.122705Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0614"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4a5af9e790dec86c4e82fa03a92e7b8e357e4f4a2317bbc0d471118739808b38)
2022-09-28T11:24:06.015525Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:24:06.031983Z - running sql script pg/upsert_orders.sql
2022-09-28T11:24:06.032019Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:24:06.037218Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:24:06.041809Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:24:06.042856Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:24:06.046829Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:24:06.051414Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:24:06.055828Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:24:06.057972Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:24:06.059201Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:24:06.065884Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:24:06.117348Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:24:06.138987Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:24:06.142761Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:24:06.160548Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:24:06.239898Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:24:06.247945Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:24:06.248351Z - job completed in 2.13 seconds (4a5af9e790dec86c4e82fa03a92e7b8e357e4f4a2317bbc0d471118739808b38)
2022-09-28T11:26:01.908612Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0616"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a3acf67737ca5d8b406e8754fe9f73141dcab838a9a41fcd21cf94b62b2f22a0)
2022-09-28T11:26:04.124534Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:26:04.149450Z - running sql script pg/upsert_orders.sql
2022-09-28T11:26:04.149624Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:26:04.156512Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:26:04.161419Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:26:04.162638Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:26:04.171670Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:26:04.178486Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:26:04.182739Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:26:04.183882Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:26:04.184916Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:26:04.194129Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:26:04.233036Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:26:04.250634Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:26:04.258083Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:26:04.266230Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:26:04.332165Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:26:04.340667Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:26:04.341180Z - job completed in 2.43 seconds (a3acf67737ca5d8b406e8754fe9f73141dcab838a9a41fcd21cf94b62b2f22a0)
2022-09-28T11:26:04.412360Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0616"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (36b3d1fde6c3658cb11446b6728c6454612b142e0b90580452c0d2b60078085f)
2022-09-28T11:26:05.520872Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:26:05.543444Z - running sql script pg/insert_tenders.sql
2022-09-28T11:26:05.543516Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:26:05.548787Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:26:05.551030Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:26:05.554838Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:26:05.558508Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:26:05.563213Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:26:05.564083Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:26:05.610912Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:26:05.645445Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:26:05.649016Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:26:05.650825Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:26:05.881698Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:26:05.975732Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:26:05.984312Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:26:06.072010Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:26:06.252036Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:26:06.254034Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:26:06.254621Z - job completed in 1.84 seconds (36b3d1fde6c3658cb11446b6728c6454612b142e0b90580452c0d2b60078085f)
2022-09-28T11:28:01.909466Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0618"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8ab776a1d0039cb1c7bd40cbf19be73a1c78544f1d15cb41896d1b7446648311)
2022-09-28T11:28:03.146308Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:28:03.163516Z - running sql script pg/insert_tenders.sql
2022-09-28T11:28:03.163583Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:28:03.168208Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:28:03.169660Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:28:03.175308Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:28:03.179218Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:28:03.183445Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:28:03.184433Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:28:03.231051Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:28:03.261906Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:28:03.266162Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:28:03.267905Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:28:03.467097Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:28:03.546975Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:28:03.551461Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:28:03.636696Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:28:03.815599Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:28:03.819804Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:28:03.820330Z - job completed in 1.91 seconds (8ab776a1d0039cb1c7bd40cbf19be73a1c78544f1d15cb41896d1b7446648311)
2022-09-28T11:28:03.904951Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0608"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (801cde115328d947a79c22da7548b46db0bf885261da46d67f2ccfbf9da44603)
2022-09-28T11:28:08.806915Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:28:08.833209Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T11:28:08.833253Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:28:08.838180Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T11:28:08.839709Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T11:28:08.840733Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T11:28:08.841693Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T11:28:08.842701Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T11:28:08.843969Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T11:28:08.844929Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:28:08.845893Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T11:28:08.846826Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T11:28:08.849208Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T11:28:08.850739Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T11:28:08.851844Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T11:28:08.854342Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T11:28:08.855606Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T11:28:08.857042Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T11:28:08.858800Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T11:28:08.954948Z - called http://score/api/keyed and received back 204
2022-09-28T11:28:08.955267Z - job completed in 5.05 seconds (801cde115328d947a79c22da7548b46db0bf885261da46d67f2ccfbf9da44603)
2022-09-28T11:28:09.006163Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0618"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0e774fc09d2a73e5abbad38d2c8d55e930c62edc2f0bf32e477f34407f3a524b)
2022-09-28T11:28:10.898594Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:28:10.917198Z - running sql script pg/upsert_orders.sql
2022-09-28T11:28:10.917487Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:28:10.922939Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:28:10.927654Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:28:10.928841Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:28:10.933128Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:28:10.937324Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:28:10.941663Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:28:10.942777Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:28:10.943841Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:28:10.949542Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:28:10.988226Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:28:11.005867Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:28:11.009674Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:28:11.015865Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:28:11.080649Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:28:11.093930Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:28:11.094442Z - job completed in 2.09 seconds (0e774fc09d2a73e5abbad38d2c8d55e930c62edc2f0bf32e477f34407f3a524b)
2022-09-28T11:30:02.088971Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0620"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (38de8b851530516a8233eef6487f9bf7ccc65f658f8a6c91479dcf5e9b9231b6)
2022-09-28T11:30:04.408090Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:30:04.426326Z - running sql script pg/upsert_orders.sql
2022-09-28T11:30:04.426367Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:30:04.431664Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:30:04.436804Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:30:04.437928Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:30:04.442065Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:30:04.446614Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:30:04.451307Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:30:04.452713Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:30:04.453894Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:30:04.460788Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:30:04.493997Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:30:04.503861Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:30:04.504926Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:30:04.509740Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:30:04.581696Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:30:04.589525Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:30:04.589830Z - job completed in 2.50 seconds (38de8b851530516a8233eef6487f9bf7ccc65f658f8a6c91479dcf5e9b9231b6)
2022-09-28T11:30:04.618589Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0620"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dba2bc98129f0af8214e787cb91c3ef055729d186afbc1a2ce17eba3c0c7227d)
2022-09-28T11:30:06.021294Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:30:06.037783Z - running sql script pg/insert_tenders.sql
2022-09-28T11:30:06.037902Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:30:06.043076Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:30:06.044629Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:30:06.048875Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:30:06.053171Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:30:06.058566Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:30:06.060166Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:30:06.106367Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:30:06.128245Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:30:06.132149Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:30:06.133661Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:30:06.330449Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:30:06.411306Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:30:06.417004Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:30:06.503869Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:30:06.682975Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:30:06.685521Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:30:06.685933Z - job completed in 2.07 seconds (dba2bc98129f0af8214e787cb91c3ef055729d186afbc1a2ce17eba3c0c7227d)
2022-09-28T11:32:01.974470Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0622"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c78743066aa12b979ca54c7673d59d7a87ad99f5e2f759241d2755c55726058e)
2022-09-28T11:32:03.282532Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:32:03.298929Z - running sql script pg/insert_tenders.sql
2022-09-28T11:32:03.299075Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:32:03.304701Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:32:03.306112Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:32:03.307221Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:32:03.308238Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:32:03.309512Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:32:03.311522Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:32:03.314111Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:32:03.315730Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:32:03.316748Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:32:03.318110Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:32:03.319590Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:32:03.320800Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:32:03.322191Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:32:03.324634Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:32:03.327629Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:32:03.330280Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:32:03.330726Z - job completed in 1.36 seconds (c78743066aa12b979ca54c7673d59d7a87ad99f5e2f759241d2755c55726058e)
2022-09-28T11:32:03.398969Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0622"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (57836cc908181b36a373310806d59bf8e1ef4e3fc329e3b3e0ad78dafabff861)
2022-09-28T11:32:05.658014Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:32:05.676336Z - running sql script pg/upsert_orders.sql
2022-09-28T11:32:05.676379Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:32:05.683560Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:32:05.687803Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:32:05.688996Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:32:05.692821Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:32:05.697113Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:32:05.701967Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:32:05.706603Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:32:05.709515Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:32:05.715877Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:32:05.741827Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:32:05.751376Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:32:05.752616Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:32:05.760419Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:32:05.820564Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:32:05.830021Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:32:05.830340Z - job completed in 2.43 seconds (57836cc908181b36a373310806d59bf8e1ef4e3fc329e3b3e0ad78dafabff861)
2022-09-28T11:34:01.949056Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0624"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c11d67ad691d1a64890736735a9515e61ebaeac1d9ee71e26e5faf87670f6fac)
2022-09-28T11:34:03.341301Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:34:03.359096Z - running sql script pg/insert_tenders.sql
2022-09-28T11:34:03.359639Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:34:03.364841Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:34:03.366619Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:34:03.370766Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:34:03.375140Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:34:03.380109Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:34:03.381332Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:34:03.424347Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:34:03.432096Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:34:03.436517Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:34:03.438208Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:34:03.439743Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:34:03.441190Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:34:03.442724Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:34:03.444825Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:34:03.446808Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:34:03.448529Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:34:03.449137Z - job completed in 1.50 seconds (c11d67ad691d1a64890736735a9515e61ebaeac1d9ee71e26e5faf87670f6fac)
2022-09-28T11:34:03.476065Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0624"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (64fd75f226bd44a529248f286c94a2e3d0a6dfe989833d9d62edd41bb0d71e04)
2022-09-28T11:34:05.693633Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:34:05.727140Z - running sql script pg/upsert_orders.sql
2022-09-28T11:34:05.727183Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:34:05.732293Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:34:05.737799Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:34:05.738777Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:34:05.742774Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:34:05.747665Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:34:05.749002Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:34:05.750395Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:34:05.751810Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:34:05.758118Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:34:05.775377Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:34:05.777859Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:34:05.778824Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:34:05.784555Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:34:05.843936Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:34:05.851307Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:34:05.851794Z - job completed in 2.38 seconds (64fd75f226bd44a529248f286c94a2e3d0a6dfe989833d9d62edd41bb0d71e04)
2022-09-28T11:36:01.885455Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0626"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (afb68e5ff8fd89e410a5965a9906cd3264d5dfa3b03df575f7032359b71dcb87)
2022-09-28T11:36:04.181040Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:36:04.201578Z - running sql script pg/upsert_orders.sql
2022-09-28T11:36:04.201715Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:36:04.207068Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:36:04.211876Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:36:04.213235Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:36:04.218135Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:36:04.220222Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:36:04.222489Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:36:04.223619Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:36:04.224977Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:36:04.232690Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:36:04.251355Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:36:04.252896Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:36:04.253999Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:36:04.267679Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:36:04.328633Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:36:04.338634Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:36:04.338937Z - job completed in 2.45 seconds (afb68e5ff8fd89e410a5965a9906cd3264d5dfa3b03df575f7032359b71dcb87)
2022-09-28T11:36:04.356984Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0626"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a69beca2455e39e51f24f1815ef0be874578937259ab768fc60ca37a1c05fb13)
2022-09-28T11:36:05.664643Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:36:05.682536Z - running sql script pg/insert_tenders.sql
2022-09-28T11:36:05.682593Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:36:05.689217Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:36:05.690523Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:36:05.694455Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:36:05.700943Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:36:05.707074Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:36:05.708Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:36:05.754284Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:36:05.755674Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:36:05.756486Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:36:05.757977Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:36:05.860455Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:36:05.900078Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:36:05.907669Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:36:05.995911Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:36:06.171570Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:36:06.173401Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:36:06.173683Z - job completed in 1.82 seconds (a69beca2455e39e51f24f1815ef0be874578937259ab768fc60ca37a1c05fb13)
2022-09-28T11:38:01.896784Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0618"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (f3f756a5533d51964ff720b052b28022c53f6430b93021b9e358f919284a2fa1)
2022-09-28T11:38:06.993667Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:38:07.009812Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T11:38:07.009849Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:38:07.014469Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T11:38:07.016188Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T11:38:07.017169Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T11:38:07.018080Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T11:38:07.019086Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T11:38:07.020958Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T11:38:07.022093Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:38:07.023321Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T11:38:07.024290Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T11:38:07.025894Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T11:38:07.027277Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T11:38:07.028229Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T11:38:07.030498Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T11:38:07.031794Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T11:38:07.032868Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T11:38:07.034989Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T11:38:07.109026Z - called http://score/api/keyed and received back 204
2022-09-28T11:38:07.109120Z - job completed in 5.21 seconds (f3f756a5533d51964ff720b052b28022c53f6430b93021b9e358f919284a2fa1)
2022-09-28T11:38:07.189301Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0628"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (916aaa50394d4138979583c04f7c287b0ce007f739596b363224a381ad80c1b3)
2022-09-28T11:38:08.585439Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:38:08.602676Z - running sql script pg/insert_tenders.sql
2022-09-28T11:38:08.602710Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:38:08.608116Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:38:08.610411Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:38:08.614438Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:38:08.618810Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:38:08.624043Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:38:08.625041Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:38:08.671825Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:38:08.673578Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:38:08.674746Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:38:08.676871Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:38:08.875710Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:38:08.956978Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:38:08.963647Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:38:09.177405Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:38:09.355237Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:38:09.357049Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:38:09.357451Z - job completed in 2.17 seconds (916aaa50394d4138979583c04f7c287b0ce007f739596b363224a381ad80c1b3)
2022-09-28T11:38:09.386781Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0628"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3e7ddec8d1d169b6145fccb59f6a4b2208c712b773bf5896366d4aa219bd1d28)
2022-09-28T11:38:11.164485Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:38:11.182773Z - running sql script pg/upsert_orders.sql
2022-09-28T11:38:11.182831Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:38:11.187778Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:38:11.192613Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:38:11.193809Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:38:11.198308Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:38:11.200356Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:38:11.204357Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:38:11.205638Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:38:11.206939Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:38:11.212984Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:38:11.230339Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:38:11.232552Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:38:11.233848Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:38:11.240918Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:38:11.303936Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:38:11.313516Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:38:11.313936Z - job completed in 1.93 seconds (3e7ddec8d1d169b6145fccb59f6a4b2208c712b773bf5896366d4aa219bd1d28)
2022-09-28T11:40:02.325548Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0630"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (74bc703b1eaade262468ea40b5f4238392ab87e204de7c16ffe3b35f6bf835af)
2022-09-28T11:40:04.621649Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:40:04.642586Z - running sql script pg/upsert_orders.sql
2022-09-28T11:40:04.642629Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:40:04.647281Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:40:04.651360Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:40:04.652388Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:40:04.656412Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:40:04.658248Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:40:04.662946Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:40:04.664024Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:40:04.665243Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:40:04.671578Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:40:04.693024Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:40:04.694708Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:40:04.695913Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:40:04.706281Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:40:04.769746Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:40:04.777726Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:40:04.778174Z - job completed in 2.45 seconds (74bc703b1eaade262468ea40b5f4238392ab87e204de7c16ffe3b35f6bf835af)
2022-09-28T11:40:04.806149Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0630"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a28341f6b94fc867a9229a32e8067d4258a38fb014ef740dde029c728de24e5c)
2022-09-28T11:40:06.111075Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:40:06.130296Z - running sql script pg/insert_tenders.sql
2022-09-28T11:40:06.130331Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:40:06.134909Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:40:06.136271Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:40:06.140602Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:40:06.144835Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:40:06.149074Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:40:06.149915Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:40:06.201218Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:40:06.209082Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:40:06.213563Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:40:06.214855Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:40:06.414650Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:40:06.499680Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:40:06.505336Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:40:06.791801Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:40:06.969908Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:40:06.974721Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:40:06.975424Z - job completed in 2.17 seconds (a28341f6b94fc867a9229a32e8067d4258a38fb014ef740dde029c728de24e5c)
2022-09-28T11:42:02.035780Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0632"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (245a1d869c70091f04ab481a01981f3a259c1dcc7f4e0bf99746fbcc1ab2d194)
2022-09-28T11:42:04.213753Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:42:04.238144Z - running sql script pg/upsert_orders.sql
2022-09-28T11:42:04.238199Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:42:04.242780Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:42:04.247615Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:42:04.248653Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:42:04.252977Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:42:04.254432Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:42:04.258301Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:42:04.259248Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:42:04.260054Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:42:04.265787Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:42:04.322396Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:42:04.358905Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:42:04.362748Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:42:04.368815Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:42:04.431706Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:42:04.439583Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:42:04.439976Z - job completed in 2.40 seconds (245a1d869c70091f04ab481a01981f3a259c1dcc7f4e0bf99746fbcc1ab2d194)
2022-09-28T11:42:04.569678Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0632"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0e1c00c59d12e60f8ed65211e0164deaf8fc4b215dd5bf5bbde41902111cd08f)
2022-09-28T11:42:05.935256Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:42:05.952787Z - running sql script pg/insert_tenders.sql
2022-09-28T11:42:05.952832Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:42:05.957414Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:42:05.958607Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:42:05.962103Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:42:05.966059Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:42:05.970992Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:42:05.972207Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:42:06.018944Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:42:06.085527Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:42:06.089804Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:42:06.091759Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:42:06.310877Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:42:06.392813Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:42:06.398231Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:42:06.613808Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:42:06.793410Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:42:06.798430Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:42:06.798805Z - job completed in 2.23 seconds (0e1c00c59d12e60f8ed65211e0164deaf8fc4b215dd5bf5bbde41902111cd08f)
2022-09-28T11:44:01.888441Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0634"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (519903a9b969ddad4b31d850ec75be472b92ebcd677717128a83fc2c6567d5c6)
2022-09-28T11:44:03.968434Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:44:03.990182Z - running sql script pg/upsert_orders.sql
2022-09-28T11:44:03.990216Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:44:03.995422Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:44:04.000352Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:44:04.001730Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:44:04.006751Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:44:04.011242Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:44:04.016177Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:44:04.017307Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:44:04.018347Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:44:04.025797Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:44:04.152697Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:44:04.226664Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:44:04.232143Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:44:04.241889Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:44:04.377779Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:44:04.388571Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:44:04.389169Z - job completed in 2.50 seconds (519903a9b969ddad4b31d850ec75be472b92ebcd677717128a83fc2c6567d5c6)
2022-09-28T11:44:04.413981Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0634"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (026678861e37e963119c15f27fbbb770a8feb4b3e4cc1de6a9c5feafbaffaf28)
2022-09-28T11:44:05.726670Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:44:05.747183Z - running sql script pg/insert_tenders.sql
2022-09-28T11:44:05.747216Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:44:05.757517Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:44:05.759350Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:44:05.762941Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:44:05.769798Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:44:05.774813Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:44:05.779731Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:44:05.826074Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:44:05.899298Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:44:05.903835Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:44:05.905358Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:44:06.104931Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:44:06.186817Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:44:06.191629Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:44:06.409325Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:44:06.579388Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:44:06.584558Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:44:06.585086Z - job completed in 2.17 seconds (026678861e37e963119c15f27fbbb770a8feb4b3e4cc1de6a9c5feafbaffaf28)
2022-09-28T11:46:01.937919Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0636"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (65aef6b1781cf53e9003090229bfd1850d63e0a184f22d2f7b08f1ebef6d8574)
2022-09-28T11:46:04.117924Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:46:04.138339Z - running sql script pg/upsert_orders.sql
2022-09-28T11:46:04.138378Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:46:04.143729Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:46:04.149097Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:46:04.150476Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:46:04.154350Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:46:04.162109Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:46:04.166522Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:46:04.167592Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:46:04.168557Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:46:04.175491Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:46:04.297795Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:46:04.386598Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:46:04.394735Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:46:04.408133Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:46:04.535932Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:46:04.550431Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:46:04.550753Z - job completed in 2.61 seconds (65aef6b1781cf53e9003090229bfd1850d63e0a184f22d2f7b08f1ebef6d8574)
2022-09-28T11:46:04.585344Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0636"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5a0266935f6599a983a4e102b65cbed65531b29eba6010b3170f922de5c72f75)
2022-09-28T11:46:05.657271Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:46:05.674733Z - running sql script pg/insert_tenders.sql
2022-09-28T11:46:05.674766Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:46:05.679117Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:46:05.680434Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:46:05.685866Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:46:05.690060Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:46:05.696008Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:46:05.697307Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:46:05.743800Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:46:05.812027Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:46:05.816362Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:46:05.817728Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:46:06.027123Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:46:06.113870Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:46:06.120921Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:46:06.335463Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:46:06.511690Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:46:06.517616Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:46:06.518095Z - job completed in 1.93 seconds (5a0266935f6599a983a4e102b65cbed65531b29eba6010b3170f922de5c72f75)
2022-09-28T11:48:01.948067Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0638"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1b16387d1f83caf71ac902b00ba15a14d81c4df7ae324867352913fb7fd76f09)
2022-09-28T11:48:03.266307Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:48:03.282392Z - running sql script pg/insert_tenders.sql
2022-09-28T11:48:03.282423Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:48:03.287374Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:48:03.288832Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:48:03.293040Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:48:03.297267Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:48:03.302272Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:48:03.303379Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:48:03.349613Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:48:03.418756Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:48:03.422896Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:48:03.424319Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:48:03.636326Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:48:03.723335Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:48:03.728778Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:48:03.947955Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:48:04.126604Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:48:04.132608Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:48:04.133227Z - job completed in 2.19 seconds (1b16387d1f83caf71ac902b00ba15a14d81c4df7ae324867352913fb7fd76f09)
2022-09-28T11:48:04.253827Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0628"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (d7c6afc9897a04dc808671f846fdc707a9a5745723254567653571d4b2b8d508)
2022-09-28T11:48:08.873461Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:48:08.890095Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T11:48:08.890712Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:48:08.896186Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T11:48:08.911040Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T11:48:08.912252Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T11:48:08.913186Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T11:48:08.914238Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T11:48:08.915613Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T11:48:08.916666Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:48:08.917667Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T11:48:08.918574Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T11:48:08.920186Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T11:48:08.921707Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T11:48:08.922518Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T11:48:08.924706Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T11:48:08.925617Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T11:48:08.926744Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T11:48:08.928329Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T11:48:09.001459Z - called http://score/api/keyed and received back 204
2022-09-28T11:48:09.001535Z - job completed in 4.75 seconds (d7c6afc9897a04dc808671f846fdc707a9a5745723254567653571d4b2b8d508)
2022-09-28T11:48:09.063874Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0638"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fbb8ca4cf4499183ccaa4d4031108976f3742dc001ba2c54321fefb2f44c63de)
2022-09-28T11:48:11.008675Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:48:11.024712Z - running sql script pg/upsert_orders.sql
2022-09-28T11:48:11.024755Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:48:11.029511Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:48:11.033967Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:48:11.035153Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:48:11.039507Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:48:11.044185Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:48:11.048468Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:48:11.049443Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:48:11.050312Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:48:11.056658Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:48:11.117430Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:48:11.180585Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:48:11.185148Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:48:11.192200Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:48:11.255945Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:48:11.265306Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:48:11.265757Z - job completed in 2.20 seconds (fbb8ca4cf4499183ccaa4d4031108976f3742dc001ba2c54321fefb2f44c63de)
2022-09-28T11:50:02.118015Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0640"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (96cbb8b61e2000cecbda446aacb4c36432ee712f09a14c127548d8f561a762c0)
2022-09-28T11:50:03.407846Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:50:03.426682Z - running sql script pg/insert_tenders.sql
2022-09-28T11:50:03.426712Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:50:03.431948Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:50:03.433632Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:50:03.437798Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:50:03.442854Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:50:03.447435Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:50:03.448648Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:50:03.494862Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:50:03.574590Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:50:03.579249Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:50:03.580702Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:50:03.791648Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:50:03.878230Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:50:03.883796Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:50:04.140647Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:50:04.321318Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:50:04.326257Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:50:04.326770Z - job completed in 2.21 seconds (96cbb8b61e2000cecbda446aacb4c36432ee712f09a14c127548d8f561a762c0)
2022-09-28T11:50:04.467747Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0640"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fef72e26b00677237b85d9b89496c016b8fc82e0eb67e645fa2dd61f7489fcf0)
2022-09-28T11:50:06.662448Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:50:06.679518Z - running sql script pg/upsert_orders.sql
2022-09-28T11:50:06.679586Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:50:06.684135Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:50:06.688564Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:50:06.689776Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:50:06.693644Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:50:06.698052Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:50:06.702782Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:50:06.703911Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:50:06.704867Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:50:06.711061Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:50:06.767241Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:50:06.803253Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:50:06.808090Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:50:06.813935Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:50:06.877231Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:50:06.884719Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:50:06.885416Z - job completed in 2.42 seconds (fef72e26b00677237b85d9b89496c016b8fc82e0eb67e645fa2dd61f7489fcf0)
2022-09-28T11:52:02.131826Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0642"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9a0662e184372e197a44c8fb37cdf49c1a720aa08ec4a45362118a20c09670ed)
2022-09-28T11:52:03.134343Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:52:03.151093Z - running sql script pg/insert_tenders.sql
2022-09-28T11:52:03.151125Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:52:03.155816Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:52:03.157301Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:52:03.161074Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:52:03.164576Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:52:03.168828Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:52:03.170164Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:52:03.228297Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:52:03.249282Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:52:03.253457Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:52:03.254791Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:52:03.468482Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:52:03.555922Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:52:03.563612Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:52:03.782061Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:52:03.959147Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:52:03.964332Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:52:03.964810Z - job completed in 1.83 seconds (9a0662e184372e197a44c8fb37cdf49c1a720aa08ec4a45362118a20c09670ed)
2022-09-28T11:52:04.036989Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0642"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ec7428c1a7ecc58e29ed02b65bb5d50f18d405dc315c02e35491bd09169bc165)
2022-09-28T11:52:09.120818Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:52:09.140207Z - running sql script pg/upsert_orders.sql
2022-09-28T11:52:09.140240Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:52:09.144785Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:52:09.149656Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:52:09.150662Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:52:09.154675Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:52:09.159083Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:52:09.160635Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:52:09.161586Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:52:09.162610Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:52:09.168299Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:52:09.185556Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:52:09.187251Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:52:09.188367Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:52:09.193953Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:52:09.256635Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:52:09.264163Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:52:09.264590Z - job completed in 5.23 seconds (ec7428c1a7ecc58e29ed02b65bb5d50f18d405dc315c02e35491bd09169bc165)
2022-09-28T11:54:01.954154Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0644"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (36796afca9fddcf1f10ce29b33d3d3f42e1985106c197821a00f425dd87dcd94)
2022-09-28T11:54:03.393616Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:54:03.410536Z - running sql script pg/insert_tenders.sql
2022-09-28T11:54:03.410565Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:54:03.415614Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:54:03.417098Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:54:03.422919Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:54:03.427663Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:54:03.432614Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:54:03.433546Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:54:03.479219Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:54:03.486973Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:54:03.494958Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:54:03.500115Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:54:03.709117Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:54:03.800576Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:54:03.805517Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:54:04.016722Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:54:04.185920Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:54:04.193455Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:54:04.193729Z - job completed in 2.24 seconds (36796afca9fddcf1f10ce29b33d3d3f42e1985106c197821a00f425dd87dcd94)
2022-09-28T11:54:04.351773Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0644"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e5ab051923cf87f8515e1b31cc1db825fe0d7189d94dd899db494d6d2966d63a)
2022-09-28T11:54:09.696094Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:54:09.714833Z - running sql script pg/upsert_orders.sql
2022-09-28T11:54:09.714873Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:54:09.720703Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:54:09.725058Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:54:09.726548Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:54:09.730521Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:54:09.732408Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:54:09.734159Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:54:09.735457Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:54:09.737479Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:54:09.743670Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:54:09.764993Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:54:09.766599Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:54:09.767686Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:54:09.775986Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:54:09.842133Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:54:09.867351Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:54:09.868248Z - job completed in 5.52 seconds (e5ab051923cf87f8515e1b31cc1db825fe0d7189d94dd899db494d6d2966d63a)
2022-09-28T11:56:02.032196Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0646"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (734ecca2bfaf0486718271495cca2a267385b14b6cfe6321024d12d1e27fb5c0)
2022-09-28T11:56:04.034835Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:56:04.051683Z - running sql script pg/upsert_orders.sql
2022-09-28T11:56:04.051724Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:56:04.056960Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:56:04.061377Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:56:04.062557Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:56:04.066379Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:56:04.068034Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:56:04.069305Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:56:04.070247Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:56:04.071163Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:56:04.077212Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:56:04.098976Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:56:04.100521Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:56:04.101444Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:56:04.108062Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:56:04.170733Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:56:04.178827Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:56:04.179316Z - job completed in 2.15 seconds (734ecca2bfaf0486718271495cca2a267385b14b6cfe6321024d12d1e27fb5c0)
2022-09-28T11:56:04.278258Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0646"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e4f451f62b12cc59ae15c82dd4aeef97aadf219e075ce4c743e14f232c5ca054)
2022-09-28T11:56:06.515137Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:56:06.533804Z - running sql script pg/insert_tenders.sql
2022-09-28T11:56:06.534056Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:56:06.540315Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:56:06.541509Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:56:06.545966Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:56:06.550224Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:56:06.554913Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:56:06.555878Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:56:06.601585Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:56:06.609321Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:56:06.613746Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:56:06.614983Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:56:06.821015Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:56:06.904154Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:56:06.909697Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:56:07.125601Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:56:07.294056Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:56:07.299379Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:56:07.299862Z - job completed in 3.02 seconds (e4f451f62b12cc59ae15c82dd4aeef97aadf219e075ce4c743e14f232c5ca054)
2022-09-28T11:58:01.877637Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0648"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (702e03c07ff80100518d8f2e69e7c0f9eda67861da21b79aa1dfa1c17432f522)
2022-09-28T11:58:04.435618Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:58:04.451454Z - running sql script pg/upsert_orders.sql
2022-09-28T11:58:04.451484Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:58:04.456491Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T11:58:04.460855Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T11:58:04.461936Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T11:58:04.465891Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T11:58:04.467342Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T11:58:04.469058Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:58:04.470013Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T11:58:04.471266Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T11:58:04.476987Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T11:58:04.493687Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T11:58:04.495275Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T11:58:04.496279Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T11:58:04.502221Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T11:58:04.562519Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T11:58:04.569674Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T11:58:04.569950Z - job completed in 2.69 seconds (702e03c07ff80100518d8f2e69e7c0f9eda67861da21b79aa1dfa1c17432f522)
2022-09-28T11:58:04.604380Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0648"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (cd03ad0049769fd573053dd6ef0d9ffa98fdc339f132b801b1776aa20a8dccc4)
2022-09-28T11:58:05.861254Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:58:05.878156Z - running sql script pg/insert_tenders.sql
2022-09-28T11:58:05.878192Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T11:58:05.883335Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T11:58:05.887631Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T11:58:05.891832Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T11:58:05.893354Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T11:58:05.895061Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T11:58:05.895925Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T11:58:05.898192Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T11:58:05.899655Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T11:58:05.900683Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T11:58:05.901979Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T11:58:05.903487Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T11:58:05.904687Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T11:58:05.906122Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T11:58:05.908128Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T11:58:05.910167Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T11:58:05.911813Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T11:58:05.912051Z - job completed in 1.31 seconds (cd03ad0049769fd573053dd6ef0d9ffa98fdc339f132b801b1776aa20a8dccc4)
2022-09-28T11:58:06.072355Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0638"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (d27f4060b2d942e169a01eb4260a05be0767281cfffc2ae74b9e5d0e2fe1f2c9)
2022-09-28T11:58:14.031438Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T11:58:14.048625Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T11:58:14.048665Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T11:58:14.053895Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T11:58:14.063453Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T11:58:14.064664Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T11:58:14.065838Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T11:58:14.066642Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T11:58:14.067768Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T11:58:14.068578Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T11:58:14.069335Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T11:58:14.070133Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T11:58:14.071855Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T11:58:14.073143Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T11:58:14.074110Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T11:58:14.076484Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T11:58:14.077382Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T11:58:14.078499Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T11:58:14.080148Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T11:58:14.160695Z - called http://score/api/keyed and received back 204
2022-09-28T11:58:14.160798Z - job completed in 8.09 seconds (d27f4060b2d942e169a01eb4260a05be0767281cfffc2ae74b9e5d0e2fe1f2c9)
2022-09-28T12:00:02.351669Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0650"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fd8857294a2d0702878c8429ebf59c00c0fdc42d5dd9499f8500a91ded4a0434)
2022-09-28T12:00:03.748004Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:00:03.777469Z - running sql script pg/insert_tenders.sql
2022-09-28T12:00:03.777502Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:00:03.783172Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:00:03.784841Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:00:03.785990Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:00:03.787084Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:00:03.788427Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:00:03.789402Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:00:03.791446Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:00:03.792836Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:00:03.793800Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:00:03.794959Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:00:03.796143Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:00:03.797869Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:00:03.799831Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:00:03.801855Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:00:03.804021Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:00:03.805657Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:00:03.805945Z - job completed in 1.45 seconds (fd8857294a2d0702878c8429ebf59c00c0fdc42d5dd9499f8500a91ded4a0434)
2022-09-28T12:00:03.866193Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0650"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (67d16c5291c0738a912eb15d49381910a3aea5d739ba363628597017db03e0b6)
2022-09-28T12:00:06.164252Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:00:06.181835Z - running sql script pg/upsert_orders.sql
2022-09-28T12:00:06.181997Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:00:06.186329Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:00:06.190384Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:00:06.191516Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:00:06.195397Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:00:06.196933Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:00:06.198381Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:00:06.199369Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:00:06.200251Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:00:06.205961Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:00:06.223212Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:00:06.224683Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:00:06.232009Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:00:06.237698Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:00:06.298947Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:00:06.308525Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:00:06.309038Z - job completed in 2.44 seconds (67d16c5291c0738a912eb15d49381910a3aea5d739ba363628597017db03e0b6)
2022-09-28T12:02:02.005766Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0652"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8a1766ae7b42a5fb40299f06dba786d39b31239ac6b9dbbb4e9f2872dff6be70)
2022-09-28T12:02:04.443826Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:02:04.462003Z - running sql script pg/upsert_orders.sql
2022-09-28T12:02:04.462036Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:02:04.467470Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:02:04.472307Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:02:04.473389Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:02:04.477658Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:02:04.479237Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:02:04.481239Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:02:04.482264Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:02:04.483739Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:02:04.489886Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:02:04.511170Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:02:04.513384Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:02:04.514513Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:02:04.521681Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:02:04.589396Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:02:04.598821Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:02:04.599194Z - job completed in 2.59 seconds (8a1766ae7b42a5fb40299f06dba786d39b31239ac6b9dbbb4e9f2872dff6be70)
2022-09-28T12:02:04.667076Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0652"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b119bc0e6afa838573f05cc661876df22d016ca9ab11d7584b3160f2d3b3110c)
2022-09-28T12:02:05.963430Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:02:05.980317Z - running sql script pg/insert_tenders.sql
2022-09-28T12:02:05.980359Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:02:05.985516Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:02:05.986786Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:02:05.987773Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:02:05.988746Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:02:05.990124Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:02:05.990979Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:02:05.993081Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:02:05.994657Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:02:05.995582Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:02:05.996890Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:02:05.998245Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:02:05.999598Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:02:06.000852Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:02:06.002653Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:02:06.006234Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:02:06.007830Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:02:06.008183Z - job completed in 1.34 seconds (b119bc0e6afa838573f05cc661876df22d016ca9ab11d7584b3160f2d3b3110c)
2022-09-28T12:04:01.940596Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0654"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ca7ba465176e0de5ab48179fcb50c0d7f1c0e49a2a18c41174d95db54aaedbd7)
2022-09-28T12:04:04.151874Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:04:04.167418Z - running sql script pg/upsert_orders.sql
2022-09-28T12:04:04.167449Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:04:04.172124Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:04:04.176410Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:04:04.177587Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:04:04.181350Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:04:04.191608Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:04:04.203612Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:04:04.207026Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:04:04.209389Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:04:04.219591Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:04:04.242201Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:04:04.243671Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:04:04.244570Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:04:04.252225Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:04:04.326579Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:04:04.337695Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:04:04.338083Z - job completed in 2.40 seconds (ca7ba465176e0de5ab48179fcb50c0d7f1c0e49a2a18c41174d95db54aaedbd7)
2022-09-28T12:04:04.414137Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0654"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (79715759e69ad856b71f74c2c228c190bc08d71d0bd2448dfbe28307cec04d9c)
2022-09-28T12:04:05.805188Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:04:05.824112Z - running sql script pg/insert_tenders.sql
2022-09-28T12:04:05.824169Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:04:05.828645Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:04:05.830271Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:04:05.836667Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:04:05.844373Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:04:05.848908Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:04:05.849867Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:04:05.889240Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:04:05.911081Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:04:05.915432Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:04:05.916923Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:04:05.918310Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:04:05.919523Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:04:05.921Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:04:05.922785Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:04:05.924666Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:04:05.926294Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:04:05.926586Z - job completed in 1.51 seconds (79715759e69ad856b71f74c2c228c190bc08d71d0bd2448dfbe28307cec04d9c)
2022-09-28T12:06:02.300931Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0656"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2b53403746335ae7f4933cd89c980be0cd6902b67de183a97e0124cd35a53cec)
2022-09-28T12:06:04.923442Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:06:04.939803Z - running sql script pg/upsert_orders.sql
2022-09-28T12:06:04.939834Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:06:04.944147Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:06:04.948766Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:06:04.949792Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:06:04.953991Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:06:04.955609Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:06:04.959718Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:06:04.960745Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:06:04.961624Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:06:04.968850Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:06:05.004199Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:06:05.009755Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:06:05.013922Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:06:05.021497Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:06:05.086003Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:06:05.102739Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:06:05.103155Z - job completed in 2.80 seconds (2b53403746335ae7f4933cd89c980be0cd6902b67de183a97e0124cd35a53cec)
2022-09-28T12:06:05.189083Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0656"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (11cffb039b4c62337d0ac28d8f3092d9d0efd666b2dd3772092c0410506824f3)
2022-09-28T12:06:06.486518Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:06:06.501851Z - running sql script pg/insert_tenders.sql
2022-09-28T12:06:06.501896Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:06:06.506598Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:06:06.507855Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:06:06.512766Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:06:06.516846Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:06:06.520935Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:06:06.521804Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:06:06.567677Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:06:06.575193Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:06:06.579322Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:06:06.580671Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:06:06.594348Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:06:06.600382Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:06:06.609383Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:06:06.700044Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:06:06.880734Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:06:06.882781Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:06:06.883147Z - job completed in 1.69 seconds (11cffb039b4c62337d0ac28d8f3092d9d0efd666b2dd3772092c0410506824f3)
2022-09-28T12:08:01.932246Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0658"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d78ae85c08595709820e0668cf54b97fac53af39c996d1e6b785fef597d6a926)
2022-09-28T12:08:03.240279Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:08:03.255614Z - running sql script pg/insert_tenders.sql
2022-09-28T12:08:03.255643Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:08:03.260786Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:08:03.261961Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:08:03.266068Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:08:03.270055Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:08:03.274818Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:08:03.276130Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:08:03.322408Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:08:03.340580Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:08:03.347938Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:08:03.349517Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:08:03.552905Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:08:03.659987Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:08:03.666543Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:08:03.931788Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:08:04.114664Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:08:04.120186Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:08:04.120902Z - job completed in 2.19 seconds (d78ae85c08595709820e0668cf54b97fac53af39c996d1e6b785fef597d6a926)
2022-09-28T12:08:04.162666Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0648"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (a8911350c6240499b3457edaf4ef94de6719922a93caee67c8dace2c0ace614d)
2022-09-28T12:08:08.987904Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:08:09.002960Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T12:08:09.002992Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:08:09.007380Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T12:08:09.012236Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T12:08:09.013250Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T12:08:09.014119Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T12:08:09.015041Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T12:08:09.016201Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T12:08:09.017102Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:08:09.018005Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T12:08:09.018901Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T12:08:09.020898Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T12:08:09.022219Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T12:08:09.023939Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T12:08:09.026182Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T12:08:09.027438Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T12:08:09.028714Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T12:08:09.030115Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T12:08:09.109800Z - called http://score/api/keyed and received back 204
2022-09-28T12:08:09.109899Z - job completed in 4.95 seconds (a8911350c6240499b3457edaf4ef94de6719922a93caee67c8dace2c0ace614d)
2022-09-28T12:08:09.142110Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0658"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4f8a9a07e34a8035a5bd0fb2f08dd0803ac4b0fa150817ba692ed1dcb5fc89fc)
2022-09-28T12:08:11.382920Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:08:11.399968Z - running sql script pg/upsert_orders.sql
2022-09-28T12:08:11.400220Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:08:11.405133Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:08:11.409726Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:08:11.411077Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:08:11.415258Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:08:11.417327Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:08:11.422282Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:08:11.423439Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:08:11.424625Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:08:11.431173Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:08:11.477875Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:08:11.483872Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:08:11.488338Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:08:11.498186Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:08:11.582188Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:08:11.604280Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:08:11.604820Z - job completed in 2.46 seconds (4f8a9a07e34a8035a5bd0fb2f08dd0803ac4b0fa150817ba692ed1dcb5fc89fc)
2022-09-28T12:10:02.283814Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0700"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (eb9c7b45f8ed7f71cb7970e4c6946b52c6b98b4c3b79030686db42f3e5e0324e)
2022-09-28T12:10:04.230011Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:10:04.248136Z - running sql script pg/upsert_orders.sql
2022-09-28T12:10:04.248189Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:10:04.253194Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:10:04.259305Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:10:04.260260Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:10:04.267630Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:10:04.273279Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:10:04.283248Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:10:04.290078Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:10:04.291431Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:10:04.298932Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:10:04.370545Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:10:04.389001Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:10:04.393858Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:10:04.403404Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:10:04.478678Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:10:04.495642Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:10:04.496184Z - job completed in 2.21 seconds (eb9c7b45f8ed7f71cb7970e4c6946b52c6b98b4c3b79030686db42f3e5e0324e)
2022-09-28T12:10:04.535042Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0700"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0af79046a926bee92b69f591572dea40e6df2c537aa32708f88acd5ea1df8dda)
2022-09-28T12:10:05.820731Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:10:05.843818Z - running sql script pg/insert_tenders.sql
2022-09-28T12:10:05.843863Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:10:05.848567Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:10:05.850289Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:10:05.854321Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:10:05.858243Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:10:05.863211Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:10:05.864970Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:10:05.911270Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:10:05.929004Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:10:05.933241Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:10:05.934740Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:10:06.139061Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:10:06.223410Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:10:06.228948Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:10:06.445110Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:10:06.634423Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:10:06.644435Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:10:06.644717Z - job completed in 2.11 seconds (0af79046a926bee92b69f591572dea40e6df2c537aa32708f88acd5ea1df8dda)
2022-09-28T12:12:02.101417Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0702"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (030be9f0881ef886a1dfd7a410772372b552c6249f629dc87043f631a53af0ef)
2022-09-28T12:12:04.709524Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:12:04.728832Z - running sql script pg/upsert_orders.sql
2022-09-28T12:12:04.728868Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:12:04.733493Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:12:04.737881Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:12:04.739119Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:12:04.743576Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:12:04.747911Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:12:04.752421Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:12:04.753584Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:12:04.754541Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:12:04.760976Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:12:04.840891Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:12:04.858708Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:12:04.863615Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:12:04.872407Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:12:04.947713Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:12:04.958001Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:12:04.958357Z - job completed in 2.86 seconds (030be9f0881ef886a1dfd7a410772372b552c6249f629dc87043f631a53af0ef)
2022-09-28T12:12:04.983083Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0702"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (05759b8729dca724a9cf0ea52e7e8ddbdd90e68ff94bdfdff9a6315e9c6e57ff)
2022-09-28T12:12:06.385409Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:12:06.401284Z - running sql script pg/insert_tenders.sql
2022-09-28T12:12:06.401325Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:12:06.405586Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:12:06.406926Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:12:06.411024Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:12:06.415049Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:12:06.419860Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:12:06.420722Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:12:06.466307Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:12:06.479585Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:12:06.483590Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:12:06.485019Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:12:06.686532Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:12:06.769538Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:12:06.776764Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:12:06.989497Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:12:07.173462Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:12:07.180014Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:12:07.180543Z - job completed in 2.20 seconds (05759b8729dca724a9cf0ea52e7e8ddbdd90e68ff94bdfdff9a6315e9c6e57ff)
2022-09-28T12:14:01.930650Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0704"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (54034f50f5ae57620915c113bcbd1df5efedbcdd4df94cd46307929a8e54692b)
2022-09-28T12:14:03.195143Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:14:03.215813Z - running sql script pg/insert_tenders.sql
2022-09-28T12:14:03.215845Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:14:03.220983Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:14:03.222524Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:14:03.226799Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:14:03.231846Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:14:03.237254Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:14:03.240149Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:14:03.307714Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:14:03.349303Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:14:03.354194Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:14:03.356256Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:14:03.558699Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:14:03.643752Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:14:03.650699Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:14:03.901387Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:14:04.087118Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:14:04.092197Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:14:04.093587Z - job completed in 2.16 seconds (54034f50f5ae57620915c113bcbd1df5efedbcdd4df94cd46307929a8e54692b)
2022-09-28T12:14:04.120648Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0704"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d22eca2f0d71afcb0959a81ed228bbb429b6793180e241b67a0970f32a84078c)
2022-09-28T12:14:06.442765Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:14:06.463278Z - running sql script pg/upsert_orders.sql
2022-09-28T12:14:06.463946Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:14:06.470134Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:14:06.474796Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:14:06.476168Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:14:06.484135Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:14:06.489057Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:14:06.494275Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:14:06.496291Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:14:06.497648Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:14:06.507126Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:14:06.606601Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:14:06.633304Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:14:06.637356Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:14:06.643895Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:14:06.709163Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:14:06.722334Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:14:06.722669Z - job completed in 2.60 seconds (d22eca2f0d71afcb0959a81ed228bbb429b6793180e241b67a0970f32a84078c)
2022-09-28T12:16:02.021498Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0706"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (110d4e8c0b0d68452983ee79311d886a7ab84f7dd7a04d5ad009a59d1fee1f79)
2022-09-28T12:16:03.432744Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:16:03.449149Z - running sql script pg/insert_tenders.sql
2022-09-28T12:16:03.449178Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:16:03.453849Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:16:03.455221Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:16:03.460325Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:16:03.466293Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:16:03.472108Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:16:03.473231Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:16:03.520222Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:16:03.554002Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:16:03.558114Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:16:03.559548Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:16:03.782200Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:16:03.867380Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:16:03.877675Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:16:04.102775Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:16:04.299865Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:16:04.309327Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:16:04.310017Z - job completed in 2.29 seconds (110d4e8c0b0d68452983ee79311d886a7ab84f7dd7a04d5ad009a59d1fee1f79)
2022-09-28T12:16:04.386199Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0706"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0eb71863496bff86ef40a339fe471e0f6279daa72e42d1b2bef9d2a0212a796c)
2022-09-28T12:16:06.872108Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:16:06.889947Z - running sql script pg/upsert_orders.sql
2022-09-28T12:16:06.889982Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:16:06.894791Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:16:06.899840Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:16:06.900889Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:16:06.904964Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:16:06.909992Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:16:06.914287Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:16:06.915665Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:16:06.916873Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:16:06.923289Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:16:07.015875Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:16:07.038109Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:16:07.042923Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:16:07.052665Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:16:07.120562Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:16:07.142572Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:16:07.143096Z - job completed in 2.76 seconds (0eb71863496bff86ef40a339fe471e0f6279daa72e42d1b2bef9d2a0212a796c)
2022-09-28T12:18:01.967300Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0708"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (54421039a899baa25e59092aeeaad4181bbdbafb2caaa2a456aceac32ee9b57c)
2022-09-28T12:18:03.647585Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:18:03.664691Z - running sql script pg/insert_tenders.sql
2022-09-28T12:18:03.664731Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:18:03.669503Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:18:03.670834Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:18:03.675324Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:18:03.679651Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:18:03.684341Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:18:03.685455Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:18:03.732110Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:18:03.800483Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:18:03.804937Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:18:03.806734Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:18:04.016543Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:18:04.100546Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:18:04.109470Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:18:04.346281Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:18:04.544403Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:18:04.549484Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:18:04.549806Z - job completed in 2.58 seconds (54421039a899baa25e59092aeeaad4181bbdbafb2caaa2a456aceac32ee9b57c)
2022-09-28T12:18:04.604087Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0658"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (eed2c29c5549dde7bbcb339a20fe49e3c212e5c8e40edb682f58822050de131b)
2022-09-28T12:18:09.297099Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:18:09.316021Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T12:18:09.316059Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:18:09.321263Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T12:18:09.323428Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T12:18:09.324742Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T12:18:09.325763Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T12:18:09.326822Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T12:18:09.328993Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T12:18:09.330566Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:18:09.332442Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T12:18:09.333392Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T12:18:09.335723Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T12:18:09.337525Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T12:18:09.338578Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T12:18:09.345928Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T12:18:09.346969Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T12:18:09.348466Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T12:18:09.350378Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T12:18:09.486487Z - called http://score/api/keyed and received back 204
2022-09-28T12:18:09.486606Z - job completed in 4.88 seconds (eed2c29c5549dde7bbcb339a20fe49e3c212e5c8e40edb682f58822050de131b)
2022-09-28T12:18:09.571388Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0708"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b799f86262f10ba2bb7f758089e6705e960d5492849702cae96b6a1ededb6661)
2022-09-28T12:18:11.834019Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:18:11.861274Z - running sql script pg/upsert_orders.sql
2022-09-28T12:18:11.861325Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:18:11.865840Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:18:11.870690Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:18:11.872175Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:18:11.876542Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:18:11.883058Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:18:11.887871Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:18:11.889108Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:18:11.890700Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:18:11.897739Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:18:12.037188Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:18:12.100494Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:18:12.104656Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:18:12.115242Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:18:12.191845Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:18:12.234574Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:18:12.235107Z - job completed in 2.66 seconds (b799f86262f10ba2bb7f758089e6705e960d5492849702cae96b6a1ededb6661)
2022-09-28T12:20:02.805827Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0710"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (828951a0e740e11395a1c732e1d04800a693d8c31cfdd00455607903fe00211c)
2022-09-28T12:20:04.151460Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:20:04.168672Z - running sql script pg/insert_tenders.sql
2022-09-28T12:20:04.168710Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:20:04.173413Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:20:04.175413Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:20:04.179735Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:20:04.183609Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:20:04.188698Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:20:04.189601Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:20:04.236957Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:20:04.308652Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:20:04.313Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:20:04.314432Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:20:04.548958Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:20:04.644769Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:20:04.652130Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:20:04.887871Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:20:05.074395Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:20:05.079496Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:20:05.080014Z - job completed in 2.27 seconds (828951a0e740e11395a1c732e1d04800a693d8c31cfdd00455607903fe00211c)
2022-09-28T12:20:05.163723Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0710"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (40538273955a3f1c28cab663e8fa2c683867e172afc9e896300d1b671817f9ae)
2022-09-28T12:20:07.533261Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:20:07.553340Z - running sql script pg/upsert_orders.sql
2022-09-28T12:20:07.553382Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:20:07.558592Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:20:07.563507Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:20:07.564548Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:20:07.571061Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:20:07.572591Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:20:07.577016Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:20:07.577979Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:20:07.578872Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:20:07.584957Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:20:07.724116Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:20:07.793040Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:20:07.797722Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:20:07.804476Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:20:07.868045Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:20:07.892469Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:20:07.892970Z - job completed in 2.73 seconds (40538273955a3f1c28cab663e8fa2c683867e172afc9e896300d1b671817f9ae)
2022-09-28T12:22:02.449984Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0712"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1e682c9eb9eb2ffd47aa325abab952600e36ea8fe875d077b18ba7b4849e0a32)
2022-09-28T12:22:06.634874Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:22:06.660882Z - running sql script pg/upsert_orders.sql
2022-09-28T12:22:06.660926Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:22:06.665278Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:22:06.669726Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:22:06.670746Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:22:06.674976Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:22:06.679124Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:22:06.683586Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:22:06.684563Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:22:06.685514Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:22:06.691862Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:22:06.826606Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:22:06.902818Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:22:06.906738Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:22:06.919091Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:22:06.984905Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:22:07.007592Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:22:07.008589Z - job completed in 4.56 seconds (1e682c9eb9eb2ffd47aa325abab952600e36ea8fe875d077b18ba7b4849e0a32)
2022-09-28T12:22:07.104640Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0712"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c1a8dc7f78e35b6526be470c5677604057765b63a502ad80765498a5cc5095ef)
2022-09-28T12:22:09.379955Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:22:09.397239Z - running sql script pg/insert_tenders.sql
2022-09-28T12:22:09.397740Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:22:09.402569Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:22:09.404093Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:22:09.408778Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:22:09.413140Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:22:09.418415Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:22:09.420291Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:22:09.466532Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:22:09.537651Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:22:09.541818Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:22:09.543176Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:22:09.812135Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:22:09.983619Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:22:09.996084Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:22:10.445558Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:22:10.761815Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:22:10.767838Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:22:10.768366Z - job completed in 3.66 seconds (c1a8dc7f78e35b6526be470c5677604057765b63a502ad80765498a5cc5095ef)
2022-09-28T12:24:02.029113Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0714"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (cfedc65ea5505ce1b95f29637c7b642d72b2f4b0497f89b8d31f4e96bb1ad7e3)
2022-09-28T12:24:04.401728Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:24:04.419523Z - running sql script pg/upsert_orders.sql
2022-09-28T12:24:04.419788Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:24:04.425838Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:24:04.432440Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:24:04.433415Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:24:04.437793Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:24:04.443294Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:24:04.447784Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:24:04.448726Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:24:04.449718Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:24:04.456102Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:24:04.583686Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:24:04.657715Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:24:04.662115Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:24:04.668160Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:24:04.732378Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:24:04.745713Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:24:04.746045Z - job completed in 2.72 seconds (cfedc65ea5505ce1b95f29637c7b642d72b2f4b0497f89b8d31f4e96bb1ad7e3)
2022-09-28T12:24:04.848571Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0714"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6291fa0d0a090a1d206641fb33a0c1b649ca32e9ef18a57071cafffc1c5f2e11)
2022-09-28T12:24:06.028081Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:24:06.046176Z - running sql script pg/insert_tenders.sql
2022-09-28T12:24:06.046366Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:24:06.052355Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:24:06.054004Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:24:06.063731Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:24:06.068521Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:24:06.073614Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:24:06.074494Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:24:06.136388Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:24:06.286053Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:24:06.291086Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:24:06.293047Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:24:06.527815Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:24:06.627436Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:24:06.633645Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:24:06.859796Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:24:07.042419Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:24:07.047428Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:24:07.048040Z - job completed in 2.20 seconds (6291fa0d0a090a1d206641fb33a0c1b649ca32e9ef18a57071cafffc1c5f2e11)
2022-09-28T12:26:02.191055Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0716"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (98819c16964511cd07bc44f4e99f998c747f42d1bc4d0a667f8e33e5d6b4a3bf)
2022-09-28T12:26:03.554715Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:26:03.571589Z - running sql script pg/insert_tenders.sql
2022-09-28T12:26:03.571620Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:26:03.579108Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:26:03.581339Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:26:03.587011Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:26:03.591380Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:26:03.596247Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:26:03.597247Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:26:03.646452Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:26:03.725978Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:26:03.730041Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:26:03.734931Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:26:03.965146Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:26:04.083773Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:26:04.093880Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:26:04.328860Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:26:04.520884Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:26:04.525704Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:26:04.534223Z - job completed in 2.34 seconds (98819c16964511cd07bc44f4e99f998c747f42d1bc4d0a667f8e33e5d6b4a3bf)
2022-09-28T12:26:04.671033Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0716"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (593014ccb5710dd52b38369e39e694a8dd5a1169ed51900c0a81341a2dbe833c)
2022-09-28T12:26:06.904561Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:26:06.927457Z - running sql script pg/upsert_orders.sql
2022-09-28T12:26:06.927497Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:26:06.934563Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:26:06.946026Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:26:06.947408Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:26:06.951576Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:26:06.956261Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:26:06.960796Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:26:06.961789Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:26:06.962639Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:26:06.987626Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:26:07.147398Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:26:07.232442Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:26:07.237889Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:26:07.248877Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:26:07.315099Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:26:07.331305Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:26:07.337878Z - job completed in 2.67 seconds (593014ccb5710dd52b38369e39e694a8dd5a1169ed51900c0a81341a2dbe833c)
2022-09-28T12:28:01.903604Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0718"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (69a83c509cd84223e3f2e30d074ed779acb18b45a52ead1c746da3f5d5167b77)
2022-09-28T12:28:03.708480Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:28:03.727652Z - running sql script pg/upsert_orders.sql
2022-09-28T12:28:03.727697Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:28:03.733Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:28:03.738041Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:28:03.739333Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:28:03.743596Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:28:03.748065Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:28:03.752396Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:28:03.753570Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:28:03.754494Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:28:03.768642Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:28:03.877167Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:28:03.920258Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:28:03.925106Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:28:03.939208Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:28:04.015221Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:28:04.031099Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:28:04.031495Z - job completed in 2.13 seconds (69a83c509cd84223e3f2e30d074ed779acb18b45a52ead1c746da3f5d5167b77)
2022-09-28T12:28:04.166295Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0708"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (ff0601e218c6fc0fdaf37dd7a70e08a59fcc6f311836f39cb12e624d2b7cfe87)
2022-09-28T12:28:09.560977Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:28:09.581827Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T12:28:09.581872Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:28:09.587602Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T12:28:09.596740Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T12:28:09.600633Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T12:28:09.602062Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T12:28:09.608724Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T12:28:09.614223Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T12:28:09.618779Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:28:09.620226Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T12:28:09.621618Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T12:28:09.627938Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T12:28:09.634103Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T12:28:09.635036Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T12:28:09.641990Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T12:28:09.646342Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T12:28:09.650616Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T12:28:09.666339Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T12:28:10.988579Z - called http://score/api/keyed and received back 200
2022-09-28T12:28:10.988674Z - job completed in 6.82 seconds (ff0601e218c6fc0fdaf37dd7a70e08a59fcc6f311836f39cb12e624d2b7cfe87)
2022-09-28T12:28:11.004223Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0718"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (28f73b9ffad5e07ddaa1b970d4e596d3efe85c3bbf4c22e094aa99d07a5ccc36)
2022-09-28T12:28:12.226906Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:28:12.255863Z - running sql script pg/insert_tenders.sql
2022-09-28T12:28:12.255904Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:28:12.260552Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:28:12.262140Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:28:12.266587Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:28:12.270651Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:28:12.275163Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:28:12.275992Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:28:12.322078Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:28:12.375405Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:28:12.379432Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:28:12.380907Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:28:12.613164Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:28:12.709707Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:28:12.721044Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:28:12.950704Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:28:13.141200Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:28:13.149806Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:28:13.150274Z - job completed in 2.15 seconds (28f73b9ffad5e07ddaa1b970d4e596d3efe85c3bbf4c22e094aa99d07a5ccc36)
2022-09-28T12:30:02.341270Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0720"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (eebafc8417ac7adc0e6b886e9bb98682123a652dd02491fc5b8438b075445576)
2022-09-28T12:30:04.979435Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:30:04.996135Z - running sql script pg/upsert_orders.sql
2022-09-28T12:30:04.996170Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:30:05.000770Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:30:05.005197Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:30:05.006208Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:30:05.010555Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:30:05.015254Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:30:05.019587Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:30:05.020593Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:30:05.021491Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:30:05.028400Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:30:05.128468Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:30:05.162378Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:30:05.166823Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:30:05.174708Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:30:05.242431Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:30:05.256836Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:30:05.257288Z - job completed in 2.92 seconds (eebafc8417ac7adc0e6b886e9bb98682123a652dd02491fc5b8438b075445576)
2022-09-28T12:30:05.367847Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0720"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (49043c01428ea9e2f287bf0d13d74964853889c5ae83c343522325b4ede2d6af)
2022-09-28T12:30:06.487503Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:30:06.505340Z - running sql script pg/insert_tenders.sql
2022-09-28T12:30:06.505372Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:30:06.510754Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:30:06.512155Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:30:06.516885Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:30:06.521401Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:30:06.526353Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:30:06.527454Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:30:06.573796Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:30:06.604780Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:30:06.608954Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:30:06.610467Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:30:06.842644Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:30:06.938737Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:30:06.947599Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:30:07.176559Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:30:07.364155Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:30:07.369598Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:30:07.370167Z - job completed in 2.00 seconds (49043c01428ea9e2f287bf0d13d74964853889c5ae83c343522325b4ede2d6af)
2022-09-28T12:32:02.235861Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0722"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a8dd0b3305e1ec931a0144cc41d25cdf6c8d5c434682caf1add14e6127bb278b)
2022-09-28T12:32:03.661630Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:32:03.677822Z - running sql script pg/insert_tenders.sql
2022-09-28T12:32:03.677854Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:32:03.682647Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:32:03.684093Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:32:03.688652Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:32:03.693552Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:32:03.699303Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:32:03.700469Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:32:03.746268Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:32:03.767806Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:32:03.772256Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:32:03.773511Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:32:03.983323Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:32:04.069765Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:32:04.079362Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:32:04.312552Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:32:04.500750Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:32:04.505862Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:32:04.506284Z - job completed in 2.27 seconds (a8dd0b3305e1ec931a0144cc41d25cdf6c8d5c434682caf1add14e6127bb278b)
2022-09-28T12:32:04.532286Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0722"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7f395ee02f87073304528cf6737f9dd0e728d4f6e724ecc700bcc89aa236f521)
2022-09-28T12:32:07.049975Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:32:07.066723Z - running sql script pg/upsert_orders.sql
2022-09-28T12:32:07.066755Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:32:07.071944Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:32:07.076453Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:32:07.077722Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:32:07.084108Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:32:07.089153Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:32:07.094932Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:32:07.096422Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:32:07.097996Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:32:07.104953Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:32:07.289387Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:32:07.342725Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:32:07.351595Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:32:07.363597Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:32:07.434327Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:32:07.443692Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:32:07.444331Z - job completed in 2.91 seconds (7f395ee02f87073304528cf6737f9dd0e728d4f6e724ecc700bcc89aa236f521)
2022-09-28T12:34:02.029929Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0724"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d4e5ef0056835814763ce03ccf91b2e2ae8eef7c6431f9d0fa95e682dd372322)
2022-09-28T12:34:03.886909Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:34:03.904231Z - running sql script pg/upsert_orders.sql
2022-09-28T12:34:03.904275Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:34:03.911056Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:34:03.916123Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:34:03.917171Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:34:03.921433Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:34:03.926034Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:34:03.930932Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:34:03.931971Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:34:03.932855Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:34:03.939361Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:34:04.069535Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:34:04.104609Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:34:04.109312Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:34:04.116688Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:34:04.234554Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:34:04.244226Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:34:04.244695Z - job completed in 2.22 seconds (d4e5ef0056835814763ce03ccf91b2e2ae8eef7c6431f9d0fa95e682dd372322)
2022-09-28T12:34:04.340845Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0724"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1df40f13c00feebf7965ac79808933598e75c787e8fdb54b1f20cd4d675c5017)
2022-09-28T12:34:05.673012Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:34:05.692155Z - running sql script pg/insert_tenders.sql
2022-09-28T12:34:05.692384Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:34:05.698133Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:34:05.699606Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:34:05.704189Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:34:05.708339Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:34:05.717692Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:34:05.719035Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:34:05.766350Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:34:05.797573Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:34:05.801933Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:34:05.803649Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:34:06.021002Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:34:06.110805Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:34:06.119714Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:34:06.354559Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:34:06.547714Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:34:06.554722Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:34:06.555219Z - job completed in 2.22 seconds (1df40f13c00feebf7965ac79808933598e75c787e8fdb54b1f20cd4d675c5017)
2022-09-28T12:36:02.056358Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0726"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (380decca99ce53082be0071442fd4e479ad7105454866728fa9aedf8af4ce256)
2022-09-28T12:36:06.666395Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:36:06.683616Z - running sql script pg/upsert_orders.sql
2022-09-28T12:36:06.683705Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:36:06.688695Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:36:06.693549Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:36:06.694782Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:36:06.701766Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:36:06.706349Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:36:06.710733Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:36:06.713370Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:36:06.714647Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:36:06.721061Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:36:06.833632Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:36:06.872672Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:36:06.876957Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:36:06.887869Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:36:06.963581Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:36:06.976809Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:36:06.977540Z - job completed in 4.92 seconds (380decca99ce53082be0071442fd4e479ad7105454866728fa9aedf8af4ce256)
2022-09-28T12:36:07.027Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0726"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3bb886532a8eb41f1cb036379fe495529a03a04a8ec932c4412687e73c14b46f)
2022-09-28T12:36:08.106687Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:36:08.125830Z - running sql script pg/insert_tenders.sql
2022-09-28T12:36:08.125864Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:36:08.130857Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:36:08.132597Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:36:08.138087Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:36:08.142872Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:36:08.147805Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:36:08.149008Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:36:08.196891Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:36:08.227271Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:36:08.231623Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:36:08.233120Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:36:08.445144Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:36:08.536412Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:36:08.544601Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:36:08.775698Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:36:09.029915Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:36:09.035982Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:36:09.036445Z - job completed in 2.01 seconds (3bb886532a8eb41f1cb036379fe495529a03a04a8ec932c4412687e73c14b46f)
2022-09-28T12:38:01.965086Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0718"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (4f6121913dfb7ee3b545347a07f31761d6e000901b96f959614bcb851554ee1f)
2022-09-28T12:38:06.804581Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:38:06.820036Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T12:38:06.820067Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:38:06.824225Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T12:38:06.828402Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T12:38:06.832373Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T12:38:06.833256Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T12:38:06.836771Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T12:38:06.840662Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T12:38:06.841698Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:38:06.842621Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T12:38:06.843526Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T12:38:06.848906Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T12:38:06.853388Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T12:38:06.854354Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T12:38:06.872326Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T12:38:06.876883Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T12:38:06.881220Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T12:38:06.886870Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T12:38:07.577578Z - called http://score/api/keyed and received back 200
2022-09-28T12:38:07.577671Z - job completed in 5.61 seconds (4f6121913dfb7ee3b545347a07f31761d6e000901b96f959614bcb851554ee1f)
2022-09-28T12:38:07.595114Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0728"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (917c4453824fbe82f01d0e2e47509c8fb37488e8a7b11f4d62479e8a1ae6e222)
2022-09-28T12:38:08.658021Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:38:08.685892Z - running sql script pg/insert_tenders.sql
2022-09-28T12:38:08.685942Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:38:08.696205Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:38:08.697801Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:38:08.702028Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:38:08.705908Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:38:08.711026Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:38:08.712670Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:38:08.758343Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:38:08.796519Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:38:08.803070Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:38:08.804871Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:38:09.017294Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:38:09.107617Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:38:09.118209Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:38:09.350519Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:38:09.532894Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:38:09.543781Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:38:09.544261Z - job completed in 1.95 seconds (917c4453824fbe82f01d0e2e47509c8fb37488e8a7b11f4d62479e8a1ae6e222)
2022-09-28T12:38:09.606280Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0728"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5c1142ccda60b7fb3426f093a1e8c1af67b08458f0a205ca21afef6806c89fb5)
2022-09-28T12:38:11.561790Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:38:11.589155Z - running sql script pg/upsert_orders.sql
2022-09-28T12:38:11.589631Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:38:11.594315Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:38:11.599402Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:38:11.611581Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:38:11.619848Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:38:11.627577Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:38:11.632549Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:38:11.633541Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:38:11.634525Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:38:11.640774Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:38:11.770495Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:38:11.814643Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:38:11.820081Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:38:11.831121Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:38:11.894889Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:38:11.911499Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:38:11.912100Z - job completed in 2.31 seconds (5c1142ccda60b7fb3426f093a1e8c1af67b08458f0a205ca21afef6806c89fb5)
2022-09-28T12:40:02.815748Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0730"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (03ce01fa0ea7ebdfba52f4c18a9186fd3f56cb17e969a586804bcad4ab47d0eb)
2022-09-28T12:40:05.186607Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:40:05.205037Z - running sql script pg/upsert_orders.sql
2022-09-28T12:40:05.205080Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:40:05.210720Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:40:05.215355Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:40:05.216264Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:40:05.220322Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:40:05.225983Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:40:05.231655Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:40:05.232494Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:40:05.233347Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:40:05.239825Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:40:05.405345Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:40:05.451597Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:40:05.455945Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:40:05.465346Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:40:05.533279Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:40:05.558215Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:40:05.558809Z - job completed in 2.74 seconds (03ce01fa0ea7ebdfba52f4c18a9186fd3f56cb17e969a586804bcad4ab47d0eb)
2022-09-28T12:40:05.619364Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0730"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f241c380a0319bbcd2859d2ea835e807ede27dd47e6990b7e9283b6448e3ed5b)
2022-09-28T12:40:08.615117Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:40:08.635061Z - running sql script pg/insert_tenders.sql
2022-09-28T12:40:08.635100Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:40:08.641831Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:40:08.643596Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:40:08.653682Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:40:08.657714Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:40:08.662247Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:40:08.663271Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:40:08.709388Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:40:08.747936Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:40:08.754645Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:40:08.756121Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:40:08.973754Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:40:09.063091Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:40:09.069648Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:40:09.299687Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:40:09.484927Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:40:09.491048Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:40:09.491421Z - job completed in 3.87 seconds (f241c380a0319bbcd2859d2ea835e807ede27dd47e6990b7e9283b6448e3ed5b)
2022-09-28T12:42:02.151711Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0732"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c80fc36077addc9d512ee6a0d5a8f58b55cb100a3235c207e2280e8cb0e7ef0b)
2022-09-28T12:42:04.240024Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:42:04.267697Z - running sql script pg/upsert_orders.sql
2022-09-28T12:42:04.271676Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:42:04.276941Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:42:04.282242Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:42:04.283851Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:42:04.289741Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:42:04.294271Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:42:04.306650Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:42:04.311671Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:42:04.313264Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:42:04.319971Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:42:04.462538Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:42:04.511787Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:42:04.516681Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:42:04.530103Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:42:04.599711Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:42:04.674414Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:42:04.674705Z - job completed in 2.52 seconds (c80fc36077addc9d512ee6a0d5a8f58b55cb100a3235c207e2280e8cb0e7ef0b)
2022-09-28T12:42:04.772814Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0732"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (44d666a0cd46baabf705e8dd1bc6a374f76a60580d986fb2b8b33eef12f1413f)
2022-09-28T12:42:05.897954Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:42:05.916893Z - running sql script pg/insert_tenders.sql
2022-09-28T12:42:05.916932Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:42:05.921619Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:42:05.923059Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:42:05.930286Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:42:05.934442Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:42:05.939244Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:42:05.940225Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:42:05.986809Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:42:06.064616Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:42:06.069472Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:42:06.070914Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:42:06.288554Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:42:06.377892Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:42:06.384690Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:42:06.611981Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:42:06.797916Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:42:06.804054Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:42:06.804456Z - job completed in 2.03 seconds (44d666a0cd46baabf705e8dd1bc6a374f76a60580d986fb2b8b33eef12f1413f)
2022-09-28T12:44:02.005506Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0734"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (23ce3022d1e83e869edb4561deb61a7d4e76f5dfb99ff4140df9c21ade8a9791)
2022-09-28T12:44:03.419011Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:44:03.435722Z - running sql script pg/insert_tenders.sql
2022-09-28T12:44:03.435753Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:44:03.440945Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:44:03.442323Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:44:03.446727Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:44:03.450908Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:44:03.456022Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:44:03.457070Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:44:03.505503Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:44:03.571123Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:44:03.575358Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:44:03.576862Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:44:03.789916Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:44:03.877712Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:44:03.883616Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:44:04.105173Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:44:04.290453Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:44:04.296307Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:44:04.296862Z - job completed in 2.29 seconds (23ce3022d1e83e869edb4561deb61a7d4e76f5dfb99ff4140df9c21ade8a9791)
2022-09-28T12:44:04.413480Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0734"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5cbf9ab0df0c490c8da7e4a63c57d408354e852932230256196b298f6eadec41)
2022-09-28T12:44:06.611837Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:44:06.631620Z - running sql script pg/upsert_orders.sql
2022-09-28T12:44:06.631653Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:44:06.636630Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:44:06.641571Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:44:06.642553Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:44:06.647218Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:44:06.651735Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:44:06.655772Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:44:06.656694Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:44:06.657566Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:44:06.664211Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:44:06.817393Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:44:06.876762Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:44:06.881369Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:44:06.889663Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:44:06.955339Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:44:06.969325Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:44:06.970175Z - job completed in 2.56 seconds (5cbf9ab0df0c490c8da7e4a63c57d408354e852932230256196b298f6eadec41)
2022-09-28T12:46:02.147063Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0736"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6516ea1a9e340a2963dfbfa91e26d71f49e20eaee57c1c9fab38f6f25ba658b5)
2022-09-28T12:46:04.765441Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:46:04.782494Z - running sql script pg/upsert_orders.sql
2022-09-28T12:46:04.782532Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:46:04.787721Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:46:04.792680Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:46:04.794103Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:46:04.799432Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:46:04.805807Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:46:04.809798Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:46:04.813560Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:46:04.814485Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:46:04.820884Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:46:04.966954Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:46:05.023233Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:46:05.027472Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:46:05.036512Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:46:05.105511Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:46:05.119900Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:46:05.120227Z - job completed in 2.97 seconds (6516ea1a9e340a2963dfbfa91e26d71f49e20eaee57c1c9fab38f6f25ba658b5)
2022-09-28T12:46:05.188813Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0736"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e2b08ef31554d42382de09481638e4a0665a785a61c6d64f9fc155dce683281f)
2022-09-28T12:46:06.641063Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:46:06.656849Z - running sql script pg/insert_tenders.sql
2022-09-28T12:46:06.656904Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:46:06.661468Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:46:06.662723Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:46:06.667707Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:46:06.671273Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:46:06.676497Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:46:06.678453Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:46:06.725954Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:46:06.788382Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:46:06.792560Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:46:06.794085Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:46:07.007295Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:46:07.096307Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:46:07.105155Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:46:07.328667Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:46:07.510142Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:46:07.516713Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:46:07.517279Z - job completed in 2.33 seconds (e2b08ef31554d42382de09481638e4a0665a785a61c6d64f9fc155dce683281f)
2022-09-28T12:48:01.919928Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0738"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d43e25c9b35096eb50b55b18a8f5ac7b0d7bcddac8302d9237431472e804e4df)
2022-09-28T12:48:03.356206Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:48:03.379457Z - running sql script pg/insert_tenders.sql
2022-09-28T12:48:03.379490Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:48:03.384007Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:48:03.385544Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:48:03.389669Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:48:03.393358Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:48:03.398256Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:48:03.399467Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:48:03.445595Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:48:03.512508Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:48:03.516477Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:48:03.518161Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:48:03.718787Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:48:03.801468Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:48:03.807763Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:48:04.028797Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:48:04.213653Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:48:04.218633Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:48:04.219047Z - job completed in 2.30 seconds (d43e25c9b35096eb50b55b18a8f5ac7b0d7bcddac8302d9237431472e804e4df)
2022-09-28T12:48:04.280086Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0738"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4eb7214e0211c6821cc474fffc5b8f2080c9335a7afb7601015697b8b897280e)
2022-09-28T12:48:06.358097Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:48:06.382516Z - running sql script pg/upsert_orders.sql
2022-09-28T12:48:06.382557Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:48:06.387300Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:48:06.391752Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:48:06.392717Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:48:06.396788Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:48:06.401170Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:48:06.405053Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:48:06.405947Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:48:06.406771Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:48:06.412494Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:48:06.540904Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:48:06.593728Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:48:06.598115Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:48:06.607757Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:48:06.673577Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:48:06.683078Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:48:06.683674Z - job completed in 2.40 seconds (4eb7214e0211c6821cc474fffc5b8f2080c9335a7afb7601015697b8b897280e)
2022-09-28T12:48:06.791253Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0728"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (b095272bc658aac399c7c100c47c7350c4680355d35d9ce638853c20be82ec15)
2022-09-28T12:48:11.858793Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:48:11.882649Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T12:48:11.882684Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:48:11.887272Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T12:48:11.892166Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T12:48:11.896925Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T12:48:11.897898Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T12:48:11.902974Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T12:48:11.907452Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T12:48:11.908444Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:48:11.909296Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T12:48:11.910201Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T12:48:11.915704Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T12:48:11.920869Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T12:48:11.921860Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T12:48:11.928278Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T12:48:11.933440Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T12:48:11.938316Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T12:48:11.948064Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T12:48:12.855730Z - called http://score/api/keyed and received back 200
2022-09-28T12:48:12.855943Z - job completed in 6.06 seconds (b095272bc658aac399c7c100c47c7350c4680355d35d9ce638853c20be82ec15)
2022-09-28T12:50:02.625493Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0740"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ba5e1cf407e2a55ac7ed9cfc88138bdadf75fc5e79f167afac3307d0e22f90d0)
2022-09-28T12:50:05.249249Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:50:05.267073Z - running sql script pg/upsert_orders.sql
2022-09-28T12:50:05.267503Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:50:05.272583Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:50:05.277613Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:50:05.279064Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:50:05.285220Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:50:05.289803Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:50:05.294944Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:50:05.298555Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:50:05.300184Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:50:05.306895Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:50:05.422002Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:50:05.455030Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:50:05.459558Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:50:05.468520Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:50:05.538969Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:50:05.557790Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:50:05.558366Z - job completed in 2.93 seconds (ba5e1cf407e2a55ac7ed9cfc88138bdadf75fc5e79f167afac3307d0e22f90d0)
2022-09-28T12:50:05.611786Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0740"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (72703b5083b706fcd528c1120ebb2d1279b3777341fadd80a90350fedd1a1c13)
2022-09-28T12:50:07.338810Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:50:07.355330Z - running sql script pg/insert_tenders.sql
2022-09-28T12:50:07.355363Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:50:07.359979Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:50:07.361224Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:50:07.365165Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:50:07.368906Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:50:07.373410Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:50:07.374361Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:50:07.420890Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:50:07.487637Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:50:07.491598Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:50:07.493192Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:50:07.688279Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:50:07.769872Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:50:07.775517Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:50:07.992659Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:50:08.182719Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:50:08.187755Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:50:08.188313Z - job completed in 2.58 seconds (72703b5083b706fcd528c1120ebb2d1279b3777341fadd80a90350fedd1a1c13)
2022-09-28T12:52:02.187775Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0742"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1a542451444a81977eefee9c881e226d1335d833e301aae1cdf4a99173f901f3)
2022-09-28T12:52:04.239242Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:52:04.257469Z - running sql script pg/upsert_orders.sql
2022-09-28T12:52:04.257501Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:52:04.262287Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:52:04.266679Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:52:04.267608Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:52:04.272179Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:52:04.276551Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:52:04.281240Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:52:04.282222Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:52:04.283218Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:52:04.289770Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:52:04.375505Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:52:04.397938Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:52:04.402239Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:52:04.408911Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:52:04.473820Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:52:04.483442Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:52:04.483975Z - job completed in 2.31 seconds (1a542451444a81977eefee9c881e226d1335d833e301aae1cdf4a99173f901f3)
2022-09-28T12:52:04.543949Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0742"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9a6a962be1741a924cf9dc10de3ef965a7af2728631df519296dbb376cee5776)
2022-09-28T12:52:05.728366Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:52:05.764162Z - running sql script pg/insert_tenders.sql
2022-09-28T12:52:05.764709Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:52:05.769227Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:52:05.770467Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:52:05.774806Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:52:05.779580Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:52:05.784962Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:52:05.786630Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:52:05.832726Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:52:05.882418Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:52:05.886925Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:52:05.888381Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:52:06.088416Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:52:06.170917Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:52:06.177874Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:52:06.399117Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:52:06.581131Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:52:06.586254Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:52:06.586726Z - job completed in 2.04 seconds (9a6a962be1741a924cf9dc10de3ef965a7af2728631df519296dbb376cee5776)
2022-09-28T12:54:01.945456Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0744"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (cb76d61b702f20d70b52229d0910c99ea3cb213715f5c2faa141edb3db287819)
2022-09-28T12:54:03.346703Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:54:03.368780Z - running sql script pg/insert_tenders.sql
2022-09-28T12:54:03.369048Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:54:03.377198Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:54:03.379075Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:54:03.383971Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:54:03.388177Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:54:03.394813Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:54:03.399621Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:54:03.446992Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:54:03.488771Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:54:03.492618Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:54:03.494042Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:54:03.691462Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:54:03.773772Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:54:03.827868Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:54:04.048408Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:54:04.240755Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:54:04.245364Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:54:04.245828Z - job completed in 2.30 seconds (cb76d61b702f20d70b52229d0910c99ea3cb213715f5c2faa141edb3db287819)
2022-09-28T12:54:04.264740Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0744"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3152e2214230a2e97941913e8f18bf0c663a34ae7b3cd063f100f6c3557928c3)
2022-09-28T12:54:06.092038Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:54:06.108348Z - running sql script pg/upsert_orders.sql
2022-09-28T12:54:06.108497Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:54:06.113470Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:54:06.117938Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:54:06.118983Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:54:06.122830Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:54:06.124204Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:54:06.128301Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:54:06.129259Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:54:06.130159Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:54:06.136093Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:54:06.199432Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:54:06.212203Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:54:06.215703Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:54:06.232191Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:54:06.301387Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:54:06.318555Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:54:06.318917Z - job completed in 2.05 seconds (3152e2214230a2e97941913e8f18bf0c663a34ae7b3cd063f100f6c3557928c3)
2022-09-28T12:56:02.025572Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0746"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b96a8efab73ad16a48ef562f079df9510d578bfa9532c4c02718192c63870d06)
2022-09-28T12:56:03.419662Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:56:03.439585Z - running sql script pg/insert_tenders.sql
2022-09-28T12:56:03.439711Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:56:03.444570Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:56:03.446483Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:56:03.451356Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:56:03.456572Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:56:03.462360Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:56:03.463560Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:56:03.509636Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:56:03.565849Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:56:03.570737Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:56:03.573103Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:56:03.771288Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:56:03.854405Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:56:03.870008Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:56:04.106220Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:56:04.300522Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:56:04.306029Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:56:04.306307Z - job completed in 2.28 seconds (b96a8efab73ad16a48ef562f079df9510d578bfa9532c4c02718192c63870d06)
2022-09-28T12:56:04.447100Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0746"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (540c3d343016b01cd0f754d8ccd5931d007f826ab93854052e0c6103ed7c4987)
2022-09-28T12:56:06.580420Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:56:06.599490Z - running sql script pg/upsert_orders.sql
2022-09-28T12:56:06.599565Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:56:06.605662Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:56:06.610479Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:56:06.614264Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:56:06.618716Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:56:06.620146Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:56:06.624872Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:56:06.626217Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:56:06.627608Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:56:06.634241Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:56:06.732353Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:56:06.746340Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:56:06.750557Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:56:06.765401Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:56:06.846819Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:56:06.866391Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:56:06.866987Z - job completed in 2.42 seconds (540c3d343016b01cd0f754d8ccd5931d007f826ab93854052e0c6103ed7c4987)
2022-09-28T12:58:01.935146Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0748"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (12f002082c0421c05852f65e1a43e7a6e67f6160723634449f7d00282647dede)
2022-09-28T12:58:03.335896Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:58:03.354269Z - running sql script pg/insert_tenders.sql
2022-09-28T12:58:03.354336Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T12:58:03.359299Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T12:58:03.361066Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T12:58:03.365988Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T12:58:03.370444Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T12:58:03.375394Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T12:58:03.376521Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T12:58:03.425698Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T12:58:03.486604Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T12:58:03.491448Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T12:58:03.492999Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T12:58:03.691207Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T12:58:03.773649Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T12:58:03.782069Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T12:58:04.008272Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T12:58:04.198382Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T12:58:04.203402Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T12:58:04.203763Z - job completed in 2.27 seconds (12f002082c0421c05852f65e1a43e7a6e67f6160723634449f7d00282647dede)
2022-09-28T12:58:04.256319Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0738"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (14ca6355528c01a4eff90862d932c57863e11f9bc57291db6ea8b3d207c4840d)
2022-09-28T12:58:10.729128Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:58:10.754001Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T12:58:10.754031Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:58:10.758471Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T12:58:10.763249Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T12:58:10.767463Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T12:58:10.768527Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T12:58:10.772590Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T12:58:10.776739Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T12:58:10.780530Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:58:10.781920Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T12:58:10.783177Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T12:58:10.791039Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T12:58:10.797070Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T12:58:10.798237Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T12:58:10.804948Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T12:58:10.809437Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T12:58:10.813436Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T12:58:10.825988Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T12:58:10.907058Z - called http://score/api/keyed and received back 204
2022-09-28T12:58:10.907457Z - job completed in 6.65 seconds (14ca6355528c01a4eff90862d932c57863e11f9bc57291db6ea8b3d207c4840d)
2022-09-28T12:58:10.952075Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0748"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (40b61961e6632a78b7e06b19887e3dd8e51ac2c511c97eecbe87623cd5ec05ac)
2022-09-28T12:58:13.424843Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T12:58:13.440942Z - running sql script pg/upsert_orders.sql
2022-09-28T12:58:13.440983Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T12:58:13.445307Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T12:58:13.449499Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T12:58:13.450460Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T12:58:13.454682Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T12:58:13.456171Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T12:58:13.460655Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T12:58:13.461709Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T12:58:13.462628Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T12:58:13.469091Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T12:58:13.559196Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T12:58:13.572801Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T12:58:13.576453Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T12:58:13.582823Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T12:58:13.690836Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T12:58:13.706917Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T12:58:13.707337Z - job completed in 2.76 seconds (40b61961e6632a78b7e06b19887e3dd8e51ac2c511c97eecbe87623cd5ec05ac)
2022-09-28T13:00:02.569232Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0750"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (24f59348e1eab10991d7698cc65cdff32869e716277811dc5a44d836b03d3fbf)
2022-09-28T13:00:07.749219Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:00:07.766216Z - running sql script pg/upsert_orders.sql
2022-09-28T13:00:07.766277Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:00:07.770678Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:00:07.775012Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:00:07.775984Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:00:07.780326Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:00:07.781801Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:00:07.786235Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:00:07.787182Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:00:07.788067Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:00:07.798098Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:00:07.881604Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:00:07.891824Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:00:07.895706Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:00:07.901695Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:00:07.966887Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:00:07.975337Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:00:07.975810Z - job completed in 5.41 seconds (24f59348e1eab10991d7698cc65cdff32869e716277811dc5a44d836b03d3fbf)
2022-09-28T13:00:08.009524Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0750"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (007295aca7e45f31820e3128297c94272cb014c829440b272249d4763b8fe9b5)
2022-09-28T13:00:09.382348Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:00:09.400603Z - running sql script pg/insert_tenders.sql
2022-09-28T13:00:09.400728Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:00:09.405267Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:00:09.406688Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:00:09.411078Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:00:09.415338Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:00:09.420238Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:00:09.421364Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:00:09.467715Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:00:09.518266Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:00:09.522214Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:00:09.524033Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:00:09.721208Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:00:09.803466Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:00:09.814893Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:00:10.042917Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:00:10.234406Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:00:10.239686Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:00:10.240135Z - job completed in 2.23 seconds (007295aca7e45f31820e3128297c94272cb014c829440b272249d4763b8fe9b5)
2022-09-28T13:02:01.985225Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0752"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (69b52f031ff9330f5adc7985c6c930d20743d6648d741f5f1a898d602f1e78cc)
2022-09-28T13:02:03.476960Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:02:03.505821Z - running sql script pg/insert_tenders.sql
2022-09-28T13:02:03.505860Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:02:03.511004Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:02:03.512736Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:02:03.517579Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:02:03.522405Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:02:03.528503Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:02:03.530021Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:02:03.583623Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:02:03.634648Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:02:03.640433Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:02:03.644447Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:02:03.845695Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:02:03.930158Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:02:03.938293Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:02:04.169822Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:02:04.367953Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:02:04.374642Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:02:04.375088Z - job completed in 2.39 seconds (69b52f031ff9330f5adc7985c6c930d20743d6648d741f5f1a898d602f1e78cc)
2022-09-28T13:02:04.431407Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0752"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1fa7db11e36690995a52b2d7ace41cec960f4d34c474b735313e5f740ec50b52)
2022-09-28T13:02:06.976911Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:02:06.993910Z - running sql script pg/upsert_orders.sql
2022-09-28T13:02:06.993952Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:02:06.998767Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:02:07.005438Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:02:07.006457Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:02:07.011276Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:02:07.012773Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:02:07.019Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:02:07.020587Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:02:07.021694Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:02:07.028069Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:02:07.129174Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:02:07.143776Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:02:07.147849Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:02:07.154886Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:02:07.220624Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:02:07.230427Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:02:07.231061Z - job completed in 2.80 seconds (1fa7db11e36690995a52b2d7ace41cec960f4d34c474b735313e5f740ec50b52)
2022-09-28T13:04:02.017889Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0754"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e2ff98432d4b5dff630ae2a796bdf1e7a794ec73f8f1703b9fed6e345f89026c)
2022-09-28T13:04:03.460020Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:04:03.476064Z - running sql script pg/insert_tenders.sql
2022-09-28T13:04:03.476103Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:04:03.480726Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:04:03.482150Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:04:03.486230Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:04:03.491089Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:04:03.495846Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:04:03.496918Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:04:03.543347Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:04:03.605007Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:04:03.610182Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:04:03.611681Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:04:03.811750Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:04:03.896658Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:04:03.904327Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:04:04.137364Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:04:04.330852Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:04:04.343561Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:04:04.343842Z - job completed in 2.33 seconds (e2ff98432d4b5dff630ae2a796bdf1e7a794ec73f8f1703b9fed6e345f89026c)
2022-09-28T13:04:04.479339Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0754"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8c27ecf700902b92fc6370af41e028f681dd1ced771ce567cf46c9c7dfcc1795)
2022-09-28T13:04:06.696897Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:04:06.712675Z - running sql script pg/upsert_orders.sql
2022-09-28T13:04:06.712877Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:04:06.717437Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:04:06.722046Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:04:06.723125Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:04:06.726822Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:04:06.728384Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:04:06.732496Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:04:06.733567Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:04:06.734451Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:04:06.741805Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:04:06.838797Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:04:06.853542Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:04:06.857625Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:04:06.867864Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:04:06.931648Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:04:06.940114Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:04:06.940417Z - job completed in 2.46 seconds (8c27ecf700902b92fc6370af41e028f681dd1ced771ce567cf46c9c7dfcc1795)
2022-09-28T13:06:02.077136Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0756"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (886e54a5d3d00fb3d7e6a46a957ee481cab56d72668d07257c34069987c66aa6)
2022-09-28T13:06:03.303076Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:06:03.322537Z - running sql script pg/insert_tenders.sql
2022-09-28T13:06:03.322581Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:06:03.327658Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:06:03.330822Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:06:03.335728Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:06:03.342673Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:06:03.347824Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:06:03.349320Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:06:03.397654Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:06:03.447225Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:06:03.451026Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:06:03.452391Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:06:03.661621Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:06:03.745246Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:06:03.759181Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:06:03.990872Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:06:04.181415Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:06:04.187024Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:06:04.187515Z - job completed in 2.11 seconds (886e54a5d3d00fb3d7e6a46a957ee481cab56d72668d07257c34069987c66aa6)
2022-09-28T13:06:04.251140Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0756"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (516dc1abc0ee71b75523cd525e278e19655430cce0390a4b8ab911ac3e4221ee)
2022-09-28T13:06:06.883216Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:06:06.899361Z - running sql script pg/upsert_orders.sql
2022-09-28T13:06:06.899388Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:06:06.904212Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:06:06.908972Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:06:06.909815Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:06:06.913583Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:06:06.915133Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:06:06.919139Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:06:06.920118Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:06:06.920897Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:06:06.926944Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:06:06.998242Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:06:07.012611Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:06:07.018723Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:06:07.029930Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:06:07.100291Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:06:07.120911Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:06:07.121428Z - job completed in 2.87 seconds (516dc1abc0ee71b75523cd525e278e19655430cce0390a4b8ab911ac3e4221ee)
2022-09-28T13:08:02.093626Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0748"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (c1f9cda14e8b292585c9ac4c45399f885fac989bdd20e2aeb64e7aa4fdc8df45)
2022-09-28T13:08:08.450199Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:08:08.467246Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T13:08:08.467301Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:08:08.472060Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T13:08:08.476461Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T13:08:08.480858Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T13:08:08.482300Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T13:08:08.486715Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T13:08:08.491955Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T13:08:08.495797Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:08:08.497094Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T13:08:08.498534Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T13:08:08.505538Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T13:08:08.510855Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T13:08:08.512010Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T13:08:08.521020Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T13:08:08.525509Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T13:08:08.529552Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T13:08:08.534923Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T13:08:09.230390Z - called http://score/api/keyed and received back 200
2022-09-28T13:08:09.230483Z - job completed in 7.14 seconds (c1f9cda14e8b292585c9ac4c45399f885fac989bdd20e2aeb64e7aa4fdc8df45)
2022-09-28T13:08:09.344073Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0758"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3000c586a4687a68a627654adade51ce62ab4d158e6c886bc00bb81d819cce11)
2022-09-28T13:08:12.132649Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:08:12.155624Z - running sql script pg/upsert_orders.sql
2022-09-28T13:08:12.156168Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:08:12.161900Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:08:12.166745Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:08:12.178133Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:08:12.182437Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:08:12.184442Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:08:12.188807Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:08:12.190017Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:08:12.191112Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:08:12.197625Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:08:12.311646Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:08:12.335360Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:08:12.341154Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:08:12.353636Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:08:12.452933Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:08:12.473367Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:08:12.474242Z - job completed in 3.13 seconds (3000c586a4687a68a627654adade51ce62ab4d158e6c886bc00bb81d819cce11)
2022-09-28T13:08:12.510968Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0758"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f41e74ac2c75b71743822100d276272f81e5294daa3f5f2afff001efa89605f9)
2022-09-28T13:08:13.722381Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:08:13.740619Z - running sql script pg/insert_tenders.sql
2022-09-28T13:08:13.740663Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:08:13.746290Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:08:13.748052Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:08:13.753891Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:08:13.758809Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:08:13.763526Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:08:13.764623Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:08:13.812950Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:08:13.860183Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:08:13.864538Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:08:13.866020Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:08:14.085929Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:08:14.169833Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:08:14.177098Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:08:14.411912Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:08:14.604130Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:08:14.614478Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:08:14.614769Z - job completed in 2.10 seconds (f41e74ac2c75b71743822100d276272f81e5294daa3f5f2afff001efa89605f9)
2022-09-28T13:10:02.730550Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0800"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (40dd60a6866a1a040aba1db2a3b0c937627352eb31fe03126ba81a65efa9440b)
2022-09-28T13:10:07.624462Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:10:07.656659Z - running sql script pg/insert_tenders.sql
2022-09-28T13:10:07.657039Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:10:07.664128Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:10:07.666119Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:10:07.673504Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:10:07.683688Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:10:07.688791Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:10:07.690042Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:10:07.736956Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:10:07.788791Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:10:07.793512Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:10:07.795272Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:10:07.996866Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:10:08.081670Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:10:08.087477Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:10:08.320700Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:10:08.513960Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:10:08.519297Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:10:08.519774Z - job completed in 5.79 seconds (40dd60a6866a1a040aba1db2a3b0c937627352eb31fe03126ba81a65efa9440b)
2022-09-28T13:10:08.555298Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0800"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c757a825530c6c70be6a92982083f12114b74a43cfa19b65b0a030f7873e6b03)
2022-09-28T13:10:11.586092Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:10:11.603277Z - running sql script pg/upsert_orders.sql
2022-09-28T13:10:11.603309Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:10:11.607688Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:10:11.612348Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:10:11.613535Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:10:11.617700Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:10:11.619160Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:10:11.623345Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:10:11.624478Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:10:11.625375Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:10:11.631590Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:10:11.762016Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:10:11.803332Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:10:11.807340Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:10:11.821344Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:10:11.905358Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:10:11.916447Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:10:11.917127Z - job completed in 3.36 seconds (c757a825530c6c70be6a92982083f12114b74a43cfa19b65b0a030f7873e6b03)
2022-09-28T13:12:01.986255Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0802"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (93e1b99073227f83135b6ffbf54fdf0edb3c8895a0d2e5ade4cc4ea836badfde)
2022-09-28T13:12:03.332182Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:12:03.347878Z - running sql script pg/insert_tenders.sql
2022-09-28T13:12:03.347915Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:12:03.352738Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:12:03.354313Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:12:03.358823Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:12:03.363150Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:12:03.367509Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:12:03.368939Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:12:03.417031Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:12:03.447777Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:12:03.452189Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:12:03.453582Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:12:03.663617Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:12:03.751667Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:12:03.757869Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:12:03.984640Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:12:04.163950Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:12:04.169448Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:12:04.169990Z - job completed in 2.18 seconds (93e1b99073227f83135b6ffbf54fdf0edb3c8895a0d2e5ade4cc4ea836badfde)
2022-09-28T13:12:04.230674Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0802"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8b51f86b96a15e5364d45d80b92b573e9a6d0488ee8a331b1a776e20a0c81ac6)
2022-09-28T13:12:06.055498Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:12:06.072711Z - running sql script pg/upsert_orders.sql
2022-09-28T13:12:06.072743Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:12:06.078622Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:12:06.084442Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:12:06.085495Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:12:06.089738Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:12:06.094192Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:12:06.098656Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:12:06.099582Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:12:06.100761Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:12:06.108962Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:12:06.224786Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:12:06.251677Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:12:06.255829Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:12:06.265305Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:12:06.328510Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:12:06.338704Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:12:06.339009Z - job completed in 2.11 seconds (8b51f86b96a15e5364d45d80b92b573e9a6d0488ee8a331b1a776e20a0c81ac6)
2022-09-28T13:14:02.073008Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0804"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c3137c05271cd00631bb5d3d1f450dfc70f2c95489be269d6cb57d2f332c96da)
2022-09-28T13:14:03.287282Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:14:03.303808Z - running sql script pg/insert_tenders.sql
2022-09-28T13:14:03.303839Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:14:03.308389Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:14:03.309752Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:14:03.313887Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:14:03.318077Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:14:03.322543Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:14:03.323473Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:14:03.370540Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:14:03.427346Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:14:03.431498Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:14:03.433297Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:14:03.708673Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:14:03.792929Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:14:03.798765Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:14:04.023784Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:14:04.199636Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:14:04.204920Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:14:04.205231Z - job completed in 2.13 seconds (c3137c05271cd00631bb5d3d1f450dfc70f2c95489be269d6cb57d2f332c96da)
2022-09-28T13:14:04.309468Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0804"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6bc4a3778d910cd9b5388e852aa544836f805c0418b04042b67b756e7dd9dba0)
2022-09-28T13:14:06.885754Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:14:06.909039Z - running sql script pg/upsert_orders.sql
2022-09-28T13:14:06.909070Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:14:06.914003Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:14:06.918715Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:14:06.919711Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:14:06.923757Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:14:06.928172Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:14:06.932294Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:14:06.933221Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:14:06.934180Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:14:06.940309Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:14:07.058907Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:14:07.086461Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:14:07.090851Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:14:07.098505Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:14:07.163112Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:14:07.172271Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:14:07.172714Z - job completed in 2.86 seconds (6bc4a3778d910cd9b5388e852aa544836f805c0418b04042b67b756e7dd9dba0)
2022-09-28T13:16:02.009408Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0806"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c7a16789163634f80e28a73f0fa7af4b6d8acec9c7ed9bd21395ee7ff103ff58)
2022-09-28T13:16:03.497412Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:16:03.515190Z - running sql script pg/insert_tenders.sql
2022-09-28T13:16:03.515231Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:16:03.520739Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:16:03.522732Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:16:03.526830Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:16:03.530815Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:16:03.535763Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:16:03.537243Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:16:03.586043Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:16:03.657026Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:16:03.661853Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:16:03.663306Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:16:03.891341Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:16:03.977522Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:16:03.985948Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:16:04.225937Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:16:04.472988Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:16:04.478911Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:16:04.479516Z - job completed in 2.47 seconds (c7a16789163634f80e28a73f0fa7af4b6d8acec9c7ed9bd21395ee7ff103ff58)
2022-09-28T13:16:04.534729Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0806"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3bc40e7062cd3bcb742ef89b28bfb3ee5864d072d3e6811550a0736bdafd6843)
2022-09-28T13:16:06.918516Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:16:06.934423Z - running sql script pg/upsert_orders.sql
2022-09-28T13:16:06.934466Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:16:06.938783Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:16:06.942945Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:16:06.943834Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:16:06.947658Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:16:06.951794Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:16:06.955948Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:16:06.956798Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:16:06.957587Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:16:06.965801Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:16:07.084504Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:16:07.115217Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:16:07.119420Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:16:07.130957Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:16:07.196461Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:16:07.211482Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:16:07.212029Z - job completed in 2.68 seconds (3bc40e7062cd3bcb742ef89b28bfb3ee5864d072d3e6811550a0736bdafd6843)
2022-09-28T13:18:02.053831Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0758"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (6b783f8a53b5a50a95201091d1e750a8b2df41c9b93cf003f128b14d15b1dae0)
2022-09-28T13:18:11.766236Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:18:11.784102Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T13:18:11.784133Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:18:11.789285Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T13:18:11.798346Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T13:18:11.802479Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T13:18:11.803590Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T13:18:11.810197Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T13:18:11.814553Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T13:18:11.818557Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:18:11.819556Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T13:18:11.820459Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T13:18:11.826702Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T13:18:11.831580Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T13:18:11.832555Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T13:18:11.839021Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T13:18:11.842927Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T13:18:11.847069Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T13:18:11.856934Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T13:18:21.541293Z - called http://score/api/keyed and received back 200
2022-09-28T13:18:21.541512Z - job completed in 19.49 seconds (6b783f8a53b5a50a95201091d1e750a8b2df41c9b93cf003f128b14d15b1dae0)
2022-09-28T13:18:21.628494Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0808"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (461c62970b2024493b9aa890619648a184ab997d87e2050013159d5293c44bd4)
2022-09-28T13:18:23.015176Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:18:23.032355Z - running sql script pg/insert_tenders.sql
2022-09-28T13:18:23.032387Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:18:23.037228Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:18:23.038684Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:18:23.042945Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:18:23.046802Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:18:23.052920Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:18:23.054249Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:18:23.103916Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:18:23.155853Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:18:23.160948Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:18:23.162620Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:18:23.369919Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:18:23.455421Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:18:23.463349Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:18:23.693093Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:18:23.871873Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:18:23.877710Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:18:23.878205Z - job completed in 2.25 seconds (461c62970b2024493b9aa890619648a184ab997d87e2050013159d5293c44bd4)
2022-09-28T13:18:23.977745Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0808"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fa9f1adb88cdaef69a5c9ad1228c6e67d008853dca980fcf666fa0ce08096ecc)
2022-09-28T13:18:27.218499Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:18:27.235927Z - running sql script pg/upsert_orders.sql
2022-09-28T13:18:27.235956Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:18:27.240870Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:18:27.245158Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:18:27.246305Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:18:27.250782Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:18:27.255013Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:18:27.259599Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:18:27.260645Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:18:27.261650Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:18:27.268019Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:18:27.365714Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:18:27.383847Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:18:27.388214Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:18:27.406090Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:18:27.476458Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:18:27.500084Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:18:27.500449Z - job completed in 3.52 seconds (fa9f1adb88cdaef69a5c9ad1228c6e67d008853dca980fcf666fa0ce08096ecc)
2022-09-28T13:20:02.836809Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0810"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (20df042ac2a0bef881ed3c1b705325c63b1c5f193532653ed8eafd1d759a3402)
2022-09-28T13:20:06.070730Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:20:06.089697Z - running sql script pg/insert_tenders.sql
2022-09-28T13:20:06.089731Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:20:06.097100Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:20:06.098746Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:20:06.103121Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:20:06.108160Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:20:06.114413Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:20:06.115381Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:20:06.162702Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:20:06.213678Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:20:06.218587Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:20:06.219959Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:20:06.446467Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:20:06.533727Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:20:06.539356Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:20:06.756758Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:20:06.930915Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:20:06.937797Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:20:06.938109Z - job completed in 4.10 seconds (20df042ac2a0bef881ed3c1b705325c63b1c5f193532653ed8eafd1d759a3402)
2022-09-28T13:20:06.964688Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0810"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f5abc25d992febee8f1643df7959888c1633fa3608b007edb3b2c46ea06494ad)
2022-09-28T13:20:09.057771Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:20:09.075008Z - running sql script pg/upsert_orders.sql
2022-09-28T13:20:09.075065Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:20:09.080172Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:20:09.084636Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:20:09.085529Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:20:09.090226Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:20:09.094740Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:20:09.098997Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:20:09.099903Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:20:09.100736Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:20:09.106706Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:20:09.185858Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:20:09.207488Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:20:09.212062Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:20:09.220013Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:20:09.284035Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:20:09.296508Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:20:09.296947Z - job completed in 2.33 seconds (f5abc25d992febee8f1643df7959888c1633fa3608b007edb3b2c46ea06494ad)
2022-09-28T13:22:02.064004Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0812"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e494886d2a4aa7aa1453d73241ff76f2e7c89b0eec5d7136e7c505c49ecee2b8)
2022-09-28T13:22:04.511481Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:22:04.537160Z - running sql script pg/upsert_orders.sql
2022-09-28T13:22:04.537196Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:22:04.541905Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:22:04.547207Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:22:04.548117Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:22:04.552125Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:22:04.558193Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:22:04.563684Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:22:04.567736Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:22:04.573030Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:22:04.588985Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:22:04.694982Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:22:04.713968Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:22:04.718376Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:22:04.726028Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:22:04.801310Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:22:04.813612Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:22:04.814213Z - job completed in 2.75 seconds (e494886d2a4aa7aa1453d73241ff76f2e7c89b0eec5d7136e7c505c49ecee2b8)
2022-09-28T13:22:04.875751Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0812"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8e527a6db75a2bd81b8ff262691270f80a8305a9ca112500f7d25855cb3b78b4)
2022-09-28T13:22:06.009457Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:22:06.027364Z - running sql script pg/insert_tenders.sql
2022-09-28T13:22:06.027409Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:22:06.033775Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:22:06.035054Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:22:06.039406Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:22:06.043207Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:22:06.047608Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:22:06.048599Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:22:06.096081Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:22:06.194365Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:22:06.199417Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:22:06.200957Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:22:06.436333Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:22:06.525619Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:22:06.532213Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:22:06.749450Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:22:06.985065Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:22:06.990370Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:22:06.990922Z - job completed in 2.12 seconds (8e527a6db75a2bd81b8ff262691270f80a8305a9ca112500f7d25855cb3b78b4)
2022-09-28T13:24:02.045575Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0814"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (266bd123cfabac44b4edfa96217f0921c0adb52548a60f2739a3bef7f694a481)
2022-09-28T13:24:04.209288Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:24:04.226493Z - running sql script pg/upsert_orders.sql
2022-09-28T13:24:04.226525Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:24:04.230832Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:24:04.235252Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:24:04.236812Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:24:04.241004Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:24:04.245060Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:24:04.248943Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:24:04.250021Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:24:04.251067Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:24:04.257643Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:24:04.361108Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:24:04.396583Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:24:04.401850Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:24:04.409680Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:24:04.474719Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:24:04.486118Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:24:04.486673Z - job completed in 2.44 seconds (266bd123cfabac44b4edfa96217f0921c0adb52548a60f2739a3bef7f694a481)
2022-09-28T13:24:04.530554Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0814"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (89253e1cd2b49e39d46ef9fa35f45362494c3308315a399d523c19216146e322)
2022-09-28T13:24:05.995091Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:24:06.013322Z - running sql script pg/insert_tenders.sql
2022-09-28T13:24:06.013360Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:24:06.018306Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:24:06.019575Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:24:06.023397Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:24:06.027067Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:24:06.031608Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:24:06.032450Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:24:06.079822Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:24:06.149384Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:24:06.153240Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:24:06.154707Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:24:06.371578Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:24:06.484909Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:24:06.490270Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:24:06.709288Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:24:06.894828Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:24:06.899475Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:24:06.899893Z - job completed in 2.37 seconds (89253e1cd2b49e39d46ef9fa35f45362494c3308315a399d523c19216146e322)
2022-09-28T13:26:02.199979Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0816"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8d159d853575d69ef669726cd829646203ae4370df8285e1b9bfe20015533a34)
2022-09-28T13:26:03.842089Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:26:03.858912Z - running sql script pg/insert_tenders.sql
2022-09-28T13:26:03.858976Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:26:03.863344Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:26:03.864767Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:26:03.869007Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:26:03.872952Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:26:03.877664Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:26:03.878644Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:26:03.926398Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:26:03.948313Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:26:03.952536Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:26:03.954025Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:26:04.170115Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:26:04.260896Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:26:04.268707Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:26:04.488383Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:26:04.677943Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:26:04.683372Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:26:04.683709Z - job completed in 2.48 seconds (8d159d853575d69ef669726cd829646203ae4370df8285e1b9bfe20015533a34)
2022-09-28T13:26:04.715675Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0816"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c61d83acf47c97ab215755620eb41b1e27f19570c9c770b7a8972892896791d0)
2022-09-28T13:26:07.172416Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:26:07.195259Z - running sql script pg/upsert_orders.sql
2022-09-28T13:26:07.195291Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:26:07.201432Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:26:07.205762Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:26:07.206845Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:26:07.211258Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:26:07.215569Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:26:07.219665Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:26:07.220781Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:26:07.221762Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:26:07.228139Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:26:07.334917Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:26:07.379119Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:26:07.383059Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:26:07.400842Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:26:07.472128Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:26:07.488111Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:26:07.488693Z - job completed in 2.77 seconds (c61d83acf47c97ab215755620eb41b1e27f19570c9c770b7a8972892896791d0)
2022-09-28T13:28:02.204846Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0818"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5f2f7bcf0dc9d68e3295e8b4cc38062cbbba829c5dc9a460e087e67939f802f9)
2022-09-28T13:28:03.446150Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:28:03.462840Z - running sql script pg/insert_tenders.sql
2022-09-28T13:28:03.462878Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:28:03.467951Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:28:03.469337Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:28:03.473774Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:28:03.477651Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:28:03.482479Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:28:03.483662Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:28:03.531519Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:28:03.554657Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:28:03.558434Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:28:03.560326Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:28:03.773142Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:28:03.862045Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:28:03.868871Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:28:04.090516Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:28:04.276792Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:28:04.283816Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:28:04.284248Z - job completed in 2.08 seconds (5f2f7bcf0dc9d68e3295e8b4cc38062cbbba829c5dc9a460e087e67939f802f9)
2022-09-28T13:28:04.411945Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0808"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (5627337a6cc2d38eb0a6cbfbeed7384cb1ab691391b05fbec909ba9ddd515020)
2022-09-28T13:28:10.433235Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:28:10.449433Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T13:28:10.449463Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:28:10.453990Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T13:28:10.459289Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T13:28:10.463847Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T13:28:10.464881Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T13:28:10.468910Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T13:28:10.472930Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T13:28:10.477960Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:28:10.481147Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T13:28:10.482185Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T13:28:10.488398Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T13:28:10.493435Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T13:28:10.494402Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T13:28:10.501121Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T13:28:10.505320Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T13:28:10.509942Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T13:28:10.516290Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T13:28:11.600921Z - called http://score/api/keyed and received back 200
2022-09-28T13:28:11.601031Z - job completed in 7.19 seconds (5627337a6cc2d38eb0a6cbfbeed7384cb1ab691391b05fbec909ba9ddd515020)
2022-09-28T13:28:11.627816Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0818"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (cd12daf8fceedb02ad3b9d4ff81439f11d05c88982ded48348eee2c64c91ea1e)
2022-09-28T13:28:13.740393Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:28:13.772935Z - running sql script pg/upsert_orders.sql
2022-09-28T13:28:13.773394Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:28:13.778906Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:28:13.784004Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:28:13.785043Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:28:13.790418Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:28:13.795288Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:28:13.799923Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:28:13.800982Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:28:13.801874Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:28:13.808154Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:28:13.936468Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:28:13.954458Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:28:13.960322Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:28:13.968037Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:28:14.034495Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:28:14.047461Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:28:14.047952Z - job completed in 2.42 seconds (cd12daf8fceedb02ad3b9d4ff81439f11d05c88982ded48348eee2c64c91ea1e)
2022-09-28T13:30:02.189126Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0820"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0ef472a73b86424a06b516b2abf29e3f16442b57250f7fa1ee7decb8de56b65e)
2022-09-28T13:30:04.897567Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:30:04.916854Z - running sql script pg/upsert_orders.sql
2022-09-28T13:30:04.916891Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:30:04.924890Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:30:04.929429Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:30:04.930368Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:30:04.934084Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:30:04.939358Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:30:04.944676Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:30:04.945773Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:30:04.947233Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:30:04.954362Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:30:05.076711Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:30:05.090392Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:30:05.094396Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:30:05.101724Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:30:05.168229Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:30:05.186809Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:30:05.187226Z - job completed in 3.00 seconds (0ef472a73b86424a06b516b2abf29e3f16442b57250f7fa1ee7decb8de56b65e)
2022-09-28T13:30:05.215043Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0820"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d0de6932df234c169ebdea7f718af6ff5d44155927899a40e1365cf1c1a9f5af)
2022-09-28T13:30:06.927841Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:30:06.944651Z - running sql script pg/insert_tenders.sql
2022-09-28T13:30:06.944694Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:30:06.949275Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:30:06.950662Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:30:06.954919Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:30:06.958801Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:30:06.963662Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:30:06.964801Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:30:07.010828Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:30:07.048662Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:30:07.055990Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:30:07.057665Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:30:07.274355Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:30:07.364693Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:30:07.370962Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:30:07.600411Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:30:07.791384Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:30:07.796541Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:30:07.797015Z - job completed in 2.58 seconds (d0de6932df234c169ebdea7f718af6ff5d44155927899a40e1365cf1c1a9f5af)
2022-09-28T13:32:01.993858Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0822"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2ab2147fdf50fa5c25da2e71e575e2dd15822c2fb921b55ae1eecb823c923bb8)
2022-09-28T13:32:07.057926Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:32:07.076005Z - running sql script pg/upsert_orders.sql
2022-09-28T13:32:07.076112Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:32:07.081031Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:32:07.085750Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:32:07.088874Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:32:07.092781Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:32:07.097126Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:32:07.101774Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:32:07.102849Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:32:07.103835Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:32:07.111142Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:32:07.226363Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:32:07.241103Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:32:07.244769Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:32:07.251157Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:32:07.314533Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:32:07.323860Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:32:07.324241Z - job completed in 5.33 seconds (2ab2147fdf50fa5c25da2e71e575e2dd15822c2fb921b55ae1eecb823c923bb8)
2022-09-28T13:32:07.424788Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0822"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (97192759eefe5cc62ec4b7a514c7bd774342e44d7ff3342a19c41cad501e10d4)
2022-09-28T13:32:08.780002Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:32:08.797810Z - running sql script pg/insert_tenders.sql
2022-09-28T13:32:08.797861Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:32:08.802544Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:32:08.803799Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:32:08.808780Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:32:08.819408Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:32:08.824895Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:32:08.825926Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:32:08.872589Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:32:08.893461Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:32:08.897609Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:32:08.899062Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:32:09.113524Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:32:09.203414Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:32:09.209560Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:32:09.442248Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:32:09.634987Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:32:09.639664Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:32:09.640153Z - job completed in 2.22 seconds (97192759eefe5cc62ec4b7a514c7bd774342e44d7ff3342a19c41cad501e10d4)
2022-09-28T13:34:01.995999Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0824"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c574f1e48a08c855da26ed6f4a7a3a785b9d483468258a47b37b3e0746eae682)
2022-09-28T13:34:04.532556Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:34:04.549894Z - running sql script pg/upsert_orders.sql
2022-09-28T13:34:04.549927Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:34:04.554459Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:34:04.560060Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:34:04.561008Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:34:04.567630Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:34:04.572927Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:34:04.584567Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:34:04.585842Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:34:04.586752Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:34:04.593025Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:34:04.709358Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:34:04.727520Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:34:04.731924Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:34:04.742670Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:34:04.808958Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:34:04.827598Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:34:04.827904Z - job completed in 2.83 seconds (c574f1e48a08c855da26ed6f4a7a3a785b9d483468258a47b37b3e0746eae682)
2022-09-28T13:34:04.984712Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0824"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6b007f6076eed49ec4243596d5e9e712c93f18e905b656061b39b769c6d857ec)
2022-09-28T13:34:06.374578Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:34:06.390182Z - running sql script pg/insert_tenders.sql
2022-09-28T13:34:06.390213Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:34:06.395097Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:34:06.396345Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:34:06.401399Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:34:06.407231Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:34:06.412109Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:34:06.413170Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:34:06.461599Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:34:06.524561Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:34:06.528894Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:34:06.530585Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:34:06.821182Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:34:06.914471Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:34:06.921542Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:34:07.160513Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:34:07.355097Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:34:07.366466Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:34:07.366997Z - job completed in 2.38 seconds (6b007f6076eed49ec4243596d5e9e712c93f18e905b656061b39b769c6d857ec)
2022-09-28T13:36:02.126780Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0826"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (beffc961129d21d30350795ac870eb0440d2cebb555d8ccfb74a6b3cf6d8accd)
2022-09-28T13:36:04.693890Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:36:04.711863Z - running sql script pg/insert_tenders.sql
2022-09-28T13:36:04.711895Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:36:04.716091Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:36:04.717518Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:36:04.721636Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:36:04.725397Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:36:04.729859Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:36:04.730887Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:36:04.780723Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:36:04.813214Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:36:04.819060Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:36:04.820674Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:36:05.048841Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:36:05.143506Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:36:05.154422Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:36:05.384716Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:36:05.580215Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:36:05.586277Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:36:05.586566Z - job completed in 3.46 seconds (beffc961129d21d30350795ac870eb0440d2cebb555d8ccfb74a6b3cf6d8accd)
2022-09-28T13:36:05.639304Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0826"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a80f52cbe4a07242eb79e9320cb75f0de93338b792fbcc5f40cfa42fec947a1a)
2022-09-28T13:36:07.967020Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:36:07.983652Z - running sql script pg/upsert_orders.sql
2022-09-28T13:36:07.983684Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:36:07.988870Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:36:07.993855Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:36:07.994903Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:36:07.998748Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:36:08.000211Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:36:08.005856Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:36:08.006924Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:36:08.007774Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:36:08.013927Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:36:08.140611Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:36:08.154985Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:36:08.158996Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:36:08.175875Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:36:08.250741Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:36:08.273853Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:36:08.274421Z - job completed in 2.64 seconds (a80f52cbe4a07242eb79e9320cb75f0de93338b792fbcc5f40cfa42fec947a1a)
2022-09-28T13:38:02.052949Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0828"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fb7a20a35b04ac07827cb70b382d54de698b4c94eaae21e6dd0d8d9906c6449f)
2022-09-28T13:38:04.602527Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:38:04.625240Z - running sql script pg/upsert_orders.sql
2022-09-28T13:38:04.625277Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:38:04.629784Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:38:04.634471Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:38:04.635868Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:38:04.639839Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:38:04.641490Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:38:04.645690Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:38:04.646742Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:38:04.647623Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:38:04.653633Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:38:04.757681Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:38:04.772973Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:38:04.776737Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:38:04.783071Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:38:04.846172Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:38:04.854816Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:38:04.855102Z - job completed in 2.80 seconds (fb7a20a35b04ac07827cb70b382d54de698b4c94eaae21e6dd0d8d9906c6449f)
2022-09-28T13:38:04.918456Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0828"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (17aed6e851acc68af0fe1d9e93680921992e89a2536373db0b33d896d4113dc3)
2022-09-28T13:38:06.743829Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:38:06.763321Z - running sql script pg/insert_tenders.sql
2022-09-28T13:38:06.763365Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:38:06.769616Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:38:06.770996Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:38:06.775560Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:38:06.779465Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:38:06.783806Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:38:06.784807Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:38:06.833029Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:38:06.859474Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:38:06.863504Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:38:06.865065Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:38:07.084378Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:38:07.175910Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:38:07.181889Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:38:07.409369Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:38:07.599296Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:38:07.605215Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:38:07.605740Z - job completed in 2.69 seconds (17aed6e851acc68af0fe1d9e93680921992e89a2536373db0b33d896d4113dc3)
2022-09-28T13:38:07.664295Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0818"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (98be03fc777a337cd37d01c30615ecdd423703d92996d8e2984a2cbe5f69db6e)
2022-09-28T13:38:15.401561Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:38:15.419110Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T13:38:15.419141Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:38:15.423453Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T13:38:15.428024Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T13:38:15.431722Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T13:38:15.432721Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T13:38:15.436576Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T13:38:15.440658Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T13:38:15.441639Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:38:15.442696Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T13:38:15.443850Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T13:38:15.449516Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T13:38:15.454172Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T13:38:15.455465Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T13:38:15.461594Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T13:38:15.465778Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T13:38:15.470302Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T13:38:15.476490Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T13:38:16.148781Z - called http://score/api/keyed and received back 200
2022-09-28T13:38:16.148896Z - job completed in 8.48 seconds (98be03fc777a337cd37d01c30615ecdd423703d92996d8e2984a2cbe5f69db6e)
2022-09-28T13:40:02.409230Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0830"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c34d3705fa0c0938d9420cc68638f427223998af79f8498ac2e107dffef25900)
2022-09-28T13:40:07.865034Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:40:07.881172Z - running sql script pg/upsert_orders.sql
2022-09-28T13:40:07.881203Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:40:07.885310Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:40:07.889603Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:40:07.890536Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:40:07.894431Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:40:07.895724Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:40:07.899876Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:40:07.900986Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:40:07.901949Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:40:07.907938Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:40:08.014873Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:40:08.024994Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:40:08.030256Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:40:08.040224Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:40:08.111982Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:40:08.122991Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:40:08.123503Z - job completed in 5.71 seconds (c34d3705fa0c0938d9420cc68638f427223998af79f8498ac2e107dffef25900)
2022-09-28T13:40:08.214579Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0830"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (542f24721de47811e7e44f6e0881d4bb8589b66913cc3948aeba8a41205e3135)
2022-09-28T13:40:09.466172Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:40:09.482219Z - running sql script pg/insert_tenders.sql
2022-09-28T13:40:09.482273Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:40:09.487064Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:40:09.488414Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:40:09.492705Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:40:09.496887Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:40:09.501814Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:40:09.503317Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:40:09.549974Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:40:09.584549Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:40:09.588775Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:40:09.590171Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:40:09.814619Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:40:09.907766Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:40:09.913804Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:40:10.141606Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:40:10.327566Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:40:10.332761Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:40:10.333029Z - job completed in 2.12 seconds (542f24721de47811e7e44f6e0881d4bb8589b66913cc3948aeba8a41205e3135)
2022-09-28T13:42:01.962978Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0832"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (986ce7b3b8752140b004581888e95307580d721f33e31c9a84d8405af118a43b)
2022-09-28T13:42:03.395632Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:42:03.411971Z - running sql script pg/insert_tenders.sql
2022-09-28T13:42:03.412Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:42:03.416314Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:42:03.417633Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:42:03.422086Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:42:03.426034Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:42:03.430439Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:42:03.431323Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:42:03.484066Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:42:03.505785Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:42:03.519819Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:42:03.521291Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:42:03.758132Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:42:03.854651Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:42:03.874048Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:42:04.104117Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:42:04.294190Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:42:04.318270Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:42:04.318826Z - job completed in 2.36 seconds (986ce7b3b8752140b004581888e95307580d721f33e31c9a84d8405af118a43b)
2022-09-28T13:42:04.404277Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0832"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ca3d12daed9af9a5459062096a9158af7b128206fd86c86ba91293f87d5738e2)
2022-09-28T13:42:06.725920Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:42:06.742300Z - running sql script pg/upsert_orders.sql
2022-09-28T13:42:06.742679Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:42:06.747474Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:42:06.752144Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:42:06.753276Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:42:06.757216Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:42:06.758567Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:42:06.762820Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:42:06.763810Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:42:06.764630Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:42:06.770498Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:42:06.917501Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:42:06.927583Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:42:06.931330Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:42:06.938083Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:42:07.001639Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:42:07.013013Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:42:07.013721Z - job completed in 2.61 seconds (ca3d12daed9af9a5459062096a9158af7b128206fd86c86ba91293f87d5738e2)
2022-09-28T13:44:01.960290Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0834"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d2d66e1e2c6b3e07c23e58db07ca70b8a3e8638d3687b1894ce6b0c83d52d37f)
2022-09-28T13:44:03.422840Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:44:03.439003Z - running sql script pg/insert_tenders.sql
2022-09-28T13:44:03.439031Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:44:03.443952Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:44:03.445659Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:44:03.450254Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:44:03.454289Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:44:03.459338Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:44:03.460371Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:44:03.507252Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:44:03.562422Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:44:03.566537Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:44:03.568448Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:44:03.793681Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:44:03.887065Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:44:03.893578Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:44:04.124539Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:44:04.309714Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:44:04.315912Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:44:04.316426Z - job completed in 2.36 seconds (d2d66e1e2c6b3e07c23e58db07ca70b8a3e8638d3687b1894ce6b0c83d52d37f)
2022-09-28T13:44:04.336142Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0834"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (43741b3fddfd8c5f16dc9f301fbbc68209aa5381b5ee0b547923361a82dc156b)
2022-09-28T13:44:09.889760Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:44:09.910824Z - running sql script pg/upsert_orders.sql
2022-09-28T13:44:09.910861Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:44:09.916059Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:44:09.921585Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:44:09.922522Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:44:09.926625Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:44:09.928228Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:44:09.935699Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:44:09.937976Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:44:09.939141Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:44:09.946106Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:44:10.058450Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:44:10.084799Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:44:10.089374Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:44:10.096825Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:44:10.161075Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:44:10.170104Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:44:10.170389Z - job completed in 5.83 seconds (43741b3fddfd8c5f16dc9f301fbbc68209aa5381b5ee0b547923361a82dc156b)
2022-09-28T13:46:02.065611Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0836"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c41781c167655c2271e1cb287806c60ceec6d33ccf00359d9687ba7c90170b70)
2022-09-28T13:46:04.750118Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:46:04.768481Z - running sql script pg/upsert_orders.sql
2022-09-28T13:46:04.768523Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:46:04.773469Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:46:04.778353Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:46:04.779480Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:46:04.783792Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:46:04.785651Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:46:04.790371Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:46:04.791418Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:46:04.792329Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:46:04.798146Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:46:04.912059Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:46:04.943128Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:46:04.947394Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:46:04.958246Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:46:05.025440Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:46:05.041810Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:46:05.042367Z - job completed in 2.98 seconds (c41781c167655c2271e1cb287806c60ceec6d33ccf00359d9687ba7c90170b70)
2022-09-28T13:46:05.132546Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0836"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (db9e4a858778fb18c94a57190aae15eae0237a4bf93093584e39832238d49dff)
2022-09-28T13:46:06.547439Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:46:06.565303Z - running sql script pg/insert_tenders.sql
2022-09-28T13:46:06.565793Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:46:06.570555Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:46:06.572880Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:46:06.577643Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:46:06.581695Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:46:06.586574Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:46:06.587955Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:46:06.635629Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:46:06.674417Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:46:06.678280Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:46:06.679745Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:46:06.902652Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:46:07.019403Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:46:07.027894Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:46:07.255750Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:46:07.441962Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:46:07.447076Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:46:07.447751Z - job completed in 2.32 seconds (db9e4a858778fb18c94a57190aae15eae0237a4bf93093584e39832238d49dff)
2022-09-28T13:48:02.146275Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0838"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (06d141a038e649e2a416fd3b1ade02d9fd8def261572dc2fd795877f89e75e7c)
2022-09-28T13:48:03.335513Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:48:03.352251Z - running sql script pg/insert_tenders.sql
2022-09-28T13:48:03.352729Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:48:03.358143Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:48:03.359994Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:48:03.365908Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:48:03.370119Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:48:03.375121Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:48:03.376583Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:48:03.422696Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:48:03.468772Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:48:03.472671Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:48:03.474401Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:48:03.691692Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:48:03.781631Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:48:03.789024Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:48:04.015032Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:48:04.199316Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:48:04.204832Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:48:04.205240Z - job completed in 2.06 seconds (06d141a038e649e2a416fd3b1ade02d9fd8def261572dc2fd795877f89e75e7c)
2022-09-28T13:48:04.328948Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0838"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (388a59c27be08ce5a19affbfa9e7f7fafbbe095f9be85a8c5dd31dadad2068e2)
2022-09-28T13:48:06.627140Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:48:06.643882Z - running sql script pg/upsert_orders.sql
2022-09-28T13:48:06.643923Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:48:06.648365Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:48:06.653334Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:48:06.654181Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:48:06.657709Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:48:06.662872Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:48:06.666949Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:48:06.667805Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:48:06.668565Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:48:06.674860Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:48:06.788054Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:48:06.822817Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:48:06.827240Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:48:06.835300Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:48:06.900758Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:48:06.912130Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:48:06.912607Z - job completed in 2.58 seconds (388a59c27be08ce5a19affbfa9e7f7fafbbe095f9be85a8c5dd31dadad2068e2)
2022-09-28T13:48:07.011964Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0828"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (14ebf202f1f52f600e76891cb59fd639f91d521ffc381e31e557ba87e082eef7)
2022-09-28T13:48:13.418186Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:48:13.439706Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T13:48:13.440238Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:48:13.444823Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T13:48:13.450609Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T13:48:13.452162Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T13:48:13.453750Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T13:48:13.455015Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T13:48:13.456518Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T13:48:13.457804Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:48:13.459122Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T13:48:13.460233Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T13:48:13.462228Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T13:48:13.463944Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T13:48:13.465367Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T13:48:13.467908Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T13:48:13.469640Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T13:48:13.471299Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T13:48:13.473513Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T13:48:13.558273Z - called http://score/api/keyed and received back 204
2022-09-28T13:48:13.558754Z - job completed in 6.55 seconds (14ebf202f1f52f600e76891cb59fd639f91d521ffc381e31e557ba87e082eef7)
2022-09-28T13:50:03.428341Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0840"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0805ff45c2717a0d2122eb048edcca1ab5c267206a0d7c4c8c2a671a244d3f22)
2022-09-28T13:50:04.741466Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:50:04.762118Z - running sql script pg/insert_tenders.sql
2022-09-28T13:50:04.762450Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:50:04.767415Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:50:04.768952Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:50:04.775365Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:50:04.779814Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:50:04.784555Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:50:04.785596Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:50:04.832151Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:50:04.887476Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:50:04.891401Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:50:04.892804Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:50:05.109849Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:50:05.199025Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:50:05.204974Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:50:05.429069Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:50:05.609842Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:50:05.615580Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:50:05.616089Z - job completed in 2.19 seconds (0805ff45c2717a0d2122eb048edcca1ab5c267206a0d7c4c8c2a671a244d3f22)
2022-09-28T13:50:05.645779Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0840"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7bc43260307f45365cb9daa07484cdc1d09b07b64a3a9eaf6f2b5f95fa4cd02d)
2022-09-28T13:50:07.520613Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:50:07.537802Z - running sql script pg/upsert_orders.sql
2022-09-28T13:50:07.537845Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:50:07.542878Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:50:07.548201Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:50:07.549330Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:50:07.553794Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:50:07.558817Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:50:07.563177Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:50:07.564228Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:50:07.565190Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:50:07.572267Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:50:07.703234Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:50:07.758825Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:50:07.763002Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:50:07.779555Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:50:07.842676Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:50:07.860846Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:50:07.861191Z - job completed in 2.22 seconds (7bc43260307f45365cb9daa07484cdc1d09b07b64a3a9eaf6f2b5f95fa4cd02d)
2022-09-28T13:52:01.978501Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0842"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d230854d194f749b27eb9bbfc61e5e87b0f9235529f73d9c9b940a285d1b8bf1)
2022-09-28T13:52:04.036714Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:52:04.053250Z - running sql script pg/upsert_orders.sql
2022-09-28T13:52:04.053280Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:52:04.058346Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:52:04.064782Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:52:04.065762Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:52:04.069827Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:52:04.074040Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:52:04.078148Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:52:04.079145Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:52:04.080048Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:52:04.086297Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:52:04.227831Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:52:04.288436Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:52:04.293066Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:52:04.299950Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:52:04.365861Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:52:04.377012Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:52:04.377690Z - job completed in 2.40 seconds (d230854d194f749b27eb9bbfc61e5e87b0f9235529f73d9c9b940a285d1b8bf1)
2022-09-28T13:52:04.444039Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0842"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c04fc2dfbbc42421264ce34f07c6a2571d944e9aee633d9f20c583bba4bb85ae)
2022-09-28T13:52:06.304876Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:52:06.322389Z - running sql script pg/insert_tenders.sql
2022-09-28T13:52:06.322533Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:52:06.327390Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:52:06.329158Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:52:06.334786Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:52:06.340107Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:52:06.345765Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:52:06.346962Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:52:06.393012Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:52:06.435518Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:52:06.440101Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:52:06.441396Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:52:06.657787Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:52:06.747844Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:52:06.753889Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:52:06.982770Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:52:07.169381Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:52:07.174479Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:52:07.174948Z - job completed in 2.73 seconds (c04fc2dfbbc42421264ce34f07c6a2571d944e9aee633d9f20c583bba4bb85ae)
2022-09-28T13:54:01.948468Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0844"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7aa29cb7c0569829ce5e34b8b6d2c9b2f722ad6cee66c999ff56e0632a0eb9ac)
2022-09-28T13:54:03.638098Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:54:03.654282Z - running sql script pg/insert_tenders.sql
2022-09-28T13:54:03.654323Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:54:03.659410Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:54:03.660690Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:54:03.665030Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:54:03.668974Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:54:03.673830Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:54:03.675139Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:54:03.722711Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:54:03.766892Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:54:03.771056Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:54:03.772575Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:54:03.991169Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:54:04.081303Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:54:04.087889Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:54:04.319690Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:54:04.509460Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:54:04.514321Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:54:04.514755Z - job completed in 2.57 seconds (7aa29cb7c0569829ce5e34b8b6d2c9b2f722ad6cee66c999ff56e0632a0eb9ac)
2022-09-28T13:54:04.585337Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0844"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (226cfa0f9b5174b13981af566d0f7d7bbe472826916811dddb1129b844b82e03)
2022-09-28T13:54:07.178546Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:54:07.194438Z - running sql script pg/upsert_orders.sql
2022-09-28T13:54:07.194481Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:54:07.200153Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:54:07.205962Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:54:07.207613Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:54:07.214326Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:54:07.218604Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:54:07.223707Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:54:07.224763Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:54:07.226159Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:54:07.234174Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:54:07.368586Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:54:07.424786Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:54:07.429012Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:54:07.436223Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:54:07.501078Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:54:07.534090Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:54:07.534637Z - job completed in 2.95 seconds (226cfa0f9b5174b13981af566d0f7d7bbe472826916811dddb1129b844b82e03)
2022-09-28T13:56:02.177641Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0846"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5e7305470fe651fb31a1bfc37efb35b6a57a6a9e91d2d6b6f5f9d69691e97bc0)
2022-09-28T13:56:03.341704Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:56:03.359852Z - running sql script pg/insert_tenders.sql
2022-09-28T13:56:03.359894Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:56:03.364480Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:56:03.365998Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:56:03.370027Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:56:03.374073Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:56:03.379410Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:56:03.381097Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:56:03.429433Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:56:03.447457Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:56:03.451679Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:56:03.453192Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:56:03.676355Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:56:03.766330Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:56:03.777179Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:56:04.004513Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:56:04.190482Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:56:04.195062Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:56:04.195629Z - job completed in 2.02 seconds (5e7305470fe651fb31a1bfc37efb35b6a57a6a9e91d2d6b6f5f9d69691e97bc0)
2022-09-28T13:56:04.275892Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0846"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (510726e2222ecb30bae5231cd655bc042b1ae09c40b1ece746066c32f27ded9b)
2022-09-28T13:56:06.662336Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:56:06.678119Z - running sql script pg/upsert_orders.sql
2022-09-28T13:56:06.678151Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:56:06.682561Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:56:06.687324Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:56:06.689007Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:56:06.695888Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:56:06.701124Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:56:06.705961Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:56:06.707174Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:56:06.708242Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:56:06.714526Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:56:06.837094Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:56:06.881873Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:56:06.891601Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:56:06.905713Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:56:06.972031Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:56:06.984108Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:56:06.984596Z - job completed in 2.71 seconds (510726e2222ecb30bae5231cd655bc042b1ae09c40b1ece746066c32f27ded9b)
2022-09-28T13:58:02.201877Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0848"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a110a1956d7ce82ed23afe4d7f94691faeb667700ed198c912002edb323db604)
2022-09-28T13:58:03.601433Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:58:03.618620Z - running sql script pg/insert_tenders.sql
2022-09-28T13:58:03.618649Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T13:58:03.623256Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T13:58:03.624898Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T13:58:03.629180Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T13:58:03.633193Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T13:58:03.639314Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T13:58:03.640733Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T13:58:03.686432Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T13:58:03.725142Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T13:58:03.729526Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T13:58:03.731283Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T13:58:03.962761Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T13:58:04.055517Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T13:58:04.066966Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T13:58:04.302720Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T13:58:04.491451Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T13:58:04.497302Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T13:58:04.497788Z - job completed in 2.30 seconds (a110a1956d7ce82ed23afe4d7f94691faeb667700ed198c912002edb323db604)
2022-09-28T13:58:04.616024Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0838"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (73e27d5b9356e5ac70f2a6be52e96a30876c54cebd4618533cbc33b6d553d497)
2022-09-28T13:58:10.507304Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:58:10.525193Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T13:58:10.525232Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:58:10.529895Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T13:58:10.534417Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T13:58:10.538125Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T13:58:10.539104Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T13:58:10.542660Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T13:58:10.547126Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T13:58:10.548376Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:58:10.549347Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T13:58:10.550245Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T13:58:10.557547Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T13:58:10.562281Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T13:58:10.563193Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T13:58:10.569437Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T13:58:10.574059Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T13:58:10.578605Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T13:58:10.584682Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T13:58:11.218291Z - called http://score/api/keyed and received back 200
2022-09-28T13:58:11.218768Z - job completed in 6.60 seconds (73e27d5b9356e5ac70f2a6be52e96a30876c54cebd4618533cbc33b6d553d497)
2022-09-28T13:58:11.342480Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0848"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7e0e0dcf2bdd297634b0f87f4f8dc068a522e74ffe9b1ed41adea8d21112f917)
2022-09-28T13:58:13.726721Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T13:58:13.748919Z - running sql script pg/upsert_orders.sql
2022-09-28T13:58:13.749485Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T13:58:13.755192Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T13:58:13.760795Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T13:58:13.761747Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T13:58:13.765808Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T13:58:13.770148Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T13:58:13.774296Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T13:58:13.775377Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T13:58:13.776385Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T13:58:13.782461Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T13:58:13.904616Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T13:58:13.927227Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T13:58:13.931492Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T13:58:13.942254Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T13:58:14.007141Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T13:58:14.027777Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T13:58:14.028229Z - job completed in 2.69 seconds (7e0e0dcf2bdd297634b0f87f4f8dc068a522e74ffe9b1ed41adea8d21112f917)
2022-09-28T14:00:02.775157Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0850"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4ddce4c40f0967d34829ff8a4fe1c85d6a7633294053597dd13d0f0d3a8e7050)
2022-09-28T14:00:05.098275Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:00:05.115057Z - running sql script pg/upsert_orders.sql
2022-09-28T14:00:05.115101Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:00:05.120058Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:00:05.125398Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:00:05.127010Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:00:05.132243Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:00:05.136593Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:00:05.141093Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:00:05.142160Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:00:05.143148Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:00:05.149381Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:00:05.274640Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:00:05.309626Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:00:05.314605Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:00:05.324798Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:00:05.393185Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:00:05.406376Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:00:05.407328Z - job completed in 2.63 seconds (4ddce4c40f0967d34829ff8a4fe1c85d6a7633294053597dd13d0f0d3a8e7050)
2022-09-28T14:00:05.538517Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0850"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (058c35a698d6abd4baf8e3800f321b8ebf7bbf9c1c5ab64eb05db940095679aa)
2022-09-28T14:00:07.700545Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:00:07.717129Z - running sql script pg/insert_tenders.sql
2022-09-28T14:00:07.717199Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:00:07.721805Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:00:07.723117Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:00:07.727055Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:00:07.730796Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:00:07.735631Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:00:07.736709Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:00:07.783607Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:00:07.823424Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:00:07.827704Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:00:07.829742Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:00:08.052776Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:00:08.146641Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:00:08.152993Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:00:08.384106Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:00:08.576469Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:00:08.581434Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:00:08.582004Z - job completed in 3.04 seconds (058c35a698d6abd4baf8e3800f321b8ebf7bbf9c1c5ab64eb05db940095679aa)
2022-09-28T14:02:02.001378Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0852"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0d1789cd06669623e1fab5d9ca3da91b934834700f1a7ab7652f2099da4d3e2d)
2022-09-28T14:02:04.642003Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:02:04.672001Z - running sql script pg/upsert_orders.sql
2022-09-28T14:02:04.672034Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:02:04.677181Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:02:04.682668Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:02:04.683753Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:02:04.687823Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:02:04.694696Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:02:04.699635Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:02:04.700855Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:02:04.701783Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:02:04.708548Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:02:04.840006Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:02:04.896669Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:02:04.900637Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:02:04.917658Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:02:04.986351Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:02:05.006369Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:02:05.007236Z - job completed in 3.01 seconds (0d1789cd06669623e1fab5d9ca3da91b934834700f1a7ab7652f2099da4d3e2d)
2022-09-28T14:02:05.084059Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0852"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (08aec7de28e58fb8de3fa2dbfc936e15f15b2aaa9bdb8caa3d2c2d3ad77364a4)
2022-09-28T14:02:06.777366Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:02:06.795148Z - running sql script pg/insert_tenders.sql
2022-09-28T14:02:06.795183Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:02:06.800187Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:02:06.801496Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:02:06.806784Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:02:06.811399Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:02:06.819720Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:02:06.820806Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:02:06.867967Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:02:06.899802Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:02:06.904259Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:02:06.905815Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:02:07.142917Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:02:07.238218Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:02:07.246293Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:02:07.476919Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:02:07.668663Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:02:07.674632Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:02:07.675104Z - job completed in 2.59 seconds (08aec7de28e58fb8de3fa2dbfc936e15f15b2aaa9bdb8caa3d2c2d3ad77364a4)
2022-09-28T14:04:02.052613Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0854"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7675316c22ef7bd0b8158355be7e6b231121fadf5c6d62b0b668e7dc25cf6083)
2022-09-28T14:04:04.258888Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:04:04.275065Z - running sql script pg/upsert_orders.sql
2022-09-28T14:04:04.275098Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:04:04.279617Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:04:04.284203Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:04:04.285168Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:04:04.288894Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:04:04.295335Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:04:04.299557Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:04:04.300416Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:04:04.301319Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:04:04.307708Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:04:04.451639Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:04:04.519454Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:04:04.523279Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:04:04.531006Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:04:04.596591Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:04:04.608637Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:04:04.608942Z - job completed in 2.56 seconds (7675316c22ef7bd0b8158355be7e6b231121fadf5c6d62b0b668e7dc25cf6083)
2022-09-28T14:04:04.757327Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0854"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (aca03cfc74d9b55f88be3c79fe3d7c4e09ea3e57786226205477c0c20505158e)
2022-09-28T14:04:06.131216Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:04:06.155297Z - running sql script pg/insert_tenders.sql
2022-09-28T14:04:06.155896Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:04:06.160479Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:04:06.162190Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:04:06.184667Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:04:06.190484Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:04:06.196311Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:04:06.197988Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:04:06.243750Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:04:06.283570Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:04:06.287433Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:04:06.288936Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:04:06.539449Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:04:06.634549Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:04:06.640491Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:04:06.864276Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:04:07.058860Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:04:07.064017Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:04:07.064535Z - job completed in 2.31 seconds (aca03cfc74d9b55f88be3c79fe3d7c4e09ea3e57786226205477c0c20505158e)
2022-09-28T14:06:02.220944Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0856"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (20db38635fe7ecc4580b69b3cead2078ee9362e0137ff4816a026b8fad60287f)
2022-09-28T14:06:03.770764Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:06:03.788140Z - running sql script pg/insert_tenders.sql
2022-09-28T14:06:03.788202Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:06:03.794307Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:06:03.795726Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:06:03.800932Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:06:03.806477Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:06:03.812484Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:06:03.814014Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:06:03.862105Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:06:03.888082Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:06:03.893017Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:06:03.895404Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:06:04.133733Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:06:04.255483Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:06:04.269599Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:06:04.514202Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:06:04.766426Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:06:04.772061Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:06:04.772369Z - job completed in 2.55 seconds (20db38635fe7ecc4580b69b3cead2078ee9362e0137ff4816a026b8fad60287f)
2022-09-28T14:06:05.022256Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0856"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e302578e52b5a8a3478de7d71e2de3f3f02e9713e864fd266e9061457610260e)
2022-09-28T14:06:07.580398Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:06:07.607371Z - running sql script pg/upsert_orders.sql
2022-09-28T14:06:07.607405Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:06:07.611921Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:06:07.617306Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:06:07.618241Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:06:07.622298Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:06:07.626400Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:06:07.630377Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:06:07.631269Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:06:07.632111Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:06:07.638561Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:06:07.806990Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:06:07.862664Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:06:07.866350Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:06:07.885283Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:06:07.967768Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:06:07.991820Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:06:07.992324Z - job completed in 2.97 seconds (e302578e52b5a8a3478de7d71e2de3f3f02e9713e864fd266e9061457610260e)
2022-09-28T14:08:02.003101Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0858"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2c03702cc42bc4b06ce45c463d10002d21ad340574ded0a6b0ea3be39d76014a)
2022-09-28T14:08:04.369294Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:08:04.388004Z - running sql script pg/upsert_orders.sql
2022-09-28T14:08:04.388043Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:08:04.393719Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:08:04.398839Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:08:04.400260Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:08:04.404587Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:08:04.408935Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:08:04.414576Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:08:04.415640Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:08:04.416709Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:08:04.423257Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:08:04.594770Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:08:04.655925Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:08:04.661345Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:08:04.675485Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:08:04.748733Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:08:04.759391Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:08:04.759932Z - job completed in 2.76 seconds (2c03702cc42bc4b06ce45c463d10002d21ad340574ded0a6b0ea3be39d76014a)
2022-09-28T14:08:04.822145Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0858"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e3aabc5b41e33f33c8becbd85f9f087a1405aaa7c3a12f68d4ea33338ec0b227)
2022-09-28T14:08:05.959140Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:08:05.979747Z - running sql script pg/insert_tenders.sql
2022-09-28T14:08:05.980333Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:08:05.985865Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:08:05.987123Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:08:05.992830Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:08:05.996715Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:08:06.002099Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:08:06.003153Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:08:06.049163Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:08:06.142101Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:08:06.146158Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:08:06.147816Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:08:06.366595Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:08:06.459266Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:08:06.467625Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:08:06.727729Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:08:06.920527Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:08:06.925909Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:08:06.926430Z - job completed in 2.10 seconds (e3aabc5b41e33f33c8becbd85f9f087a1405aaa7c3a12f68d4ea33338ec0b227)
2022-09-28T14:08:06.953373Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0848"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (a6edea30524122284c886df5a95c2a5871c5f15f62e0d230ab1355c189e306ce)
2022-09-28T14:08:13.558798Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:08:13.582829Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T14:08:13.584656Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:08:13.590099Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T14:08:13.595235Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T14:08:13.599378Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T14:08:13.600768Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T14:08:13.605141Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T14:08:13.609376Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T14:08:13.615008Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:08:13.616666Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T14:08:13.618120Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T14:08:13.623843Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T14:08:13.631682Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T14:08:13.633238Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T14:08:13.640738Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T14:08:13.644913Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T14:08:13.649654Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T14:08:13.655627Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T14:08:14.686468Z - called http://score/api/keyed and received back 200
2022-09-28T14:08:14.686690Z - job completed in 7.73 seconds (a6edea30524122284c886df5a95c2a5871c5f15f62e0d230ab1355c189e306ce)
2022-09-28T14:10:02.505219Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0900"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (62881db71ca687df4a47c7ae1616a8d1923ce291c86843a7aa6c82a155169da8)
2022-09-28T14:10:04.970981Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:10:04.986924Z - running sql script pg/upsert_orders.sql
2022-09-28T14:10:04.986980Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:10:04.991317Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:10:04.996167Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:10:04.997061Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:10:05.001798Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:10:05.003081Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:10:05.010789Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:10:05.012053Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:10:05.013058Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:10:05.019734Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:10:05.187937Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:10:05.244142Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:10:05.248414Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:10:05.254927Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:10:05.319684Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:10:05.330924Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:10:05.331219Z - job completed in 2.83 seconds (62881db71ca687df4a47c7ae1616a8d1923ce291c86843a7aa6c82a155169da8)
2022-09-28T14:10:05.447789Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0900"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7c667aee548baa4474297cac1dbdbf15423c5fbb274624eeb505521f0cfbd0e8)
2022-09-28T14:10:06.877935Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:10:06.895516Z - running sql script pg/insert_tenders.sql
2022-09-28T14:10:06.895833Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:10:06.901008Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:10:06.902746Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:10:06.907450Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:10:06.911781Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:10:06.941573Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:10:06.942834Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:10:06.990047Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:10:07.079353Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:10:07.084052Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:10:07.085790Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:10:07.301962Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:10:07.393899Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:10:07.400659Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:10:07.632196Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:10:07.824621Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:10:07.830023Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:10:07.830463Z - job completed in 2.38 seconds (7c667aee548baa4474297cac1dbdbf15423c5fbb274624eeb505521f0cfbd0e8)
2022-09-28T14:12:01.949057Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0902"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d5d3f0323409f0c10bc4b35bdefbefc897239a1db7f55de32a09082f9949e6e2)
2022-09-28T14:12:03.137191Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:12:03.154404Z - running sql script pg/insert_tenders.sql
2022-09-28T14:12:03.154433Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:12:03.158936Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:12:03.160268Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:12:03.164705Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:12:03.171618Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:12:03.179761Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:12:03.180941Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:12:03.227254Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:12:03.327663Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:12:03.331583Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:12:03.333586Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:12:03.550755Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:12:03.642193Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:12:03.652375Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:12:03.884936Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:12:04.073074Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:12:04.078664Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:12:04.079221Z - job completed in 2.13 seconds (d5d3f0323409f0c10bc4b35bdefbefc897239a1db7f55de32a09082f9949e6e2)
2022-09-28T14:12:04.143280Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0902"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (035bef883aa393535503c631c2965622530e8daa03b21a5c56700da97b0d635f)
2022-09-28T14:12:06.661217Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:12:06.682499Z - running sql script pg/upsert_orders.sql
2022-09-28T14:12:06.682535Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:12:06.688488Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:12:06.693512Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:12:06.694928Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:12:06.699440Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:12:06.701950Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:12:06.706467Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:12:06.707316Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:12:06.708437Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:12:06.715684Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:12:06.880757Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:12:06.936201Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:12:06.939956Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:12:06.953995Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:12:07.019179Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:12:07.036897Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:12:07.037419Z - job completed in 2.89 seconds (035bef883aa393535503c631c2965622530e8daa03b21a5c56700da97b0d635f)
2022-09-28T14:14:02.114489Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0904"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5a94424e075b6b590c2bc0ed3ff9e7157dbad44909d5eb1b72b5a6b9b5c50b7d)
2022-09-28T14:14:04.676682Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:14:04.696567Z - running sql script pg/upsert_orders.sql
2022-09-28T14:14:04.696606Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:14:04.701557Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:14:04.706381Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:14:04.707350Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:14:04.711741Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:14:04.713136Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:14:04.719318Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:14:04.720427Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:14:04.721329Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:14:04.728158Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:14:04.909477Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:14:04.986899Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:14:04.990940Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:14:04.998051Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:14:05.066037Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:14:05.078065Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:14:05.078486Z - job completed in 2.96 seconds (5a94424e075b6b590c2bc0ed3ff9e7157dbad44909d5eb1b72b5a6b9b5c50b7d)
2022-09-28T14:14:05.098407Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0904"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (eccf735dac9fbfe20cb0f1bf8db4ae1bcca09d0af3711dc133495e821e23bc86)
2022-09-28T14:14:06.680370Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:14:06.697669Z - running sql script pg/insert_tenders.sql
2022-09-28T14:14:06.697702Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:14:06.702862Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:14:06.704217Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:14:06.708693Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:14:06.713065Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:14:06.718572Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:14:06.719776Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:14:06.766278Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:14:06.858992Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:14:06.862876Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:14:06.864364Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:14:07.088411Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:14:07.182760Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:14:07.189403Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:14:07.420015Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:14:07.610362Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:14:07.615799Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:14:07.616195Z - job completed in 2.52 seconds (eccf735dac9fbfe20cb0f1bf8db4ae1bcca09d0af3711dc133495e821e23bc86)
2022-09-28T14:16:02.168176Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0906"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (804a75b3031683a5177027437114e343badd911d5f531c7a56be742cc561fbe9)
2022-09-28T14:16:04.279588Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:16:04.296650Z - running sql script pg/upsert_orders.sql
2022-09-28T14:16:04.296680Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:16:04.303519Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:16:04.308107Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:16:04.309097Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:16:04.313Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:16:04.314346Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:16:04.318528Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:16:04.319585Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:16:04.320469Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:16:04.326796Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:16:04.503662Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:16:04.597652Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:16:04.602472Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:16:04.620617Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:16:04.695769Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:16:04.719254Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:16:04.719804Z - job completed in 2.55 seconds (804a75b3031683a5177027437114e343badd911d5f531c7a56be742cc561fbe9)
2022-09-28T14:16:04.774428Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0906"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (453182de3ed54f8084f68f099163415874556b5a32cc31762198d3460dccc3a7)
2022-09-28T14:16:05.936347Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:16:05.956439Z - running sql script pg/insert_tenders.sql
2022-09-28T14:16:05.956475Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:16:05.961040Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:16:05.962272Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:16:05.966682Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:16:05.970798Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:16:05.975768Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:16:05.976675Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:16:06.024551Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:16:06.096784Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:16:06.101092Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:16:06.102798Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:16:06.338151Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:16:06.435833Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:16:06.450180Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:16:06.678725Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:16:06.919635Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:16:06.927189Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:16:06.927912Z - job completed in 2.15 seconds (453182de3ed54f8084f68f099163415874556b5a32cc31762198d3460dccc3a7)
2022-09-28T14:18:02.071488Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0908"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (94d9065778e5595712552a70e797aeac569747f28f8aa133eafada9987198aa8)
2022-09-28T14:18:04.682218Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:18:04.699292Z - running sql script pg/upsert_orders.sql
2022-09-28T14:18:04.699344Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:18:04.705188Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:18:04.710138Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:18:04.711031Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:18:04.715719Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:18:04.717049Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:18:04.722400Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:18:04.723338Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:18:04.724109Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:18:04.731500Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:18:04.961676Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:18:05.083031Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:18:05.086905Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:18:05.098025Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:18:05.167702Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:18:05.192015Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:18:05.192511Z - job completed in 3.13 seconds (94d9065778e5595712552a70e797aeac569747f28f8aa133eafada9987198aa8)
2022-09-28T14:18:05.233665Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0908"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (763042df08e79f21cbf27f072ea394bcce58beb1a02d98c78ef6508c2acfa363)
2022-09-28T14:18:06.362346Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:18:06.379600Z - running sql script pg/insert_tenders.sql
2022-09-28T14:18:06.379647Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:18:06.385114Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:18:06.386345Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:18:06.391655Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:18:06.395788Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:18:06.400168Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:18:06.401527Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:18:06.447945Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:18:06.515825Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:18:06.519705Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:18:06.521826Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:18:06.762856Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:18:06.860912Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:18:06.868433Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:18:07.098367Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:18:07.284980Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:18:07.289915Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:18:07.290375Z - job completed in 2.06 seconds (763042df08e79f21cbf27f072ea394bcce58beb1a02d98c78ef6508c2acfa363)
2022-09-28T14:18:07.344993Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0858"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (72c8dc8c0047beaebb7336582abccf6b9ca42a7c2e2979d82e758e535d21a5de)
2022-09-28T14:18:14.194155Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:18:14.220301Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T14:18:14.220347Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:18:14.224876Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T14:18:14.233498Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T14:18:14.238710Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T14:18:14.239724Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T14:18:14.244530Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T14:18:14.248729Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T14:18:14.249643Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:18:14.250510Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T14:18:14.251352Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T14:18:14.256812Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T14:18:14.261737Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T14:18:14.262680Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T14:18:14.269363Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T14:18:14.273278Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T14:18:14.277393Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T14:18:14.283383Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T14:18:15.197923Z - called http://score/api/keyed and received back 200
2022-09-28T14:18:15.198262Z - job completed in 7.85 seconds (72c8dc8c0047beaebb7336582abccf6b9ca42a7c2e2979d82e758e535d21a5de)
2022-09-28T14:20:02.196488Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0910"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c5bcf742b0f6f1a02446c667b28f75654525b5a7998b09dd873cbbe1f3f02374)
2022-09-28T14:20:04.080694Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:20:04.098943Z - running sql script pg/insert_tenders.sql
2022-09-28T14:20:04.098974Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:20:04.103695Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:20:04.105111Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:20:04.109819Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:20:04.114069Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:20:04.119039Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:20:04.120086Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:20:04.167396Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:20:04.283632Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:20:04.290129Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:20:04.291792Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:20:04.533249Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:20:04.630988Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:20:04.638195Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:20:04.868353Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:20:05.057002Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:20:05.062325Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:20:05.062756Z - job completed in 2.87 seconds (c5bcf742b0f6f1a02446c667b28f75654525b5a7998b09dd873cbbe1f3f02374)
2022-09-28T14:20:05.095385Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0910"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b201bc69d42d88a64d6e5b6096b9bb6a77b68f9e0f0c0e0d78ec33d482e51bbb)
2022-09-28T14:20:07.268671Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:20:07.285169Z - running sql script pg/upsert_orders.sql
2022-09-28T14:20:07.285258Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:20:07.290497Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:20:07.296290Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:20:07.297550Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:20:07.302754Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:20:07.310100Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:20:07.315256Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:20:07.316638Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:20:07.317811Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:20:07.324796Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:20:07.563692Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:20:07.670303Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:20:07.675466Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:20:07.686038Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:20:07.754723Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:20:07.770726Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:20:07.771208Z - job completed in 2.68 seconds (b201bc69d42d88a64d6e5b6096b9bb6a77b68f9e0f0c0e0d78ec33d482e51bbb)
2022-09-28T14:22:02.016082Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0912"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (27fa4d4c5a2b6ccddcea7b733365eb7d95ae5252d61834c72a85b435414c5c09)
2022-09-28T14:22:04.407873Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:22:04.424653Z - running sql script pg/upsert_orders.sql
2022-09-28T14:22:04.424682Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:22:04.429401Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:22:04.434492Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:22:04.435552Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:22:04.440053Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:22:04.441402Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:22:04.445717Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:22:04.446706Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:22:04.447561Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:22:04.454322Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:22:04.684656Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:22:04.762379Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:22:04.766968Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:22:04.776967Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:22:04.842560Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:22:04.859883Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:22:04.860386Z - job completed in 2.84 seconds (27fa4d4c5a2b6ccddcea7b733365eb7d95ae5252d61834c72a85b435414c5c09)
2022-09-28T14:22:04.900319Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0912"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (669d0f1b49407d1c994c411a3d8e9f767704970595f448a46d6edf674ddb6615)
2022-09-28T14:22:06.133310Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:22:06.150048Z - running sql script pg/insert_tenders.sql
2022-09-28T14:22:06.150234Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:22:06.154528Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:22:06.155813Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:22:06.161250Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:22:06.165670Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:22:06.171010Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:22:06.172081Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:22:06.218409Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:22:06.281274Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:22:06.285453Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:22:06.286932Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:22:06.519639Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:22:06.618102Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:22:06.625104Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:22:06.852718Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:22:07.041095Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:22:07.046234Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:22:07.046703Z - job completed in 2.15 seconds (669d0f1b49407d1c994c411a3d8e9f767704970595f448a46d6edf674ddb6615)
2022-09-28T14:24:02.234253Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0914"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c831fc50109f8ae9896b422cbf4dd908330ab6388a374b9c3c004584880ae7f2)
2022-09-28T14:24:03.742287Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:24:03.760807Z - running sql script pg/insert_tenders.sql
2022-09-28T14:24:03.760847Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:24:03.766118Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:24:03.767578Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:24:03.772346Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:24:03.778641Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:24:03.784736Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:24:03.785721Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:24:03.863243Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:24:03.997835Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:24:04.001924Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:24:04.003676Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:24:04.242303Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:24:04.342495Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:24:04.351028Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:24:04.585284Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:24:04.781410Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:24:04.786747Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:24:04.787162Z - job completed in 2.55 seconds (c831fc50109f8ae9896b422cbf4dd908330ab6388a374b9c3c004584880ae7f2)
2022-09-28T14:24:04.842497Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0914"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (53a216291752fa0784ec9b08cfb16035b6c239194070dae2fbcd447b2222823a)
2022-09-28T14:24:07.853328Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:24:07.869244Z - running sql script pg/upsert_orders.sql
2022-09-28T14:24:07.869287Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:24:07.873503Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:24:07.878077Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:24:07.879012Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:24:07.883418Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:24:07.884949Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:24:07.889941Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:24:07.891Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:24:07.891919Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:24:07.898864Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:24:08.156714Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:24:08.246708Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:24:08.251117Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:24:08.263465Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:24:08.333144Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:24:08.352169Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:24:08.352648Z - job completed in 3.51 seconds (53a216291752fa0784ec9b08cfb16035b6c239194070dae2fbcd447b2222823a)
2022-09-28T14:26:02.106048Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0916"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a9d845f405d5bf259ebd86f0b9e8e61ca29feb1dc76f638cba60f5e9cca41a8f)
2022-09-28T14:26:04.145063Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:26:04.161431Z - running sql script pg/insert_tenders.sql
2022-09-28T14:26:04.161463Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:26:04.166154Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:26:04.167520Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:26:04.171641Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:26:04.176034Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:26:04.181115Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:26:04.182165Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:26:04.231315Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:26:04.336858Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:26:04.340724Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:26:04.342406Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:26:04.576985Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:26:04.676917Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:26:04.690275Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:26:04.924315Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:26:05.118288Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:26:05.123796Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:26:05.124266Z - job completed in 3.02 seconds (a9d845f405d5bf259ebd86f0b9e8e61ca29feb1dc76f638cba60f5e9cca41a8f)
2022-09-28T14:26:05.229704Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0916"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (79ac60d3cc3e9c95c6d107aa36d8d0e4aacff0adc4d8a8b7f5abee5517ccebea)
2022-09-28T14:26:07.306159Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:26:07.322902Z - running sql script pg/upsert_orders.sql
2022-09-28T14:26:07.322947Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:26:07.328015Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:26:07.332606Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:26:07.333592Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:26:07.338233Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:26:07.339754Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:26:07.344258Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:26:07.345190Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:26:07.346087Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:26:07.353098Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:26:07.644636Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:26:07.726154Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:26:07.730067Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:26:07.749969Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:26:07.818851Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:26:07.844947Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:26:07.845535Z - job completed in 2.62 seconds (79ac60d3cc3e9c95c6d107aa36d8d0e4aacff0adc4d8a8b7f5abee5517ccebea)
2022-09-28T14:28:02.014457Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0908"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (80cc68ed2ef053c1ae20b72a3ebe884a2c3d036b92ec48627066334ca52c656a)
2022-09-28T14:28:07.688058Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:28:07.704699Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T14:28:07.704732Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:28:07.709211Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T14:28:07.714005Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T14:28:07.718177Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T14:28:07.719101Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T14:28:07.723411Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T14:28:07.727614Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T14:28:07.728717Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:28:07.729624Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T14:28:07.730472Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T14:28:07.736108Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T14:28:07.742363Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T14:28:07.743306Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T14:28:07.750592Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T14:28:07.755173Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T14:28:07.759563Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T14:28:07.766365Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T14:28:08.772484Z - called http://score/api/keyed and received back 200
2022-09-28T14:28:08.773013Z - job completed in 6.76 seconds (80cc68ed2ef053c1ae20b72a3ebe884a2c3d036b92ec48627066334ca52c656a)
2022-09-28T14:28:08.804885Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0918"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1b2992ad1e496a1a09ada8701f5a80e24132da797ce82563f2134767af79d249)
2022-09-28T14:28:10.973490Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:28:11.006890Z - running sql script pg/upsert_orders.sql
2022-09-28T14:28:11.006938Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:28:11.011667Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:28:11.016320Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:28:11.017364Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:28:11.022658Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:28:11.024174Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:28:11.028465Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:28:11.030366Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:28:11.031316Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:28:11.038205Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:28:11.312307Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:28:11.388974Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:28:11.392818Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:28:11.407400Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:28:11.478345Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:28:11.494960Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:28:11.495413Z - job completed in 2.69 seconds (1b2992ad1e496a1a09ada8701f5a80e24132da797ce82563f2134767af79d249)
2022-09-28T14:28:11.519972Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0918"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ec4c186246dc5a987a2a045524770f5c22136289ead5c358b2414078ea885c8c)
2022-09-28T14:28:12.833765Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:28:12.849631Z - running sql script pg/insert_tenders.sql
2022-09-28T14:28:12.849683Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:28:12.854651Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:28:12.855998Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:28:12.862993Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:28:12.867309Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:28:12.873658Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:28:12.874629Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:28:12.921410Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:28:13.018450Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:28:13.022402Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:28:13.024002Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:28:13.280305Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:28:13.379512Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:28:13.389475Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:28:13.627043Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:28:13.928074Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:28:13.933570Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:28:13.933946Z - job completed in 2.41 seconds (ec4c186246dc5a987a2a045524770f5c22136289ead5c358b2414078ea885c8c)
2022-09-28T14:30:02.340807Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0920"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ae4eedeee509f7c6e7395d3b9288baa062266662884db2c6cca824cc68770dfc)
2022-09-28T14:30:03.707054Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:30:03.723372Z - running sql script pg/insert_tenders.sql
2022-09-28T14:30:03.723406Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:30:03.727853Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:30:03.729057Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:30:03.733356Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:30:03.737571Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:30:03.741908Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:30:03.742862Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:30:03.789060Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:30:03.874458Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:30:03.878346Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:30:03.882827Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:30:04.115469Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:30:04.214413Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:30:04.222207Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:30:04.521287Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:30:04.713047Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:30:04.718244Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:30:04.718685Z - job completed in 2.38 seconds (ae4eedeee509f7c6e7395d3b9288baa062266662884db2c6cca824cc68770dfc)
2022-09-28T14:30:04.767836Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0920"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3edd46c147dee0e6847ca1c532fcb1f8348fe4523b0df8b69a917cfd759349e1)
2022-09-28T14:30:07.242770Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:30:07.260674Z - running sql script pg/upsert_orders.sql
2022-09-28T14:30:07.260753Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:30:07.266936Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:30:07.271864Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:30:07.272710Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:30:07.277084Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:30:07.281497Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:30:07.285913Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:30:07.287088Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:30:07.287982Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:30:07.295571Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:30:07.544098Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:30:07.624989Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:30:07.628816Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:30:07.636611Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:30:07.703650Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:30:07.718573Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:30:07.719082Z - job completed in 2.95 seconds (3edd46c147dee0e6847ca1c532fcb1f8348fe4523b0df8b69a917cfd759349e1)
2022-09-28T14:32:02.250780Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0922"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7cb12f263a7cacfa2af7b6a3c108521016b15052bc338f7843463c620819a230)
2022-09-28T14:32:03.780594Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:32:03.798851Z - running sql script pg/insert_tenders.sql
2022-09-28T14:32:03.798881Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:32:03.804226Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:32:03.805801Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:32:03.811373Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:32:03.816310Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:32:03.821649Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:32:03.822681Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:32:03.869723Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:32:03.962801Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:32:03.967301Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:32:03.969055Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:32:04.200176Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:32:04.300626Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:32:04.307721Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:32:04.540029Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:32:04.737128Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:32:04.742356Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:32:04.742858Z - job completed in 2.49 seconds (7cb12f263a7cacfa2af7b6a3c108521016b15052bc338f7843463c620819a230)
2022-09-28T14:32:04.823383Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0922"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (cc19d190e2d889e759cd4b20b3ad6d846417b826b9564966465d0f7b459702a1)
2022-09-28T14:32:07.064383Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:32:07.083162Z - running sql script pg/upsert_orders.sql
2022-09-28T14:32:07.089668Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:32:07.095640Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:32:07.101248Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:32:07.102231Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:32:07.106647Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:32:07.111269Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:32:07.115883Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:32:07.117254Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:32:07.118382Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:32:07.125500Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:32:07.383402Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:32:07.488115Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:32:07.492211Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:32:07.501389Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:32:07.571175Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:32:07.593694Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:32:07.594161Z - job completed in 2.77 seconds (cc19d190e2d889e759cd4b20b3ad6d846417b826b9564966465d0f7b459702a1)
2022-09-28T14:34:02.156967Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0924"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dd3251c2945ebcede2af3175872072dec132c151fbfb21da8f8351442a789b18)
2022-09-28T14:34:04.033525Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:34:04.052628Z - running sql script pg/insert_tenders.sql
2022-09-28T14:34:04.052668Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:34:04.059116Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:34:04.060598Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:34:04.065070Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:34:04.069681Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:34:04.074576Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:34:04.075629Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:34:04.122345Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:34:04.217934Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:34:04.222162Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:34:04.223761Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:34:04.461352Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:34:04.562868Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:34:04.570264Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:34:04.823521Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:34:05.016438Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:34:05.022290Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:34:05.022688Z - job completed in 2.87 seconds (dd3251c2945ebcede2af3175872072dec132c151fbfb21da8f8351442a789b18)
2022-09-28T14:34:05.093032Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0924"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (cff3f19e47e47aca163983139c0b60b735122c6b12765ab64dced5b3fd72b007)
2022-09-28T14:34:07.672821Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:34:07.689873Z - running sql script pg/upsert_orders.sql
2022-09-28T14:34:07.689979Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:34:07.695455Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:34:07.700689Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:34:07.701835Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:34:07.707635Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:34:07.712039Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:34:07.718422Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:34:07.719780Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:34:07.720794Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:34:07.727594Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:34:07.949970Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:34:08.071913Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:34:08.076020Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:34:08.082699Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:34:08.147656Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:34:08.157671Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:34:08.158299Z - job completed in 3.07 seconds (cff3f19e47e47aca163983139c0b60b735122c6b12765ab64dced5b3fd72b007)
2022-09-28T14:36:02.021809Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0926"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ae3dbacb78357e9972f1181efe2985c8f0f247ed19dffec8f1a964505e39e693)
2022-09-28T14:36:03.423821Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:36:03.447102Z - running sql script pg/insert_tenders.sql
2022-09-28T14:36:03.447141Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:36:03.452056Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:36:03.453697Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:36:03.458756Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:36:03.463588Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:36:03.474736Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:36:03.476214Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:36:03.525199Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:36:03.601502Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:36:03.606037Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:36:03.607741Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:36:03.827637Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:36:03.922325Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:36:03.934373Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:36:04.168523Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:36:04.362341Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:36:04.368784Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:36:04.369210Z - job completed in 2.35 seconds (ae3dbacb78357e9972f1181efe2985c8f0f247ed19dffec8f1a964505e39e693)
2022-09-28T14:36:04.475491Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0926"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3a758b4be57a2c855dd7eb6ac2b23e1fab3f64b109c98cbeaba67eeaddce4b12)
2022-09-28T14:36:06.533436Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:36:06.550599Z - running sql script pg/upsert_orders.sql
2022-09-28T14:36:06.550629Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:36:06.555308Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:36:06.559855Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:36:06.560750Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:36:06.564923Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:36:06.569119Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:36:06.573495Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:36:06.574419Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:36:06.575264Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:36:06.582066Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:36:06.758904Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:36:06.942390Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:36:06.947083Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:36:06.962987Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:36:07.038234Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:36:07.053594Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:36:07.054470Z - job completed in 2.58 seconds (3a758b4be57a2c855dd7eb6ac2b23e1fab3f64b109c98cbeaba67eeaddce4b12)
2022-09-28T14:38:02.027892Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0928"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (aa5cde67d4d39a30a2308fa6491d17300c93f756169272ffc1cbde74fef55082)
2022-09-28T14:38:05.612967Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:38:05.631796Z - running sql script pg/upsert_orders.sql
2022-09-28T14:38:05.631826Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:38:05.639970Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:38:05.645456Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:38:05.646434Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:38:05.650491Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:38:05.655872Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:38:05.659943Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:38:05.661025Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:38:05.662154Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:38:05.669033Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:38:05.814082Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:38:05.894562Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:38:05.899969Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:38:05.907976Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:38:05.976860Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:38:05.991658Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:38:05.991991Z - job completed in 3.96 seconds (aa5cde67d4d39a30a2308fa6491d17300c93f756169272ffc1cbde74fef55082)
2022-09-28T14:38:06.078013Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0928"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2c1d5270f2659d0f1609fda28f8f12c9574909a54a90dcaeb2f454aae3846f95)
2022-09-28T14:38:07.947038Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:38:07.963689Z - running sql script pg/insert_tenders.sql
2022-09-28T14:38:07.963726Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:38:07.968867Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:38:07.970322Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:38:07.976921Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:38:07.982101Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:38:07.987886Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:38:07.988911Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:38:08.034899Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:38:08.156234Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:38:08.160248Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:38:08.161741Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:38:08.376915Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:38:08.466001Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:38:08.473099Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:38:08.703967Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:38:08.893787Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:38:08.899864Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:38:08.900692Z - job completed in 2.82 seconds (2c1d5270f2659d0f1609fda28f8f12c9574909a54a90dcaeb2f454aae3846f95)
2022-09-28T14:38:08.968869Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0918"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (b15cda108e94bc824f0ee67ac95174a6225fd2b6a9675d07fcc911940b775d14)
2022-09-28T14:38:14.158983Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:38:14.181071Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T14:38:14.181102Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:38:14.186188Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T14:38:14.190962Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T14:38:14.195012Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T14:38:14.196449Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T14:38:14.203668Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T14:38:14.207570Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T14:38:14.211403Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:38:14.212432Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T14:38:14.213678Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T14:38:14.219893Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T14:38:14.224395Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T14:38:14.228094Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T14:38:14.234365Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T14:38:14.238660Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T14:38:14.242841Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T14:38:14.248709Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T14:38:15.216444Z - called http://score/api/keyed and received back 200
2022-09-28T14:38:15.216809Z - job completed in 6.25 seconds (b15cda108e94bc824f0ee67ac95174a6225fd2b6a9675d07fcc911940b775d14)
2022-09-28T14:40:02.664541Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0930"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a8ff1730868d8ad7d02d632e5c52afb7c685bb86d4af5afdd6ae019abbfa4537)
2022-09-28T14:40:03.973276Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:40:03.992626Z - running sql script pg/insert_tenders.sql
2022-09-28T14:40:03.992660Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:40:03.997988Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:40:03.999199Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:40:04.003591Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:40:04.007688Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:40:04.012581Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:40:04.013429Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:40:04.060124Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:40:04.190891Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:40:04.194990Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:40:04.196573Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:40:04.409711Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:40:04.502517Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:40:04.510467Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:40:04.747882Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:40:04.942847Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:40:04.948904Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:40:04.949189Z - job completed in 2.29 seconds (a8ff1730868d8ad7d02d632e5c52afb7c685bb86d4af5afdd6ae019abbfa4537)
2022-09-28T14:40:05.014711Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0930"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (15238a5d7d00b158d92e287d514607d53dc81168c0623e7d4f2fecbaf4d234fa)
2022-09-28T14:40:07.302343Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:40:07.320712Z - running sql script pg/upsert_orders.sql
2022-09-28T14:40:07.320756Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:40:07.325797Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:40:07.330652Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:40:07.332108Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:40:07.335651Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:40:07.337097Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:40:07.342304Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:40:07.343859Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:40:07.345445Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:40:07.352029Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:40:07.489464Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:40:07.557471Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:40:07.561309Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:40:07.569629Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:40:07.635031Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:40:07.650399Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:40:07.650944Z - job completed in 2.64 seconds (15238a5d7d00b158d92e287d514607d53dc81168c0623e7d4f2fecbaf4d234fa)
2022-09-28T14:42:02.104994Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0932"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2d67a872347f1775a2c6da34239594e40d32cde16c812797eef1c3bfcb578da1)
2022-09-28T14:42:04.732321Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:42:04.749741Z - running sql script pg/upsert_orders.sql
2022-09-28T14:42:04.749775Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:42:04.754294Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:42:04.760204Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:42:04.761290Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:42:04.766755Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:42:04.768308Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:42:04.772733Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:42:04.773861Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:42:04.774885Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:42:04.781435Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:42:04.924462Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:42:04.983750Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:42:04.987431Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:42:04.995669Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:42:05.072317Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:42:05.085388Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:42:05.085957Z - job completed in 2.98 seconds (2d67a872347f1775a2c6da34239594e40d32cde16c812797eef1c3bfcb578da1)
2022-09-28T14:42:05.199670Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0932"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (77bc223b574d307d6e8e52faf610fd2798d21d7053ad81db1ff68e2d46fbef3b)
2022-09-28T14:42:06.329386Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:42:06.345204Z - running sql script pg/insert_tenders.sql
2022-09-28T14:42:06.345236Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:42:06.349572Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:42:06.350820Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:42:06.354714Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:42:06.358960Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:42:06.363679Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:42:06.364700Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:42:06.411033Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:42:06.484804Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:42:06.488746Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:42:06.490230Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:42:06.708992Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:42:06.801245Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:42:06.811366Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:42:07.045654Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:42:07.251669Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:42:07.258389Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:42:07.259297Z - job completed in 2.06 seconds (77bc223b574d307d6e8e52faf610fd2798d21d7053ad81db1ff68e2d46fbef3b)
2022-09-28T14:44:02.275878Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0934"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (01d8457929070e861410868bf71c7c9f4d93de9e12d1c707ace2e537ebda3f07)
2022-09-28T14:44:04.742863Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:44:04.761979Z - running sql script pg/upsert_orders.sql
2022-09-28T14:44:04.762034Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:44:04.766134Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:44:04.770583Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:44:04.771785Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:44:04.775745Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:44:04.777101Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:44:04.781348Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:44:04.782542Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:44:04.783627Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:44:04.789918Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:44:04.950907Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:44:04.998549Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:44:05.002424Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:44:05.011464Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:44:05.078999Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:44:05.091316Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:44:05.091904Z - job completed in 2.82 seconds (01d8457929070e861410868bf71c7c9f4d93de9e12d1c707ace2e537ebda3f07)
2022-09-28T14:44:05.205019Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0934"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (30f33eaef8213fe332fabff0a9947d267b48199bfb14bb3f1f3f0fbe93b7f79c)
2022-09-28T14:44:06.532046Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:44:06.549744Z - running sql script pg/insert_tenders.sql
2022-09-28T14:44:06.549788Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:44:06.554275Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:44:06.555671Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:44:06.559995Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:44:06.564254Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:44:06.569062Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:44:06.570119Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:44:06.617107Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:44:06.663439Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:44:06.667489Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:44:06.675587Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:44:06.893290Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:44:06.987186Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:44:06.994067Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:44:07.226914Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:44:07.422901Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:44:07.428733Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:44:07.429267Z - job completed in 2.23 seconds (30f33eaef8213fe332fabff0a9947d267b48199bfb14bb3f1f3f0fbe93b7f79c)
2022-09-28T14:46:01.968008Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0936"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d45c064c079bc9ad29b13b1285ec58aa8769237dbbe9124db1f4873a82a29e6f)
2022-09-28T14:46:04.632382Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:46:04.647872Z - running sql script pg/upsert_orders.sql
2022-09-28T14:46:04.647903Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:46:04.652697Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:46:04.657573Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:46:04.658475Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:46:04.662535Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:46:04.663813Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:46:04.667846Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:46:04.669081Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:46:04.669939Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:46:04.676379Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:46:04.859579Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:46:04.911137Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:46:04.915067Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:46:04.929652Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:46:05.006977Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:46:05.025725Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:46:05.026020Z - job completed in 3.06 seconds (d45c064c079bc9ad29b13b1285ec58aa8769237dbbe9124db1f4873a82a29e6f)
2022-09-28T14:46:05.045714Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0936"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2f8c896302c4c0e7ea0e674d24212b454d6294e772f0a7e4365c0c0da755bfb3)
2022-09-28T14:46:06.465978Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:46:06.481873Z - running sql script pg/insert_tenders.sql
2022-09-28T14:46:06.481923Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:46:06.486515Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:46:06.487899Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:46:06.491978Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:46:06.497144Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:46:06.502208Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:46:06.503112Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:46:06.552084Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:46:06.590552Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:46:06.594461Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:46:06.596110Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:46:06.818550Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:46:06.912999Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:46:06.924543Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:46:07.174801Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:46:07.375311Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:46:07.381226Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:46:07.381807Z - job completed in 2.34 seconds (2f8c896302c4c0e7ea0e674d24212b454d6294e772f0a7e4365c0c0da755bfb3)
2022-09-28T14:48:02.043111Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0928"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (a4c7821d0e99f38440dfa880e0c67796ccf1bdfefec04bfd0079cb6651bf811f)
2022-09-28T14:48:08.568871Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:48:08.587569Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T14:48:08.587610Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:48:08.592355Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T14:48:08.598682Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T14:48:08.603699Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T14:48:08.605276Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T14:48:08.609106Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T14:48:08.613564Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T14:48:08.617896Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:48:08.619184Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T14:48:08.620249Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T14:48:08.625938Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T14:48:08.631438Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T14:48:08.636001Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T14:48:08.643170Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T14:48:08.647583Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T14:48:08.652572Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T14:48:08.659011Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T14:48:09.694285Z - called http://score/api/keyed and received back 200
2022-09-28T14:48:09.694625Z - job completed in 7.65 seconds (a4c7821d0e99f38440dfa880e0c67796ccf1bdfefec04bfd0079cb6651bf811f)
2022-09-28T14:48:09.731796Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0938"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d2500385017f2406bf37cda770a553c4282ce6c0f9bf854768789ef667a2a6f1)
2022-09-28T14:48:12.252383Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:48:12.290355Z - running sql script pg/upsert_orders.sql
2022-09-28T14:48:12.290941Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:48:12.297058Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:48:12.302529Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:48:12.303637Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:48:12.308339Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:48:12.310391Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:48:12.314975Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:48:12.316063Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:48:12.317018Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:48:12.324914Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:48:12.540186Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:48:12.591452Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:48:12.595669Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:48:12.608241Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:48:12.680442Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:48:12.699274Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:48:12.699854Z - job completed in 2.97 seconds (d2500385017f2406bf37cda770a553c4282ce6c0f9bf854768789ef667a2a6f1)
2022-09-28T14:48:12.737984Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0938"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2988cd59a142b5d5d89a84058b5d47194944330d1ed31adf1c0e8cfd1c4d253a)
2022-09-28T14:48:13.872188Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:48:13.888326Z - running sql script pg/insert_tenders.sql
2022-09-28T14:48:13.888387Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:48:13.894885Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:48:13.896235Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:48:13.901743Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:48:13.905584Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:48:13.910083Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:48:13.910937Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:48:13.957095Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:48:13.999268Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:48:14.003902Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:48:14.005541Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:48:14.231571Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:48:14.325818Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:48:14.334044Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:48:14.570352Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:48:14.762974Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:48:14.768362Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:48:14.768989Z - job completed in 2.03 seconds (2988cd59a142b5d5d89a84058b5d47194944330d1ed31adf1c0e8cfd1c4d253a)
2022-09-28T14:50:02.760120Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0940"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (11d5abf45c6e27893b2f89363f73e6eed3c99495582bb050b2db7fdd02b973d6)
2022-09-28T14:50:04.832524Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:50:04.865914Z - running sql script pg/insert_tenders.sql
2022-09-28T14:50:04.865944Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:50:04.876979Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:50:04.878479Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:50:04.883716Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:50:04.888721Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:50:04.894081Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:50:04.899148Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:50:04.951988Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:50:04.986119Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:50:04.990084Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:50:04.991468Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:50:05.210772Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:50:05.314871Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:50:05.321196Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:50:05.546833Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:50:05.737753Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:50:05.743389Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:50:05.744529Z - job completed in 2.98 seconds (11d5abf45c6e27893b2f89363f73e6eed3c99495582bb050b2db7fdd02b973d6)
2022-09-28T14:50:05.790670Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0940"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (bde1cd36239aa98472414e5556ebad4f4f665db7f796b3b8516acada322d3cba)
2022-09-28T14:50:07.747284Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:50:07.764829Z - running sql script pg/upsert_orders.sql
2022-09-28T14:50:07.764859Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:50:07.770189Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:50:07.775192Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:50:07.776168Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:50:07.780814Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:50:07.782660Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:50:07.787160Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:50:07.788623Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:50:07.789515Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:50:07.797393Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:50:08.002563Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:50:08.065989Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:50:08.069608Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:50:08.076151Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:50:08.143801Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:50:08.155511Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:50:08.155910Z - job completed in 2.37 seconds (bde1cd36239aa98472414e5556ebad4f4f665db7f796b3b8516acada322d3cba)
2022-09-28T14:52:01.999925Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0942"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b2285e1d120cccdee407ca3896e3ebddd41f6f18a8025bdb92b6f9129658977a)
2022-09-28T14:52:05.267828Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:52:05.284663Z - running sql script pg/insert_tenders.sql
2022-09-28T14:52:05.284693Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:52:05.289061Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:52:05.290405Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:52:05.294452Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:52:05.298490Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:52:05.302830Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:52:05.303739Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:52:05.350301Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:52:05.379663Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:52:05.383482Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:52:05.385033Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:52:05.603606Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:52:05.694352Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:52:05.700700Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:52:05.929558Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:52:06.116485Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:52:06.121821Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:52:06.122452Z - job completed in 4.12 seconds (b2285e1d120cccdee407ca3896e3ebddd41f6f18a8025bdb92b6f9129658977a)
2022-09-28T14:52:06.162843Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0942"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (23bbbbab529a7ba4ee75b547b3717c579cc445b6d5f8b54c066742bfac4e1c8d)
2022-09-28T14:52:08.274536Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:52:08.296292Z - running sql script pg/upsert_orders.sql
2022-09-28T14:52:08.296562Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:52:08.300829Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:52:08.305619Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:52:08.306767Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:52:08.310734Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:52:08.312273Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:52:08.317737Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:52:08.318890Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:52:08.320173Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:52:08.327413Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:52:08.537379Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:52:08.606211Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:52:08.610096Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:52:08.620560Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:52:08.688535Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:52:08.701090Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:52:08.701601Z - job completed in 2.54 seconds (23bbbbab529a7ba4ee75b547b3717c579cc445b6d5f8b54c066742bfac4e1c8d)
2022-09-28T14:54:02.037594Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0944"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9345c17489415682d250270f1fadbb617583e40db8e456df177352b3bdf1dddf)
2022-09-28T14:54:04.135908Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:54:04.152448Z - running sql script pg/upsert_orders.sql
2022-09-28T14:54:04.152478Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:54:04.156689Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:54:04.162163Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:54:04.163328Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:54:04.168917Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:54:04.170387Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:54:04.178870Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:54:04.183812Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:54:04.188573Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:54:04.196282Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:54:04.409206Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:54:04.543098Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:54:04.547650Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:54:04.558784Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:54:04.684482Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:54:04.697740Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:54:04.698423Z - job completed in 2.66 seconds (9345c17489415682d250270f1fadbb617583e40db8e456df177352b3bdf1dddf)
2022-09-28T14:54:04.785692Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0944"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (974130950ff45b4ec553008061bd103654ba91bed2be79a8bb6eac14c8c455b3)
2022-09-28T14:54:06.083771Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:54:06.102154Z - running sql script pg/insert_tenders.sql
2022-09-28T14:54:06.102236Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:54:06.146511Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:54:06.147838Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:54:06.151725Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:54:06.155697Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:54:06.160238Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:54:06.161345Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:54:06.208025Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:54:06.229130Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:54:06.230015Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:54:06.231254Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:54:06.445714Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:54:06.538751Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:54:06.546225Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:54:06.775397Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:54:06.962844Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:54:06.968008Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:54:06.968512Z - job completed in 2.18 seconds (974130950ff45b4ec553008061bd103654ba91bed2be79a8bb6eac14c8c455b3)
2022-09-28T14:56:02.065038Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0946"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (acfe3cf7a27dda63cae6356d80cfbefa550d28be706bae667d5a5f1bc8fe7613)
2022-09-28T14:56:05.252495Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:56:05.290152Z - running sql script pg/upsert_orders.sql
2022-09-28T14:56:05.290547Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:56:05.304169Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:56:05.312354Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:56:05.314100Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:56:05.319022Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:56:05.321298Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:56:05.326855Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:56:05.329317Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:56:05.330682Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:56:05.340604Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:56:05.959902Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:56:06.027271Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:56:06.030934Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:56:06.046303Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:56:06.126970Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:56:06.153992Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:56:06.154290Z - job completed in 4.09 seconds (acfe3cf7a27dda63cae6356d80cfbefa550d28be706bae667d5a5f1bc8fe7613)
2022-09-28T14:56:06.213486Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0946"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c582f9f44590a419b2e84fe2f27b040fe637aa177e1d8d7e697f28517debea47)
2022-09-28T14:56:07.921717Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:56:07.937642Z - running sql script pg/insert_tenders.sql
2022-09-28T14:56:07.937672Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:56:07.942528Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:56:07.944361Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:56:07.949343Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:56:07.953150Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:56:07.957538Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:56:07.958793Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:56:08.004831Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:56:08.015692Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:56:08.016629Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:56:08.017923Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:56:08.225103Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:56:08.311202Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:56:08.317663Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:56:08.550969Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:56:08.733448Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:56:08.738899Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:56:08.739486Z - job completed in 2.53 seconds (c582f9f44590a419b2e84fe2f27b040fe637aa177e1d8d7e697f28517debea47)
2022-09-28T14:58:02.033284Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0948"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (81da8d5e61491466c958d1ba733b8fdfaf64bb7d97bff68f410ec26cf57af905)
2022-09-28T14:58:03.727596Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:58:03.748113Z - running sql script pg/upsert_orders.sql
2022-09-28T14:58:03.748139Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:58:03.753484Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T14:58:03.758418Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T14:58:03.759915Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T14:58:03.764842Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T14:58:03.766599Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T14:58:03.770713Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:58:03.771654Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T14:58:03.772570Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T14:58:03.780497Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T14:58:03.918017Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T14:58:03.980784Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T14:58:03.984859Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T14:58:03.992592Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T14:58:04.057592Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T14:58:04.075307Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T14:58:04.075870Z - job completed in 2.04 seconds (81da8d5e61491466c958d1ba733b8fdfaf64bb7d97bff68f410ec26cf57af905)
2022-09-28T14:58:04.182824Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0938"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (35ec91bedcca0ca073176ab0c9e4762a38df872c85c702748f4d84f1defd7d2d)
2022-09-28T14:58:09.157740Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:58:09.178142Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T14:58:09.178178Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T14:58:09.182681Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T14:58:09.187490Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T14:58:09.192297Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T14:58:09.193448Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T14:58:09.197477Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T14:58:09.201762Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T14:58:09.205851Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T14:58:09.206999Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T14:58:09.208017Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T14:58:09.213694Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T14:58:09.218600Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T14:58:09.219626Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T14:58:09.226677Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T14:58:09.231646Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T14:58:09.236153Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T14:58:09.242277Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T14:58:10.281446Z - called http://score/api/keyed and received back 200
2022-09-28T14:58:10.281527Z - job completed in 6.10 seconds (35ec91bedcca0ca073176ab0c9e4762a38df872c85c702748f4d84f1defd7d2d)
2022-09-28T14:58:10.300051Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0948"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (37630bafee46859e1554c4536dc28c2c9f0c9b86808e1ebddf53c07c37c678c0)
2022-09-28T14:58:11.504747Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T14:58:11.525334Z - running sql script pg/insert_tenders.sql
2022-09-28T14:58:11.525810Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T14:58:11.539205Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T14:58:11.543573Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T14:58:11.553369Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T14:58:11.559619Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T14:58:11.561651Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T14:58:11.563075Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T14:58:11.565591Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T14:58:11.567300Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T14:58:11.570425Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T14:58:11.572305Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T14:58:11.573691Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T14:58:11.574877Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T14:58:11.575959Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T14:58:11.577607Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T14:58:11.579289Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T14:58:11.580730Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T14:58:11.581035Z - job completed in 1.28 seconds (37630bafee46859e1554c4536dc28c2c9f0c9b86808e1ebddf53c07c37c678c0)
2022-09-28T15:00:03.008251Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0950"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (808ef950c4f27db7df2016d5624f6821d218a202fa36901f30ea54740698644c)
2022-09-28T15:00:05.246400Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:00:05.269917Z - running sql script pg/insert_tenders.sql
2022-09-28T15:00:05.269954Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:00:05.274633Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:00:05.275896Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:00:05.280079Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:00:05.284119Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:00:05.288989Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:00:05.290062Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:00:05.334142Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:00:05.351915Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:00:05.356276Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:00:05.357694Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:00:05.359249Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:00:05.360554Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:00:05.361793Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:00:05.363426Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:00:05.364943Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:00:05.366439Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:00:05.366864Z - job completed in 2.36 seconds (808ef950c4f27db7df2016d5624f6821d218a202fa36901f30ea54740698644c)
2022-09-28T15:00:05.449105Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0950"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6e60f0a9e610641ba75e9c4bb50d9433623837563ea9d7d2808a8ea1a0682b4c)
2022-09-28T15:00:07.358756Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:00:07.375302Z - running sql script pg/upsert_orders.sql
2022-09-28T15:00:07.375343Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:00:07.380909Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:00:07.387147Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:00:07.388086Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:00:07.392499Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:00:07.393919Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:00:07.398887Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:00:07.400213Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:00:07.401467Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:00:07.408600Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:00:07.564267Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:00:07.599989Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:00:07.604288Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:00:07.616683Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:00:07.683580Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:00:07.697299Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:00:07.697838Z - job completed in 2.25 seconds (6e60f0a9e610641ba75e9c4bb50d9433623837563ea9d7d2808a8ea1a0682b4c)
2022-09-28T15:02:01.999556Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0952"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2616756d5a5e88aacc04ef87ead84bd8548a7dc1864d8731bb27d327e28098cb)
2022-09-28T15:02:04.634318Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:02:04.651452Z - running sql script pg/insert_tenders.sql
2022-09-28T15:02:04.651496Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:02:04.656543Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:02:04.657854Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:02:04.662016Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:02:04.666630Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:02:04.671518Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:02:04.672540Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:02:04.718631Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:02:04.770944Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:02:04.775429Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:02:04.777068Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:02:05.000359Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:02:05.096106Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:02:05.110642Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:02:05.362853Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:02:05.566950Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:02:05.577449Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:02:05.577869Z - job completed in 3.58 seconds (2616756d5a5e88aacc04ef87ead84bd8548a7dc1864d8731bb27d327e28098cb)
2022-09-28T15:02:05.672153Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0952"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9ac160582abedfc2a27c90a1c543cc167f2fec818f1253567e20b9ccc5bafa7a)
2022-09-28T15:02:08.101338Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:02:08.118466Z - running sql script pg/upsert_orders.sql
2022-09-28T15:02:08.118495Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:02:08.123577Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:02:08.128528Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:02:08.129553Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:02:08.133826Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:02:08.135341Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:02:08.139565Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:02:08.141008Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:02:08.141925Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:02:08.148731Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:02:08.310957Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:02:08.358292Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:02:08.362241Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:02:08.373250Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:02:08.447279Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:02:08.463642Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:02:08.464003Z - job completed in 2.79 seconds (9ac160582abedfc2a27c90a1c543cc167f2fec818f1253567e20b9ccc5bafa7a)
2022-09-28T15:04:02.059669Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0954"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (052a811d00b9d501f1dc88a24070e48ade97ebfa4e53a6a1fbfecb3a32945525)
2022-09-28T15:04:03.521007Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:04:03.536912Z - running sql script pg/insert_tenders.sql
2022-09-28T15:04:03.536965Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:04:03.541534Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:04:03.542906Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:04:03.547658Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:04:03.552388Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:04:03.558495Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:04:03.559694Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:04:03.607693Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:04:03.648281Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:04:03.653080Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:04:03.655373Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:04:03.872304Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:04:03.967336Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:04:03.975870Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:04:04.214246Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:04:04.406473Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:04:04.412222Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:04:04.412514Z - job completed in 2.35 seconds (052a811d00b9d501f1dc88a24070e48ade97ebfa4e53a6a1fbfecb3a32945525)
2022-09-28T15:04:04.459838Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0954"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (de3b6e4c2411391913fec83961d9ebea06a8dab7d896116548b5ec7141f77733)
2022-09-28T15:04:06.851588Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:04:06.873948Z - running sql script pg/upsert_orders.sql
2022-09-28T15:04:06.874481Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:04:06.879575Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:04:06.885031Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:04:06.886168Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:04:06.890218Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:04:06.892172Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:04:06.897366Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:04:06.898712Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:04:06.899872Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:04:06.908539Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:04:07.263389Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:04:07.335824Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:04:07.339522Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:04:07.348067Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:04:07.414959Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:04:07.426857Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:04:07.427274Z - job completed in 2.97 seconds (de3b6e4c2411391913fec83961d9ebea06a8dab7d896116548b5ec7141f77733)
2022-09-28T15:06:02.035903Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0956"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e8e6999addbfd78b0920d98bb4e78aebcd6d873641a48daf56f299aaa234b13d)
2022-09-28T15:06:04.703279Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:06:04.719841Z - running sql script pg/upsert_orders.sql
2022-09-28T15:06:04.719873Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:06:04.725153Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:06:04.732215Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:06:04.733541Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:06:04.738116Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:06:04.739577Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:06:04.744614Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:06:04.745848Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:06:04.746776Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:06:04.753813Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:06:04.960822Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:06:05.055762Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:06:05.061158Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:06:05.077978Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:06:05.150264Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:06:05.169097Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:06:05.169682Z - job completed in 3.13 seconds (e8e6999addbfd78b0920d98bb4e78aebcd6d873641a48daf56f299aaa234b13d)
2022-09-28T15:06:05.252321Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0956"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1b8130083ae917d196ea11d3f9bf0eaba1595b8a7bcc7633cc40649d135e3824)
2022-09-28T15:06:06.739719Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:06:06.757409Z - running sql script pg/insert_tenders.sql
2022-09-28T15:06:06.757441Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:06:06.761951Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:06:06.763492Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:06:06.769807Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:06:06.774861Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:06:06.784573Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:06:06.785949Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:06:06.870032Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:06:06.973403Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:06:06.979352Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:06:06.982083Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:06:07.466651Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:06:07.658564Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:06:07.677761Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:06:07.986571Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:06:08.182276Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:06:08.189690Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:06:08.190107Z - job completed in 2.94 seconds (1b8130083ae917d196ea11d3f9bf0eaba1595b8a7bcc7633cc40649d135e3824)
2022-09-28T15:08:02.244316Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"0958"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c1117a9eb2c295a98b207ce4f98cfda5935a455010701dd07313d01de21f5dbf)
2022-09-28T15:08:04.787836Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:08:04.806670Z - running sql script pg/insert_tenders.sql
2022-09-28T15:08:04.807223Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:08:04.812210Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:08:04.813853Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:08:04.818406Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:08:04.822619Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:08:04.827799Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:08:04.829100Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:08:04.878462Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:08:04.931682Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:08:04.935828Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:08:04.940184Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:08:05.156630Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:08:05.250253Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:08:05.257563Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:08:05.491664Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:08:05.688319Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:08:05.694145Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:08:05.694596Z - job completed in 3.45 seconds (c1117a9eb2c295a98b207ce4f98cfda5935a455010701dd07313d01de21f5dbf)
2022-09-28T15:08:05.797736Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0948"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (e3a9c28eefb6735993281466dda956d2551737a0c0b204ae1b72941d4c815482)
2022-09-28T15:08:12.393054Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:08:12.413653Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T15:08:12.413687Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:08:12.419701Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T15:08:12.425334Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T15:08:12.430395Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T15:08:12.431737Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T15:08:12.435819Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T15:08:12.440352Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T15:08:12.441599Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:08:12.442848Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T15:08:12.443992Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T15:08:12.450418Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T15:08:12.455387Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T15:08:12.456696Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T15:08:12.463012Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T15:08:12.466931Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T15:08:12.471134Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T15:08:12.478157Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T15:08:13.278446Z - called http://score/api/keyed and received back 200
2022-09-28T15:08:13.278522Z - job completed in 7.48 seconds (e3a9c28eefb6735993281466dda956d2551737a0c0b204ae1b72941d4c815482)
2022-09-28T15:08:13.316740Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"0958"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8620579d2bc3cefec4a72425b5e282482a81342ff3d24e139138c9601b9076d2)
2022-09-28T15:08:15.581285Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:08:15.597761Z - running sql script pg/upsert_orders.sql
2022-09-28T15:08:15.597805Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:08:15.604743Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:08:15.610017Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:08:15.610981Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:08:15.616047Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:08:15.617478Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:08:15.622537Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:08:15.623495Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:08:15.624872Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:08:15.631966Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:08:15.868129Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:08:15.946196Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:08:15.949897Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:08:15.960729Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:08:16.030714Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:08:16.063473Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:08:16.063886Z - job completed in 2.75 seconds (8620579d2bc3cefec4a72425b5e282482a81342ff3d24e139138c9601b9076d2)
2022-09-28T15:10:02.970003Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1000"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (383a31c60e68b11fd897a539843e4a0487b2296de8ed7557279967fe5dedd29c)
2022-09-28T15:10:04.254280Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:10:04.270897Z - running sql script pg/insert_tenders.sql
2022-09-28T15:10:04.270931Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:10:04.275293Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:10:04.277767Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:10:04.281908Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:10:04.286083Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:10:04.290925Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:10:04.292478Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:10:04.339210Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:10:04.417642Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:10:04.423489Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:10:04.425155Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:10:04.654170Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:10:04.759018Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:10:04.768110Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:10:05.012856Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:10:05.209322Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:10:05.220746Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:10:05.221388Z - job completed in 2.25 seconds (383a31c60e68b11fd897a539843e4a0487b2296de8ed7557279967fe5dedd29c)
2022-09-28T15:10:05.308920Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1000"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ded7d766dcd9d0e5c60900bdd0e3f8f42bc03e45b601e1b5534aff965e662759)
2022-09-28T15:10:08.019461Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:10:08.042269Z - running sql script pg/upsert_orders.sql
2022-09-28T15:10:08.042305Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:10:08.048440Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:10:08.054201Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:10:08.055460Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:10:08.061352Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:10:08.063410Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:10:08.068773Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:10:08.070256Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:10:08.071932Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:10:08.082409Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:10:08.342602Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:10:08.427669Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:10:08.431802Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:10:08.439769Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:10:08.505140Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:10:08.523358Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:10:08.523870Z - job completed in 3.22 seconds (ded7d766dcd9d0e5c60900bdd0e3f8f42bc03e45b601e1b5534aff965e662759)
2022-09-28T15:12:02.028559Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1002"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (42054d2c986d917991a884eaa84cd924ac38812fec67f88ec33e8416cdb52a7f)
2022-09-28T15:12:04.399859Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:12:04.419786Z - running sql script pg/upsert_orders.sql
2022-09-28T15:12:04.419906Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:12:04.424956Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:12:04.429535Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:12:04.430565Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:12:04.435097Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:12:04.437112Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:12:04.441584Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:12:04.442890Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:12:04.443970Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:12:04.451472Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:12:04.673072Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:12:04.767306Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:12:04.771187Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:12:04.779986Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:12:04.847829Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:12:04.862965Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:12:04.863266Z - job completed in 2.84 seconds (42054d2c986d917991a884eaa84cd924ac38812fec67f88ec33e8416cdb52a7f)
2022-09-28T15:12:04.991871Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1002"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (192380cd3d10401954af169df2b5731c877573a7342253d5b568fc27d4ba1c35)
2022-09-28T15:12:08.201203Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:12:08.228947Z - running sql script pg/insert_tenders.sql
2022-09-28T15:12:08.228991Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:12:08.235085Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:12:08.242144Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:12:08.246663Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:12:08.251066Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:12:08.258873Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:12:08.260486Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:12:08.340357Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:12:08.542892Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:12:08.547511Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:12:08.549227Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:12:08.769712Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:12:08.864999Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:12:08.872180Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:12:09.104887Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:12:09.322932Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:12:09.328724Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:12:09.329190Z - job completed in 4.34 seconds (192380cd3d10401954af169df2b5731c877573a7342253d5b568fc27d4ba1c35)
2022-09-28T15:14:02.004981Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1004"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b47ad5fe5bc9739b7e73d7bbf948d50bcee8eea51fc7820b8c6f53151d74a94f)
2022-09-28T15:14:04.548859Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:14:04.569607Z - running sql script pg/upsert_orders.sql
2022-09-28T15:14:04.569828Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:14:04.575223Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:14:04.582763Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:14:04.584278Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:14:04.591267Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:14:04.593495Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:14:04.599427Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:14:04.600480Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:14:04.601330Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:14:04.609410Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:14:04.832970Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:14:04.940030Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:14:04.944532Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:14:04.952724Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:14:05.017005Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:14:05.030678Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:14:05.031142Z - job completed in 3.03 seconds (b47ad5fe5bc9739b7e73d7bbf948d50bcee8eea51fc7820b8c6f53151d74a94f)
2022-09-28T15:14:05.155726Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1004"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b182ddb80d7e7ff0a209ee138cdcb4de085bbf615d57b0d6bc0c7bb643439628)
2022-09-28T15:14:06.452739Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:14:06.468448Z - running sql script pg/insert_tenders.sql
2022-09-28T15:14:06.468485Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:14:06.473087Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:14:06.474411Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:14:06.478614Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:14:06.483076Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:14:06.487848Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:14:06.488747Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:14:06.535326Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:14:06.621669Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:14:06.626087Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:14:06.627898Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:14:06.848398Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:14:06.943696Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:14:06.951990Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:14:07.187126Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:14:07.376770Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:14:07.382945Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:14:07.383439Z - job completed in 2.23 seconds (b182ddb80d7e7ff0a209ee138cdcb4de085bbf615d57b0d6bc0c7bb643439628)
2022-09-28T15:16:02.212402Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1006"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dc79e8c30ed8b73cd0359d979bc50002c7af8416e342627470926e649bffe649)
2022-09-28T15:16:03.608840Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:16:03.626088Z - running sql script pg/insert_tenders.sql
2022-09-28T15:16:03.626116Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:16:03.630686Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:16:03.631916Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:16:03.636469Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:16:03.640651Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:16:03.645556Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:16:03.646537Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:16:03.694778Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:16:03.763880Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:16:03.768031Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:16:03.769566Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:16:03.987600Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:16:04.081837Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:16:04.094481Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:16:04.330398Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:16:04.521430Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:16:04.527974Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:16:04.528302Z - job completed in 2.32 seconds (dc79e8c30ed8b73cd0359d979bc50002c7af8416e342627470926e649bffe649)
2022-09-28T15:16:04.611130Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1006"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1ea567b1df6da50a12182d0c9cc70e48f3ddc7b4b722b52d74e872cae73cbf54)
2022-09-28T15:16:07.226937Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:16:07.243469Z - running sql script pg/upsert_orders.sql
2022-09-28T15:16:07.243500Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:16:07.247782Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:16:07.252572Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:16:07.253651Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:16:07.257703Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:16:07.258970Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:16:07.263077Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:16:07.264071Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:16:07.265278Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:16:07.271734Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:16:07.459260Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:16:07.552979Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:16:07.556788Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:16:07.569163Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:16:07.635438Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:16:07.650882Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:16:07.651320Z - job completed in 3.04 seconds (1ea567b1df6da50a12182d0c9cc70e48f3ddc7b4b722b52d74e872cae73cbf54)
2022-09-28T15:18:02.276663Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1008"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (92edc2ebca9dac71bfaa8f0fca0e7a716c282390c26d779548ce05c8bcfa454d)
2022-09-28T15:18:03.691369Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:18:03.707585Z - running sql script pg/insert_tenders.sql
2022-09-28T15:18:03.707640Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:18:03.711579Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:18:03.713146Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:18:03.717456Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:18:03.721831Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:18:03.726306Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:18:03.727213Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:18:03.774513Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:18:03.873246Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:18:03.877192Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:18:03.878753Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:18:04.102754Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:18:04.270686Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:18:04.278379Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:18:04.509317Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:18:04.697495Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:18:04.703417Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:18:04.703839Z - job completed in 2.43 seconds (92edc2ebca9dac71bfaa8f0fca0e7a716c282390c26d779548ce05c8bcfa454d)
2022-09-28T15:18:04.722219Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1008"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b454dd3eb443db7274b53304edd7246cac5fa043a1e273162bb69e10ba81823c)
2022-09-28T15:18:08.421649Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:18:08.438361Z - running sql script pg/upsert_orders.sql
2022-09-28T15:18:08.438405Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:18:08.443173Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:18:08.448033Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:18:08.449034Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:18:08.453162Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:18:08.454800Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:18:08.458757Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:18:08.459707Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:18:08.460565Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:18:08.467014Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:18:08.638107Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:18:08.822339Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:18:08.826424Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:18:08.843958Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:18:08.987129Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:18:09.003436Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:18:09.004112Z - job completed in 4.28 seconds (b454dd3eb443db7274b53304edd7246cac5fa043a1e273162bb69e10ba81823c)
2022-09-28T15:18:09.243560Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"0958"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (305fc96a2d367d97798bf6927ee1d8863c56770c4978232de2bef87db39a3e13)
2022-09-28T15:18:15.336083Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:18:15.354112Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T15:18:15.354148Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:18:15.359326Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T15:18:15.364359Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T15:18:15.368234Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T15:18:15.369285Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T15:18:15.373347Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T15:18:15.377793Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T15:18:15.381471Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:18:15.382621Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T15:18:15.383747Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T15:18:15.389705Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T15:18:15.395054Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T15:18:15.396041Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T15:18:15.403888Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T15:18:15.408501Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T15:18:15.414046Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T15:18:15.421948Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T15:18:15.666237Z - called http://score/api/keyed and received back 500
2022-09-28T15:18:15.666543Z - job completed in 6.42 seconds (305fc96a2d367d97798bf6927ee1d8863c56770c4978232de2bef87db39a3e13)
2022-09-28T15:20:02.516451Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1010"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f6f58b87b15a3e516bea7dcd793453724e37ddf411d82a5e0c69ec785bedb542)
2022-09-28T15:20:05.221088Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:20:05.248711Z - running sql script pg/upsert_orders.sql
2022-09-28T15:20:05.248745Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:20:05.253896Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:20:05.259686Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:20:05.260644Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:20:05.264930Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:20:05.271569Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:20:05.276103Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:20:05.277137Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:20:05.278060Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:20:05.284684Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:20:05.442147Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:20:05.506211Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:20:05.510021Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:20:05.518415Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:20:05.585524Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:20:05.597004Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:20:05.597301Z - job completed in 3.08 seconds (f6f58b87b15a3e516bea7dcd793453724e37ddf411d82a5e0c69ec785bedb542)
2022-09-28T15:20:05.670527Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1010"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e78ff9aeff803b855f198a1b0608ad30723c0a6e8c1992a822102b01ad0e01cc)
2022-09-28T15:20:07.153990Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:20:07.171027Z - running sql script pg/insert_tenders.sql
2022-09-28T15:20:07.171068Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:20:07.175635Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:20:07.177062Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:20:07.181747Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:20:07.186024Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:20:07.190967Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:20:07.191920Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:20:07.238247Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:20:07.328730Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:20:07.334965Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:20:07.336477Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:20:07.559720Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:20:07.654581Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:20:07.660716Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:20:07.892482Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:20:08.090425Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:20:08.095704Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:20:08.096047Z - job completed in 2.43 seconds (e78ff9aeff803b855f198a1b0608ad30723c0a6e8c1992a822102b01ad0e01cc)
2022-09-28T15:22:02.083143Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1012"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4a254914768fac32a68b105aeaf7e3443f6152f35fbfad798b4f47e42b225b6d)
2022-09-28T15:22:03.515317Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:22:03.532051Z - running sql script pg/insert_tenders.sql
2022-09-28T15:22:03.532081Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:22:03.537367Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:22:03.538818Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:22:03.543401Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:22:03.547381Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:22:03.552121Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:22:03.553049Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:22:03.599505Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:22:03.702984Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:22:03.707150Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:22:03.708562Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:22:03.928632Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:22:04.034780Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:22:04.040685Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:22:04.270943Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:22:04.458361Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:22:04.464315Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:22:04.464839Z - job completed in 2.38 seconds (4a254914768fac32a68b105aeaf7e3443f6152f35fbfad798b4f47e42b225b6d)
2022-09-28T15:22:04.488856Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1012"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0adcae1134d83eb57f6eb7e91bbd5210aae3c2b0d91c13e54818c61931e2fac6)
2022-09-28T15:22:06.606012Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:22:06.627506Z - running sql script pg/upsert_orders.sql
2022-09-28T15:22:06.627597Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:22:06.635285Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:22:06.640223Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:22:06.641185Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:22:06.645245Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:22:06.649985Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:22:06.654953Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:22:06.656307Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:22:06.657420Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:22:06.665660Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:22:07.004803Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:22:07.166592Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:22:07.174593Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:22:07.192493Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:22:07.361749Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:22:07.378623Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:22:07.379040Z - job completed in 2.89 seconds (0adcae1134d83eb57f6eb7e91bbd5210aae3c2b0d91c13e54818c61931e2fac6)
2022-09-28T15:24:02.166027Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1014"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (37a8e0f1a52dc7be7d7ea422c019418576a629d9530c762f5c441379419eda56)
2022-09-28T15:24:03.459115Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:24:03.476423Z - running sql script pg/insert_tenders.sql
2022-09-28T15:24:03.476450Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:24:03.484293Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:24:03.485831Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:24:03.491647Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:24:03.495967Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:24:03.500571Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:24:03.502715Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:24:03.549621Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:24:03.642007Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:24:03.646312Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:24:03.647655Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:24:03.847501Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:24:03.934207Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:24:03.939631Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:24:04.181299Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:24:04.364022Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:24:04.369145Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:24:04.370261Z - job completed in 2.21 seconds (37a8e0f1a52dc7be7d7ea422c019418576a629d9530c762f5c441379419eda56)
2022-09-28T15:24:04.453339Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1014"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3580b22f19fa30c85bf21400f9ff58c302bcd67d39710c4e3dcda85a6c65c952)
2022-09-28T15:24:06.631619Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:24:06.648076Z - running sql script pg/upsert_orders.sql
2022-09-28T15:24:06.648107Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:24:06.654007Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:24:06.658902Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:24:06.660416Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:24:06.664895Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:24:06.669441Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:24:06.677050Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:24:06.678300Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:24:06.679599Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:24:06.686259Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:24:06.801503Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:24:06.854884Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:24:06.859652Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:24:06.882750Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:24:06.950255Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:24:06.963759Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:24:06.964936Z - job completed in 2.51 seconds (3580b22f19fa30c85bf21400f9ff58c302bcd67d39710c4e3dcda85a6c65c952)
2022-09-28T15:26:02.128796Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1016"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ba2c5b531e7dd02e0578bf87a8aefd7a414afe01df1e41b752b488f12904e8c9)
2022-09-28T15:26:04.336400Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:26:04.354955Z - running sql script pg/upsert_orders.sql
2022-09-28T15:26:04.354988Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:26:04.359767Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:26:04.364069Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:26:04.365124Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:26:04.369026Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:26:04.373551Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:26:04.377829Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:26:04.378870Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:26:04.379829Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:26:04.386117Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:26:04.500379Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:26:04.546942Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:26:04.550927Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:26:04.562833Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:26:04.631392Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:26:04.643912Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:26:04.644173Z - job completed in 2.52 seconds (ba2c5b531e7dd02e0578bf87a8aefd7a414afe01df1e41b752b488f12904e8c9)
2022-09-28T15:26:04.666491Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1016"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b1e3f56ac3cd65dbfdc51068b71f90bc2d1ee34d3893c213af3cbb0f206b9341)
2022-09-28T15:26:05.882800Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:26:05.901100Z - running sql script pg/insert_tenders.sql
2022-09-28T15:26:05.901136Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:26:05.905877Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:26:05.907761Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:26:05.918242Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:26:05.923721Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:26:05.928673Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:26:05.929802Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:26:05.975865Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:26:06.074293Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:26:06.078481Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:26:06.079948Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:26:06.289131Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:26:06.375117Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:26:06.382043Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:26:06.610146Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:26:06.798770Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:26:06.803827Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:26:06.804346Z - job completed in 2.14 seconds (b1e3f56ac3cd65dbfdc51068b71f90bc2d1ee34d3893c213af3cbb0f206b9341)
2022-09-28T15:28:01.987907Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1018"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8bf60ad47accfcb946fd65311ead91a28c19cebb7f37cda6e01801c96b817a7d)
2022-09-28T15:28:03.259624Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:28:03.294113Z - running sql script pg/insert_tenders.sql
2022-09-28T15:28:03.294185Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:28:03.300513Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:28:03.304465Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:28:03.309318Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:28:03.313591Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:28:03.318852Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:28:03.320337Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:28:03.370031Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:28:03.463616Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:28:03.470891Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:28:03.472422Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:28:03.748833Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:28:03.849586Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:28:03.855939Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:28:04.089908Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:28:04.272868Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:28:04.277619Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:28:04.278107Z - job completed in 2.29 seconds (8bf60ad47accfcb946fd65311ead91a28c19cebb7f37cda6e01801c96b817a7d)
2022-09-28T15:28:04.323485Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1008"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (57495b18b71fc51a67c9aca76a3b76bb0ae34e779c1be5aa46fd9a9ffef8ea0b)
2022-09-28T15:28:10.001973Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:28:10.019950Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T15:28:10.019982Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:28:10.027860Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T15:28:10.034181Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T15:28:10.038343Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T15:28:10.039718Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T15:28:10.043673Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T15:28:10.048145Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T15:28:10.052045Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:28:10.053096Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T15:28:10.054829Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T15:28:10.061513Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T15:28:10.066095Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T15:28:10.067009Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T15:28:10.077386Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T15:28:10.081494Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T15:28:10.086443Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T15:28:10.091270Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T15:28:11.231669Z - called http://score/api/keyed and received back 200
2022-09-28T15:28:11.231799Z - job completed in 6.91 seconds (57495b18b71fc51a67c9aca76a3b76bb0ae34e779c1be5aa46fd9a9ffef8ea0b)
2022-09-28T15:28:11.255064Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1018"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a982c3fd6221d99771d352d6b062ce825a0d8864ccc7dd483d9b7fa55136fac2)
2022-09-28T15:28:15.125914Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:28:15.153802Z - running sql script pg/upsert_orders.sql
2022-09-28T15:28:15.153942Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:28:15.158901Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:28:15.163196Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:28:15.164364Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:28:15.175657Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:28:15.180028Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:28:15.184193Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:28:15.185775Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:28:15.186978Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:28:15.194049Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:28:15.290517Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:28:15.329527Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:28:15.333562Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:28:15.341076Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:28:15.404871Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:28:15.418572Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:28:15.419053Z - job completed in 4.16 seconds (a982c3fd6221d99771d352d6b062ce825a0d8864ccc7dd483d9b7fa55136fac2)
2022-09-28T15:30:02.464889Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1020"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (63504851cd9e0b9452ba6948b1c9d2aad8972548edd418567c7c0967f8c9ac87)
2022-09-28T15:30:03.699642Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:30:03.720178Z - running sql script pg/insert_tenders.sql
2022-09-28T15:30:03.720212Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:30:03.725625Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:30:03.727192Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:30:03.732336Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:30:03.736603Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:30:03.741782Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:30:03.742790Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:30:03.790076Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:30:03.917824Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:30:03.922727Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:30:03.924284Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:30:04.164387Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:30:04.290268Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:30:04.297597Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:30:04.528946Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:30:04.715451Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:30:04.723579Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:30:04.723804Z - job completed in 2.26 seconds (63504851cd9e0b9452ba6948b1c9d2aad8972548edd418567c7c0967f8c9ac87)
2022-09-28T15:30:04.841618Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1020"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8d9e9da7c52550a8042b18363c14564ace2daeeeea520e3b8049722cd4f73452)
2022-09-28T15:30:07.229005Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:30:07.244681Z - running sql script pg/upsert_orders.sql
2022-09-28T15:30:07.244707Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:30:07.249263Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:30:07.253909Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:30:07.255097Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:30:07.259320Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:30:07.260844Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:30:07.265141Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:30:07.266027Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:30:07.266878Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:30:07.273153Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:30:07.375643Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:30:07.419068Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:30:07.423096Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:30:07.431041Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:30:07.494844Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:30:07.507476Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:30:07.507891Z - job completed in 2.67 seconds (8d9e9da7c52550a8042b18363c14564ace2daeeeea520e3b8049722cd4f73452)
2022-09-28T15:32:02.607569Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1022"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fcc046af1771994b457a2945b9ce52226fcfea2cc040a88a463f8da7393c44f9)
2022-09-28T15:32:04.010569Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:32:04.027328Z - running sql script pg/insert_tenders.sql
2022-09-28T15:32:04.027357Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:32:04.032061Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:32:04.033366Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:32:04.038093Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:32:04.042203Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:32:04.047340Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:32:04.048437Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:32:04.094844Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:32:04.186809Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:32:04.191286Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:32:04.192818Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:32:04.432586Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:32:04.534129Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:32:04.548314Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:32:04.801242Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:32:04.994622Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:32:05.001010Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:32:05.001422Z - job completed in 2.39 seconds (fcc046af1771994b457a2945b9ce52226fcfea2cc040a88a463f8da7393c44f9)
2022-09-28T15:32:05.087874Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1022"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (372b1060e4317a7069a499d247ec40251193b4e187c35e8ed5f438f55412460e)
2022-09-28T15:32:07.816450Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:32:07.832418Z - running sql script pg/upsert_orders.sql
2022-09-28T15:32:07.832452Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:32:07.837517Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:32:07.842184Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:32:07.843107Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:32:07.846985Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:32:07.848520Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:32:07.852750Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:32:07.853667Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:32:07.854522Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:32:07.860500Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:32:07.949884Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:32:07.989205Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:32:07.993148Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:32:07.998458Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:32:08.063664Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:32:08.072046Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:32:08.072519Z - job completed in 2.99 seconds (372b1060e4317a7069a499d247ec40251193b4e187c35e8ed5f438f55412460e)
2022-09-28T15:34:02.309989Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1024"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6aa49352c844376ee2cfca3cefce58c3c81f56c84849cd6f6615a5df172e3bee)
2022-09-28T15:34:04.391490Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:34:04.407277Z - running sql script pg/upsert_orders.sql
2022-09-28T15:34:04.407315Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:34:04.412409Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:34:04.417522Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:34:04.418570Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:34:04.423025Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:34:04.427143Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:34:04.431202Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:34:04.432202Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:34:04.433153Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:34:04.442001Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:34:04.572610Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:34:04.647449Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:34:04.651553Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:34:04.659521Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:34:04.727318Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:34:04.738506Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:34:04.738879Z - job completed in 2.43 seconds (6aa49352c844376ee2cfca3cefce58c3c81f56c84849cd6f6615a5df172e3bee)
2022-09-28T15:34:04.815331Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1024"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (52d68fecb24b6a50c728989c52f9fbdb5f14719ea6c57d43802cca95b9a3971a)
2022-09-28T15:34:06.137032Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:34:06.154443Z - running sql script pg/insert_tenders.sql
2022-09-28T15:34:06.154477Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:34:06.159448Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:34:06.160883Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:34:06.165278Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:34:06.169635Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:34:06.174302Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:34:06.175346Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:34:06.222421Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:34:06.318832Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:34:06.322745Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:34:06.324366Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:34:06.563643Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:34:06.664832Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:34:06.670334Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:34:06.905888Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:34:07.096414Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:34:07.101492Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:34:07.101935Z - job completed in 2.29 seconds (52d68fecb24b6a50c728989c52f9fbdb5f14719ea6c57d43802cca95b9a3971a)
2022-09-28T15:36:02.048708Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1026"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ccd89ae792597163cd5e38fb2308901691dc6a1d7d056ab60796654cd61e55ac)
2022-09-28T15:36:04.280674Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:36:04.297602Z - running sql script pg/upsert_orders.sql
2022-09-28T15:36:04.297633Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:36:04.302204Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:36:04.307490Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:36:04.308488Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:36:04.312459Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:36:04.316702Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:36:04.320795Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:36:04.321775Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:36:04.322692Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:36:04.333274Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:36:04.735845Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:36:05.050422Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:36:05.054517Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:36:05.068994Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:36:05.325690Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:36:05.362038Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:36:05.362560Z - job completed in 3.31 seconds (ccd89ae792597163cd5e38fb2308901691dc6a1d7d056ab60796654cd61e55ac)
2022-09-28T15:36:05.391687Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1026"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b0f0c7f6a7046bd6201f3362f13fc780bcc1b11c2e6b9aea49be4e934deb81a9)
2022-09-28T15:36:06.705609Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:36:06.721183Z - running sql script pg/insert_tenders.sql
2022-09-28T15:36:06.721213Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:36:06.726229Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:36:06.727614Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:36:06.732349Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:36:06.736514Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:36:06.741492Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:36:06.742379Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:36:06.789550Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:36:06.849863Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:36:06.853743Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:36:06.856902Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:36:07.097665Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:36:07.198324Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:36:07.215367Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:36:07.451194Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:36:07.643514Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:36:07.650443Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:36:07.650907Z - job completed in 2.26 seconds (b0f0c7f6a7046bd6201f3362f13fc780bcc1b11c2e6b9aea49be4e934deb81a9)
2022-09-28T15:38:01.978047Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1028"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b35ff687aced1a180ebb80a28c354dd7d91ea6638da2ab4d5259018369b02ea4)
2022-09-28T15:38:04.452640Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:38:04.485802Z - running sql script pg/upsert_orders.sql
2022-09-28T15:38:04.485927Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:38:04.492008Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:38:04.497515Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:38:04.499132Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:38:04.504037Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:38:04.508713Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:38:04.514708Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:38:04.515679Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:38:04.516836Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:38:04.524437Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:38:04.646182Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:38:04.709074Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:38:04.713192Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:38:04.719474Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:38:04.784967Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:38:04.795267Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:38:04.795888Z - job completed in 2.82 seconds (b35ff687aced1a180ebb80a28c354dd7d91ea6638da2ab4d5259018369b02ea4)
2022-09-28T15:38:04.829384Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1018"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (40a8f919f71b518c058296968670223cbae116f1219629cb26f02c074ae64752)
2022-09-28T15:38:11.365894Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:38:11.394049Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T15:38:11.394095Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:38:11.398360Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T15:38:11.403315Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T15:38:11.407216Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T15:38:11.408195Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T15:38:11.411867Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T15:38:11.415965Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T15:38:11.419820Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:38:11.420648Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T15:38:11.421499Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T15:38:11.427512Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T15:38:11.432370Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T15:38:11.433308Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T15:38:11.439812Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T15:38:11.443734Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T15:38:11.447614Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T15:38:11.454480Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T15:38:12.670400Z - called http://score/api/keyed and received back 200
2022-09-28T15:38:12.670506Z - job completed in 7.84 seconds (40a8f919f71b518c058296968670223cbae116f1219629cb26f02c074ae64752)
2022-09-28T15:38:12.707945Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1028"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0954534395a7fa2df8a0824858a6bf9bd6c66123a5fc96594730f2677dfe082e)
2022-09-28T15:38:13.955663Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:38:13.972526Z - running sql script pg/insert_tenders.sql
2022-09-28T15:38:13.972562Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:38:13.977260Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:38:13.978865Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:38:13.984299Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:38:13.990907Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:38:13.995570Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:38:13.996688Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:38:14.042866Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:38:14.097274Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:38:14.101093Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:38:14.102761Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:38:14.302186Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:38:14.387668Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:38:14.393374Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:38:14.623377Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:38:14.803753Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:38:14.809071Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:38:14.809606Z - job completed in 2.10 seconds (0954534395a7fa2df8a0824858a6bf9bd6c66123a5fc96594730f2677dfe082e)
2022-09-28T15:40:02.697434Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1030"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (45afaa566a5a892f4035bed31c1899e08b995637cc8c98b4a80380b4b533c8fa)
2022-09-28T15:40:03.902943Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:40:03.918685Z - running sql script pg/insert_tenders.sql
2022-09-28T15:40:03.918716Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:40:03.923126Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:40:03.937394Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:40:03.941739Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:40:03.945660Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:40:03.950185Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:40:03.951089Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:40:03.997008Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:40:04.060451Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:40:04.067609Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:40:04.068933Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:40:04.296081Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:40:04.393114Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:40:04.399201Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:40:04.631455Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:40:04.818754Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:40:04.823689Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:40:04.824330Z - job completed in 2.13 seconds (45afaa566a5a892f4035bed31c1899e08b995637cc8c98b4a80380b4b533c8fa)
2022-09-28T15:40:04.889799Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1030"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2d6fc3b76ca2dbee462aede5ba189f4ba3a114078eb28161a22f9edd5b060565)
2022-09-28T15:40:07.185983Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:40:07.204049Z - running sql script pg/upsert_orders.sql
2022-09-28T15:40:07.204091Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:40:07.209240Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:40:07.213924Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:40:07.214978Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:40:07.219330Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:40:07.223827Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:40:07.228010Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:40:07.228939Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:40:07.230010Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:40:07.236889Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:40:07.353941Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:40:07.392645Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:40:07.396854Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:40:07.404128Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:40:07.468661Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:40:07.483958Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:40:07.484398Z - job completed in 2.60 seconds (2d6fc3b76ca2dbee462aede5ba189f4ba3a114078eb28161a22f9edd5b060565)
2022-09-28T15:42:02.051825Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1032"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c9cc2bc3d74fbc94a7fea2bb4ec8b8bbf9c3c74c5f0e91adae94ebdf1e45cf8c)
2022-09-28T15:42:03.355339Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:42:03.372600Z - running sql script pg/insert_tenders.sql
2022-09-28T15:42:03.372642Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:42:03.377097Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:42:03.382030Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:42:03.386323Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:42:03.390505Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:42:03.395670Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:42:03.396886Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:42:03.443676Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:42:03.480910Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:42:03.484983Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:42:03.486753Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:42:03.719480Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:42:03.859824Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:42:03.869353Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:42:04.121497Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:42:04.310685Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:42:04.315861Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:42:04.316625Z - job completed in 2.27 seconds (c9cc2bc3d74fbc94a7fea2bb4ec8b8bbf9c3c74c5f0e91adae94ebdf1e45cf8c)
2022-09-28T15:42:04.419693Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1032"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (17fdf2206affc02d83987e8f5a59ddc91bb8457ad18ca6cd15eb09d65932cc3e)
2022-09-28T15:42:06.554148Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:42:06.571952Z - running sql script pg/upsert_orders.sql
2022-09-28T15:42:06.571983Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:42:06.576162Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:42:06.580793Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:42:06.581799Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:42:06.585714Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:42:06.589983Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:42:06.594130Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:42:06.595180Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:42:06.596120Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:42:06.602268Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:42:06.723835Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:42:06.754171Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:42:06.760086Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:42:06.766772Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:42:06.830458Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:42:06.840487Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:42:06.840997Z - job completed in 2.42 seconds (17fdf2206affc02d83987e8f5a59ddc91bb8457ad18ca6cd15eb09d65932cc3e)
2022-09-28T15:44:02.128854Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1034"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (618eb630a42537063e8e7ce2f43533e0d6ce9ae3e512b74c75f1ee0919192384)
2022-09-28T15:44:04.366675Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:44:04.384564Z - running sql script pg/upsert_orders.sql
2022-09-28T15:44:04.384604Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:44:04.389464Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:44:04.393993Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:44:04.395119Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:44:04.399653Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:44:04.401232Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:44:04.405517Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:44:04.406544Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:44:04.407629Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:44:04.413987Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:44:04.509238Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:44:04.540229Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:44:04.545681Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:44:04.553316Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:44:04.627754Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:44:04.637143Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:44:04.637712Z - job completed in 2.51 seconds (618eb630a42537063e8e7ce2f43533e0d6ce9ae3e512b74c75f1ee0919192384)
2022-09-28T15:44:04.674784Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1034"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2545f6888809e6ce85a736b2249c1970419440321aa34154ef76a2a271680bcf)
2022-09-28T15:44:07.746158Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:44:07.762753Z - running sql script pg/insert_tenders.sql
2022-09-28T15:44:07.762794Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:44:07.767366Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:44:07.771602Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:44:07.775744Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:44:07.780177Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:44:07.786018Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:44:07.787054Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:44:07.834498Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:44:07.915449Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:44:07.919605Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:44:07.921280Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:44:08.149550Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:44:08.246609Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:44:08.253875Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:44:08.481508Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:44:08.672326Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:44:08.678141Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:44:08.678459Z - job completed in 4.00 seconds (2545f6888809e6ce85a736b2249c1970419440321aa34154ef76a2a271680bcf)
2022-09-28T15:46:02.052378Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1036"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (71e31bbc820e6ffc8015144e61aab6e6899517a3f51508031ee148f40dc9e3bd)
2022-09-28T15:46:04.393990Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:46:04.410956Z - running sql script pg/upsert_orders.sql
2022-09-28T15:46:04.411861Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:46:04.417482Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:46:04.422118Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:46:04.423197Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:46:04.427432Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:46:04.429101Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:46:04.433500Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:46:04.434577Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:46:04.435588Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:46:04.441898Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:46:04.582089Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:46:04.630090Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:46:04.634249Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:46:04.646539Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:46:04.714401Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:46:04.740309Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:46:04.741205Z - job completed in 2.69 seconds (71e31bbc820e6ffc8015144e61aab6e6899517a3f51508031ee148f40dc9e3bd)
2022-09-28T15:46:04.768179Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1036"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fa5301f47c6c5b352f3a51ac1c7697f786e4f10a0a2936622657dd7725c00952)
2022-09-28T15:46:05.969115Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:46:05.996097Z - running sql script pg/insert_tenders.sql
2022-09-28T15:46:05.996125Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:46:06.000839Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:46:06.005374Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:46:06.009558Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:46:06.013916Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:46:06.019063Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:46:06.020181Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:46:06.068028Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:46:06.115735Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:46:06.119968Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:46:06.121550Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:46:06.349119Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:46:06.446593Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:46:06.456250Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:46:06.688865Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:46:06.873670Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:46:06.881130Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:46:06.881405Z - job completed in 2.11 seconds (fa5301f47c6c5b352f3a51ac1c7697f786e4f10a0a2936622657dd7725c00952)
2022-09-28T15:48:02.100053Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1038"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a15672a940764e3ce73c7e5c686ea95b7a180dcd1f5bd0482cb69b8d5ca71ce7)
2022-09-28T15:48:04.120933Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:48:04.138467Z - running sql script pg/upsert_orders.sql
2022-09-28T15:48:04.138732Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:48:04.144354Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:48:04.149339Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:48:04.150879Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:48:04.154993Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:48:04.156670Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:48:04.162423Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:48:04.163574Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:48:04.164731Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:48:04.170926Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:48:04.319392Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:48:04.378080Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:48:04.381753Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:48:04.387468Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:48:04.452051Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:48:04.461899Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:48:04.462444Z - job completed in 2.36 seconds (a15672a940764e3ce73c7e5c686ea95b7a180dcd1f5bd0482cb69b8d5ca71ce7)
2022-09-28T15:48:04.503496Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1038"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (bc09b818380f3d1157b30242d2270e08f90982fef5e29ad881e343c9cf38322b)
2022-09-28T15:48:05.889919Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:48:05.939611Z - running sql script pg/insert_tenders.sql
2022-09-28T15:48:05.939649Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:48:05.944795Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:48:05.950139Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:48:05.954779Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:48:05.958692Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:48:05.963655Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:48:05.964713Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:48:06.012346Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:48:06.076168Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:48:06.080999Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:48:06.082528Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:48:06.349918Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:48:06.473454Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:48:06.484673Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:48:06.722901Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:48:06.909504Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:48:06.914986Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:48:06.915287Z - job completed in 2.41 seconds (bc09b818380f3d1157b30242d2270e08f90982fef5e29ad881e343c9cf38322b)
2022-09-28T15:48:07.009335Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1028"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (8014a9225bf35375bb7c6566f97c9c062be4869220429dc4f295c9c997c63d0b)
2022-09-28T15:48:12.240190Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:48:12.264851Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T15:48:12.264900Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:48:12.271732Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T15:48:12.276852Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T15:48:12.281333Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T15:48:12.282410Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T15:48:12.286155Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T15:48:12.290817Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T15:48:12.294987Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:48:12.296041Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T15:48:12.297019Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T15:48:12.303017Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T15:48:12.308076Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T15:48:12.309116Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T15:48:12.315947Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T15:48:12.320173Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T15:48:12.324282Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T15:48:12.330433Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T15:48:12.971588Z - called http://score/api/keyed and received back 200
2022-09-28T15:48:12.974963Z - job completed in 5.96 seconds (8014a9225bf35375bb7c6566f97c9c062be4869220429dc4f295c9c997c63d0b)
2022-09-28T15:50:02.753429Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1040"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (aa816cdf8ffd278afa7ffb0afa9a85659f1178b2770dddc7d2d5b02de54f4c1a)
2022-09-28T15:50:05.206080Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:50:05.222663Z - running sql script pg/insert_tenders.sql
2022-09-28T15:50:05.222906Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:50:05.227741Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:50:05.235709Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:50:05.243644Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:50:05.248174Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:50:05.253097Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:50:05.254125Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:50:05.303402Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:50:05.366679Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:50:05.370807Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:50:05.372321Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:50:05.592519Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:50:05.991024Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:50:06.008334Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:50:06.243773Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:50:06.425730Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:50:06.431124Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:50:06.434575Z - job completed in 3.68 seconds (aa816cdf8ffd278afa7ffb0afa9a85659f1178b2770dddc7d2d5b02de54f4c1a)
2022-09-28T15:50:06.535995Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1040"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (273295c4c28d127343954e642390ac16a23789bc65551d2cb3d5bde03f83da0a)
2022-09-28T15:50:08.866916Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:50:08.888432Z - running sql script pg/upsert_orders.sql
2022-09-28T15:50:08.888468Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:50:08.892879Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:50:08.897322Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:50:08.898379Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:50:08.902306Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:50:08.903718Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:50:08.907886Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:50:08.908914Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:50:08.909774Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:50:08.916181Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:50:09.072505Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:50:09.118635Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:50:09.122764Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:50:09.131977Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:50:09.198979Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:50:09.216762Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:50:09.217325Z - job completed in 2.68 seconds (273295c4c28d127343954e642390ac16a23789bc65551d2cb3d5bde03f83da0a)
2022-09-28T15:52:01.975840Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1042"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0f63389317fda4da41ad40e5bd1c2ea4be15250e79f479abde9a4fdbc03cbeca)
2022-09-28T15:52:03.340816Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:52:03.360446Z - running sql script pg/insert_tenders.sql
2022-09-28T15:52:03.360477Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:52:03.365576Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:52:03.367115Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:52:03.371938Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:52:03.376278Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:52:03.382593Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:52:03.384115Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:52:03.433392Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:52:03.490127Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:52:03.494296Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:52:03.495999Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:52:03.719650Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:52:03.819832Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:52:03.827595Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:52:04.062776Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:52:04.246982Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:52:04.252652Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:52:04.253121Z - job completed in 2.28 seconds (0f63389317fda4da41ad40e5bd1c2ea4be15250e79f479abde9a4fdbc03cbeca)
2022-09-28T15:52:04.308497Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1042"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9775e9593c72c18b19ad0c65b3e70c3aaf721bc2e87d38347b639d54e6f01414)
2022-09-28T15:52:06.946043Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:52:06.964394Z - running sql script pg/upsert_orders.sql
2022-09-28T15:52:06.964429Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:52:06.970193Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:52:06.975151Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:52:06.976525Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:52:06.980546Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:52:06.983452Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:52:06.988019Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:52:06.989242Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:52:06.990169Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:52:06.998025Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:52:07.173416Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:52:07.219131Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:52:07.223167Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:52:07.229671Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:52:07.294938Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:52:07.304993Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:52:07.305359Z - job completed in 3.00 seconds (9775e9593c72c18b19ad0c65b3e70c3aaf721bc2e87d38347b639d54e6f01414)
2022-09-28T15:54:01.981536Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1044"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5b863501d729dcb4260a0dad37b449b479e40d4fbcd43424e2922a1e78bc5412)
2022-09-28T15:54:04.181429Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:54:04.199720Z - running sql script pg/upsert_orders.sql
2022-09-28T15:54:04.199859Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:54:04.205019Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:54:04.211701Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:54:04.213125Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:54:04.219188Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:54:04.220938Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:54:04.227394Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:54:04.228922Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:54:04.230197Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:54:04.236726Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:54:04.383656Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:54:04.440033Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:54:04.444829Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:54:04.451854Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:54:04.518308Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:54:04.535595Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:54:04.535847Z - job completed in 2.55 seconds (5b863501d729dcb4260a0dad37b449b479e40d4fbcd43424e2922a1e78bc5412)
2022-09-28T15:54:04.684054Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1044"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (206edd998c4e8b3a5c91bd4539b78b31804189cd9e2d5f7cdc977ee00185f093)
2022-09-28T15:54:05.872786Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:54:05.889934Z - running sql script pg/insert_tenders.sql
2022-09-28T15:54:05.889972Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:54:05.895181Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:54:05.896637Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:54:05.900834Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:54:05.906047Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:54:05.910932Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:54:05.911840Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:54:05.960159Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:54:05.986156Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:54:05.991259Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:54:05.992708Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:54:06.212870Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:54:06.310005Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:54:06.315731Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:54:06.548991Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:54:06.734325Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:54:06.740351Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:54:06.740773Z - job completed in 2.06 seconds (206edd998c4e8b3a5c91bd4539b78b31804189cd9e2d5f7cdc977ee00185f093)
2022-09-28T15:56:02.012744Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1046"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7fe14f5c7d833e93e6c9c13e95178004e6070725f858bb76c6f83d41995c604b)
2022-09-28T15:56:03.224171Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:56:03.245071Z - running sql script pg/insert_tenders.sql
2022-09-28T15:56:03.245123Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:56:03.252584Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:56:03.254430Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:56:03.258823Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:56:03.262567Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:56:03.267230Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:56:03.268363Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:56:03.326354Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:56:03.347271Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:56:03.351109Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:56:03.352511Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:56:03.571281Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:56:03.667450Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:56:03.676835Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:56:03.912027Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:56:04.094089Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:56:04.101665Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:56:04.101992Z - job completed in 2.09 seconds (7fe14f5c7d833e93e6c9c13e95178004e6070725f858bb76c6f83d41995c604b)
2022-09-28T15:56:04.132242Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1046"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c0359bfe9b67882cd7e71acef09be71ad2d3cca5f09c1e74bffab08426b9d0be)
2022-09-28T15:56:06.397438Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:56:06.416470Z - running sql script pg/upsert_orders.sql
2022-09-28T15:56:06.416515Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:56:06.423201Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:56:06.427726Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:56:06.428908Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:56:06.433086Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:56:06.434601Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:56:06.441016Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:56:06.442065Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:56:06.442927Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:56:06.450518Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:56:06.536503Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:56:06.583694Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:56:06.587444Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:56:06.595644Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:56:06.659709Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:56:06.669986Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:56:06.670255Z - job completed in 2.54 seconds (c0359bfe9b67882cd7e71acef09be71ad2d3cca5f09c1e74bffab08426b9d0be)
2022-09-28T15:58:02.196590Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1038"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (ed34c8f7f6eed6859cc66c92afc35e0d3a7986693c53467d28024f95df31d547)
2022-09-28T15:58:08.751691Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:58:08.768085Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T15:58:08.768125Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:58:08.775805Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T15:58:08.780685Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T15:58:08.784977Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T15:58:08.785954Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T15:58:08.789905Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T15:58:08.793915Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T15:58:08.794965Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:58:08.795954Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T15:58:08.797679Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T15:58:08.803377Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T15:58:08.808205Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T15:58:08.809243Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T15:58:08.815074Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T15:58:08.819178Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T15:58:08.823768Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T15:58:08.829313Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T15:58:09.471255Z - called http://score/api/keyed and received back 200
2022-09-28T15:58:09.471380Z - job completed in 7.28 seconds (ed34c8f7f6eed6859cc66c92afc35e0d3a7986693c53467d28024f95df31d547)
2022-09-28T15:58:09.562654Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1048"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (35936a0436ebe5c657375e304c6f395349629a4bf0e327756543e516f001c34d)
2022-09-28T15:58:10.985824Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:58:11.003048Z - running sql script pg/insert_tenders.sql
2022-09-28T15:58:11.003098Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T15:58:11.007685Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T15:58:11.009025Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T15:58:11.012735Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T15:58:11.016155Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T15:58:11.020895Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T15:58:11.021782Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T15:58:11.068755Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T15:58:11.084979Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T15:58:11.086095Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T15:58:11.087589Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T15:58:11.314418Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T15:58:11.400366Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T15:58:11.406317Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T15:58:11.631724Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T15:58:11.813047Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T15:58:11.818324Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T15:58:11.818797Z - job completed in 2.26 seconds (35936a0436ebe5c657375e304c6f395349629a4bf0e327756543e516f001c34d)
2022-09-28T15:58:11.920660Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1048"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (192fc4e7000eafcb73c318b8a691f9ea0d4f44425d121dc74c7da04362583b95)
2022-09-28T15:58:14.130249Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T15:58:14.147104Z - running sql script pg/upsert_orders.sql
2022-09-28T15:58:14.147139Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T15:58:14.152187Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T15:58:14.156812Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T15:58:14.157954Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T15:58:14.162217Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T15:58:14.163764Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T15:58:14.168421Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T15:58:14.169537Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T15:58:14.170498Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T15:58:14.177236Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T15:58:14.245621Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T15:58:14.276572Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T15:58:14.280370Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T15:58:14.286449Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T15:58:14.350500Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T15:58:14.359973Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T15:58:14.360486Z - job completed in 2.44 seconds (192fc4e7000eafcb73c318b8a691f9ea0d4f44425d121dc74c7da04362583b95)
2022-09-28T16:00:03.096140Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1050"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d075021b228adacbfb608a4ee8d6174ff1f42e260c02a326b9b82220571f749d)
2022-09-28T16:00:04.412398Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:00:04.432129Z - running sql script pg/insert_tenders.sql
2022-09-28T16:00:04.432161Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:00:04.436992Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:00:04.438297Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:00:04.442063Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:00:04.449910Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:00:04.454494Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:00:04.455579Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:00:04.502887Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:00:04.527666Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:00:04.531422Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:00:04.532842Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:00:04.648533Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:00:04.700595Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:00:04.706388Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:00:04.931773Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:00:05.111455Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:00:05.116701Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:00:05.116967Z - job completed in 2.02 seconds (d075021b228adacbfb608a4ee8d6174ff1f42e260c02a326b9b82220571f749d)
2022-09-28T16:00:05.296245Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1050"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1c7ac4a9f0d07efd56dd646385dc4d01b247059d7a98d4bdf7c4840d254c4f87)
2022-09-28T16:00:07.333885Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:00:07.357783Z - running sql script pg/upsert_orders.sql
2022-09-28T16:00:07.357819Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:00:07.362992Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:00:07.368044Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:00:07.368920Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:00:07.373129Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:00:07.374430Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:00:07.378408Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:00:07.379360Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:00:07.380745Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:00:07.387289Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:00:07.451111Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:00:07.481802Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:00:07.485841Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:00:07.496695Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:00:07.560352Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:00:07.569675Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:00:07.571009Z - job completed in 2.27 seconds (1c7ac4a9f0d07efd56dd646385dc4d01b247059d7a98d4bdf7c4840d254c4f87)
2022-09-28T16:02:02.155378Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1052"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1c2985e0709c7ef9a8bede51bb3f139a4ebb86cdd4d6af189a43407c9097c91f)
2022-09-28T16:02:04.726783Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:02:04.753548Z - running sql script pg/upsert_orders.sql
2022-09-28T16:02:04.754035Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:02:04.759400Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:02:04.764118Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:02:04.765203Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:02:04.769205Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:02:04.773979Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:02:04.779187Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:02:04.780183Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:02:04.781029Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:02:04.787509Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:02:04.858602Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:02:04.915026Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:02:04.927987Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:02:04.939360Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:02:05.004420Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:02:05.014151Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:02:05.014820Z - job completed in 2.86 seconds (1c2985e0709c7ef9a8bede51bb3f139a4ebb86cdd4d6af189a43407c9097c91f)
2022-09-28T16:02:05.050746Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1052"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f9b25c350e3a3a40b0d8548cf7e241d8de35b7bed14e41f99625fdc4873488ce)
2022-09-28T16:02:06.308659Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:02:06.325816Z - running sql script pg/insert_tenders.sql
2022-09-28T16:02:06.325850Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:02:06.330387Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:02:06.331776Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:02:06.338630Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:02:06.342509Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:02:06.347105Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:02:06.348004Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:02:06.395967Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:02:06.425681Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:02:06.430198Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:02:06.431767Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:02:06.552126Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:02:06.604675Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:02:06.610154Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:02:06.833453Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:02:07.014507Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:02:07.019726Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:02:07.020277Z - job completed in 1.97 seconds (f9b25c350e3a3a40b0d8548cf7e241d8de35b7bed14e41f99625fdc4873488ce)
2022-09-28T16:04:02.172731Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1054"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (aa9e59f7fe46bcc2576e282c15bd1bf4e168f61149fae40e79e7b1c81e46d176)
2022-09-28T16:04:04.466657Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:04:04.483937Z - running sql script pg/upsert_orders.sql
2022-09-28T16:04:04.483965Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:04:04.488618Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:04:04.492817Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:04:04.493965Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:04:04.498155Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:04:04.502623Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:04:04.507870Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:04:04.508797Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:04:04.509745Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:04:04.516014Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:04:04.592774Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:04:04.633762Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:04:04.637628Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:04:04.644477Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:04:04.711382Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:04:04.719290Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:04:04.719960Z - job completed in 2.55 seconds (aa9e59f7fe46bcc2576e282c15bd1bf4e168f61149fae40e79e7b1c81e46d176)
2022-09-28T16:04:04.745219Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1054"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9a5908ac6288bb267667897efe8ee2333a749d4010f86dbd87f4422e8ee7ab92)
2022-09-28T16:04:10.618367Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:04:10.638520Z - running sql script pg/insert_tenders.sql
2022-09-28T16:04:10.638828Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:04:10.643767Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:04:10.645254Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:04:10.649395Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:04:10.654034Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:04:10.658931Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:04:10.660683Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:04:10.708523Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:04:10.734512Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:04:10.738945Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:04:10.740563Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:04:10.855693Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:04:10.905848Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:04:10.910696Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:04:11.131396Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:04:11.309174Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:04:11.314609Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:04:11.315147Z - job completed in 6.57 seconds (9a5908ac6288bb267667897efe8ee2333a749d4010f86dbd87f4422e8ee7ab92)
2022-09-28T16:06:02.182899Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1056"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e1064f738ff6774ebcaf56cc272359906c5e26bd244e4fbee44fcb5b1e7e6203)
2022-09-28T16:06:04.645103Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:06:04.662338Z - running sql script pg/upsert_orders.sql
2022-09-28T16:06:04.662383Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:06:04.667362Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:06:04.671400Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:06:04.672542Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:06:04.676734Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:06:04.681248Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:06:04.685869Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:06:04.686874Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:06:04.687915Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:06:04.694069Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:06:04.768469Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:06:04.805267Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:06:04.809301Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:06:04.822090Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:06:04.890191Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:06:04.899715Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:06:04.900202Z - job completed in 2.72 seconds (e1064f738ff6774ebcaf56cc272359906c5e26bd244e4fbee44fcb5b1e7e6203)
2022-09-28T16:06:04.980753Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1056"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (962ad9e127980adc04910f4e404d11cbbdae843bac8f3a97b705336868ee404d)
2022-09-28T16:06:06.123018Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:06:06.140432Z - running sql script pg/insert_tenders.sql
2022-09-28T16:06:06.140461Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:06:06.145773Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:06:06.147170Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:06:06.151268Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:06:06.155457Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:06:06.160408Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:06:06.161479Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:06:06.207504Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:06:06.233067Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:06:06.236923Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:06:06.238486Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:06:06.353047Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:06:06.404683Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:06:06.410680Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:06:06.628007Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:06:06.801357Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:06:06.808946Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:06:06.809205Z - job completed in 1.83 seconds (962ad9e127980adc04910f4e404d11cbbdae843bac8f3a97b705336868ee404d)
2022-09-28T16:08:02.019823Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1058"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0484a4633ed03925f215dae23bf0ae022467fc22a480b5cf8f0068bc25e0f374)
2022-09-28T16:08:04.195349Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:08:04.212195Z - running sql script pg/upsert_orders.sql
2022-09-28T16:08:04.212239Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:08:04.216962Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:08:04.221720Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:08:04.224065Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:08:04.228233Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:08:04.234019Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:08:04.238626Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:08:04.239896Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:08:04.240885Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:08:04.248133Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:08:04.399177Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:08:04.436364Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:08:04.440394Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:08:04.449041Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:08:04.516720Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:08:04.528837Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:08:04.529651Z - job completed in 2.51 seconds (0484a4633ed03925f215dae23bf0ae022467fc22a480b5cf8f0068bc25e0f374)
2022-09-28T16:08:04.561301Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1058"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (350cc35f3015de2e33343518e3ffb707e0b00ba1bb60716bfcfaab1e4c080ce6)
2022-09-28T16:08:05.848938Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:08:05.866340Z - running sql script pg/insert_tenders.sql
2022-09-28T16:08:05.866373Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:08:05.871464Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:08:05.872737Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:08:05.876701Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:08:05.880745Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:08:05.885298Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:08:05.886380Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:08:05.933153Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:08:05.958942Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:08:05.964817Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:08:05.966595Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:08:06.083245Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:08:06.134169Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:08:06.139155Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:08:06.365305Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:08:06.542023Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:08:06.547418Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:08:06.547795Z - job completed in 1.99 seconds (350cc35f3015de2e33343518e3ffb707e0b00ba1bb60716bfcfaab1e4c080ce6)
2022-09-28T16:08:06.579243Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1048"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (b4e9c2b84d8cf489de5c5b66818b86143dcf23f086bccd4e816f22bdd7c2317d)
2022-09-28T16:08:15.033170Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:08:15.050082Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T16:08:15.050114Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:08:15.055108Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T16:08:15.059918Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T16:08:15.063996Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T16:08:15.065011Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T16:08:15.069099Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T16:08:15.073560Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T16:08:15.074774Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:08:15.075834Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T16:08:15.076929Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T16:08:15.084104Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T16:08:15.089141Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T16:08:15.090265Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T16:08:15.096186Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T16:08:15.100505Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T16:08:15.104982Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T16:08:15.110114Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T16:08:15.679173Z - called http://score/api/keyed and received back 200
2022-09-28T16:08:15.679267Z - job completed in 9.10 seconds (b4e9c2b84d8cf489de5c5b66818b86143dcf23f086bccd4e816f22bdd7c2317d)
2022-09-28T16:10:02.599883Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1100"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (edb3a5048a124cd51b54419fe75b0c1794a9581998f5eed640fadc3015e25b45)
2022-09-28T16:10:04.809333Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:10:04.829013Z - running sql script pg/upsert_orders.sql
2022-09-28T16:10:04.829052Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:10:04.833265Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:10:04.837407Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:10:04.840075Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:10:04.845421Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:10:04.857850Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:10:04.862381Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:10:04.863432Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:10:04.864205Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:10:04.870104Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:10:04.999789Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:10:05.045191Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:10:05.049235Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:10:05.058184Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:10:05.134471Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:10:05.145244Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:10:05.145667Z - job completed in 2.55 seconds (edb3a5048a124cd51b54419fe75b0c1794a9581998f5eed640fadc3015e25b45)
2022-09-28T16:10:05.197450Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1100"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8be4f2d30adfbd29db07399fe38cf1d0148755d370558378c99d970a63dd649f)
2022-09-28T16:10:06.547259Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:10:06.564005Z - running sql script pg/insert_tenders.sql
2022-09-28T16:10:06.564065Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:10:06.568846Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:10:06.570361Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:10:06.574093Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:10:06.577762Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:10:06.582252Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:10:06.583099Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:10:06.627187Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:10:06.652969Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:10:06.656804Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:10:06.658353Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:10:06.660358Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:10:06.661621Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:10:06.662841Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:10:06.664484Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:10:06.666141Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:10:06.667654Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:10:06.668064Z - job completed in 1.47 seconds (8be4f2d30adfbd29db07399fe38cf1d0148755d370558378c99d970a63dd649f)
2022-09-28T16:12:02.111273Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1102"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1824b8f66757a731b818d2dd0644d56834a64131466fadb923297ddddc021d71)
2022-09-28T16:12:04.363704Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:12:04.380717Z - running sql script pg/upsert_orders.sql
2022-09-28T16:12:04.380772Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:12:04.385517Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:12:04.390109Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:12:04.392070Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:12:04.397148Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:12:04.401567Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:12:04.406151Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:12:04.407241Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:12:04.408209Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:12:04.415243Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:12:04.476398Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:12:04.494845Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:12:04.499288Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:12:04.513315Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:12:04.598719Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:12:04.607260Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:12:04.607594Z - job completed in 2.50 seconds (1824b8f66757a731b818d2dd0644d56834a64131466fadb923297ddddc021d71)
2022-09-28T16:12:04.658269Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1102"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7d05f13300c1bb134ca2a7b81f70f7f9fb29a1549cf439b46d0b10e147433d33)
2022-09-28T16:12:06.326531Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:12:06.359631Z - running sql script pg/insert_tenders.sql
2022-09-28T16:12:06.360385Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:12:06.365127Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:12:06.370125Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:12:06.375439Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:12:06.380091Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:12:06.385191Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:12:06.386752Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:12:06.434064Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:12:06.490592Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:12:06.494876Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:12:06.496703Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:12:06.720672Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:12:06.817922Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:12:06.838513Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:12:07.073978Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:12:07.289006Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:12:07.294890Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:12:07.295321Z - job completed in 2.64 seconds (7d05f13300c1bb134ca2a7b81f70f7f9fb29a1549cf439b46d0b10e147433d33)
2022-09-28T16:14:02.535970Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1104"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6425ef30594bfb4d8494fd808efe8452b77ede49c65dc9ca79229281bb160aa1)
2022-09-28T16:14:04.966220Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:14:04.983071Z - running sql script pg/upsert_orders.sql
2022-09-28T16:14:04.983111Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:14:04.987924Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:14:04.993029Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:14:04.994216Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:14:05.000015Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:14:05.004630Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:14:05.008849Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:14:05.009798Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:14:05.010827Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:14:05.017022Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:14:05.113507Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:14:05.132812Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:14:05.136979Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:14:05.147831Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:14:05.215176Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:14:05.230701Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:14:05.231094Z - job completed in 2.70 seconds (6425ef30594bfb4d8494fd808efe8452b77ede49c65dc9ca79229281bb160aa1)
2022-09-28T16:14:05.302683Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1104"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c3e9cf072d391bf7de08600d733a042645a07f1e2c1baac3026b5d69a3d6eb16)
2022-09-28T16:14:06.651475Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:14:06.668287Z - running sql script pg/insert_tenders.sql
2022-09-28T16:14:06.668322Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:14:06.673120Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:14:06.677299Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:14:06.681804Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:14:06.686059Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:14:06.692239Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:14:06.693363Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:14:06.739383Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:14:06.794502Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:14:06.798388Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:14:06.800027Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:14:07.019941Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:14:07.116389Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:14:07.124881Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:14:07.357037Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:14:07.550856Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:14:07.556491Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:14:07.556978Z - job completed in 2.25 seconds (c3e9cf072d391bf7de08600d733a042645a07f1e2c1baac3026b5d69a3d6eb16)
2022-09-28T16:16:02.072835Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1106"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (108438ac1530b7bb7e8359c25f50d05cabf130db0d1f5c536f4d6ace320bfc46)
2022-09-28T16:16:06.803312Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:16:06.821264Z - running sql script pg/upsert_orders.sql
2022-09-28T16:16:06.821296Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:16:06.831674Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:16:06.836469Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:16:06.837337Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:16:06.841078Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:16:06.842499Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:16:06.846972Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:16:06.848085Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:16:06.848868Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:16:06.855026Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:16:06.981264Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:16:07.007868Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:16:07.012038Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:16:07.024408Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:16:07.108481Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:16:07.127998Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:16:07.128431Z - job completed in 5.06 seconds (108438ac1530b7bb7e8359c25f50d05cabf130db0d1f5c536f4d6ace320bfc46)
2022-09-28T16:16:07.262031Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1106"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1adbaaca985e749cbc27433ae621732f6cb725113a66f8b5389899a2e0db04a2)
2022-09-28T16:16:08.507792Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:16:08.536401Z - running sql script pg/insert_tenders.sql
2022-09-28T16:16:08.537014Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:16:08.542333Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:16:08.547635Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:16:08.552363Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:16:08.557661Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:16:08.562562Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:16:08.564292Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:16:08.611778Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:16:08.670294Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:16:08.674414Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:16:08.677518Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:16:08.902755Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:16:08.999784Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:16:09.011942Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:16:09.246970Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:16:09.439354Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:16:09.446150Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:16:09.446415Z - job completed in 2.18 seconds (1adbaaca985e749cbc27433ae621732f6cb725113a66f8b5389899a2e0db04a2)
2022-09-28T16:18:02.083700Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1058"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (f4a7b0e378d0238ad94f616e08a947a96d7ddbfafff22858b944a52da6d0fa4f)
2022-09-28T16:18:08.860392Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:18:08.880906Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T16:18:08.881046Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:18:08.885594Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T16:18:08.889805Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T16:18:08.890860Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T16:18:08.892377Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T16:18:08.893793Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T16:18:08.895399Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T16:18:08.896536Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:18:08.898159Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T16:18:08.899370Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T16:18:08.901278Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T16:18:08.903036Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T16:18:08.904067Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T16:18:08.906437Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T16:18:08.907486Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T16:18:08.908949Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T16:18:08.910867Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T16:18:08.986747Z - called http://score/api/keyed and received back 204
2022-09-28T16:18:08.986863Z - job completed in 6.90 seconds (f4a7b0e378d0238ad94f616e08a947a96d7ddbfafff22858b944a52da6d0fa4f)
2022-09-28T16:18:09.089463Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1108"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1e4fb1d70bb49f65bbeda09981a3808d067588995fa2ae2ff58032e4eb3e0ca6)
2022-09-28T16:18:11.500660Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:18:11.517829Z - running sql script pg/upsert_orders.sql
2022-09-28T16:18:11.517861Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:18:11.522523Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:18:11.527306Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:18:11.528433Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:18:11.532639Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:18:11.534169Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:18:11.538292Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:18:11.539413Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:18:11.540425Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:18:11.547677Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:18:11.684607Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:18:11.729008Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:18:11.732971Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:18:11.738793Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:18:11.803883Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:18:11.813904Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:18:11.814457Z - job completed in 2.73 seconds (1e4fb1d70bb49f65bbeda09981a3808d067588995fa2ae2ff58032e4eb3e0ca6)
2022-09-28T16:18:11.914917Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1108"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ca29f681e21f3492e255cbe9493c3f6566459da3c70774fec5ed43cca7ac220e)
2022-09-28T16:18:13.415586Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:18:13.433157Z - running sql script pg/insert_tenders.sql
2022-09-28T16:18:13.433209Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:18:13.437590Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:18:13.441873Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:18:13.445878Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:18:13.450330Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:18:13.455387Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:18:13.456494Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:18:13.503405Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:18:13.577719Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:18:13.582206Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:18:13.583818Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:18:13.861832Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:18:13.958769Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:18:13.965205Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:18:14.198966Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:18:14.395752Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:18:14.400814Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:18:14.401318Z - job completed in 2.49 seconds (ca29f681e21f3492e255cbe9493c3f6566459da3c70774fec5ed43cca7ac220e)
2022-09-28T16:20:02.561313Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1110"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (87367915a238fdfec724b889288c8c42df357bfd545ac29e62dbdde3c02d7da4)
2022-09-28T16:20:06.044526Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:20:06.060887Z - running sql script pg/upsert_orders.sql
2022-09-28T16:20:06.060917Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:20:06.065266Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:20:06.070399Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:20:06.071430Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:20:06.075954Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:20:06.082024Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:20:06.086510Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:20:06.087585Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:20:06.088505Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:20:06.095132Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:20:06.249785Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:20:06.303912Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:20:06.307804Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:20:06.318038Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:20:06.385302Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:20:06.407252Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:20:06.407935Z - job completed in 3.85 seconds (87367915a238fdfec724b889288c8c42df357bfd545ac29e62dbdde3c02d7da4)
2022-09-28T16:20:06.468062Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1110"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c20e04c41f02a8bfb955879069cbb7f94c09a009c9d329b16ef3913d823ffc54)
2022-09-28T16:20:07.852905Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:20:07.875970Z - running sql script pg/insert_tenders.sql
2022-09-28T16:20:07.876004Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:20:07.880776Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:20:07.885086Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:20:07.889330Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:20:07.893402Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:20:07.898193Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:20:07.899190Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:20:07.945292Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:20:08.029946Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:20:08.034006Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:20:08.035667Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:20:08.261472Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:20:08.360705Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:20:08.367769Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:20:08.605778Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:20:08.797842Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:20:08.803081Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:20:08.803637Z - job completed in 2.34 seconds (c20e04c41f02a8bfb955879069cbb7f94c09a009c9d329b16ef3913d823ffc54)
2022-09-28T16:22:02.199368Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1112"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c6db88130cc360a31e0a8aceb3ecbb292c532ddbd74783575724575405f637e7)
2022-09-28T16:22:04.438617Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:22:04.456083Z - running sql script pg/upsert_orders.sql
2022-09-28T16:22:04.456331Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:22:04.460842Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:22:04.466041Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:22:04.467299Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:22:04.471634Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:22:04.476105Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:22:04.480643Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:22:04.481820Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:22:04.482832Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:22:04.491609Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:22:04.671968Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:22:04.779289Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:22:04.783029Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:22:04.790706Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:22:04.856871Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:22:04.867458Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:22:04.867861Z - job completed in 2.67 seconds (c6db88130cc360a31e0a8aceb3ecbb292c532ddbd74783575724575405f637e7)
2022-09-28T16:22:04.962253Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1112"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e1e1631a36c9f9bccf0389a7de4032efb6b05ee6d05847aab43c294edbff97f6)
2022-09-28T16:22:06.320154Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:22:06.337684Z - running sql script pg/insert_tenders.sql
2022-09-28T16:22:06.337732Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:22:06.342414Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:22:06.346502Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:22:06.350574Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:22:06.354555Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:22:06.359333Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:22:06.360867Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:22:06.407987Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:22:06.471501Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:22:06.474942Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:22:06.476326Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:22:06.702036Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:22:06.796862Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:22:06.804801Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:22:07.037964Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:22:07.234467Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:22:07.243020Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:22:07.243707Z - job completed in 2.28 seconds (e1e1631a36c9f9bccf0389a7de4032efb6b05ee6d05847aab43c294edbff97f6)
2022-09-28T16:24:02.100235Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1114"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b75efb4af8dbc4fd3594e1e589fe44f1cd760dfe512c9f580282b23a66bdb028)
2022-09-28T16:24:04.533197Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:24:04.557653Z - running sql script pg/upsert_orders.sql
2022-09-28T16:24:04.557693Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:24:04.562301Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:24:04.568275Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:24:04.575326Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:24:04.581319Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:24:04.587637Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:24:04.594319Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:24:04.599104Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:24:04.600410Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:24:04.607140Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:24:04.749551Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:24:04.809689Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:24:04.813429Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:24:04.818918Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:24:04.884523Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:24:04.893329Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:24:04.893568Z - job completed in 2.79 seconds (b75efb4af8dbc4fd3594e1e589fe44f1cd760dfe512c9f580282b23a66bdb028)
2022-09-28T16:24:05.014030Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1114"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a4174092f9e2ef008f2240548778179af75172497df89aa1cd39ee411103e665)
2022-09-28T16:24:07.117926Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:24:07.135589Z - running sql script pg/insert_tenders.sql
2022-09-28T16:24:07.135630Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:24:07.140283Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:24:07.144405Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:24:07.148532Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:24:07.152681Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:24:07.157372Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:24:07.158377Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:24:07.205849Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:24:07.274641Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:24:07.279012Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:24:07.280522Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:24:07.502467Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:24:07.607233Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:24:07.613539Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:24:07.851653Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:24:08.050597Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:24:08.056976Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:24:08.057455Z - job completed in 3.04 seconds (a4174092f9e2ef008f2240548778179af75172497df89aa1cd39ee411103e665)
2022-09-28T16:26:02.036416Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1116"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (58ac73689cbf995985a065f769a640643129b8da58c1ed4b687e6d0c7f6c4bce)
2022-09-28T16:26:03.760078Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:26:03.780488Z - running sql script pg/insert_tenders.sql
2022-09-28T16:26:03.780524Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:26:03.786801Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:26:03.791029Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:26:03.795322Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:26:03.802018Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:26:03.807224Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:26:03.808365Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:26:03.857463Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:26:03.923606Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:26:03.932321Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:26:03.939679Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:26:04.144086Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:26:04.232256Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:26:04.241760Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:26:04.483271Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:26:04.681578Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:26:04.686917Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:26:04.687313Z - job completed in 2.65 seconds (58ac73689cbf995985a065f769a640643129b8da58c1ed4b687e6d0c7f6c4bce)
2022-09-28T16:26:04.726542Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1116"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f587e53de006822a327a9eeb13a1f0b0f2e0372f288561a89dc2029caad1e5bf)
2022-09-28T16:26:07.181176Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:26:07.198795Z - running sql script pg/upsert_orders.sql
2022-09-28T16:26:07.198825Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:26:07.204263Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:26:07.209010Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:26:07.210080Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:26:07.214312Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:26:07.218614Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:26:07.222811Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:26:07.223990Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:26:07.224746Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:26:07.231608Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:26:07.383605Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:26:07.517596Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:26:07.521401Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:26:07.535050Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:26:07.605849Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:26:07.623104Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:26:07.624Z - job completed in 2.90 seconds (f587e53de006822a327a9eeb13a1f0b0f2e0372f288561a89dc2029caad1e5bf)
2022-09-28T16:28:01.989899Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1118"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (75214601bf6859e03f6925d43344e78f83b1ee9a7013d70947ee1a6fa1502b9a)
2022-09-28T16:28:03.302584Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:28:03.320855Z - running sql script pg/insert_tenders.sql
2022-09-28T16:28:03.320885Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:28:03.325425Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:28:03.329482Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:28:03.333643Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:28:03.337524Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:28:03.342198Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:28:03.343306Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:28:03.391616Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:28:03.452023Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:28:03.455953Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:28:03.457819Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:28:03.563435Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:28:03.610558Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:28:03.619426Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:28:03.855182Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:28:04.046930Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:28:04.058013Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:28:04.058521Z - job completed in 2.07 seconds (75214601bf6859e03f6925d43344e78f83b1ee9a7013d70947ee1a6fa1502b9a)
2022-09-28T16:28:04.099942Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1118"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4ea437857ba3b2f8b7c8a787eb8fc17c0f13345f0b8ea8704fade2aa22dfcc19)
2022-09-28T16:28:06.314790Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:28:06.331878Z - running sql script pg/upsert_orders.sql
2022-09-28T16:28:06.331982Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:28:06.337031Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:28:06.343955Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:28:06.345562Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:28:06.350796Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:28:06.356056Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:28:06.360455Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:28:06.361513Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:28:06.362373Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:28:06.368485Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:28:06.491148Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:28:06.547173Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:28:06.551329Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:28:06.557790Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:28:06.622463Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:28:06.631576Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:28:06.631956Z - job completed in 2.53 seconds (4ea437857ba3b2f8b7c8a787eb8fc17c0f13345f0b8ea8704fade2aa22dfcc19)
2022-09-28T16:28:06.724856Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1108"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (637d4ed1a28ecb65589e039dc080875e57dad210e6367822e0bf41c735484662)
2022-09-28T16:28:13.197500Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:28:13.214046Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T16:28:13.214086Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:28:13.220184Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T16:28:13.225081Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T16:28:13.229169Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T16:28:13.230087Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T16:28:13.236291Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T16:28:13.241900Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T16:28:13.242793Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:28:13.243630Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T16:28:13.244425Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T16:28:13.250758Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T16:28:13.255785Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T16:28:13.256860Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T16:28:13.263241Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T16:28:13.267256Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T16:28:13.271494Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T16:28:13.277358Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T16:28:13.882993Z - called http://score/api/keyed and received back 200
2022-09-28T16:28:13.883502Z - job completed in 7.16 seconds (637d4ed1a28ecb65589e039dc080875e57dad210e6367822e0bf41c735484662)
2022-09-28T16:30:02.430134Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1120"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f6a7ff5c5b027fa8757e8d697cdf5af6742aaf1f353f1a2544f24ec41881f4a1)
2022-09-28T16:30:04.796337Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:30:04.814641Z - running sql script pg/upsert_orders.sql
2022-09-28T16:30:04.814688Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:30:04.819022Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:30:04.824770Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:30:04.825985Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:30:04.829874Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:30:04.834035Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:30:04.839272Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:30:04.840266Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:30:04.841149Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:30:04.847587Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:30:04.958472Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:30:05.003286Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:30:05.007143Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:30:05.015726Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:30:05.083504Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:30:05.094237Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:30:05.094500Z - job completed in 2.66 seconds (f6a7ff5c5b027fa8757e8d697cdf5af6742aaf1f353f1a2544f24ec41881f4a1)
2022-09-28T16:30:05.156722Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1120"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (22b20f1eea67c83075017a0338a36a9adc06bcd8c44e19cd88bae79e72aa635e)
2022-09-28T16:30:06.214677Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:30:06.231477Z - running sql script pg/insert_tenders.sql
2022-09-28T16:30:06.231507Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:30:06.236795Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:30:06.241222Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:30:06.245955Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:30:06.250239Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:30:06.254848Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:30:06.255776Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:30:06.302614Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:30:06.356924Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:30:06.361104Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:30:06.362935Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:30:06.479036Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:30:06.531095Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:30:06.540679Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:30:06.775607Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:30:06.967420Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:30:06.973957Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:30:06.974411Z - job completed in 1.82 seconds (22b20f1eea67c83075017a0338a36a9adc06bcd8c44e19cd88bae79e72aa635e)
2022-09-28T16:32:02.095632Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1122"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (20903e66c0fdfc41a00488635f6b46d020bb5a52aa6f74cecced4903ee17ce41)
2022-09-28T16:32:03.444771Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:32:03.464556Z - running sql script pg/insert_tenders.sql
2022-09-28T16:32:03.464588Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:32:03.469748Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:32:03.471066Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:32:03.475321Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:32:03.479614Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:32:03.484437Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:32:03.485408Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:32:03.532966Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:32:03.571049Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:32:03.575470Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:32:03.576880Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:32:03.877136Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:32:03.976681Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:32:03.983460Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:32:04.216163Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:32:04.402555Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:32:04.408162Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:32:04.408666Z - job completed in 2.31 seconds (20903e66c0fdfc41a00488635f6b46d020bb5a52aa6f74cecced4903ee17ce41)
2022-09-28T16:32:04.510171Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1122"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (573fb1154c891166065071ea3abae4dce575e43d9786c9c57658d0ab36b6f8e9)
2022-09-28T16:32:06.867138Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:32:06.888056Z - running sql script pg/upsert_orders.sql
2022-09-28T16:32:06.888643Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:32:06.893829Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:32:06.899044Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:32:06.900052Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:32:06.903935Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:32:06.905598Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:32:06.909724Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:32:06.910855Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:32:06.911718Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:32:06.917988Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:32:07.011629Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:32:07.055657Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:32:07.059521Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:32:07.065666Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:32:07.128825Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:32:07.137352Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:32:07.137749Z - job completed in 2.63 seconds (573fb1154c891166065071ea3abae4dce575e43d9786c9c57658d0ab36b6f8e9)
2022-09-28T16:34:02.057893Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1124"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5e7ff1b94cfbb391d7b5c1ddb0402cac5a7de2bbc1bee9b68e4f5cccac8e0f32)
2022-09-28T16:34:04.773373Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:34:04.790531Z - running sql script pg/upsert_orders.sql
2022-09-28T16:34:04.790563Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:34:04.795658Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:34:04.800285Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:34:04.801193Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:34:04.805453Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:34:04.806896Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:34:04.811206Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:34:04.812207Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:34:04.813031Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:34:04.819976Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:34:04.902344Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:34:04.942949Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:34:04.947080Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:34:04.953131Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:34:05.017823Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:34:05.026256Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:34:05.026521Z - job completed in 2.97 seconds (5e7ff1b94cfbb391d7b5c1ddb0402cac5a7de2bbc1bee9b68e4f5cccac8e0f32)
2022-09-28T16:34:05.045057Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1124"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (885c6f057dbc7fe1acb45df2e54fc3e6e7b4ad6d4b04a8d511f8051b4b2f67d9)
2022-09-28T16:34:06.930957Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:34:06.947867Z - running sql script pg/insert_tenders.sql
2022-09-28T16:34:06.947922Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:34:06.952650Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:34:06.954067Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:34:06.958408Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:34:06.962272Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:34:06.967245Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:34:06.968074Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:34:07.015396Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:34:07.061773Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:34:07.065899Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:34:07.067294Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:34:07.300617Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:34:07.400353Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:34:07.407714Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:34:07.642606Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:34:07.830585Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:34:07.836927Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:34:07.837279Z - job completed in 2.79 seconds (885c6f057dbc7fe1acb45df2e54fc3e6e7b4ad6d4b04a8d511f8051b4b2f67d9)
2022-09-28T16:36:02.060939Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1126"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (70285a9bd8c6e5ecf86c2f92289fcc3915c02d89f1fa25ad8933bee45c1158e9)
2022-09-28T16:36:07.128844Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:36:07.145357Z - running sql script pg/upsert_orders.sql
2022-09-28T16:36:07.145402Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:36:07.149707Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:36:07.153863Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:36:07.154836Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:36:07.158296Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:36:07.159662Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:36:07.163408Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:36:07.164410Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:36:07.165310Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:36:07.171343Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:36:07.235122Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:36:07.262754Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:36:07.267046Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:36:07.276613Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:36:07.344473Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:36:07.356235Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:36:07.356477Z - job completed in 5.30 seconds (70285a9bd8c6e5ecf86c2f92289fcc3915c02d89f1fa25ad8933bee45c1158e9)
2022-09-28T16:36:07.437502Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1126"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (40dc57a7b21ad7b87cde023286961b70118e638020ce5db17d81661526ce097f)
2022-09-28T16:36:08.966133Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:36:08.982280Z - running sql script pg/insert_tenders.sql
2022-09-28T16:36:08.982341Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:36:08.986981Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:36:08.988321Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:36:08.992443Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:36:08.996351Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:36:09.000773Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:36:09.001629Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:36:09.049394Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:36:09.076780Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:36:09.081037Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:36:09.082552Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:36:09.319619Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:36:09.418750Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:36:09.428707Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:36:09.671049Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:36:09.863620Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:36:09.871228Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:36:09.871775Z - job completed in 2.43 seconds (40dc57a7b21ad7b87cde023286961b70118e638020ce5db17d81661526ce097f)
2022-09-28T16:38:01.994514Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1128"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3a153b88c7ce4e177bd8267ef7ad93f95ee8e824d5c7b75b740b3d9a7ee6768a)
2022-09-28T16:38:04.831963Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:38:04.848743Z - running sql script pg/insert_tenders.sql
2022-09-28T16:38:04.848770Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:38:04.852963Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:38:04.854290Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:38:04.858102Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:38:04.861869Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:38:04.866267Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:38:04.867285Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:38:04.914956Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:38:04.945735Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:38:04.949675Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:38:04.951124Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:38:05.187665Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:38:05.286831Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:38:05.292822Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:38:05.513155Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:38:05.693820Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:38:05.698868Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:38:05.699784Z - job completed in 3.71 seconds (3a153b88c7ce4e177bd8267ef7ad93f95ee8e824d5c7b75b740b3d9a7ee6768a)
2022-09-28T16:38:05.767180Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1118"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (8bd53c5bafe9b1a20df99530ed6c5a64e11f6702d703565cb63b9bebf5bd93ac)
2022-09-28T16:38:11.835943Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:38:11.853416Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T16:38:11.853459Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:38:11.858830Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T16:38:11.863896Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T16:38:11.868392Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T16:38:11.869574Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T16:38:11.873646Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T16:38:11.877496Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T16:38:11.881431Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:38:11.882700Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T16:38:11.883635Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T16:38:11.889838Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T16:38:11.896427Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T16:38:11.900890Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T16:38:11.906805Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T16:38:11.910510Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T16:38:11.915073Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T16:38:11.921487Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T16:38:13.095839Z - called http://score/api/keyed and received back 200
2022-09-28T16:38:13.096996Z - job completed in 7.33 seconds (8bd53c5bafe9b1a20df99530ed6c5a64e11f6702d703565cb63b9bebf5bd93ac)
2022-09-28T16:38:13.174302Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1128"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (20ed9f6aec354396deb71ba3fe651d1b176d77d02bbc18501482b85158156124)
2022-09-28T16:38:15.188858Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:38:15.205651Z - running sql script pg/upsert_orders.sql
2022-09-28T16:38:15.205683Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:38:15.210371Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:38:15.216122Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:38:15.217856Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:38:15.221939Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:38:15.226249Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:38:15.230762Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:38:15.231744Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:38:15.232606Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:38:15.238743Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:38:15.302455Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:38:15.326084Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:38:15.331888Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:38:15.338368Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:38:15.401973Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:38:15.409840Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:38:15.410118Z - job completed in 2.24 seconds (20ed9f6aec354396deb71ba3fe651d1b176d77d02bbc18501482b85158156124)
2022-09-28T16:40:02.811414Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1130"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (dcc098e5e1c6c7cf229275d017b663853e3bcaf39fb795595f97acfb3016dc0e)
2022-09-28T16:40:05.277288Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:40:05.295258Z - running sql script pg/upsert_orders.sql
2022-09-28T16:40:05.295422Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:40:05.300325Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:40:05.305664Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:40:05.306750Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:40:05.310677Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:40:05.314695Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:40:05.318838Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:40:05.319778Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:40:05.320578Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:40:05.327608Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:40:05.369032Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:40:05.379139Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:40:05.383093Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:40:05.389641Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:40:05.452673Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:40:05.462294Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:40:05.462569Z - job completed in 2.65 seconds (dcc098e5e1c6c7cf229275d017b663853e3bcaf39fb795595f97acfb3016dc0e)
2022-09-28T16:40:05.513765Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1130"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (95aa84c28211376fb5656b356c3aab08a7ab4feb3e36c3048e5edcd426a82009)
2022-09-28T16:40:06.963237Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:40:06.981671Z - running sql script pg/insert_tenders.sql
2022-09-28T16:40:06.981736Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:40:06.989923Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:40:06.992462Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:40:06.996601Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:40:07.000308Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:40:07.005184Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:40:07.006103Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:40:07.052981Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:40:07.083699Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:40:07.095662Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:40:07.097008Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:40:07.328873Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:40:07.426592Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:40:07.431791Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:40:07.654674Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:40:07.836350Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:40:07.841831Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:40:07.842134Z - job completed in 2.33 seconds (95aa84c28211376fb5656b356c3aab08a7ab4feb3e36c3048e5edcd426a82009)
2022-09-28T16:42:01.910597Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1132"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d5a20fde6bbca0a4fb4cd33e6feb1f2c4fb518a31822bc3ff90ddc91d7125d1b)
2022-09-28T16:42:03.649598Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:42:03.667706Z - running sql script pg/upsert_orders.sql
2022-09-28T16:42:03.667736Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:42:03.673219Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:42:03.678056Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:42:03.679512Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:42:03.683840Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:42:03.688322Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:42:03.692619Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:42:03.693659Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:42:03.694643Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:42:03.700551Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:42:03.738707Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:42:03.748756Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:42:03.753168Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:42:03.759551Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:42:03.823990Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:42:03.833418Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:42:03.833942Z - job completed in 1.92 seconds (d5a20fde6bbca0a4fb4cd33e6feb1f2c4fb518a31822bc3ff90ddc91d7125d1b)
2022-09-28T16:42:03.912740Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1132"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e6a92ce8c3e00c164d368c0f0d858c2115a9b5ad790d1a3dc5491a11e216ed47)
2022-09-28T16:42:05.196329Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:42:05.215996Z - running sql script pg/insert_tenders.sql
2022-09-28T16:42:05.216028Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:42:05.220481Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:42:05.222057Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:42:05.226439Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:42:05.231445Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:42:05.236723Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:42:05.237832Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:42:05.285787Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:42:05.421658Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:42:05.426013Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:42:05.427637Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:42:05.682382Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:42:05.785404Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:42:05.794481Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:42:06.016407Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:42:06.199846Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:42:06.205289Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:42:06.205728Z - job completed in 2.29 seconds (e6a92ce8c3e00c164d368c0f0d858c2115a9b5ad790d1a3dc5491a11e216ed47)
2022-09-28T16:44:02.026083Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1134"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4756bdc9c7fa6a38f02d090c076c0529ca18d09dc4f96afa831a6196fdcafa1f)
2022-09-28T16:44:03.450136Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:44:03.466548Z - running sql script pg/insert_tenders.sql
2022-09-28T16:44:03.466590Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:44:03.471586Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:44:03.472887Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:44:03.477138Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:44:03.481348Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:44:03.486365Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:44:03.487393Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:44:03.553208Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:44:03.709985Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:44:03.719940Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:44:03.721700Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:44:03.925477Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:44:04.015516Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:44:04.022543Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:44:04.262117Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:44:04.445517Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:44:04.450508Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:44:04.451020Z - job completed in 2.42 seconds (4756bdc9c7fa6a38f02d090c076c0529ca18d09dc4f96afa831a6196fdcafa1f)
2022-09-28T16:44:04.469797Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1134"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (39d330f409f40afe2b047517ce9e13fa104f99de07e41dab6c733a340f6857a8)
2022-09-28T16:44:08.904717Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:44:08.922945Z - running sql script pg/upsert_orders.sql
2022-09-28T16:44:08.923045Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:44:08.927848Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:44:08.932216Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:44:08.933064Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:44:08.936951Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:44:08.941484Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:44:08.946036Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:44:08.947893Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:44:08.948729Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:44:08.954800Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:44:09.018313Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:44:09.053757Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:44:09.058434Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:44:09.065961Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:44:09.129793Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:44:09.139210Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:44:09.139680Z - job completed in 4.67 seconds (39d330f409f40afe2b047517ce9e13fa104f99de07e41dab6c733a340f6857a8)
2022-09-28T16:46:02.092790Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1136"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e40234106f9b2bc306923a09a70d639ee29fa750afd328aceab9dd2d888fde7b)
2022-09-28T16:46:04.956082Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:46:04.975864Z - running sql script pg/upsert_orders.sql
2022-09-28T16:46:04.975902Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:46:04.984357Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:46:04.988981Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:46:04.990013Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:46:04.993937Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:46:04.998581Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:46:05.002917Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:46:05.004139Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:46:05.005214Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:46:05.011603Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:46:05.112552Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:46:05.151938Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:46:05.155850Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:46:05.171482Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:46:05.241382Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:46:05.263098Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:46:05.263989Z - job completed in 3.17 seconds (e40234106f9b2bc306923a09a70d639ee29fa750afd328aceab9dd2d888fde7b)
2022-09-28T16:46:05.368922Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1136"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f6170d35e70fd5cd725865237ca3b7f1c2cd0005e33fee36a49d6cc20f3cc1cc)
2022-09-28T16:46:06.845292Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:46:06.861346Z - running sql script pg/insert_tenders.sql
2022-09-28T16:46:06.861377Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:46:06.866504Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:46:06.868079Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:46:06.873491Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:46:06.878502Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:46:06.883849Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:46:06.884870Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:46:06.932353Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:46:06.972446Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:46:06.980419Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:46:06.981910Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:46:07.222332Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:46:07.327600Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:46:07.339812Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:46:07.568646Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:46:07.766067Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:46:07.772442Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:46:07.774458Z - job completed in 2.41 seconds (f6170d35e70fd5cd725865237ca3b7f1c2cd0005e33fee36a49d6cc20f3cc1cc)
2022-09-28T16:48:02.062315Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1138"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (47c2ff47551b08fc77e6a09acf2e39ae0efe719951bb78c8d8363b593bb560ab)
2022-09-28T16:48:03.488106Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:48:03.504764Z - running sql script pg/insert_tenders.sql
2022-09-28T16:48:03.504820Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:48:03.510184Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:48:03.511697Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:48:03.516066Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:48:03.520334Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:48:03.525564Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:48:03.526835Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:48:03.584363Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:48:03.659745Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:48:03.663836Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:48:03.665409Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:48:03.910512Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:48:04.014827Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:48:04.022065Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:48:04.251933Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:48:04.447512Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:48:04.452802Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:48:04.453331Z - job completed in 2.39 seconds (47c2ff47551b08fc77e6a09acf2e39ae0efe719951bb78c8d8363b593bb560ab)
2022-09-28T16:48:04.515958Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1128"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (fe883990d719871f5d7f4c1d3c9e8c415541967aa666221314fbe49fdb93dee5)
2022-09-28T16:48:11.461454Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:48:11.479001Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T16:48:11.479031Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:48:11.483644Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T16:48:11.488563Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T16:48:11.492376Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T16:48:11.493689Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T16:48:11.503592Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T16:48:11.508228Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T16:48:11.512639Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:48:11.514034Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T16:48:11.515004Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T16:48:11.521897Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T16:48:11.527483Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T16:48:11.531693Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T16:48:11.546133Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T16:48:11.550434Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T16:48:11.554953Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T16:48:11.560766Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T16:48:12.184564Z - called http://score/api/keyed and received back 200
2022-09-28T16:48:12.184643Z - job completed in 7.67 seconds (fe883990d719871f5d7f4c1d3c9e8c415541967aa666221314fbe49fdb93dee5)
2022-09-28T16:48:12.199334Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1138"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ca037b472b1d99732e3634a2f250aedbb18dd6b1860ad60c34abc003e3a285ea)
2022-09-28T16:48:14.467506Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:48:14.485451Z - running sql script pg/upsert_orders.sql
2022-09-28T16:48:14.485503Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:48:14.490880Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:48:14.495732Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:48:14.497165Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:48:14.501455Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:48:14.505865Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:48:14.510190Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:48:14.511429Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:48:14.512573Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:48:14.521305Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:48:14.679269Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:48:14.706645Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:48:14.710768Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:48:14.718949Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:48:14.792794Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:48:14.806904Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:48:14.807151Z - job completed in 2.61 seconds (ca037b472b1d99732e3634a2f250aedbb18dd6b1860ad60c34abc003e3a285ea)
2022-09-28T16:50:02.732747Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1140"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a79a1c7d1f299521a559a7d125619df07a8142a690aef727b50a88c39415c25e)
2022-09-28T16:50:04.182635Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:50:04.199300Z - running sql script pg/insert_tenders.sql
2022-09-28T16:50:04.199332Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:50:04.204185Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:50:04.205585Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:50:04.209873Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:50:04.214009Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:50:04.218700Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:50:04.219584Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:50:04.266713Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:50:04.314709Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:50:04.319655Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:50:04.321141Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:50:04.561530Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:50:04.666568Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:50:04.675709Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:50:04.906889Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:50:05.100180Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:50:05.105488Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:50:05.105726Z - job completed in 2.37 seconds (a79a1c7d1f299521a559a7d125619df07a8142a690aef727b50a88c39415c25e)
2022-09-28T16:50:05.155394Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1140"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (987c761530e8ddc571e18ec9b8d48a383c08a822950ae781c6d20715fd761d55)
2022-09-28T16:50:07.541346Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:50:07.557256Z - running sql script pg/upsert_orders.sql
2022-09-28T16:50:07.557291Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:50:07.561555Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:50:07.566257Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:50:07.567768Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:50:07.573011Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:50:07.577421Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:50:07.581445Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:50:07.582386Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:50:07.583296Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:50:07.589580Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:50:07.734991Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:50:07.765614Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:50:07.769161Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:50:07.776444Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:50:07.840002Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:50:07.848203Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:50:07.848630Z - job completed in 2.69 seconds (987c761530e8ddc571e18ec9b8d48a383c08a822950ae781c6d20715fd761d55)
2022-09-28T16:52:01.972695Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1142"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (61fa530b0a9157811e90c503eca406dc140ae333cc2b38b59cc40d3701a802ba)
2022-09-28T16:52:03.124577Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:52:03.140625Z - running sql script pg/insert_tenders.sql
2022-09-28T16:52:03.140669Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:52:03.145569Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:52:03.147040Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:52:03.151465Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:52:03.155395Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:52:03.162159Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:52:03.163158Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:52:03.210202Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:52:03.246245Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:52:03.251250Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:52:03.252821Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:52:03.495163Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:52:03.601309Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:52:03.611414Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:52:03.883703Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:52:04.074174Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:52:04.079222Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:52:04.079668Z - job completed in 2.11 seconds (61fa530b0a9157811e90c503eca406dc140ae333cc2b38b59cc40d3701a802ba)
2022-09-28T16:52:04.099688Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1142"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8ed9d41076b29c6d5a5b195d11fcd608dd9eba8028c4d2d6bebe813a458601d1)
2022-09-28T16:52:05.993734Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:52:06.010118Z - running sql script pg/upsert_orders.sql
2022-09-28T16:52:06.010159Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:52:06.014661Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:52:06.019212Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:52:06.020085Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:52:06.024148Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:52:06.029036Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:52:06.033123Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:52:06.034162Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:52:06.035092Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:52:06.041740Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:52:06.197630Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:52:06.228324Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:52:06.232195Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:52:06.238170Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:52:06.302030Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:52:06.310165Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:52:06.310535Z - job completed in 2.21 seconds (8ed9d41076b29c6d5a5b195d11fcd608dd9eba8028c4d2d6bebe813a458601d1)
2022-09-28T16:54:01.941396Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1144"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (24b3579775db0239fc5a1dcdc7b8e053d2af26cc46b137a2d6aa93e5f0ffcaa2)
2022-09-28T16:54:04.426289Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:54:04.443461Z - running sql script pg/upsert_orders.sql
2022-09-28T16:54:04.443972Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:54:04.448507Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:54:04.453366Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:54:04.454852Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:54:04.458865Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:54:04.463480Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:54:04.470098Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:54:04.471564Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:54:04.472836Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:54:04.479573Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:54:04.633366Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:54:04.664447Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:54:04.669055Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:54:04.675020Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:54:04.737846Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:54:04.747880Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:54:04.748261Z - job completed in 2.81 seconds (24b3579775db0239fc5a1dcdc7b8e053d2af26cc46b137a2d6aa93e5f0ffcaa2)
2022-09-28T16:54:04.784889Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1144"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9bb62ae1437dd7a8278110ad793f42518d03ea1c644fe28f325aea6fa65c672b)
2022-09-28T16:54:05.905700Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:54:05.922849Z - running sql script pg/insert_tenders.sql
2022-09-28T16:54:05.922908Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:54:05.927274Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:54:05.928550Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:54:05.933039Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:54:05.936977Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:54:05.941241Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:54:05.942223Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:54:05.987714Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:54:06.022787Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:54:06.026804Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:54:06.028194Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:54:06.227633Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:54:06.314881Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:54:06.321003Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:54:06.547059Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:54:06.739091Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:54:06.744486Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:54:06.744861Z - job completed in 1.96 seconds (9bb62ae1437dd7a8278110ad793f42518d03ea1c644fe28f325aea6fa65c672b)
2022-09-28T16:56:02.032082Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1146"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d7a0fa37deb17a122c6f9d136e695f5a2ab363d315cb8a9c752bd924dc691e87)
2022-09-28T16:56:03.256084Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:56:03.274990Z - running sql script pg/insert_tenders.sql
2022-09-28T16:56:03.275022Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:56:03.279745Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:56:03.281121Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:56:03.285528Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:56:03.290182Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:56:03.295043Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:56:03.296055Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:56:03.343663Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:56:03.368167Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:56:03.371992Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:56:03.373439Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:56:03.605222Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:56:03.708182Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:56:03.717704Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:56:03.977756Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:56:04.164498Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:56:04.169372Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:56:04.169893Z - job completed in 2.14 seconds (d7a0fa37deb17a122c6f9d136e695f5a2ab363d315cb8a9c752bd924dc691e87)
2022-09-28T16:56:04.207704Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1146"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (434c6d0601af717d08d790cf3e6189c1d80f078b40e8ee2cbe708e524bea7e5e)
2022-09-28T16:56:06.273263Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:56:06.289689Z - running sql script pg/upsert_orders.sql
2022-09-28T16:56:06.289729Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:56:06.293993Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:56:06.298507Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:56:06.299469Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:56:06.303393Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:56:06.307562Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:56:06.311441Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:56:06.312429Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:56:06.313344Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:56:06.319636Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:56:06.415896Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:56:06.435076Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:56:06.439267Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:56:06.448097Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:56:06.511848Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:56:06.521819Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:56:06.522239Z - job completed in 2.32 seconds (434c6d0601af717d08d790cf3e6189c1d80f078b40e8ee2cbe708e524bea7e5e)
2022-09-28T16:58:02.124594Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1148"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e31012b888b0736764d994ed4bbab9dd27a837f703089680324de9fc5e94fa59)
2022-09-28T16:58:04.687848Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:58:04.703749Z - running sql script pg/upsert_orders.sql
2022-09-28T16:58:04.703791Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:58:04.710011Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T16:58:04.716851Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T16:58:04.717934Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T16:58:04.722248Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T16:58:04.726396Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T16:58:04.731680Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:58:04.732765Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T16:58:04.733606Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T16:58:04.739694Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T16:58:04.832990Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T16:58:04.864743Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T16:58:04.868869Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T16:58:04.875279Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T16:58:04.940038Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T16:58:04.949009Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T16:58:04.949259Z - job completed in 2.83 seconds (e31012b888b0736764d994ed4bbab9dd27a837f703089680324de9fc5e94fa59)
2022-09-28T16:58:05.041050Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1138"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (9790cb4ccb21d806e72c89bb50d9c6f908a3fd721d6b7c51e671d8531720634f)
2022-09-28T16:58:12.712949Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:58:12.763988Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T16:58:12.764704Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T16:58:12.774751Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T16:58:12.783614Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T16:58:12.795587Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T16:58:12.803701Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T16:58:12.810857Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T16:58:12.848642Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T16:58:12.865541Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T16:58:12.890204Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T16:58:12.892838Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T16:58:12.908338Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T16:58:12.914295Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T16:58:12.917603Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T16:58:12.926313Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T16:58:12.931810Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T16:58:12.956182Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T16:58:12.963653Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T16:58:13.725403Z - called http://score/api/keyed and received back 200
2022-09-28T16:58:13.725488Z - job completed in 8.68 seconds (9790cb4ccb21d806e72c89bb50d9c6f908a3fd721d6b7c51e671d8531720634f)
2022-09-28T16:58:13.823382Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1148"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (953d17220a3925651e0665e1b225e6e5c74875d834d1c7ac4bbc512ee83d2c33)
2022-09-28T16:58:15.048348Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T16:58:15.065824Z - running sql script pg/insert_tenders.sql
2022-09-28T16:58:15.065868Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T16:58:15.070309Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T16:58:15.071624Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T16:58:15.075681Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T16:58:15.079822Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T16:58:15.084502Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T16:58:15.085642Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T16:58:15.131588Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T16:58:15.157170Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T16:58:15.161303Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T16:58:15.162775Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T16:58:15.395281Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T16:58:15.495976Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T16:58:15.502035Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T16:58:15.730119Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T16:58:15.918498Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T16:58:15.923378Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T16:58:15.923841Z - job completed in 2.10 seconds (953d17220a3925651e0665e1b225e6e5c74875d834d1c7ac4bbc512ee83d2c33)
2022-09-28T17:00:02.942256Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1150"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0009d9db7421b8da70a39a63c242231e7d15982cf68a095e74c7bb5e59a479d3)
2022-09-28T17:00:06.207841Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:00:06.223661Z - running sql script pg/upsert_orders.sql
2022-09-28T17:00:06.223693Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:00:06.227997Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:00:06.232349Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:00:06.233406Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:00:06.237532Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:00:06.241771Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:00:06.246086Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:00:06.247171Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:00:06.248190Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:00:06.254056Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:00:06.326964Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:00:06.354637Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:00:06.359176Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:00:06.366633Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:00:06.430072Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:00:06.440711Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:00:06.441330Z - job completed in 3.50 seconds (0009d9db7421b8da70a39a63c242231e7d15982cf68a095e74c7bb5e59a479d3)
2022-09-28T17:00:06.474380Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1150"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1d78f947944b2eb78206751ada9cb6c11094ff9280b77db749d65241f55ec7bc)
2022-09-28T17:00:07.525874Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:00:07.543555Z - running sql script pg/insert_tenders.sql
2022-09-28T17:00:07.543587Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:00:07.548499Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:00:07.550302Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:00:07.554294Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:00:07.558144Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:00:07.563863Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:00:07.564816Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:00:07.615306Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:00:07.653217Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:00:07.657285Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:00:07.658937Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:00:07.894679Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:00:07.996719Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:00:08.002302Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:00:08.227646Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:00:08.412033Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:00:08.418539Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:00:08.419224Z - job completed in 1.95 seconds (1d78f947944b2eb78206751ada9cb6c11094ff9280b77db749d65241f55ec7bc)
2022-09-28T17:02:01.987690Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1152"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (911107aeb71c3c4f0e7189e2e0caeb8fcfb31e4a12b79677d7eae227fab7ef6c)
2022-09-28T17:02:04.312420Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:02:04.328215Z - running sql script pg/upsert_orders.sql
2022-09-28T17:02:04.328311Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:02:04.333253Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:02:04.338895Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:02:04.340043Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:02:04.344404Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:02:04.348848Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:02:04.353222Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:02:04.354614Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:02:04.356154Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:02:04.363347Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:02:04.440462Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:02:04.481574Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:02:04.485517Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:02:04.494375Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:02:04.564558Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:02:04.584467Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:02:04.585037Z - job completed in 2.60 seconds (911107aeb71c3c4f0e7189e2e0caeb8fcfb31e4a12b79677d7eae227fab7ef6c)
2022-09-28T17:02:04.692033Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1152"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b84b1e0298ad7f421ca3686f47ec1046a7eeb2bfbf2c8cc2aeeacc812b35c770)
2022-09-28T17:02:05.906920Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:02:05.924116Z - running sql script pg/insert_tenders.sql
2022-09-28T17:02:05.924153Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:02:05.928724Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:02:05.930055Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:02:05.934074Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:02:05.937846Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:02:05.942029Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:02:05.943240Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:02:05.991002Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:02:06.011708Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:02:06.015234Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:02:06.016656Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:02:06.246092Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:02:06.343931Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:02:06.350009Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:02:06.571053Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:02:06.756003Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:02:06.760821Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:02:06.761279Z - job completed in 2.07 seconds (b84b1e0298ad7f421ca3686f47ec1046a7eeb2bfbf2c8cc2aeeacc812b35c770)
2022-09-28T17:04:02.139477Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1154"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dcd58b4f8e40fb017d1e2df1556f110a6c4466dd0f3dd8de97bd208f27660f5d)
2022-09-28T17:04:06.216986Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:04:06.232983Z - running sql script pg/insert_tenders.sql
2022-09-28T17:04:06.233232Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:04:06.237367Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:04:06.238560Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:04:06.242135Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:04:06.246545Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:04:06.251174Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:04:06.252104Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:04:06.297993Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:04:06.361633Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:04:06.365464Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:04:06.368726Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:04:06.485567Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:04:06.564826Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:04:06.570451Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:04:06.818174Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:04:07.002782Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:04:07.008575Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:04:07.009196Z - job completed in 4.87 seconds (dcd58b4f8e40fb017d1e2df1556f110a6c4466dd0f3dd8de97bd208f27660f5d)
2022-09-28T17:04:07.111664Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1154"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b881eea7fd50915bd86bfd761a05930fcccb73819c42c986d27587444215f389)
2022-09-28T17:04:09.705688Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:04:09.723198Z - running sql script pg/upsert_orders.sql
2022-09-28T17:04:09.723240Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:04:09.727904Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:04:09.732556Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:04:09.733874Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:04:09.738006Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:04:09.739728Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:04:09.744669Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:04:09.747620Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:04:09.748986Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:04:09.755332Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:04:09.856652Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:04:09.900054Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:04:09.904066Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:04:09.915339Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:04:09.987443Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:04:09.996664Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:04:09.997263Z - job completed in 2.89 seconds (b881eea7fd50915bd86bfd761a05930fcccb73819c42c986d27587444215f389)
2022-09-28T17:06:02.293397Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1156"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a602503d4dcbfe5a501c27489eb23fc74c47be8c088d0968280f232356717135)
2022-09-28T17:06:03.873925Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:06:03.891133Z - running sql script pg/insert_tenders.sql
2022-09-28T17:06:03.891489Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:06:03.896501Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:06:03.898157Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:06:03.902056Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:06:03.905763Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:06:03.910153Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:06:03.912457Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:06:03.982951Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:06:03.994396Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:06:03.995322Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:06:03.996715Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:06:04.215344Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:06:04.304412Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:06:04.316100Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:06:04.558698Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:06:04.760236Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:06:04.765016Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:06:04.765539Z - job completed in 2.47 seconds (a602503d4dcbfe5a501c27489eb23fc74c47be8c088d0968280f232356717135)
2022-09-28T17:06:04.796766Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1156"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (13d6558cc3f622479645ba9658b5b26be6f61de0641852268310373df9ef0dde)
2022-09-28T17:06:09.091352Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:06:09.106799Z - running sql script pg/upsert_orders.sql
2022-09-28T17:06:09.106831Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:06:09.113316Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:06:09.118108Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:06:09.118949Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:06:09.122760Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:06:09.124166Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:06:09.129910Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:06:09.131644Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:06:09.132754Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:06:09.139429Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:06:09.274144Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:06:09.307387Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:06:09.313209Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:06:09.332396Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:06:09.402125Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:06:09.419701Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:06:09.420222Z - job completed in 4.62 seconds (13d6558cc3f622479645ba9658b5b26be6f61de0641852268310373df9ef0dde)
2022-09-28T17:08:02.146849Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1158"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (332fa7fabe7a54975ec1a646065d94507819f53772c5c381fdb185dc936de321)
2022-09-28T17:08:05.056884Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:08:05.076943Z - running sql script pg/upsert_orders.sql
2022-09-28T17:08:05.077285Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:08:05.082790Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:08:05.087763Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:08:05.088979Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:08:05.093514Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:08:05.099489Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:08:05.106271Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:08:05.108867Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:08:05.110020Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:08:05.116443Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:08:05.260967Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:08:05.294086Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:08:05.298614Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:08:05.308924Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:08:05.374445Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:08:05.384517Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:08:05.385005Z - job completed in 3.24 seconds (332fa7fabe7a54975ec1a646065d94507819f53772c5c381fdb185dc936de321)
2022-09-28T17:08:05.496161Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1158"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3cf1224e7f191613a896354e90638eb0e7e6ed2a06b2e1363acc8859c4ce3899)
2022-09-28T17:08:07.394872Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:08:07.412334Z - running sql script pg/insert_tenders.sql
2022-09-28T17:08:07.412365Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:08:07.419874Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:08:07.421256Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:08:07.426191Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:08:07.430579Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:08:07.435355Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:08:07.436400Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:08:07.482906Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:08:07.539967Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:08:07.543819Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:08:07.545320Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:08:07.750119Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:08:07.838696Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:08:07.845824Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:08:08.089483Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:08:08.309888Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:08:08.318210Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:08:08.318551Z - job completed in 2.82 seconds (3cf1224e7f191613a896354e90638eb0e7e6ed2a06b2e1363acc8859c4ce3899)
2022-09-28T17:08:08.430934Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1148"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (5806f886925466bad1f9c4571ed78c6dbd559a9aaa524d4a0388a9ae395294b0)
2022-09-28T17:08:15.486329Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:08:15.518514Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T17:08:15.518802Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:08:15.524201Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T17:08:15.532613Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T17:08:15.536722Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T17:08:15.537971Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T17:08:15.542273Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T17:08:15.546558Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T17:08:15.547710Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:08:15.554963Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T17:08:15.555924Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T17:08:15.575642Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T17:08:15.580582Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T17:08:15.581982Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T17:08:15.590479Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T17:08:15.594175Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T17:08:15.599611Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T17:08:15.605036Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T17:08:16.539743Z - called http://score/api/keyed and received back 200
2022-09-28T17:08:16.539872Z - job completed in 8.11 seconds (5806f886925466bad1f9c4571ed78c6dbd559a9aaa524d4a0388a9ae395294b0)
2022-09-28T17:10:02.439737Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1200"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2ab76474e5062c9cad880cc19ac0dd5c223cd124809b9400fa704324c23a3940)
2022-09-28T17:10:03.794658Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:10:03.810983Z - running sql script pg/insert_tenders.sql
2022-09-28T17:10:03.811011Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:10:03.815936Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:10:03.817332Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:10:03.823114Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:10:03.827575Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:10:03.832736Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:10:03.833671Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:10:03.884155Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:10:03.944258Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:10:03.948245Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:10:03.950100Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:10:04.189205Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:10:04.279120Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:10:04.285642Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:10:04.526715Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:10:04.723918Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:10:04.729048Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:10:04.729724Z - job completed in 2.29 seconds (2ab76474e5062c9cad880cc19ac0dd5c223cd124809b9400fa704324c23a3940)
2022-09-28T17:10:04.748860Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1200"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (012d81d7fbe4b1a5e565378ded654d09fa26774e08fd45db8f229d95967b4e5e)
2022-09-28T17:10:09.618045Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:10:09.636857Z - running sql script pg/upsert_orders.sql
2022-09-28T17:10:09.636887Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:10:09.641269Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:10:09.645991Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:10:09.646902Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:10:09.651205Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:10:09.652999Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:10:09.658336Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:10:09.659433Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:10:09.660289Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:10:09.667202Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:10:09.814222Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:10:09.841975Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:10:09.845937Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:10:09.852940Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:10:09.921440Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:10:09.932238Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:10:09.932624Z - job completed in 5.18 seconds (012d81d7fbe4b1a5e565378ded654d09fa26774e08fd45db8f229d95967b4e5e)
2022-09-28T17:12:02.167356Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1202"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ae37dc6673b17abae8f24632ec9137917188c92effce25722b746d52cc7c84b1)
2022-09-28T17:12:04.406272Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:12:04.435073Z - running sql script pg/insert_tenders.sql
2022-09-28T17:12:04.435687Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:12:04.441139Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:12:04.443192Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:12:04.447617Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:12:04.452574Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:12:04.457430Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:12:04.458516Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:12:04.506949Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:12:04.537967Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:12:04.547027Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:12:04.548911Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:12:04.753912Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:12:04.844081Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:12:04.851340Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:12:05.091309Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:12:05.285762Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:12:05.291255Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:12:05.291656Z - job completed in 3.12 seconds (ae37dc6673b17abae8f24632ec9137917188c92effce25722b746d52cc7c84b1)
2022-09-28T17:12:05.392298Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1202"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8d36f487b6b2bcfae60f66835e66816dbd2cce50c403184fc21ffc7b29b0f82a)
2022-09-28T17:12:10.356621Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:12:10.373174Z - running sql script pg/upsert_orders.sql
2022-09-28T17:12:10.373206Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:12:10.379624Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:12:10.385860Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:12:10.386894Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:12:10.391096Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:12:10.392589Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:12:10.397156Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:12:10.398044Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:12:10.399100Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:12:10.405662Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:12:10.546741Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:12:10.574565Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:12:10.578707Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:12:10.588169Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:12:10.654509Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:12:10.665211Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:12:10.665650Z - job completed in 5.27 seconds (8d36f487b6b2bcfae60f66835e66816dbd2cce50c403184fc21ffc7b29b0f82a)
2022-09-28T17:14:02.347754Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1204"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (19c4c1e67cecbc0e440f00aa1b6b0d16721756b08e70c8369f4e32348cbfc076)
2022-09-28T17:14:07.921463Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:14:07.939452Z - running sql script pg/upsert_orders.sql
2022-09-28T17:14:07.939479Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:14:07.945084Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:14:07.950139Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:14:07.951301Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:14:07.956738Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:14:07.958177Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:14:07.962288Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:14:07.963321Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:14:07.964266Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:14:07.970518Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:14:08.089421Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:14:08.151042Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:14:08.154392Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:14:08.160105Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:14:08.228339Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:14:08.237427Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:14:08.237942Z - job completed in 5.89 seconds (19c4c1e67cecbc0e440f00aa1b6b0d16721756b08e70c8369f4e32348cbfc076)
2022-09-28T17:14:08.343380Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1204"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (627c1535597e17127a7ccfcbd3873f7f8be9245436ba3538296d6308bcc80f25)
2022-09-28T17:14:09.804178Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:14:09.821092Z - running sql script pg/insert_tenders.sql
2022-09-28T17:14:09.821305Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:14:09.825932Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:14:09.827426Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:14:09.834096Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:14:09.838367Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:14:09.843589Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:14:09.844947Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:14:09.911701Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:14:10.003679Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:14:10.008279Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:14:10.009860Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:14:10.218216Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:14:10.309120Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:14:10.315738Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:14:10.557564Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:14:10.815807Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:14:10.821404Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:14:10.821832Z - job completed in 2.48 seconds (627c1535597e17127a7ccfcbd3873f7f8be9245436ba3538296d6308bcc80f25)
2022-09-28T17:16:02.177046Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1206"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ead5c81ab264ac943062fd6365530a1a3a7f099dc455f16210e709d6d5c4d04f)
2022-09-28T17:16:05.131150Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:16:05.151525Z - running sql script pg/upsert_orders.sql
2022-09-28T17:16:05.152006Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:16:05.156918Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:16:05.162287Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:16:05.163711Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:16:05.168015Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:16:05.169970Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:16:05.174311Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:16:05.175550Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:16:05.176807Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:16:05.183397Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:16:05.302169Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:16:05.351979Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:16:05.355968Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:16:05.367824Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:16:05.441271Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:16:05.456394Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:16:05.456857Z - job completed in 3.28 seconds (ead5c81ab264ac943062fd6365530a1a3a7f099dc455f16210e709d6d5c4d04f)
2022-09-28T17:16:05.517569Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1206"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5b1564554f2544009fcdf6904fc3b7c896220a225c46c10fca9b5738cd3a2896)
2022-09-28T17:16:06.861793Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:16:06.884364Z - running sql script pg/insert_tenders.sql
2022-09-28T17:16:06.884411Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:16:06.888637Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:16:06.889908Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:16:06.894435Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:16:06.898488Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:16:06.903044Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:16:06.903977Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:16:06.953312Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:16:06.997076Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:16:07.001074Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:16:07.002942Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:16:07.210421Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:16:07.300845Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:16:07.311353Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:16:07.554474Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:16:07.751678Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:16:07.756643Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:16:07.757046Z - job completed in 2.24 seconds (5b1564554f2544009fcdf6904fc3b7c896220a225c46c10fca9b5738cd3a2896)
2022-09-28T17:18:02.110234Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1208"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b43c87e174de82efe43940d370c69a010b211982ef120cc48305785c2f11066b)
2022-09-28T17:18:03.312568Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:18:03.329Z - running sql script pg/insert_tenders.sql
2022-09-28T17:18:03.329030Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:18:03.334401Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:18:03.335994Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:18:03.342180Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:18:03.348524Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:18:03.353428Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:18:03.354496Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:18:03.400271Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:18:03.437841Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:18:03.441511Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:18:03.443202Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:18:03.651040Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:18:03.742824Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:18:03.749540Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:18:03.982228Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:18:04.170612Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:18:04.175242Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:18:04.175739Z - job completed in 2.07 seconds (b43c87e174de82efe43940d370c69a010b211982ef120cc48305785c2f11066b)
2022-09-28T17:18:04.216772Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1208"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b138703213ffdb71da2d28f40df8a16abd47059f944976a4c6459f3cd3d35fa4)
2022-09-28T17:18:06.691964Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:18:06.709470Z - running sql script pg/upsert_orders.sql
2022-09-28T17:18:06.709527Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:18:06.714170Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:18:06.718556Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:18:06.719630Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:18:06.723678Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:18:06.725026Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:18:06.729328Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:18:06.730356Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:18:06.731430Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:18:06.738488Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:18:06.844835Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:18:06.890210Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:18:06.894367Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:18:06.901323Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:18:06.967089Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:18:06.978223Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:18:06.979152Z - job completed in 2.76 seconds (b138703213ffdb71da2d28f40df8a16abd47059f944976a4c6459f3cd3d35fa4)
2022-09-28T17:18:07.074707Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1158"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (21316a74442171bd404b4eca330daee49c0073e0569db71f4f49572e559104c5)
2022-09-28T17:18:12.819502Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:18:12.836206Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T17:18:12.836235Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:18:12.841088Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T17:18:12.847178Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T17:18:12.851427Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T17:18:12.852461Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T17:18:12.856204Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T17:18:12.860405Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T17:18:12.861421Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:18:12.862242Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T17:18:12.863080Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T17:18:12.871869Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T17:18:12.877508Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T17:18:12.879466Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T17:18:12.887842Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T17:18:12.892149Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T17:18:12.896342Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T17:18:12.909311Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T17:18:15.073086Z - called http://score/api/keyed and received back 200
2022-09-28T17:18:15.073257Z - job completed in 8.00 seconds (21316a74442171bd404b4eca330daee49c0073e0569db71f4f49572e559104c5)
2022-09-28T17:20:02.359955Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1210"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (006cb42ffa48330fbd911137dd19e5aec90db8571bc9e1697f29ddf43b0658a3)
2022-09-28T17:20:03.677379Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:20:03.695971Z - running sql script pg/insert_tenders.sql
2022-09-28T17:20:03.696016Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:20:03.700648Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:20:03.702137Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:20:03.706050Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:20:03.710539Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:20:03.715606Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:20:03.717763Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:20:03.766170Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:20:03.805375Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:20:03.810876Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:20:03.812546Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:20:04.025405Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:20:04.116774Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:20:04.122773Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:20:04.390471Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:20:04.584692Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:20:04.592286Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:20:04.592600Z - job completed in 2.23 seconds (006cb42ffa48330fbd911137dd19e5aec90db8571bc9e1697f29ddf43b0658a3)
2022-09-28T17:20:04.617347Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1210"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (eb334bbe167fc52eba99cc40fb5f4daf1499ec4efee4a722f056a51fe444b4e2)
2022-09-28T17:20:06.756530Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:20:06.774389Z - running sql script pg/upsert_orders.sql
2022-09-28T17:20:06.774444Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:20:06.778866Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:20:06.783133Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:20:06.784092Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:20:06.788544Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:20:06.790130Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:20:06.794194Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:20:06.795156Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:20:06.796096Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:20:06.802717Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:20:06.886335Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:20:06.906614Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:20:06.910743Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:20:06.916928Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:20:06.983696Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:20:07.000450Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:20:07.001259Z - job completed in 2.38 seconds (eb334bbe167fc52eba99cc40fb5f4daf1499ec4efee4a722f056a51fe444b4e2)
2022-09-28T17:22:02.083170Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1212"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (23d630d3cf51e4980f595dca774925a39881883061b9b2c3206a37d8a447746a)
2022-09-28T17:22:04.467039Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:22:04.507731Z - running sql script pg/upsert_orders.sql
2022-09-28T17:22:04.507771Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:22:04.512696Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:22:04.517021Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:22:04.518226Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:22:04.523869Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:22:04.532958Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:22:04.538483Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:22:04.539740Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:22:04.541693Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:22:04.549536Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:22:04.635634Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:22:04.650433Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:22:04.657512Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:22:04.667091Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:22:04.735819Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:22:04.745780Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:22:04.746502Z - job completed in 2.66 seconds (23d630d3cf51e4980f595dca774925a39881883061b9b2c3206a37d8a447746a)
2022-09-28T17:22:04.793712Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1212"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f96e6ff5406e8bdcb0cc3a1f6128123fb4df872908c02d1e7bd860d6791f1b3f)
2022-09-28T17:22:05.988267Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:22:06.005241Z - running sql script pg/insert_tenders.sql
2022-09-28T17:22:06.005271Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:22:06.009982Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:22:06.011266Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:22:06.015718Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:22:06.021913Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:22:06.027600Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:22:06.028569Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:22:06.077894Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:22:06.099502Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:22:06.104099Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:22:06.105561Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:22:06.220193Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:22:06.270690Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:22:06.278048Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:22:06.505265Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:22:06.696301Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:22:06.701556Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:22:06.702211Z - job completed in 1.91 seconds (f96e6ff5406e8bdcb0cc3a1f6128123fb4df872908c02d1e7bd860d6791f1b3f)
2022-09-28T17:24:02.193231Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1214"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6231301cfb1d41556f8288b7e65ed47726e663552e3d7c8949403a8c3ccc9abd)
2022-09-28T17:24:03.414341Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:24:03.430402Z - running sql script pg/insert_tenders.sql
2022-09-28T17:24:03.430435Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:24:03.435651Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:24:03.436926Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:24:03.440947Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:24:03.444480Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:24:03.449292Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:24:03.450468Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:24:03.497442Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:24:03.534161Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:24:03.538459Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:24:03.539905Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:24:03.656100Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:24:03.708435Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:24:03.714818Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:24:03.946111Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:24:04.136896Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:24:04.142290Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:24:04.142828Z - job completed in 1.95 seconds (6231301cfb1d41556f8288b7e65ed47726e663552e3d7c8949403a8c3ccc9abd)
2022-09-28T17:24:04.182206Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1214"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (812f6cda0c878d3fad01512d839cc75d5e363701150a5ea2181d7eb1a9ad0921)
2022-09-28T17:24:06.693956Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:24:06.713456Z - running sql script pg/upsert_orders.sql
2022-09-28T17:24:06.713781Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:24:06.718881Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:24:06.727583Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:24:06.728829Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:24:06.732824Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:24:06.737422Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:24:06.741776Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:24:06.743020Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:24:06.744445Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:24:06.755694Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:24:06.822767Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:24:06.844144Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:24:06.845257Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:24:06.851952Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:24:06.916108Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:24:06.927092Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:24:06.927363Z - job completed in 2.75 seconds (812f6cda0c878d3fad01512d839cc75d5e363701150a5ea2181d7eb1a9ad0921)
2022-09-28T17:26:02.219607Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1216"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8f3b7167afc7a73685548e4941c2ffba132e0386bad83bcbfba569a4242f7a9a)
2022-09-28T17:26:03.725882Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:26:03.746704Z - running sql script pg/insert_tenders.sql
2022-09-28T17:26:03.746736Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:26:03.752844Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:26:03.754633Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:26:03.759309Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:26:03.763413Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:26:03.768404Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:26:03.769679Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:26:03.820137Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:26:03.845092Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:26:03.849604Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:26:03.851323Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:26:04.074581Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:26:04.167829Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:26:04.181701Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:26:04.457153Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:26:04.668347Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:26:04.677961Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:26:04.678413Z - job completed in 2.46 seconds (8f3b7167afc7a73685548e4941c2ffba132e0386bad83bcbfba569a4242f7a9a)
2022-09-28T17:26:04.845700Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1216"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8d2c56db26851a4694db8c68103bfaabf28b907a6d896d741c055fc972422cc2)
2022-09-28T17:26:06.993902Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:26:07.012926Z - running sql script pg/upsert_orders.sql
2022-09-28T17:26:07.012969Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:26:07.017432Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:26:07.021820Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:26:07.022762Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:26:07.026498Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:26:07.030512Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:26:07.034496Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:26:07.035413Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:26:07.036171Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:26:07.042333Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:26:07.109854Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:26:07.123069Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:26:07.123927Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:26:07.134173Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:26:07.208217Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:26:07.231014Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:26:07.231961Z - job completed in 2.39 seconds (8d2c56db26851a4694db8c68103bfaabf28b907a6d896d741c055fc972422cc2)
2022-09-28T17:28:02.129839Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1218"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a13a64061d773c994f7d5e7effe8ed0bb46ca4100e7dad86a43a6149afc3b3e5)
2022-09-28T17:28:04.723601Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:28:04.750412Z - running sql script pg/upsert_orders.sql
2022-09-28T17:28:04.750765Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:28:04.755898Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:28:04.761054Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:28:04.762472Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:28:04.766824Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:28:04.773008Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:28:04.775079Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:28:04.776623Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:28:04.777980Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:28:04.788683Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:28:04.848111Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:28:04.869653Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:28:04.871233Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:28:04.879678Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:28:04.948812Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:28:04.959375Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:28:04.959944Z - job completed in 2.83 seconds (a13a64061d773c994f7d5e7effe8ed0bb46ca4100e7dad86a43a6149afc3b3e5)
2022-09-28T17:28:05.060942Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1208"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (915bbd8d84e251e194955575018c491bd8ba80c6d434527d2cb621e121063d60)
2022-09-28T17:28:13.316470Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:28:13.342859Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T17:28:13.342899Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:28:13.348178Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T17:28:13.353960Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T17:28:13.355194Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T17:28:13.356159Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T17:28:13.357142Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T17:28:13.358330Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T17:28:13.359355Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:28:13.360262Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T17:28:13.361176Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T17:28:13.362956Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T17:28:13.364574Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T17:28:13.365684Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T17:28:13.368104Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T17:28:13.369050Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T17:28:13.370614Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T17:28:13.372528Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T17:28:13.454591Z - called http://score/api/keyed and received back 204
2022-09-28T17:28:13.454665Z - job completed in 8.39 seconds (915bbd8d84e251e194955575018c491bd8ba80c6d434527d2cb621e121063d60)
2022-09-28T17:28:13.477639Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1218"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (eb32c6591611ad6b31f84e98347c39021a7cc51c41e9d5b2eb277af017fdc13c)
2022-09-28T17:28:14.685840Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:28:14.703204Z - running sql script pg/insert_tenders.sql
2022-09-28T17:28:14.703235Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:28:14.708626Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:28:14.710545Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:28:14.714765Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:28:14.718790Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:28:14.724097Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:28:14.725198Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:28:14.774449Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:28:14.793624Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:28:14.797712Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:28:14.799392Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:28:15.010338Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:28:15.101504Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:28:15.108790Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:28:15.346977Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:28:15.544185Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:28:15.551943Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:28:15.553049Z - job completed in 2.08 seconds (eb32c6591611ad6b31f84e98347c39021a7cc51c41e9d5b2eb277af017fdc13c)
2022-09-28T17:30:02.330015Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1220"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4f4aa80fc24f2233ac43e273ae4dc48516c517807711e9350e7a935255cb4320)
2022-09-28T17:30:05.755770Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:30:05.798670Z - running sql script pg/upsert_orders.sql
2022-09-28T17:30:05.798724Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:30:05.803927Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:30:05.808503Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:30:05.810513Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:30:05.815458Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:30:05.820085Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:30:05.824450Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:30:05.825785Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:30:05.826756Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:30:05.833031Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:30:05.908907Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:30:05.936831Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:30:05.943172Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:30:05.951420Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:30:06.022364Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:30:06.034669Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:30:06.035348Z - job completed in 3.71 seconds (4f4aa80fc24f2233ac43e273ae4dc48516c517807711e9350e7a935255cb4320)
2022-09-28T17:30:06.115848Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1220"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a05f2279cac6a0ded5abfb89a59b4bd58390d2108b28eb7a6c02ecfdad2d4996)
2022-09-28T17:30:07.504572Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:30:07.524521Z - running sql script pg/insert_tenders.sql
2022-09-28T17:30:07.524554Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:30:07.529197Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:30:07.530649Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:30:07.535031Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:30:07.539107Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:30:07.543784Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:30:07.544765Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:30:07.593206Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:30:07.621543Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:30:07.625554Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:30:07.627047Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:30:07.835375Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:30:07.926297Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:30:07.932646Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:30:08.175327Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:30:08.370589Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:30:08.376275Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:30:08.376683Z - job completed in 2.26 seconds (a05f2279cac6a0ded5abfb89a59b4bd58390d2108b28eb7a6c02ecfdad2d4996)
2022-09-28T17:32:02.072503Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1222"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (68106e8034191eedc2e4a1c40c84ceab0f6dc6ffecde2dba1906d3b9a4807c11)
2022-09-28T17:32:04.242560Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:32:04.267007Z - running sql script pg/upsert_orders.sql
2022-09-28T17:32:04.267043Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:32:04.271670Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:32:04.276125Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:32:04.277405Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:32:04.281421Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:32:04.283203Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:32:04.287695Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:32:04.289071Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:32:04.290237Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:32:04.296563Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:32:04.366830Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:32:04.391380Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:32:04.396831Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:32:04.403387Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:32:04.470595Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:32:04.479354Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:32:04.479770Z - job completed in 2.41 seconds (68106e8034191eedc2e4a1c40c84ceab0f6dc6ffecde2dba1906d3b9a4807c11)
2022-09-28T17:32:04.512159Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1222"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (87b1129837781627cecaf6909d8877d6fa4b16ccdb11e00df236b557c12b91b7)
2022-09-28T17:32:05.899702Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:32:05.915872Z - running sql script pg/insert_tenders.sql
2022-09-28T17:32:05.916137Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:32:05.921664Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:32:05.925052Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:32:05.930485Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:32:05.936203Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:32:05.940645Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:32:05.941732Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:32:05.988213Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:32:06.006185Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:32:06.010422Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:32:06.011826Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:32:06.222143Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:32:06.313363Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:32:06.320260Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:32:06.557188Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:32:06.748854Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:32:06.754415Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:32:06.758775Z - job completed in 2.25 seconds (87b1129837781627cecaf6909d8877d6fa4b16ccdb11e00df236b557c12b91b7)
2022-09-28T17:34:02.504244Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1224"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b308769479f2eb7b51890dc713a2202b5688cad0a66afbc676a2a954027cb763)
2022-09-28T17:34:04.562952Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:34:04.616178Z - running sql script pg/upsert_orders.sql
2022-09-28T17:34:04.616215Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:34:04.621431Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:34:04.625720Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:34:04.626947Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:34:04.636251Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:34:04.640871Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:34:04.645325Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:34:04.646328Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:34:04.647184Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:34:04.653900Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:34:04.736170Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:34:04.758282Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:34:04.762725Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:34:04.769529Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:34:04.838020Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:34:04.845971Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:34:04.846913Z - job completed in 2.34 seconds (b308769479f2eb7b51890dc713a2202b5688cad0a66afbc676a2a954027cb763)
2022-09-28T17:34:04.879016Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1224"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8d017c48b3bea0b270025882dd74caee89e8b8f59f6aac03bccbeebf0dc9dc38)
2022-09-28T17:34:06.327123Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:34:06.344151Z - running sql script pg/insert_tenders.sql
2022-09-28T17:34:06.344251Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:34:06.349341Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:34:06.350519Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:34:06.354686Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:34:06.358570Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:34:06.363221Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:34:06.364149Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:34:06.410878Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:34:06.438870Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:34:06.443133Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:34:06.444722Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:34:06.654863Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:34:06.752212Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:34:06.761990Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:34:07.031960Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:34:07.230693Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:34:07.237942Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:34:07.238554Z - job completed in 2.36 seconds (8d017c48b3bea0b270025882dd74caee89e8b8f59f6aac03bccbeebf0dc9dc38)
2022-09-28T17:36:02.175258Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1226"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a7b713b966b5e55a4064714fa80381cbf2d2a5dea47582d48f910178c85bc512)
2022-09-28T17:36:03.388686Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:36:03.408201Z - running sql script pg/insert_tenders.sql
2022-09-28T17:36:03.408232Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:36:03.413245Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:36:03.414729Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:36:03.419245Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:36:03.423995Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:36:03.430049Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:36:03.430956Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:36:03.482381Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:36:03.490799Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:36:03.495687Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:36:03.498430Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:36:03.751293Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:36:03.849171Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:36:03.861216Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:36:04.101204Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:36:04.300335Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:36:04.306099Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:36:04.306510Z - job completed in 2.13 seconds (a7b713b966b5e55a4064714fa80381cbf2d2a5dea47582d48f910178c85bc512)
2022-09-28T17:36:04.416915Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1226"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5c9e094a8b1510db8ee9d383cf12618777fd0bba06a662bbebb538f2e2bdccda)
2022-09-28T17:36:06.497202Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:36:06.517300Z - running sql script pg/upsert_orders.sql
2022-09-28T17:36:06.517416Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:36:06.522599Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:36:06.526972Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:36:06.528164Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:36:06.532527Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:36:06.536657Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:36:06.541194Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:36:06.542051Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:36:06.542961Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:36:06.548825Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:36:06.644899Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:36:06.671858Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:36:06.675698Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:36:06.685676Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:36:06.753964Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:36:06.769699Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:36:06.770109Z - job completed in 2.35 seconds (5c9e094a8b1510db8ee9d383cf12618777fd0bba06a662bbebb538f2e2bdccda)
2022-09-28T17:38:02.156886Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1228"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fe04d01fb96f3c8e3cc96e50ef94296a569f0b83fc3a9e3be31f3d06ffe2cd65)
2022-09-28T17:38:04.234950Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:38:04.252609Z - running sql script pg/upsert_orders.sql
2022-09-28T17:38:04.252643Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:38:04.258052Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:38:04.263379Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:38:04.264311Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:38:04.268842Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:38:04.273048Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:38:04.277012Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:38:04.278039Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:38:04.279084Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:38:04.285329Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:38:04.372772Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:38:04.397369Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:38:04.401377Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:38:04.407373Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:38:04.472839Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:38:04.480265Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:38:04.480847Z - job completed in 2.32 seconds (fe04d01fb96f3c8e3cc96e50ef94296a569f0b83fc3a9e3be31f3d06ffe2cd65)
2022-09-28T17:38:04.576430Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1228"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (21e32e0578e748ef626517a8c82b922fdbf2e4a9ecb9c60f1d2a5a213ead65fb)
2022-09-28T17:38:05.937308Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:38:05.953435Z - running sql script pg/insert_tenders.sql
2022-09-28T17:38:05.953827Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:38:05.958307Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:38:05.959641Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:38:05.963624Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:38:05.968576Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:38:05.973445Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:38:05.974360Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:38:06.020970Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:38:06.043441Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:38:06.047515Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:38:06.048934Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:38:06.259195Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:38:06.354684Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:38:06.360031Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:38:06.589869Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:38:06.781860Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:38:06.787347Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:38:06.787782Z - job completed in 2.21 seconds (21e32e0578e748ef626517a8c82b922fdbf2e4a9ecb9c60f1d2a5a213ead65fb)
2022-09-28T17:38:06.824889Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1218"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (dfb7ce63c72f9ccdd7dfece5658077067667abb32e7b3c6f95a1becca9a2f019)
2022-09-28T17:38:14.115720Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:38:14.131692Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T17:38:14.131723Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:38:14.136462Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T17:38:14.140754Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T17:38:14.144482Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T17:38:14.145533Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T17:38:14.149357Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T17:38:14.153697Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T17:38:14.154636Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:38:14.155899Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T17:38:14.156818Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T17:38:14.163324Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T17:38:14.168027Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T17:38:14.169055Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T17:38:14.175242Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T17:38:14.180306Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T17:38:14.184515Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T17:38:14.189891Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T17:38:14.814459Z - called http://score/api/keyed and received back 200
2022-09-28T17:38:14.815594Z - job completed in 7.99 seconds (dfb7ce63c72f9ccdd7dfece5658077067667abb32e7b3c6f95a1becca9a2f019)
2022-09-28T17:40:02.152664Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1230"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f7a5fc68c484719442a7adf8bf1e2b8013d6313de1a088c0a8fbd45dda18f1c8)
2022-09-28T17:40:04.042541Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:40:04.061544Z - running sql script pg/insert_tenders.sql
2022-09-28T17:40:04.061671Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:40:04.067343Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:40:04.068926Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:40:04.076164Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:40:04.080940Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:40:04.087330Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:40:04.088236Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:40:04.137756Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:40:04.160882Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:40:04.164666Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:40:04.166275Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:40:04.378289Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:40:04.471414Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:40:04.477557Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:40:04.712392Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:40:04.908371Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:40:04.913528Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:40:04.913781Z - job completed in 2.76 seconds (f7a5fc68c484719442a7adf8bf1e2b8013d6313de1a088c0a8fbd45dda18f1c8)
2022-09-28T17:40:04.958700Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1230"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6c6e648086d3d5d209f8edf7c0742726c079d712829628480a8412c34e3862f9)
2022-09-28T17:40:07.440358Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:40:07.462227Z - running sql script pg/upsert_orders.sql
2022-09-28T17:40:07.462560Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:40:07.468829Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:40:07.475238Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:40:07.476777Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:40:07.483396Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:40:07.487619Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:40:07.492317Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:40:07.493368Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:40:07.494216Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:40:07.500049Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:40:07.577391Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:40:07.595593Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:40:07.599463Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:40:07.607730Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:40:07.678434Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:40:07.695847Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:40:07.696266Z - job completed in 2.74 seconds (6c6e648086d3d5d209f8edf7c0742726c079d712829628480a8412c34e3862f9)
2022-09-28T17:42:02.186555Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1232"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (cd0fd08c7cb2bc59cbcdccf8d2946eef7d8b997cf82458d4bf330759fb68f248)
2022-09-28T17:42:06.914750Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:42:06.930463Z - running sql script pg/insert_tenders.sql
2022-09-28T17:42:06.930509Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:42:06.934760Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:42:06.935993Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:42:06.939699Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:42:06.947964Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:42:06.953918Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:42:06.955110Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:42:07.002396Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:42:07.015697Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:42:07.022046Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:42:07.023613Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:42:07.233722Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:42:07.327928Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:42:07.335480Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:42:07.569838Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:42:07.766208Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:42:07.771317Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:42:07.771689Z - job completed in 5.59 seconds (cd0fd08c7cb2bc59cbcdccf8d2946eef7d8b997cf82458d4bf330759fb68f248)
2022-09-28T17:42:07.905434Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1232"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (19d3634db319b83e752302d744cc2c8b643908efbd2274e9cefcc760ab7e768c)
2022-09-28T17:42:10.235836Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:42:10.263273Z - running sql script pg/upsert_orders.sql
2022-09-28T17:42:10.263761Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:42:10.268836Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:42:10.273167Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:42:10.274761Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:42:10.279332Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:42:10.285668Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:42:10.292193Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:42:10.293142Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:42:10.294720Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:42:10.301599Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:42:10.385516Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:42:10.407861Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:42:10.413552Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:42:10.419617Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:42:10.485531Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:42:10.494533Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:42:10.494996Z - job completed in 2.59 seconds (19d3634db319b83e752302d744cc2c8b643908efbd2274e9cefcc760ab7e768c)
2022-09-28T17:44:02.128744Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1234"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1ad4c08168120b1bf18606435d2696a30c1ceeb12ff5baaa0e19340f5f387206)
2022-09-28T17:44:04.514875Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:44:04.544253Z - running sql script pg/upsert_orders.sql
2022-09-28T17:44:04.544287Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:44:04.550242Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:44:04.556259Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:44:04.557785Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:44:04.562113Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:44:04.568284Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:44:04.575776Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:44:04.577633Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:44:04.578922Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:44:04.586044Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:44:04.715356Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:44:04.737697Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:44:04.741518Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:44:04.756932Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:44:04.825418Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:44:04.840728Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:44:04.841363Z - job completed in 2.71 seconds (1ad4c08168120b1bf18606435d2696a30c1ceeb12ff5baaa0e19340f5f387206)
2022-09-28T17:44:04.859973Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1234"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4ad1658bd8dc410f6aa319d049646819b18f7bb04ea93ac04263a83ebf2e599f)
2022-09-28T17:44:06.388112Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:44:06.414140Z - running sql script pg/insert_tenders.sql
2022-09-28T17:44:06.414666Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:44:06.420498Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:44:06.424283Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:44:06.429446Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:44:06.434409Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:44:06.440615Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:44:06.443716Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:44:06.492499Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:44:06.506791Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:44:06.511300Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:44:06.515602Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:44:06.728481Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:44:06.817862Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:44:06.824529Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:44:07.059514Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:44:07.253529Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:44:07.258503Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:44:07.258917Z - job completed in 2.40 seconds (4ad1658bd8dc410f6aa319d049646819b18f7bb04ea93ac04263a83ebf2e599f)
2022-09-28T17:46:02.374647Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1236"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5ba9ab9dee99be846083bbfee5608e0725e84c3cbb80ca11c847605e33824f31)
2022-09-28T17:46:05.798129Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:46:05.819421Z - running sql script pg/upsert_orders.sql
2022-09-28T17:46:05.819471Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:46:05.824204Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:46:05.828423Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:46:05.829401Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:46:05.833667Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:46:05.837998Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:46:05.842069Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:46:05.843030Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:46:05.843953Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:46:05.849626Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:46:05.937702Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:46:05.957624Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:46:05.961311Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:46:05.970409Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:46:06.040626Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:46:06.054366Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:46:06.054856Z - job completed in 3.68 seconds (5ba9ab9dee99be846083bbfee5608e0725e84c3cbb80ca11c847605e33824f31)
2022-09-28T17:46:06.118982Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1236"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0e2f5fbb7279df02a14a3d24f9fd7edcd16df3a464c140dfc398f060b7c83fa5)
2022-09-28T17:46:07.419067Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:46:07.437129Z - running sql script pg/insert_tenders.sql
2022-09-28T17:46:07.437257Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:46:07.442060Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:46:07.443585Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:46:07.447926Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:46:07.451586Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:46:07.456209Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:46:07.457170Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:46:07.503192Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:46:07.562434Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:46:07.566394Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:46:07.567871Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:46:07.778314Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:46:07.869550Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:46:07.878540Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:46:08.112280Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:46:08.314505Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:46:08.320411Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:46:08.322412Z - job completed in 2.20 seconds (0e2f5fbb7279df02a14a3d24f9fd7edcd16df3a464c140dfc398f060b7c83fa5)
2022-09-28T17:48:02.106817Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1238"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4d40d413fcd0d1f3cc685794612a418441ccbbdb806ebaa83d5cc90e1cbd6967)
2022-09-28T17:48:04.321060Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:48:04.340034Z - running sql script pg/upsert_orders.sql
2022-09-28T17:48:04.340072Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:48:04.346302Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:48:04.351491Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:48:04.352802Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:48:04.357222Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:48:04.362007Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:48:04.366542Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:48:04.368946Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:48:04.370369Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:48:04.378838Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:48:04.625196Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:48:04.673635Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:48:04.677408Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:48:04.689209Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:48:04.859628Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:48:04.909415Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:48:04.910365Z - job completed in 2.80 seconds (4d40d413fcd0d1f3cc685794612a418441ccbbdb806ebaa83d5cc90e1cbd6967)
2022-09-28T17:48:04.983077Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1238"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (15825935c27b31cd565f554f60032b38fbbfbe7108f3f77b5fbdf3ef9594ec1f)
2022-09-28T17:48:06.565236Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:48:06.583351Z - running sql script pg/insert_tenders.sql
2022-09-28T17:48:06.583387Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:48:06.588730Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:48:06.589992Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:48:06.594621Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:48:06.598713Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:48:06.604732Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:48:06.605719Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:48:06.655442Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:48:06.708584Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:48:06.713768Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:48:06.715273Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:48:06.923421Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:48:07.013579Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:48:07.020738Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:48:07.258573Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:48:07.452315Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:48:07.457181Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:48:07.457554Z - job completed in 2.47 seconds (15825935c27b31cd565f554f60032b38fbbfbe7108f3f77b5fbdf3ef9594ec1f)
2022-09-28T17:48:07.676321Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1228"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (b5c36cfcc729506dfa3bee79d9830a8ecea7261ecccf79c314127e24ba25033c)
2022-09-28T17:48:13.735786Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:48:13.754461Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T17:48:13.754498Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:48:13.758814Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T17:48:13.768377Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T17:48:13.772049Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T17:48:13.773145Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T17:48:13.776836Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T17:48:13.780678Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T17:48:13.781827Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:48:13.782768Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T17:48:13.783694Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T17:48:13.789370Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T17:48:13.794047Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T17:48:13.795107Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T17:48:13.802562Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T17:48:13.806275Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T17:48:13.810504Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T17:48:13.816762Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T17:48:14.514792Z - called http://score/api/keyed and received back 200
2022-09-28T17:48:14.515178Z - job completed in 6.84 seconds (b5c36cfcc729506dfa3bee79d9830a8ecea7261ecccf79c314127e24ba25033c)
2022-09-28T17:50:02.175176Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1240"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7455717e92017e7ca5b895e1c62e1c3a9fc3a8f60e5cfd19cae49f94d8c1c376)
2022-09-28T17:50:03.517655Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:50:03.542538Z - running sql script pg/insert_tenders.sql
2022-09-28T17:50:03.542605Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:50:03.548257Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:50:03.550050Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:50:03.555654Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:50:03.559820Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:50:03.564758Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:50:03.566760Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:50:03.614282Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:50:03.672751Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:50:03.676847Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:50:03.678395Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:50:03.886413Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:50:03.977500Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:50:03.983682Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:50:04.219026Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:50:04.406130Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:50:04.411735Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:50:04.412150Z - job completed in 2.24 seconds (7455717e92017e7ca5b895e1c62e1c3a9fc3a8f60e5cfd19cae49f94d8c1c376)
2022-09-28T17:50:04.504014Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1240"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (140aec297e097fcfa794f1262cdeee9882fbc7dfbda9729aaadb740420a14419)
2022-09-28T17:50:06.728991Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:50:06.754219Z - running sql script pg/upsert_orders.sql
2022-09-28T17:50:06.755501Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:50:06.762188Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:50:06.767184Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:50:06.769965Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:50:06.776025Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:50:06.781229Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:50:06.787606Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:50:06.789316Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:50:06.791247Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:50:06.798668Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:50:06.908960Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:50:06.915634Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:50:06.920361Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:50:06.931117Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:50:06.998187Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:50:07.027935Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:50:07.028209Z - job completed in 2.53 seconds (140aec297e097fcfa794f1262cdeee9882fbc7dfbda9729aaadb740420a14419)
2022-09-28T17:52:02.054536Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1242"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (74189126bb85e9255f2c60e89631492c782fc1157a037a5cf0d93c2bcba89610)
2022-09-28T17:52:04.655721Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:52:04.673218Z - running sql script pg/upsert_orders.sql
2022-09-28T17:52:04.673246Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:52:04.678350Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:52:04.683106Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:52:04.684420Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:52:04.688499Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:52:04.692861Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:52:04.696752Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:52:04.697617Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:52:04.698435Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:52:04.704673Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:52:04.822629Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:52:04.844783Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:52:04.848594Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:52:04.856658Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:52:04.959356Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:52:04.975947Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:52:04.976380Z - job completed in 2.92 seconds (74189126bb85e9255f2c60e89631492c782fc1157a037a5cf0d93c2bcba89610)
2022-09-28T17:52:05.039177Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1242"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2e56f784b43cdf876529df0a934bf6cf59fbd8b1141562034f94e57597090e6c)
2022-09-28T17:52:06.393056Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:52:06.410698Z - running sql script pg/insert_tenders.sql
2022-09-28T17:52:06.410731Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:52:06.415362Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:52:06.416593Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:52:06.422008Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:52:06.425992Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:52:06.430684Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:52:06.431559Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:52:06.485931Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:52:06.526204Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:52:06.530562Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:52:06.532136Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:52:06.752699Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:52:06.843730Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:52:06.849951Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:52:07.087698Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:52:07.287388Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:52:07.292093Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:52:07.292570Z - job completed in 2.25 seconds (2e56f784b43cdf876529df0a934bf6cf59fbd8b1141562034f94e57597090e6c)
2022-09-28T17:54:02.225441Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1244"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (992c206be4a001781415859ffbc82a1432aee75f8b1e75f6f80c402e7b75dbd8)
2022-09-28T17:54:05.604784Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:54:05.638219Z - running sql script pg/upsert_orders.sql
2022-09-28T17:54:05.638254Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:54:05.651780Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:54:05.657Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:54:05.658723Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:54:05.664224Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:54:05.669229Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:54:05.674588Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:54:05.675678Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:54:05.676847Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:54:05.685935Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:54:05.866468Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:54:05.894943Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:54:05.899021Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:54:05.914055Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:54:05.993934Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:54:06.006867Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:54:06.007302Z - job completed in 3.78 seconds (992c206be4a001781415859ffbc82a1432aee75f8b1e75f6f80c402e7b75dbd8)
2022-09-28T17:54:06.089459Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1244"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (233e8c5602ff06ca9d7f2ce04b48dce9038ca337d654083d7bd2a9f097b6a0eb)
2022-09-28T17:54:08.012459Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:54:08.032317Z - running sql script pg/insert_tenders.sql
2022-09-28T17:54:08.032347Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:54:08.037156Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:54:08.042143Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:54:08.047573Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:54:08.052813Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:54:08.058433Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:54:08.059629Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:54:08.108333Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:54:08.162868Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:54:08.167301Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:54:08.168986Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:54:08.379361Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:54:08.472767Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:54:08.479957Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:54:08.735622Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:54:08.929859Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:54:08.937708Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:54:08.937975Z - job completed in 2.85 seconds (233e8c5602ff06ca9d7f2ce04b48dce9038ca337d654083d7bd2a9f097b6a0eb)
2022-09-28T17:56:02.263869Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1246"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a5ff0a3d39285a48dc04b94f69d8aa317d2bbda25dad326b1af6e536f8328563)
2022-09-28T17:56:04.949727Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:56:04.976648Z - running sql script pg/upsert_orders.sql
2022-09-28T17:56:04.976694Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:56:04.982452Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:56:04.987029Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:56:04.988491Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:56:04.992915Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:56:04.999064Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:56:05.003604Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:56:05.004437Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:56:05.005579Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:56:05.011954Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:56:05.114381Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:56:05.133241Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:56:05.137574Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:56:05.150775Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:56:05.222457Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:56:05.242491Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:56:05.242869Z - job completed in 2.98 seconds (a5ff0a3d39285a48dc04b94f69d8aa317d2bbda25dad326b1af6e536f8328563)
2022-09-28T17:56:05.352357Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1246"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e9b4475a16576fe28c1daf78c0095df1b1b7a37d2837ff22c24c8ff689743aea)
2022-09-28T17:56:06.998807Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:56:07.025037Z - running sql script pg/insert_tenders.sql
2022-09-28T17:56:07.025076Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:56:07.029464Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:56:07.033523Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:56:07.038913Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:56:07.043013Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:56:07.048118Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:56:07.049197Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:56:07.099675Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:56:07.148607Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:56:07.153827Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:56:07.158247Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:56:07.414718Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:56:07.531707Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:56:07.540786Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:56:07.781448Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:56:07.978722Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:56:07.984285Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:56:07.984771Z - job completed in 2.63 seconds (e9b4475a16576fe28c1daf78c0095df1b1b7a37d2837ff22c24c8ff689743aea)
2022-09-28T17:58:02.110645Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1238"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (a2ea25d0edf770b7b5d7829657f7e2b75779e864f25fc563f3461b73095dc300)
2022-09-28T17:58:08.348216Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:58:08.372771Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T17:58:08.372815Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:58:08.379316Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T17:58:08.384997Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T17:58:08.390407Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T17:58:08.391512Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T17:58:08.396936Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T17:58:08.401836Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T17:58:08.402994Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:58:08.403921Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T17:58:08.404932Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T17:58:08.410863Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T17:58:08.415960Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T17:58:08.416959Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T17:58:08.423885Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T17:58:08.428748Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T17:58:08.436362Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T17:58:08.442152Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T17:58:09.383963Z - called http://score/api/keyed and received back 200
2022-09-28T17:58:09.384285Z - job completed in 7.27 seconds (a2ea25d0edf770b7b5d7829657f7e2b75779e864f25fc563f3461b73095dc300)
2022-09-28T17:58:09.474803Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1248"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (13b4c4946c3ddcbea235d9c29081cfe44c2b7252c62c8d74593aaf1e324d9a5c)
2022-09-28T17:58:11.931088Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:58:11.954079Z - running sql script pg/upsert_orders.sql
2022-09-28T17:58:11.954591Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T17:58:11.961447Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T17:58:11.966296Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T17:58:11.967176Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T17:58:11.971716Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T17:58:11.975561Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T17:58:11.979433Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T17:58:11.980308Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T17:58:11.981091Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T17:58:11.988760Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T17:58:12.090353Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T17:58:12.103836Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T17:58:12.104738Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T17:58:12.121200Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T17:58:12.204399Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T17:58:12.223240Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T17:58:12.223509Z - job completed in 2.75 seconds (13b4c4946c3ddcbea235d9c29081cfe44c2b7252c62c8d74593aaf1e324d9a5c)
2022-09-28T17:58:12.300387Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1248"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7d851ea24e0d88895d0e37a01ba9b5dcdc645c125f0c1e6eaec06e2b8d444f59)
2022-09-28T17:58:15.387688Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T17:58:15.404352Z - running sql script pg/insert_tenders.sql
2022-09-28T17:58:15.404998Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T17:58:15.416064Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T17:58:15.421217Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T17:58:15.426062Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T17:58:15.433263Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T17:58:15.438671Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T17:58:15.440002Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T17:58:15.488207Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T17:58:15.517856Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T17:58:15.522410Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T17:58:15.524166Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T17:58:15.756848Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T17:58:15.850092Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T17:58:15.861163Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T17:58:16.102582Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T17:58:16.301985Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T17:58:16.308977Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T17:58:16.309491Z - job completed in 4.01 seconds (7d851ea24e0d88895d0e37a01ba9b5dcdc645c125f0c1e6eaec06e2b8d444f59)
2022-09-28T18:00:02.322076Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1250"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2702f0c1e17bdbe83420c3531c9c6b7974345fba283b7835f880d265bcb8eaec)
2022-09-28T18:00:04.880563Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:00:04.902073Z - running sql script pg/upsert_orders.sql
2022-09-28T18:00:04.902508Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:00:04.909400Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:00:04.915206Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:00:04.916324Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:00:04.925230Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:00:04.930761Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:00:04.936750Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:00:04.937702Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:00:04.938559Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:00:04.945251Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:00:05.055448Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:00:05.071040Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:00:05.072277Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:00:05.082201Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:00:05.148372Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:00:05.160063Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:00:05.160411Z - job completed in 2.84 seconds (2702f0c1e17bdbe83420c3531c9c6b7974345fba283b7835f880d265bcb8eaec)
2022-09-28T18:00:05.259422Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1250"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8912bd57d04094fe45849eec6f9f16565492d21aa4d2f2819eaee48300b52ad9)
2022-09-28T18:00:06.717020Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:00:06.738463Z - running sql script pg/insert_tenders.sql
2022-09-28T18:00:06.738611Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:00:06.743759Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:00:06.748997Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:00:06.753701Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:00:06.760642Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:00:06.767075Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:00:06.768741Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:00:06.896826Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:00:06.932234Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:00:06.937556Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:00:06.940282Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:00:07.223216Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:00:07.314786Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:00:07.321485Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:00:07.562887Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:00:07.769032Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:00:07.774145Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:00:07.774761Z - job completed in 2.52 seconds (8912bd57d04094fe45849eec6f9f16565492d21aa4d2f2819eaee48300b52ad9)
2022-09-28T18:02:02.218255Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1252"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (bbe969224c33b14f547cdac3deac93e0fe91cf5af5641902c120322c1b31992b)
2022-09-28T18:02:03.753851Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:02:03.775644Z - running sql script pg/insert_tenders.sql
2022-09-28T18:02:03.775739Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:02:03.780251Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:02:03.785435Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:02:03.792065Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:02:03.798324Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:02:03.804885Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:02:03.806076Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:02:03.853702Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:02:03.875722Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:02:03.880246Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:02:03.882361Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:02:04.106268Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:02:04.199020Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:02:04.207468Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:02:04.449367Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:02:04.646906Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:02:04.652963Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:02:04.653415Z - job completed in 2.44 seconds (bbe969224c33b14f547cdac3deac93e0fe91cf5af5641902c120322c1b31992b)
2022-09-28T18:02:04.770295Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1252"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b6cd91ba3efd7b53c1159f6748f5f339faa5f25a10bc2668c605f576e46642f9)
2022-09-28T18:02:07.337603Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:02:07.355650Z - running sql script pg/upsert_orders.sql
2022-09-28T18:02:07.355845Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:02:07.360944Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:02:07.365153Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:02:07.366763Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:02:07.371366Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:02:07.375754Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:02:07.381404Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:02:07.382613Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:02:07.383556Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:02:07.390280Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:02:07.497256Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:02:07.503577Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:02:07.507470Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:02:07.515369Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:02:07.583329Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:02:07.597999Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:02:07.598388Z - job completed in 2.83 seconds (b6cd91ba3efd7b53c1159f6748f5f339faa5f25a10bc2668c605f576e46642f9)
2022-09-28T18:04:02.238020Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1254"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a4da4e728958888ca7521fe5dd5d27ec1b8380452504b831b27f6c06a9e55086)
2022-09-28T18:04:04.919020Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:04:04.937843Z - running sql script pg/upsert_orders.sql
2022-09-28T18:04:04.939843Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:04:04.944651Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:04:04.949495Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:04:04.950500Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:04:04.955121Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:04:04.959605Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:04:04.963857Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:04:04.964841Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:04:04.965723Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:04:04.971826Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:04:05.064110Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:04:05.071572Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:04:05.075358Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:04:05.082487Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:04:05.146951Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:04:05.156246Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:04:05.156608Z - job completed in 2.92 seconds (a4da4e728958888ca7521fe5dd5d27ec1b8380452504b831b27f6c06a9e55086)
2022-09-28T18:04:05.211144Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1254"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (09a6429e95c1a0607638d3040d44f3d1fe5ac54700a73c451dc51b23cf352fdf)
2022-09-28T18:04:06.762644Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:04:06.787387Z - running sql script pg/insert_tenders.sql
2022-09-28T18:04:06.787426Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:04:06.800689Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:04:06.805676Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:04:06.811103Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:04:06.816518Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:04:06.821704Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:04:06.822707Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:04:06.904484Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:04:06.928613Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:04:06.933127Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:04:06.935098Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:04:07.344665Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:04:07.527295Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:04:07.538083Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:04:07.915325Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:04:08.113600Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:04:08.121721Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:04:08.122113Z - job completed in 2.91 seconds (09a6429e95c1a0607638d3040d44f3d1fe5ac54700a73c451dc51b23cf352fdf)
2022-09-28T18:06:02.532153Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1256"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (bb7e82e8ddf32ffaf3c419ae746570c427b58f2a88892a593085dd0504a1e3c6)
2022-09-28T18:06:04.163942Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:06:04.182238Z - running sql script pg/insert_tenders.sql
2022-09-28T18:06:04.182271Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:06:04.187232Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:06:04.191821Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:06:04.196199Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:06:04.200219Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:06:04.204768Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:06:04.205993Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:06:04.258819Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:06:04.274592Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:06:04.281465Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:06:04.283088Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:06:04.493506Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:06:04.583675Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:06:04.604143Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:06:04.854973Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:06:05.056385Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:06:05.066043Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:06:05.066847Z - job completed in 2.53 seconds (bb7e82e8ddf32ffaf3c419ae746570c427b58f2a88892a593085dd0504a1e3c6)
2022-09-28T18:06:05.143127Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1256"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (336979d8ea3b9f499f1a04827645dcdf4f2d79089a956dd831daa555c0a9c3a3)
2022-09-28T18:06:07.898538Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:06:07.916800Z - running sql script pg/upsert_orders.sql
2022-09-28T18:06:07.916830Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:06:07.921372Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:06:07.925887Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:06:07.927023Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:06:07.931666Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:06:07.936113Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:06:07.940441Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:06:07.941422Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:06:07.942511Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:06:07.948540Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:06:08.014565Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:06:08.020996Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:06:08.025433Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:06:08.035422Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:06:08.104194Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:06:08.117492Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:06:08.118145Z - job completed in 2.98 seconds (336979d8ea3b9f499f1a04827645dcdf4f2d79089a956dd831daa555c0a9c3a3)
2022-09-28T18:08:02.107710Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1258"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (05ce06311040c9ec0d49bcb520f8612edbbe47baff5b7f8f3a1f5803775e9075)
2022-09-28T18:08:03.435044Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:08:03.451847Z - running sql script pg/insert_tenders.sql
2022-09-28T18:08:03.451880Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:08:03.457616Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:08:03.461811Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:08:03.466007Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:08:03.472587Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:08:03.478257Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:08:03.479310Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:08:03.532273Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:08:03.589164Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:08:03.593074Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:08:03.594590Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:08:03.807492Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:08:03.899951Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:08:03.907984Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:08:04.155092Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:08:04.355012Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:08:04.361618Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:08:04.362239Z - job completed in 2.26 seconds (05ce06311040c9ec0d49bcb520f8612edbbe47baff5b7f8f3a1f5803775e9075)
2022-09-28T18:08:04.483695Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1258"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5a1803ba94dd073572c9beef12fcbb479a07243e8014d23772952498108e532c)
2022-09-28T18:08:07.161142Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:08:07.176799Z - running sql script pg/upsert_orders.sql
2022-09-28T18:08:07.176839Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:08:07.182030Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:08:07.187674Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:08:07.188905Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:08:07.194072Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:08:07.195814Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:08:07.200550Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:08:07.201510Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:08:07.202427Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:08:07.208501Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:08:07.282429Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:08:07.294441Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:08:07.298335Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:08:07.308583Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:08:07.385255Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:08:07.400043Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:08:07.400391Z - job completed in 2.92 seconds (5a1803ba94dd073572c9beef12fcbb479a07243e8014d23772952498108e532c)
2022-09-28T18:08:07.467937Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1248"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (d3d3c1cc48b1afb82d5b92e886618978b0158eab771991ec9991f744fda202f6)
2022-09-28T18:08:14.789192Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:08:14.806065Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T18:08:14.806134Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:08:14.810594Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T18:08:14.819327Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T18:08:14.824617Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T18:08:14.825722Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T18:08:14.829334Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T18:08:14.833194Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T18:08:14.837037Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:08:14.838118Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T18:08:14.839003Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T18:08:14.844432Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T18:08:14.849245Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T18:08:14.850073Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T18:08:14.856578Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T18:08:14.863228Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T18:08:14.869615Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T18:08:14.875602Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T18:08:19.175004Z - called http://score/api/keyed and received back 200
2022-09-28T18:08:19.175318Z - job completed in 11.71 seconds (d3d3c1cc48b1afb82d5b92e886618978b0158eab771991ec9991f744fda202f6)
2022-09-28T18:10:02.306285Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1300"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (905241bacf6dc4c89df457e919977684646a5831b03764d1c52edf01910e60f0)
2022-09-28T18:10:05.128442Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:10:05.146294Z - running sql script pg/upsert_orders.sql
2022-09-28T18:10:05.146582Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:10:05.152405Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:10:05.159434Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:10:05.160542Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:10:05.165454Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:10:05.166917Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:10:05.171286Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:10:05.172213Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:10:05.173010Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:10:05.179524Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:10:05.268812Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:10:05.291118Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:10:05.296317Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:10:05.303697Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:10:05.370813Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:10:05.395915Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:10:05.396228Z - job completed in 3.09 seconds (905241bacf6dc4c89df457e919977684646a5831b03764d1c52edf01910e60f0)
2022-09-28T18:10:05.455032Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1300"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b07b1dc67c3706f6ba82b903eebee21b7c5da3f8d623a0d5803b721af16bc66c)
2022-09-28T18:10:07.441233Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:10:07.462836Z - running sql script pg/insert_tenders.sql
2022-09-28T18:10:07.462878Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:10:07.468511Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:10:07.470305Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:10:07.474326Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:10:07.478864Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:10:07.484181Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:10:07.485321Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:10:07.534917Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:10:07.570599Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:10:07.575429Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:10:07.577352Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:10:07.784771Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:10:07.875985Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:10:07.882135Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:10:08.171118Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:10:08.525546Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:10:08.531961Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:10:08.532397Z - job completed in 3.08 seconds (b07b1dc67c3706f6ba82b903eebee21b7c5da3f8d623a0d5803b721af16bc66c)
2022-09-28T18:12:02.201504Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1302"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (cd105f8a0de76dd0fb60bdb3c667b2575b74ec36ada0394d7b2aba9f6e576ebc)
2022-09-28T18:12:04.406628Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:12:04.431668Z - running sql script pg/upsert_orders.sql
2022-09-28T18:12:04.431727Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:12:04.437854Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:12:04.443185Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:12:04.444622Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:12:04.451602Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:12:04.456053Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:12:04.460138Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:12:04.461222Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:12:04.462379Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:12:04.468605Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:12:04.587842Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:12:04.602248Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:12:04.607193Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:12:04.615770Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:12:04.684528Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:12:04.698414Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:12:04.698794Z - job completed in 2.50 seconds (cd105f8a0de76dd0fb60bdb3c667b2575b74ec36ada0394d7b2aba9f6e576ebc)
2022-09-28T18:12:04.741742Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1302"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (79246b825fade08448a336b89273f735ff66711af53946c7448fe72de4f17930)
2022-09-28T18:12:06.358940Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:12:06.376614Z - running sql script pg/insert_tenders.sql
2022-09-28T18:12:06.376645Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:12:06.381310Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:12:06.382751Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:12:06.389052Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:12:06.393547Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:12:06.398445Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:12:06.399491Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:12:06.447402Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:12:06.536478Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:12:06.542173Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:12:06.543573Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:12:06.755771Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:12:06.847229Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:12:06.856351Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:12:07.094402Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:12:07.294614Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:12:07.299772Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:12:07.300349Z - job completed in 2.56 seconds (79246b825fade08448a336b89273f735ff66711af53946c7448fe72de4f17930)
2022-09-28T18:14:02.233045Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1304"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9f0d8fc4b20066be0ccb88b4c8c6620f26f5ed84a8b63a8d763708a25ab05fbd)
2022-09-28T18:14:03.810617Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:14:03.827071Z - running sql script pg/insert_tenders.sql
2022-09-28T18:14:03.827100Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:14:03.831650Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:14:03.833093Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:14:03.837669Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:14:03.842052Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:14:03.846712Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:14:03.847618Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:14:03.896495Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:14:03.984989Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:14:03.988957Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:14:03.990554Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:14:04.200672Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:14:04.296020Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:14:04.419081Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:14:04.958708Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:14:05.399192Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:14:05.404346Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:14:05.404698Z - job completed in 3.17 seconds (9f0d8fc4b20066be0ccb88b4c8c6620f26f5ed84a8b63a8d763708a25ab05fbd)
2022-09-28T18:14:05.456477Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1304"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a964f8f287e2716f3e9f507e7f5934cd4b28c51f3f2d518a7ce074aa3856a69f)
2022-09-28T18:14:07.651234Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:14:07.667703Z - running sql script pg/upsert_orders.sql
2022-09-28T18:14:07.667734Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:14:07.672513Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:14:07.678103Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:14:07.679120Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:14:07.684607Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:14:07.688725Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:14:07.695020Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:14:07.697956Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:14:07.699110Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:14:07.706277Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:14:07.949579Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:14:07.992247Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:14:07.997320Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:14:08.007162Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:14:08.075941Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:14:08.088737Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:14:08.089182Z - job completed in 2.63 seconds (a964f8f287e2716f3e9f507e7f5934cd4b28c51f3f2d518a7ce074aa3856a69f)
2022-09-28T18:16:02.011141Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1306"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (79f1a0bf4f760ba2832899ebc075d113049f87b95a0a4eea051bef7d3a6c2ff5)
2022-09-28T18:16:04.781295Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:16:04.798130Z - running sql script pg/upsert_orders.sql
2022-09-28T18:16:04.798159Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:16:04.802918Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:16:04.807900Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:16:04.808990Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:16:04.813419Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:16:04.817925Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:16:04.822503Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:16:04.823521Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:16:04.824815Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:16:04.831766Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:16:05.129124Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:16:05.147622Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:16:05.151756Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:16:05.166431Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:16:05.295294Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:16:05.333009Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:16:05.333589Z - job completed in 3.32 seconds (79f1a0bf4f760ba2832899ebc075d113049f87b95a0a4eea051bef7d3a6c2ff5)
2022-09-28T18:16:05.440892Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1306"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3fbe65edf9268a752c611e66ee360fe69428ee5adff2e888fd27516b072b408c)
2022-09-28T18:16:08.465968Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:16:08.485542Z - running sql script pg/insert_tenders.sql
2022-09-28T18:16:08.485645Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:16:08.490226Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:16:08.493885Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:16:08.498290Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:16:08.502514Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:16:08.509699Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:16:08.510911Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:16:08.561648Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:16:08.599888Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:16:08.603975Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:16:08.605973Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:16:08.807891Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:16:08.897499Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:16:08.910157Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:16:09.257975Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:16:09.681432Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:16:09.688791Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:16:09.689261Z - job completed in 4.25 seconds (3fbe65edf9268a752c611e66ee360fe69428ee5adff2e888fd27516b072b408c)
2022-09-28T18:18:02.007796Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1308"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (cea7ab51183309491f8c3b89e8272a1140cc210475031ce237dfaaa396bab287)
2022-09-28T18:18:04.384427Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:18:04.402480Z - running sql script pg/upsert_orders.sql
2022-09-28T18:18:04.402528Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:18:04.407732Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:18:04.412792Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:18:04.414168Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:18:04.418515Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:18:04.422885Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:18:04.427107Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:18:04.428194Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:18:04.429093Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:18:04.436958Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:18:04.723185Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:18:04.776257Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:18:04.781009Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:18:04.797945Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:18:04.866917Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:18:04.881870Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:18:04.882287Z - job completed in 2.88 seconds (cea7ab51183309491f8c3b89e8272a1140cc210475031ce237dfaaa396bab287)
2022-09-28T18:18:05.055115Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1308"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0a52d1693cf81696a49ea6d9c0e6efa1fb3c33bee3851ce92838f5569960c9f7)
2022-09-28T18:18:06.451451Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:18:06.466943Z - running sql script pg/insert_tenders.sql
2022-09-28T18:18:06.466982Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:18:06.471423Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:18:06.472750Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:18:06.476697Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:18:06.480851Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:18:06.485999Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:18:06.486923Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:18:06.533879Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:18:06.588626Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:18:06.592097Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:18:06.593628Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:18:06.800515Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:18:06.892430Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:18:06.900296Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:18:07.135845Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:18:07.335684Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:18:07.341120Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:18:07.341513Z - job completed in 2.29 seconds (0a52d1693cf81696a49ea6d9c0e6efa1fb3c33bee3851ce92838f5569960c9f7)
2022-09-28T18:18:07.433994Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1258"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (89d7c2eb7163d8851b2bf888f17d7946976fcf077d23719ec808017564a3884a)
2022-09-28T18:18:13.778584Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:18:13.795769Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T18:18:13.795800Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:18:13.800013Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T18:18:13.804746Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T18:18:13.808934Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T18:18:13.809945Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T18:18:13.813714Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T18:18:13.817813Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T18:18:13.821375Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:18:13.822496Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T18:18:13.823423Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T18:18:13.830386Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T18:18:13.835558Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T18:18:13.836605Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T18:18:13.844694Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T18:18:13.849079Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T18:18:13.854282Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T18:18:13.860961Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T18:18:14.942658Z - called http://score/api/keyed and received back 200
2022-09-28T18:18:14.943139Z - job completed in 7.51 seconds (89d7c2eb7163d8851b2bf888f17d7946976fcf077d23719ec808017564a3884a)
2022-09-28T18:20:02.374007Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1310"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7618f474e257e020dd436741a66fc69a298c20c8d53641cd587bb5558a55fac7)
2022-09-28T18:20:05.016834Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:20:05.036150Z - running sql script pg/upsert_orders.sql
2022-09-28T18:20:05.036261Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:20:05.041306Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:20:05.046688Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:20:05.047950Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:20:05.052729Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:20:05.059738Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:20:05.068103Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:20:05.074744Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:20:05.076050Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:20:05.083729Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:20:05.390090Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:20:05.464434Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:20:05.468885Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:20:05.476774Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:20:05.545645Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:20:05.559446Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:20:05.559946Z - job completed in 3.19 seconds (7618f474e257e020dd436741a66fc69a298c20c8d53641cd587bb5558a55fac7)
2022-09-28T18:20:05.625842Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1310"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (50c93252fc604d91c181518f1a33c8799eb714cea8c4d7f32de55041e9f26c4f)
2022-09-28T18:20:07.000428Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:20:07.019454Z - running sql script pg/insert_tenders.sql
2022-09-28T18:20:07.019495Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:20:07.024155Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:20:07.025662Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:20:07.033081Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:20:07.037229Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:20:07.045099Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:20:07.046124Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:20:07.094579Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:20:07.161161Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:20:07.165280Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:20:07.166895Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:20:07.378816Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:20:07.470439Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:20:07.480580Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:20:07.722442Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:20:07.919766Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:20:07.925601Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:20:07.926169Z - job completed in 2.30 seconds (50c93252fc604d91c181518f1a33c8799eb714cea8c4d7f32de55041e9f26c4f)
2022-09-28T18:22:02.436075Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1312"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (33d5adf357b64523e08c3b880f09bf0aa227c87444ecc3e33bd781ebd26f8482)
2022-09-28T18:22:04.711044Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:22:04.732239Z - running sql script pg/upsert_orders.sql
2022-09-28T18:22:04.732273Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:22:04.737885Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:22:04.742525Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:22:04.743568Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:22:04.748166Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:22:04.752357Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:22:04.756573Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:22:04.757550Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:22:04.758459Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:22:04.765698Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:22:05.001814Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:22:05.047917Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:22:05.051817Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:22:05.061609Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:22:05.127770Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:22:05.139248Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:22:05.139688Z - job completed in 2.70 seconds (33d5adf357b64523e08c3b880f09bf0aa227c87444ecc3e33bd781ebd26f8482)
2022-09-28T18:22:05.258945Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1312"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a333d83f71d2402d21cece84ac355deacefd44afd3b110a9dd07d8cdb94e1481)
2022-09-28T18:22:06.771244Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:22:06.796180Z - running sql script pg/insert_tenders.sql
2022-09-28T18:22:06.796214Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:22:06.801127Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:22:06.802587Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:22:06.809023Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:22:06.814811Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:22:06.819639Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:22:06.820714Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:22:06.867366Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:22:06.903285Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:22:06.907382Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:22:06.909072Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:22:07.120794Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:22:07.215281Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:22:07.224898Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:22:07.470698Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:22:07.736858Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:22:07.742864Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:22:07.743231Z - job completed in 2.49 seconds (a333d83f71d2402d21cece84ac355deacefd44afd3b110a9dd07d8cdb94e1481)
2022-09-28T18:24:02.085416Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1314"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b3cd5954d8ea88506dc3b62f328b29ecc72ab886fade8880f0ad98325c2050dd)
2022-09-28T18:24:04.732275Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:24:04.751214Z - running sql script pg/upsert_orders.sql
2022-09-28T18:24:04.751358Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:24:04.756640Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:24:04.762508Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:24:04.763591Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:24:04.767878Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:24:04.775930Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:24:04.781014Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:24:04.782161Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:24:04.783129Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:24:04.791217Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:24:05.072617Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:24:05.165147Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:24:05.170107Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:24:05.175776Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:24:05.241019Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:24:05.250412Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:24:05.251005Z - job completed in 3.17 seconds (b3cd5954d8ea88506dc3b62f328b29ecc72ab886fade8880f0ad98325c2050dd)
2022-09-28T18:24:05.321547Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1314"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8da0dfbd0defc3253861f491e4fb9b4da8f0f2b2518400779bd11c854d40da9a)
2022-09-28T18:24:07.296521Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:24:07.314056Z - running sql script pg/insert_tenders.sql
2022-09-28T18:24:07.314155Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:24:07.318985Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:24:07.320546Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:24:07.325214Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:24:07.329708Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:24:07.335513Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:24:07.336623Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:24:07.383485Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:24:07.543924Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:24:07.548528Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:24:07.550171Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:24:07.763128Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:24:07.858287Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:24:07.865647Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:24:08.100745Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:24:08.317792Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:24:08.323828Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:24:08.324219Z - job completed in 3.00 seconds (8da0dfbd0defc3253861f491e4fb9b4da8f0f2b2518400779bd11c854d40da9a)
2022-09-28T18:26:02.130324Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1316"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (444b6dbcef25239f2036a62727e5d71b309477b37a5205b2ebf7c0610e8f69fe)
2022-09-28T18:26:04.460645Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:26:04.479168Z - running sql script pg/upsert_orders.sql
2022-09-28T18:26:04.479307Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:26:04.484472Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:26:04.489473Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:26:04.490522Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:26:04.494924Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:26:04.496394Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:26:04.501034Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:26:04.502129Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:26:04.503977Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:26:04.510745Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:26:04.651714Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:26:04.718530Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:26:04.722513Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:26:04.734365Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:26:04.808243Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:26:04.821943Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:26:04.822273Z - job completed in 2.69 seconds (444b6dbcef25239f2036a62727e5d71b309477b37a5205b2ebf7c0610e8f69fe)
2022-09-28T18:26:04.895055Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1316"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ab1c9daac501f433f918b986d2f2fd194f782203fd5f6a0e1aef0b439ec38762)
2022-09-28T18:26:06.402607Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:26:06.419486Z - running sql script pg/insert_tenders.sql
2022-09-28T18:26:06.419524Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:26:06.423718Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:26:06.425081Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:26:06.430080Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:26:06.435081Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:26:06.441352Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:26:06.442636Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:26:06.491234Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:26:06.840477Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:26:06.844381Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:26:06.845877Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:26:07.059017Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:26:07.154340Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:26:07.166772Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:26:07.410661Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:26:07.613122Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:26:07.620539Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:26:07.620948Z - job completed in 2.73 seconds (ab1c9daac501f433f918b986d2f2fd194f782203fd5f6a0e1aef0b439ec38762)
2022-09-28T18:28:02.258577Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (990388ba680fa80d41fc31358bf5b98168f11a160dba74b1144404b17a83743d)
2022-09-28T18:28:03.653486Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:28:03.671879Z - running sql script pg/insert_tenders.sql
2022-09-28T18:28:03.671912Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:28:03.681028Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:28:03.682555Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:28:03.688220Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:28:03.692803Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:28:03.700506Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:28:03.701518Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:28:03.750491Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:28:04.089599Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:28:04.093673Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:28:04.095132Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:28:04.315087Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:28:04.417023Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:28:04.426293Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:28:04.667056Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:28:04.867383Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:28:04.873305Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:28:04.873551Z - job completed in 2.62 seconds (990388ba680fa80d41fc31358bf5b98168f11a160dba74b1144404b17a83743d)
2022-09-28T18:28:04.984307Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a229f73bcfc63b8c11b38e55aa56975634255ca31ff0d6a33804b2f1171f39a3)
2022-09-28T18:28:07.162304Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:28:07.179195Z - running sql script pg/upsert_orders.sql
2022-09-28T18:28:07.179227Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:28:07.184225Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:28:07.189031Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:28:07.190087Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:28:07.194311Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:28:07.195687Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:28:07.199992Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:28:07.200877Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:28:07.201674Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:28:07.208167Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:28:07.332502Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:28:07.368362Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:28:07.372353Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:28:07.380024Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:28:07.446111Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:28:07.458667Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:28:07.459710Z - job completed in 2.48 seconds (a229f73bcfc63b8c11b38e55aa56975634255ca31ff0d6a33804b2f1171f39a3)
2022-09-28T18:28:07.579947Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1308"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (3a312f7542a4a7d82fa5ea8be73ee89c5ccc424b1125d74779630f34fc460628)
2022-09-28T18:28:13.279128Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:28:13.297279Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T18:28:13.297313Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:28:13.302162Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T18:28:13.307223Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T18:28:13.308342Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T18:28:13.309220Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T18:28:13.310384Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T18:28:13.311596Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T18:28:13.312994Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:28:13.313851Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T18:28:13.315144Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T18:28:13.316945Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T18:28:13.318560Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T18:28:13.319488Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T18:28:13.322170Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T18:28:13.323120Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T18:28:13.324252Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T18:28:13.325888Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T18:28:13.436719Z - called http://score/api/keyed and received back 204
2022-09-28T18:28:13.437767Z - job completed in 5.86 seconds (3a312f7542a4a7d82fa5ea8be73ee89c5ccc424b1125d74779630f34fc460628)
2022-09-28T18:30:02.198672Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1320"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9a71f342276150c358fd6696dd6fee2eb2284c2e1b5b5fde328b8f0ce7e112a6)
2022-09-28T18:30:04.612261Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:30:04.632038Z - running sql script pg/upsert_orders.sql
2022-09-28T18:30:04.632119Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:30:04.637331Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:30:04.641778Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:30:04.642750Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:30:04.647869Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:30:04.649368Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:30:04.653399Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:30:04.654639Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:30:04.655650Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:30:04.662620Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:30:04.796010Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:30:04.836360Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:30:04.840219Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:30:04.848256Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:30:04.916384Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:30:04.929648Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:30:04.930145Z - job completed in 2.73 seconds (9a71f342276150c358fd6696dd6fee2eb2284c2e1b5b5fde328b8f0ce7e112a6)
2022-09-28T18:30:04.979123Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1320"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4f09def5fe022a813680d4d7cde45386a8a3e01cf3f7bf43ca8e1243c0d36059)
2022-09-28T18:30:06.527667Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:30:06.546738Z - running sql script pg/insert_tenders.sql
2022-09-28T18:30:06.546910Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:30:06.551825Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:30:06.553132Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:30:06.558599Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:30:06.564428Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:30:06.569438Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:30:06.570736Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:30:06.619554Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:30:06.951497Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:30:06.958268Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:30:06.960116Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:30:07.376703Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:30:07.582600Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:30:07.592547Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:30:08.136224Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:30:08.489031Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:30:08.496103Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:30:08.496508Z - job completed in 3.52 seconds (4f09def5fe022a813680d4d7cde45386a8a3e01cf3f7bf43ca8e1243c0d36059)
2022-09-28T18:32:02.335049Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1322"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a86c22c1e032d2cd0af50c097684b9a7a3312c1154a23b4ad41fa93af829389d)
2022-09-28T18:32:04.873112Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:32:04.903043Z - running sql script pg/upsert_orders.sql
2022-09-28T18:32:04.903079Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:32:04.907776Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:32:04.912913Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:32:04.915606Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:32:04.919975Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:32:04.921550Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:32:04.926189Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:32:04.927194Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:32:04.928151Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:32:04.934891Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:32:05.074826Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:32:05.114732Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:32:05.119807Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:32:05.126865Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:32:05.193100Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:32:05.204314Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:32:05.204701Z - job completed in 2.87 seconds (a86c22c1e032d2cd0af50c097684b9a7a3312c1154a23b4ad41fa93af829389d)
2022-09-28T18:32:05.251405Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1322"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (13ef9d685781ef07caff74814d2de38761f2c0a9becc936e80756efc11e7e838)
2022-09-28T18:32:06.670926Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:32:06.699829Z - running sql script pg/insert_tenders.sql
2022-09-28T18:32:06.699877Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:32:06.707665Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:32:06.710953Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:32:06.716027Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:32:06.722973Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:32:06.728746Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:32:06.731573Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:32:06.781466Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:32:06.834209Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:32:06.839727Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:32:06.841460Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:32:07.056337Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:32:07.151459Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:32:07.164110Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:32:07.403555Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:32:07.623699Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:32:07.629182Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:32:07.629728Z - job completed in 2.38 seconds (13ef9d685781ef07caff74814d2de38761f2c0a9becc936e80756efc11e7e838)
2022-09-28T18:34:02.255738Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1324"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (01b6e992c3ce27ce3605f3a714d42dd2e0c410e9d89a8c10336fd8d2b1167134)
2022-09-28T18:34:04.799760Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:34:04.821240Z - running sql script pg/upsert_orders.sql
2022-09-28T18:34:04.822860Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:34:04.828051Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:34:04.833290Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:34:04.834646Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:34:04.841463Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:34:04.843516Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:34:04.847402Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:34:04.848658Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:34:04.850171Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:34:04.857868Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:34:04.991789Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:34:05.019258Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:34:05.023593Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:34:05.034027Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:34:05.102817Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:34:05.112243Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:34:05.113227Z - job completed in 2.86 seconds (01b6e992c3ce27ce3605f3a714d42dd2e0c410e9d89a8c10336fd8d2b1167134)
2022-09-28T18:34:05.170721Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1324"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (dae0066e6c7e42895355758c3b94432d02273c83f8407224d71f68adf9c43e3d)
2022-09-28T18:34:06.875907Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:34:06.895873Z - running sql script pg/insert_tenders.sql
2022-09-28T18:34:06.895910Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:34:06.900623Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:34:06.902584Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:34:06.907578Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:34:06.913848Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:34:06.919603Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:34:06.920867Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:34:06.968749Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:34:07.027741Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:34:07.034892Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:34:07.036603Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:34:07.243630Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:34:07.338325Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:34:07.349237Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:34:07.644055Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:34:07.845841Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:34:07.851829Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:34:07.852378Z - job completed in 2.68 seconds (dae0066e6c7e42895355758c3b94432d02273c83f8407224d71f68adf9c43e3d)
2022-09-28T18:36:01.960452Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1326"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (afa226a0145d77a437361e142da274b5bdf20d3ef7077d91afe658470c8f5bcc)
2022-09-28T18:36:04.830404Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:36:04.908825Z - running sql script pg/insert_tenders.sql
2022-09-28T18:36:04.908863Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:36:04.913755Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:36:04.915073Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:36:04.919628Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:36:04.929559Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:36:04.935076Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:36:04.936480Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:36:05.034705Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:36:05.079777Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:36:05.084087Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:36:05.086045Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:36:05.295921Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:36:05.389176Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:36:05.398353Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:36:05.635306Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:36:05.852685Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:36:05.858481Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:36:05.858779Z - job completed in 3.90 seconds (afa226a0145d77a437361e142da274b5bdf20d3ef7077d91afe658470c8f5bcc)
2022-09-28T18:36:05.939293Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1326"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (aad58ec87c8fdf79600581ba3f2048bc1d33fa7c84463aa5728f842cf6714645)
2022-09-28T18:36:08.439079Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:36:08.456865Z - running sql script pg/upsert_orders.sql
2022-09-28T18:36:08.456910Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:36:08.461598Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:36:08.466438Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:36:08.467449Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:36:08.471487Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:36:08.473059Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:36:08.477888Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:36:08.479031Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:36:08.479929Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:36:08.486885Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:36:08.629780Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:36:08.644888Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:36:08.648959Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:36:08.659591Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:36:08.727368Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:36:08.742912Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:36:08.743412Z - job completed in 2.80 seconds (aad58ec87c8fdf79600581ba3f2048bc1d33fa7c84463aa5728f842cf6714645)
2022-09-28T18:38:02.333730Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1318"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (7a806b9c6467a2bb93c2be2da8d0bb96bc38020c094cfdf797f80eb24fd277c8)
2022-09-28T18:38:07.254170Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:38:07.272771Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T18:38:07.274374Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:38:07.279569Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T18:38:07.284887Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T18:38:07.289709Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T18:38:07.291005Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T18:38:07.295209Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T18:38:07.302052Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T18:38:07.306295Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:38:07.307480Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T18:38:07.309114Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T18:38:07.315571Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T18:38:07.322443Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T18:38:07.323446Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T18:38:07.329980Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T18:38:07.333772Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T18:38:07.338115Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T18:38:07.343593Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T18:38:07.983884Z - called http://score/api/keyed and received back 200
2022-09-28T18:38:07.984714Z - job completed in 5.65 seconds (7a806b9c6467a2bb93c2be2da8d0bb96bc38020c094cfdf797f80eb24fd277c8)
2022-09-28T18:38:08.158395Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (040691f29212b5c24af862b3180a48e39b449d358ce338cf7d495e52021874ce)
2022-09-28T18:38:09.948311Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:38:09.965696Z - running sql script pg/upsert_orders.sql
2022-09-28T18:38:09.965750Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:38:09.970325Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:38:09.974897Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:38:09.975916Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:38:09.979500Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:38:09.981995Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:38:09.987595Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:38:09.988743Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:38:09.990552Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:38:09.997511Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:38:10.132633Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:38:10.139364Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:38:10.143163Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:38:10.153515Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:38:10.219762Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:38:10.237294Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:38:10.237705Z - job completed in 2.08 seconds (040691f29212b5c24af862b3180a48e39b449d358ce338cf7d495e52021874ce)
2022-09-28T18:38:10.343136Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3664b8c303a5eaf6c5ec2498efa4e0b789d147753ba3713d09a55db1be9bdf05)
2022-09-28T18:38:11.734514Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:38:11.756090Z - running sql script pg/insert_tenders.sql
2022-09-28T18:38:11.756135Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:38:11.761137Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:38:11.762739Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:38:11.767447Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:38:11.771612Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:38:11.782102Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:38:11.783674Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:38:11.832825Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:38:11.870201Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:38:11.874618Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:38:11.876610Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:38:12.119622Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:38:12.233559Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:38:12.251627Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:38:12.542063Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:38:12.880491Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:38:12.886944Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:38:12.887453Z - job completed in 2.54 seconds (3664b8c303a5eaf6c5ec2498efa4e0b789d147753ba3713d09a55db1be9bdf05)
2022-09-28T18:40:02.135439Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1330"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (85cc9a3156233bea137dae6c980f640961c54372c39496a2f2feca85627c19a1)
2022-09-28T18:40:03.812500Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:40:03.851967Z - running sql script pg/insert_tenders.sql
2022-09-28T18:40:03.852003Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:40:03.859012Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:40:03.860607Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:40:03.866385Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:40:03.873039Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:40:03.881215Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:40:03.884151Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:40:03.938302Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:40:04.205869Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:40:04.210918Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:40:04.212512Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:40:04.457060Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:40:04.565783Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:40:04.582856Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:40:04.939680Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:40:05.138307Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:40:05.144217Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:40:05.144684Z - job completed in 3.01 seconds (85cc9a3156233bea137dae6c980f640961c54372c39496a2f2feca85627c19a1)
2022-09-28T18:40:05.192565Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1330"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (38a08d50d360fb710f7440a353b8e25e1ab3e47cd861cdf93b65085a9a81b5bd)
2022-09-28T18:40:07.381564Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:40:07.399912Z - running sql script pg/upsert_orders.sql
2022-09-28T18:40:07.399963Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:40:07.407291Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:40:07.412316Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:40:07.413248Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:40:07.417394Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:40:07.421775Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:40:07.425604Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:40:07.426799Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:40:07.427631Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:40:07.434620Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:40:07.604797Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:40:07.614159Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:40:07.614982Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:40:07.628269Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:40:07.698849Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:40:07.722283Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:40:07.722644Z - job completed in 2.53 seconds (38a08d50d360fb710f7440a353b8e25e1ab3e47cd861cdf93b65085a9a81b5bd)
2022-09-28T18:42:02.402907Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1332"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (bd6e54c2745dc7e5544b65ffa715715cfd86a78faa7ace6d37d5529e8c91fcd4)
2022-09-28T18:42:03.926456Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:42:03.948426Z - running sql script pg/insert_tenders.sql
2022-09-28T18:42:03.948457Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:42:03.952898Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:42:03.954353Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:42:03.958924Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:42:03.964239Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:42:03.970400Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:42:03.971372Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:42:04.021152Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:42:04.055150Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:42:04.059235Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:42:04.060976Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:42:04.311260Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:42:04.419483Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:42:04.431334Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:42:04.677388Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:42:04.898565Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:42:04.908110Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:42:04.909110Z - job completed in 2.51 seconds (bd6e54c2745dc7e5544b65ffa715715cfd86a78faa7ace6d37d5529e8c91fcd4)
2022-09-28T18:42:05.040634Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1332"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (98b8c8be713673fc913356b33f1d00d30af77eb341164f93d3b5c825de914e20)
2022-09-28T18:42:07.350239Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:42:07.367122Z - running sql script pg/upsert_orders.sql
2022-09-28T18:42:07.367160Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:42:07.371720Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:42:07.376581Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:42:07.377484Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:42:07.381593Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:42:07.386016Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:42:07.389965Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:42:07.391168Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:42:07.392164Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:42:07.399294Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:42:07.617409Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:42:07.636492Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:42:07.640285Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:42:07.649366Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:42:07.729742Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:42:07.743659Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:42:07.744178Z - job completed in 2.70 seconds (98b8c8be713673fc913356b33f1d00d30af77eb341164f93d3b5c825de914e20)
2022-09-28T18:44:02.193519Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1334"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (36330be9cabebf6cf520f28b6c16596586c7886fd8213808fe51af988c33aca3)
2022-09-28T18:44:05.103810Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:44:05.120262Z - running sql script pg/upsert_orders.sql
2022-09-28T18:44:05.120315Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:44:05.124800Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:44:05.129434Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:44:05.130505Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:44:05.137440Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:44:05.143892Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:44:05.148420Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:44:05.149359Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:44:05.150344Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:44:05.157649Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:44:05.439367Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:44:05.471613Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:44:05.475171Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:44:05.484032Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:44:05.552158Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:44:05.569029Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:44:05.569266Z - job completed in 3.38 seconds (36330be9cabebf6cf520f28b6c16596586c7886fd8213808fe51af988c33aca3)
2022-09-28T18:44:05.628936Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1334"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (efccc9cc6cb13ca578e605bfe6404b1194e0c6e3cc58689857d61c569cd6d4b6)
2022-09-28T18:44:07.231866Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:44:07.252071Z - running sql script pg/insert_tenders.sql
2022-09-28T18:44:07.252316Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:44:07.258665Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:44:07.260911Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:44:07.265953Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:44:07.271190Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:44:07.277031Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:44:07.278066Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:44:07.327917Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:44:07.358236Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:44:07.362357Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:44:07.363923Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:44:07.608186Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:44:07.717114Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:44:07.730192Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:44:07.973593Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:44:08.174991Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:44:08.181701Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:44:08.182036Z - job completed in 2.55 seconds (efccc9cc6cb13ca578e605bfe6404b1194e0c6e3cc58689857d61c569cd6d4b6)
2022-09-28T18:46:02.235770Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1336"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1f6dbc93a7ee19947ff8840ca51e9c38aaca8e6c072a9a62883825f98cde1f2b)
2022-09-28T18:46:04.877636Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:46:04.928937Z - running sql script pg/upsert_orders.sql
2022-09-28T18:46:04.928975Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:46:04.939957Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:46:04.948492Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:46:04.950189Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:46:04.955805Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:46:04.960690Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:46:04.967708Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:46:04.968822Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:46:04.969842Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:46:04.977713Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:46:05.349229Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:46:05.388819Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:46:05.393262Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:46:05.403046Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:46:05.471629Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:46:05.486925Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:46:05.487397Z - job completed in 3.25 seconds (1f6dbc93a7ee19947ff8840ca51e9c38aaca8e6c072a9a62883825f98cde1f2b)
2022-09-28T18:46:05.518379Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1336"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f9319636b09504e6d83aba9c3a2deb32e330a59b2aa7c575fe3736f15bc575eb)
2022-09-28T18:46:07.212417Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:46:07.228547Z - running sql script pg/insert_tenders.sql
2022-09-28T18:46:07.228588Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:46:07.233497Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:46:07.234738Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:46:07.239821Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:46:07.244738Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:46:07.252010Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:46:07.253Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:46:07.301391Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:46:07.327140Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:46:07.332700Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:46:07.334992Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:46:07.578470Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:46:07.686415Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:46:07.697070Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:46:07.935742Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:46:08.134093Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:46:08.140269Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:46:08.140740Z - job completed in 2.62 seconds (f9319636b09504e6d83aba9c3a2deb32e330a59b2aa7c575fe3736f15bc575eb)
2022-09-28T18:48:02.432992Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (32377f1d747ad92076ac432cff270172a3ec5d360ec923aaf837aa4bb2546618)
2022-09-28T18:48:03.827998Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:48:03.848205Z - running sql script pg/insert_tenders.sql
2022-09-28T18:48:03.848251Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:48:03.853484Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:48:03.854922Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:48:03.859377Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:48:03.863815Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:48:03.868936Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:48:03.870480Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:48:03.919136Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:48:03.992121Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:48:03.996258Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:48:03.997819Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:48:04.245466Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:48:04.361606Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:48:04.374112Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:48:04.623039Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:48:04.824302Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:48:04.833296Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:48:04.833830Z - job completed in 2.40 seconds (32377f1d747ad92076ac432cff270172a3ec5d360ec923aaf837aa4bb2546618)
2022-09-28T18:48:04.911242Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0f86ec3095639e58a1fd81ff281d2e63167a6d0072b06c4dc5cfd7eddc2592b8)
2022-09-28T18:48:07.286027Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:48:07.311480Z - running sql script pg/upsert_orders.sql
2022-09-28T18:48:07.311920Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:48:07.316792Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:48:07.323524Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:48:07.324832Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:48:07.329768Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:48:07.335866Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:48:07.340804Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:48:07.342929Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:48:07.344350Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:48:07.354498Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:48:07.887081Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:48:07.922280Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:48:07.926493Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:48:07.936824Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:48:08.053235Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:48:08.068644Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:48:08.069015Z - job completed in 3.16 seconds (0f86ec3095639e58a1fd81ff281d2e63167a6d0072b06c4dc5cfd7eddc2592b8)
2022-09-28T18:48:08.100744Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1328"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (fb671e65c304b8a61d8a716a72dd33f1387bdd8af6bca369f23230db45ca48a1)
2022-09-28T18:48:14.044063Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:48:14.061313Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T18:48:14.061519Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:48:14.066488Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T18:48:14.074679Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T18:48:14.078448Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T18:48:14.079941Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T18:48:14.083709Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T18:48:14.087809Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T18:48:14.091140Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:48:14.092154Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T18:48:14.093026Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T18:48:14.098867Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T18:48:14.110820Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T18:48:14.111857Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T18:48:14.121973Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T18:48:14.131664Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T18:48:14.137484Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T18:48:14.144825Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T18:48:14.858598Z - called http://score/api/keyed and received back 200
2022-09-28T18:48:14.858766Z - job completed in 6.76 seconds (fb671e65c304b8a61d8a716a72dd33f1387bdd8af6bca369f23230db45ca48a1)
2022-09-28T18:50:02.051293Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1340"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c79027b400f18174f43776094befd4707a962a8eb1ab469fb29ed1128b9bbc65)
2022-09-28T18:50:04.133828Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:50:04.163311Z - running sql script pg/insert_tenders.sql
2022-09-28T18:50:04.163350Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:50:04.168246Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:50:04.170483Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:50:04.175041Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:50:04.179191Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:50:04.184600Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:50:04.185450Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:50:04.233859Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:50:04.294142Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:50:04.300526Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:50:04.302083Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:50:04.552409Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:50:04.662832Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:50:04.683849Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:50:04.951026Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:50:05.180850Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:50:05.189152Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:50:05.189668Z - job completed in 3.14 seconds (c79027b400f18174f43776094befd4707a962a8eb1ab469fb29ed1128b9bbc65)
2022-09-28T18:50:05.226822Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1340"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (087d0519ae581fec5a8dd93b2932d6f929fe24f6943f20a1bdd6825548564858)
2022-09-28T18:50:07.635736Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:50:07.654634Z - running sql script pg/upsert_orders.sql
2022-09-28T18:50:07.654669Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:50:07.660886Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:50:07.666366Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:50:07.667316Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:50:07.671815Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:50:07.677503Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:50:07.681619Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:50:07.683152Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:50:07.683969Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:50:07.692751Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:50:08.213242Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:50:08.235017Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:50:08.238494Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:50:08.254303Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:50:08.328066Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:50:08.359019Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:50:08.359425Z - job completed in 3.13 seconds (087d0519ae581fec5a8dd93b2932d6f929fe24f6943f20a1bdd6825548564858)
2022-09-28T18:52:02.326620Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1342"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (02945b1c740f2759ef9f8a45e22e08f5f9b495bf51a646cbcfd030cc19c07818)
2022-09-28T18:52:04.820073Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:52:04.836561Z - running sql script pg/upsert_orders.sql
2022-09-28T18:52:04.836606Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:52:04.842032Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:52:04.847505Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:52:04.848480Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:52:04.854955Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:52:04.857254Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:52:04.861783Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:52:04.863261Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:52:04.864034Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:52:04.875636Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:52:05.511039Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:52:05.531655Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:52:05.535736Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:52:05.546268Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:52:05.619261Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:52:05.636837Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:52:05.637274Z - job completed in 3.31 seconds (02945b1c740f2759ef9f8a45e22e08f5f9b495bf51a646cbcfd030cc19c07818)
2022-09-28T18:52:05.716420Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1342"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3b232d11a4faa80f8859f8aa37a913e6fb06d7dabfb820e71fb4acccbd956497)
2022-09-28T18:52:07.428773Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:52:07.447498Z - running sql script pg/insert_tenders.sql
2022-09-28T18:52:07.447559Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:52:07.454001Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:52:07.455866Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:52:07.460749Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:52:07.465328Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:52:07.470642Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:52:07.471744Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:52:07.520723Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:52:07.550675Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:52:07.554992Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:52:07.556769Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:52:07.806995Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:52:07.917574Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:52:07.929442Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:52:08.173897Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:52:08.372419Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:52:08.379215Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:52:08.379900Z - job completed in 2.66 seconds (3b232d11a4faa80f8859f8aa37a913e6fb06d7dabfb820e71fb4acccbd956497)
2022-09-28T18:54:02.060312Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1344"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4e7654931cba7895f803618ae730507c6301bb626f5c1c5b4b20378efccdbafb)
2022-09-28T18:54:04.176240Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:54:04.193869Z - running sql script pg/upsert_orders.sql
2022-09-28T18:54:04.194467Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:54:04.199616Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:54:04.205705Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:54:04.206700Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:54:04.211320Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:54:04.215644Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:54:04.219998Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:54:04.221147Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:54:04.222204Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:54:04.231658Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:54:04.780831Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:54:04.801100Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:54:04.804682Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:54:04.817485Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:54:04.888989Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:54:04.906224Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:54:04.906452Z - job completed in 2.85 seconds (4e7654931cba7895f803618ae730507c6301bb626f5c1c5b4b20378efccdbafb)
2022-09-28T18:54:05.068659Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1344"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b53d710f7d2864c4f6d2b8f0cbf63fc4086d48d4cc934a10d50a4f1ff71e97e2)
2022-09-28T18:54:06.707277Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:54:06.729790Z - running sql script pg/insert_tenders.sql
2022-09-28T18:54:06.729825Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:54:06.734055Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:54:06.735674Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:54:06.743200Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:54:06.747670Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:54:06.753522Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:54:06.754446Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:54:06.805563Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:54:06.823927Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:54:06.828066Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:54:06.830217Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:54:07.094343Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:54:07.201644Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:54:07.213463Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:54:07.455627Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:54:07.652573Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:54:07.658815Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:54:07.659209Z - job completed in 2.59 seconds (b53d710f7d2864c4f6d2b8f0cbf63fc4086d48d4cc934a10d50a4f1ff71e97e2)
2022-09-28T18:56:02.183713Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1346"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (76aed627885902c7a3e1011c113efbdddba9bc0655ccfa88cffa3f53f4f69233)
2022-09-28T18:56:03.704632Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:56:03.720482Z - running sql script pg/insert_tenders.sql
2022-09-28T18:56:03.720515Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:56:03.724656Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:56:03.726238Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:56:03.732301Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:56:03.736981Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:56:03.744352Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:56:03.750433Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:56:03.797155Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:56:03.854036Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:56:03.857715Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:56:03.859306Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:56:04.090041Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:56:04.192778Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:56:04.203402Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:56:04.453716Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:56:04.649469Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:56:04.655438Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:56:04.655909Z - job completed in 2.47 seconds (76aed627885902c7a3e1011c113efbdddba9bc0655ccfa88cffa3f53f4f69233)
2022-09-28T18:56:04.755873Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1346"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (89f8907157dfbbed4c265b8e21a1f0a8b61b06baaaf887208331f7c6aed8ea16)
2022-09-28T18:56:07.505511Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:56:07.521022Z - running sql script pg/upsert_orders.sql
2022-09-28T18:56:07.521064Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:56:07.525519Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:56:07.530587Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:56:07.531872Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:56:07.536428Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:56:07.541314Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:56:07.545860Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:56:07.546794Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:56:07.547632Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:56:07.555260Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:56:08.027739Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:56:08.066550Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:56:08.070273Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:56:08.078987Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:56:08.146200Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:56:08.159812Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:56:08.160206Z - job completed in 3.41 seconds (89f8907157dfbbed4c265b8e21a1f0a8b61b06baaaf887208331f7c6aed8ea16)
2022-09-28T18:58:02.250486Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ee3bb2bbda022d191496859f910c49b0f023df5a3b3547626d88f4c611fe8517)
2022-09-28T18:58:03.666935Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:58:03.684162Z - running sql script pg/insert_tenders.sql
2022-09-28T18:58:03.684217Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T18:58:03.689683Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T18:58:03.691131Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T18:58:03.695376Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T18:58:03.700033Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T18:58:03.705698Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T18:58:03.706785Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T18:58:03.754693Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T18:58:03.785816Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T18:58:03.789831Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T18:58:03.791501Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T18:58:04.008910Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T18:58:04.108605Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T18:58:04.117772Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T18:58:04.355308Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T18:58:04.552316Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T18:58:04.558013Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T18:58:04.558286Z - job completed in 2.31 seconds (ee3bb2bbda022d191496859f910c49b0f023df5a3b3547626d88f4c611fe8517)
2022-09-28T18:58:04.691005Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7c9262d8d9bf25a46afa78da8dfdbb99be03412597b275f3015753cec5b25672)
2022-09-28T18:58:07.259515Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:58:07.276655Z - running sql script pg/upsert_orders.sql
2022-09-28T18:58:07.276683Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:58:07.281531Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T18:58:07.286462Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T18:58:07.287604Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T18:58:07.295045Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T18:58:07.299331Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T18:58:07.303628Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:58:07.305047Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T18:58:07.306479Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T18:58:07.314066Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T18:58:07.675215Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T18:58:07.719692Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T18:58:07.724095Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T18:58:07.735424Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T18:58:07.800989Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T18:58:07.816808Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T18:58:07.817237Z - job completed in 3.13 seconds (7c9262d8d9bf25a46afa78da8dfdbb99be03412597b275f3015753cec5b25672)
2022-09-28T18:58:07.895386Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1338"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (f7ea7ecc8249674bcc9b7defbe4b378a66336cbdf8b9cf59fd713f63b32b914b)
2022-09-28T18:58:14.499272Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T18:58:14.519814Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T18:58:14.519859Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T18:58:14.524295Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T18:58:14.529054Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T18:58:14.533261Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T18:58:14.534383Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T18:58:14.538387Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T18:58:14.542812Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T18:58:14.547199Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T18:58:14.550718Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T18:58:14.553010Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T18:58:14.563081Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T18:58:14.568028Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T18:58:14.568916Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T18:58:14.577234Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T18:58:14.581208Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T18:58:14.586291Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T18:58:14.592458Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T18:58:15.382390Z - called http://score/api/keyed and received back 200
2022-09-28T18:58:15.382607Z - job completed in 7.49 seconds (f7ea7ecc8249674bcc9b7defbe4b378a66336cbdf8b9cf59fd713f63b32b914b)
2022-09-28T19:00:02.243515Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1350"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b3948c2d50c86c9980d192be0612b76be6c686be117e00d1d227f6401d778e26)
2022-09-28T19:00:05.311784Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:00:05.328764Z - running sql script pg/upsert_orders.sql
2022-09-28T19:00:05.328819Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:00:05.334498Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:00:05.339874Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:00:05.340961Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:00:05.345190Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:00:05.350671Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:00:05.355012Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:00:05.356090Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:00:05.356976Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:00:05.364564Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:00:05.597157Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:00:05.628797Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:00:05.632869Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:00:05.646066Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:00:05.721636Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:00:05.750854Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:00:05.751188Z - job completed in 3.51 seconds (b3948c2d50c86c9980d192be0612b76be6c686be117e00d1d227f6401d778e26)
2022-09-28T19:00:05.830291Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1350"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6554bfc21fb5d39011d8fc8b21268ea5e268e2b6898d27bd6608ac2d3a028a31)
2022-09-28T19:00:07.452625Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:00:07.468373Z - running sql script pg/insert_tenders.sql
2022-09-28T19:00:07.468446Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:00:07.473310Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:00:07.474799Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:00:07.479400Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:00:07.484324Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:00:07.489277Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:00:07.490386Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:00:07.537573Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:00:07.591752Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:00:07.596002Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:00:07.597537Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:00:07.825004Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:00:07.929898Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:00:07.946263Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:00:08.187873Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:00:08.384708Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:00:08.392453Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:00:08.393129Z - job completed in 2.56 seconds (6554bfc21fb5d39011d8fc8b21268ea5e268e2b6898d27bd6608ac2d3a028a31)
2022-09-28T19:02:02.028780Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1352"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (09539f8792f2c85cd13d33027203be60c8214a4240fcd4efda3e26207fd22a45)
2022-09-28T19:02:03.788595Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:02:03.805379Z - running sql script pg/insert_tenders.sql
2022-09-28T19:02:03.805411Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:02:03.811052Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:02:03.812641Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:02:03.817399Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:02:03.821493Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:02:03.826298Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:02:03.827239Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:02:03.875565Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:02:03.936625Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:02:03.940450Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:02:03.941995Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:02:04.170094Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:02:04.275958Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:02:04.282482Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:02:04.522947Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:02:04.713890Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:02:04.719208Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:02:04.719496Z - job completed in 2.69 seconds (09539f8792f2c85cd13d33027203be60c8214a4240fcd4efda3e26207fd22a45)
2022-09-28T19:02:04.846006Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1352"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (02b8417169ad87c37ba9d5673d8154a61e5e575ca104cc26c5f7200895de3f48)
2022-09-28T19:02:07.406887Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:02:07.424707Z - running sql script pg/upsert_orders.sql
2022-09-28T19:02:07.424787Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:02:07.429821Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:02:07.434569Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:02:07.435402Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:02:07.442054Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:02:07.447001Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:02:07.451186Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:02:07.452242Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:02:07.453229Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:02:07.460272Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:02:07.619935Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:02:07.651492Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:02:07.655999Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:02:07.662992Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:02:07.727976Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:02:07.739129Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:02:07.739654Z - job completed in 2.89 seconds (02b8417169ad87c37ba9d5673d8154a61e5e575ca104cc26c5f7200895de3f48)
2022-09-28T19:04:02.219823Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1354"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9c8b2986585a5eb86d9ae62da0bda24adebd1325d8f9430a70ca775a0b650afc)
2022-09-28T19:04:03.776291Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:04:03.794277Z - running sql script pg/insert_tenders.sql
2022-09-28T19:04:03.794311Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:04:03.799336Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:04:03.800690Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:04:03.805763Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:04:03.809772Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:04:03.814242Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:04:03.815356Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:04:03.863288Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:04:03.923039Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:04:03.927217Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:04:03.928773Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:04:04.182494Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:04:04.330108Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:04:04.337628Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:04:04.572938Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:04:04.764177Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:04:04.769839Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:04:04.770282Z - job completed in 2.55 seconds (9c8b2986585a5eb86d9ae62da0bda24adebd1325d8f9430a70ca775a0b650afc)
2022-09-28T19:04:04.858444Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1354"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (219d5894397469c6808228562e49c26e4b59a303838edfbb9781cf38eaaf9b0f)
2022-09-28T19:04:07.178648Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:04:07.194579Z - running sql script pg/upsert_orders.sql
2022-09-28T19:04:07.194620Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:04:07.199279Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:04:07.204370Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:04:07.205429Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:04:07.211013Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:04:07.215132Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:04:07.219174Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:04:07.221186Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:04:07.222596Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:04:07.228569Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:04:07.353241Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:04:07.389683Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:04:07.394640Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:04:07.402119Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:04:07.464865Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:04:07.474661Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:04:07.475081Z - job completed in 2.62 seconds (219d5894397469c6808228562e49c26e4b59a303838edfbb9781cf38eaaf9b0f)
2022-09-28T19:06:02.198368Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1356"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (10dfdc9cc0597090d1ae7ce31922278e1c65922607fa142ab3c31139427150c6)
2022-09-28T19:06:03.871256Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:06:03.889480Z - running sql script pg/insert_tenders.sql
2022-09-28T19:06:03.889518Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:06:03.895191Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:06:03.896767Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:06:03.901090Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:06:03.905483Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:06:03.910910Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:06:03.911959Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:06:03.960707Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:06:04.013843Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:06:04.018207Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:06:04.019771Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:06:04.244578Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:06:04.346758Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:06:04.352852Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:06:04.588470Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:06:04.777686Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:06:04.783674Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:06:04.784200Z - job completed in 2.59 seconds (10dfdc9cc0597090d1ae7ce31922278e1c65922607fa142ab3c31139427150c6)
2022-09-28T19:06:04.816539Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1356"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8e33ef12072be7485910b8769beafa595b95890a022cdffc78eb10a2dc5f46f1)
2022-09-28T19:06:07.153748Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:06:07.170687Z - running sql script pg/upsert_orders.sql
2022-09-28T19:06:07.170718Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:06:07.176628Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:06:07.181296Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:06:07.182345Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:06:07.186651Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:06:07.190953Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:06:07.195863Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:06:07.196968Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:06:07.198004Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:06:07.204012Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:06:07.344161Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:06:07.392339Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:06:07.396496Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:06:07.405797Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:06:07.476785Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:06:07.490092Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:06:07.490602Z - job completed in 2.67 seconds (8e33ef12072be7485910b8769beafa595b95890a022cdffc78eb10a2dc5f46f1)
2022-09-28T19:08:01.991642Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1348"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (f3cc1f3a3f21e6a9190c9549ec87e607898ef3a1a1dc2575dd2958578e3001de)
2022-09-28T19:08:08.722619Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:08:08.741769Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T19:08:08.742004Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:08:08.747085Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T19:08:08.755597Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T19:08:08.760016Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T19:08:08.761258Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T19:08:08.765645Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T19:08:08.770853Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T19:08:08.775590Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:08:08.777871Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T19:08:08.779655Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T19:08:08.786287Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T19:08:08.795732Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T19:08:08.797162Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T19:08:08.805269Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T19:08:08.810543Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T19:08:08.821123Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T19:08:08.830372Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T19:08:09.798368Z - called http://score/api/keyed and received back 200
2022-09-28T19:08:09.798445Z - job completed in 7.81 seconds (f3cc1f3a3f21e6a9190c9549ec87e607898ef3a1a1dc2575dd2958578e3001de)
2022-09-28T19:08:09.912113Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (648f15fe11d06ac801b90f8ee20e209e28e47d6a87dd37ee3f680694b76060ba)
2022-09-28T19:08:11.520425Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:08:11.536606Z - running sql script pg/insert_tenders.sql
2022-09-28T19:08:11.536666Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:08:11.541532Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:08:11.542919Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:08:11.548039Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:08:11.552518Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:08:11.557943Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:08:11.558829Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:08:11.606762Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:08:11.646353Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:08:11.651449Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:08:11.655321Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:08:11.889581Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:08:11.989890Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:08:11.995255Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:08:12.226155Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:08:12.413319Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:08:12.418559Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:08:12.418851Z - job completed in 2.51 seconds (648f15fe11d06ac801b90f8ee20e209e28e47d6a87dd37ee3f680694b76060ba)
2022-09-28T19:08:12.532274Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1099eee3896d5515c18811fe97f3729bce78cb76644476ff6e0afc8cd7c6aa0f)
2022-09-28T19:08:15.104591Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:08:15.122153Z - running sql script pg/upsert_orders.sql
2022-09-28T19:08:15.122197Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:08:15.127293Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:08:15.132098Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:08:15.133190Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:08:15.137975Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:08:15.142407Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:08:15.147964Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:08:15.148900Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:08:15.149824Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:08:15.157369Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:08:15.319687Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:08:15.344632Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:08:15.349250Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:08:15.361149Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:08:15.426052Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:08:15.438231Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:08:15.438639Z - job completed in 2.91 seconds (1099eee3896d5515c18811fe97f3729bce78cb76644476ff6e0afc8cd7c6aa0f)
2022-09-28T19:10:02.300707Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1400"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f1a5865eb3205e329f708301563186e4871c3c936b07126370084dca98b8e102)
2022-09-28T19:10:04.766620Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:10:04.788164Z - running sql script pg/upsert_orders.sql
2022-09-28T19:10:04.788676Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:10:04.794141Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:10:04.799966Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:10:04.801285Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:10:04.805858Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:10:04.807295Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:10:04.812568Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:10:04.813907Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:10:04.815008Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:10:04.824592Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:10:05.004377Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:10:05.055797Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:10:05.060290Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:10:05.072258Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:10:05.146124Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:10:05.161251Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:10:05.161624Z - job completed in 2.86 seconds (f1a5865eb3205e329f708301563186e4871c3c936b07126370084dca98b8e102)
2022-09-28T19:10:05.287287Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1400"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (aec51f38418753820b92f648361c2350f715759266b14393b258b07f6ab3a609)
2022-09-28T19:10:06.856253Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:10:06.874103Z - running sql script pg/insert_tenders.sql
2022-09-28T19:10:06.874152Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:10:06.878823Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:10:06.880516Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:10:06.884933Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:10:06.889103Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:10:06.894075Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:10:06.895368Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:10:06.943976Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:10:06.963022Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:10:06.968985Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:10:06.970774Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:10:07.203147Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:10:07.304474Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:10:07.311871Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:10:07.544835Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:10:07.736425Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:10:07.741251Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:10:07.741784Z - job completed in 2.45 seconds (aec51f38418753820b92f648361c2350f715759266b14393b258b07f6ab3a609)
2022-09-28T19:12:02.143526Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1402"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (54eb358b9f4f8aac973a586170715e8a80385c5784ae30300c7dff7ca7002bc4)
2022-09-28T19:12:03.825837Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:12:03.842342Z - running sql script pg/insert_tenders.sql
2022-09-28T19:12:03.842383Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:12:03.849594Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:12:03.851223Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:12:03.855395Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:12:03.859564Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:12:03.864106Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:12:03.865010Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:12:03.912608Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:12:03.920607Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:12:03.924722Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:12:03.926238Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:12:04.143356Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:12:04.239722Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:12:04.245719Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:12:04.474957Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:12:04.657595Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:12:04.663284Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:12:04.663891Z - job completed in 2.52 seconds (54eb358b9f4f8aac973a586170715e8a80385c5784ae30300c7dff7ca7002bc4)
2022-09-28T19:12:04.748113Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1402"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2a65c6e4972d807e6ed11649bcff2f0f046bf5dd99668d25dfcb3b96db49f21a)
2022-09-28T19:12:07.054632Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:12:07.078509Z - running sql script pg/upsert_orders.sql
2022-09-28T19:12:07.078543Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:12:07.083924Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:12:07.088637Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:12:07.089946Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:12:07.094338Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:12:07.099968Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:12:07.104426Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:12:07.105420Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:12:07.106270Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:12:07.112461Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:12:07.346947Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:12:07.390471Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:12:07.394563Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:12:07.402776Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:12:07.467036Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:12:07.478086Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:12:07.478556Z - job completed in 2.73 seconds (2a65c6e4972d807e6ed11649bcff2f0f046bf5dd99668d25dfcb3b96db49f21a)
2022-09-28T19:14:02.076256Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1404"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (e548435161e974702edeee822f07616bbba5547002f5a12df83188e2891421ba)
2022-09-28T19:14:03.793458Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:14:03.809798Z - running sql script pg/insert_tenders.sql
2022-09-28T19:14:03.809827Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:14:03.814839Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:14:03.816506Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:14:03.823077Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:14:03.827578Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:14:03.834325Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:14:03.835455Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:14:03.883952Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:14:04.024457Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:14:04.029265Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:14:04.030915Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:14:04.255192Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:14:04.357311Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:14:04.363622Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:14:04.597621Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:14:04.775136Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:14:04.780775Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:14:04.781043Z - job completed in 2.71 seconds (e548435161e974702edeee822f07616bbba5547002f5a12df83188e2891421ba)
2022-09-28T19:14:04.889064Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1404"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6e86ee83418cb15a7aa9368c2324d096f961a359c4a7ee919e1706a3386ab305)
2022-09-28T19:14:07.285629Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:14:07.301434Z - running sql script pg/upsert_orders.sql
2022-09-28T19:14:07.301474Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:14:07.308208Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:14:07.313239Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:14:07.314255Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:14:07.318383Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:14:07.322602Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:14:07.327165Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:14:07.328496Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:14:07.329394Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:14:07.336263Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:14:07.481164Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:14:07.540127Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:14:07.545591Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:14:07.553269Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:14:07.617973Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:14:07.627368Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:14:07.627923Z - job completed in 2.74 seconds (6e86ee83418cb15a7aa9368c2324d096f961a359c4a7ee919e1706a3386ab305)
2022-09-28T19:16:02.058583Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1406"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1c766d76404bd0be5d837394c7b00691373fc7e72bbdd11b3f084398cb4f375d)
2022-09-28T19:16:04.784201Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:16:04.806336Z - running sql script pg/upsert_orders.sql
2022-09-28T19:16:04.806469Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:16:04.812031Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:16:04.817052Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:16:04.818074Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:16:04.822391Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:16:04.826925Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:16:04.831762Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:16:04.832790Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:16:04.833952Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:16:04.841310Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:16:04.980885Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:16:05.042979Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:16:05.047414Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:16:05.057531Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:16:05.121674Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:16:05.133860Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:16:05.134233Z - job completed in 3.08 seconds (1c766d76404bd0be5d837394c7b00691373fc7e72bbdd11b3f084398cb4f375d)
2022-09-28T19:16:05.178630Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1406"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6bc3728c49d8ab336122c8c0835eded2c9455e3c7763fc28076c6d488fddca74)
2022-09-28T19:16:06.838412Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:16:06.856681Z - running sql script pg/insert_tenders.sql
2022-09-28T19:16:06.856716Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:16:06.861274Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:16:06.862785Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:16:06.866780Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:16:06.870987Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:16:06.877409Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:16:06.878669Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:16:06.925730Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:16:06.970382Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:16:06.974399Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:16:06.976560Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:16:07.197979Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:16:07.297810Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:16:07.304499Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:16:07.550512Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:16:07.742367Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:16:07.747938Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:16:07.748355Z - job completed in 2.57 seconds (6bc3728c49d8ab336122c8c0835eded2c9455e3c7763fc28076c6d488fddca74)
2022-09-28T19:18:01.881498Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1358"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (18d0a9ef80daf07e3f526ab7761ac86d667b85d6ae943947a193566770e34b92)
2022-09-28T19:18:08.187369Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:18:08.204796Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T19:18:08.204826Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:18:08.209997Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T19:18:08.215681Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T19:18:08.222123Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T19:18:08.223117Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T19:18:08.227461Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T19:18:08.231881Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T19:18:08.236083Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:18:08.236948Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T19:18:08.237830Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T19:18:08.244223Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T19:18:08.249936Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T19:18:08.250905Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T19:18:08.257452Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T19:18:08.263640Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T19:18:08.267901Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T19:18:08.274308Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T19:18:09.171817Z - called http://score/api/keyed and received back 200
2022-09-28T19:18:09.171945Z - job completed in 7.29 seconds (18d0a9ef80daf07e3f526ab7761ac86d667b85d6ae943947a193566770e34b92)
2022-09-28T19:18:09.224590Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1408"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6fe06cb2e310b50846b12459c8bd475c21178e9954b9909e28a761ec7b24df96)
2022-09-28T19:18:11.552199Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:18:11.571978Z - running sql script pg/upsert_orders.sql
2022-09-28T19:18:11.572020Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:18:11.577190Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:18:11.582470Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:18:11.583635Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:18:11.587773Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:18:11.592494Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:18:11.596809Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:18:11.597882Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:18:11.598808Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:18:11.605322Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:18:11.753978Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:18:11.781214Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:18:11.785140Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:18:11.797101Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:18:11.864953Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:18:11.880210Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:18:11.880953Z - job completed in 2.66 seconds (6fe06cb2e310b50846b12459c8bd475c21178e9954b9909e28a761ec7b24df96)
2022-09-28T19:18:11.942377Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1408"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (49f72f993612383ecc7ca9ae91fa871ce3cb120111421e08438fb9ff36c1f55c)
2022-09-28T19:18:13.535243Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:18:13.551751Z - running sql script pg/insert_tenders.sql
2022-09-28T19:18:13.551782Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:18:13.557072Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:18:13.558803Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:18:13.563399Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:18:13.567582Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:18:13.572946Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:18:13.573991Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:18:13.622656Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:18:13.704794Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:18:13.709012Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:18:13.710831Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:18:13.984616Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:18:14.088225Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:18:14.105572Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:18:14.346499Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:18:14.545676Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:18:14.552100Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:18:14.552467Z - job completed in 2.61 seconds (49f72f993612383ecc7ca9ae91fa871ce3cb120111421e08438fb9ff36c1f55c)
2022-09-28T19:20:02.364874Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1410"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f8e66e80859f9901205c6dbc3dd7bf2a462417307f445c483638130214b644cb)
2022-09-28T19:20:03.751946Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:20:03.767711Z - running sql script pg/insert_tenders.sql
2022-09-28T19:20:03.767737Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:20:03.773490Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:20:03.775068Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:20:03.782817Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:20:03.787869Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:20:03.793547Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:20:03.794733Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:20:03.847009Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:20:03.897163Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:20:03.901889Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:20:03.903756Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:20:04.127150Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:20:04.229656Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:20:04.243320Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:20:04.493296Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:20:04.690066Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:20:04.699099Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:20:04.699524Z - job completed in 2.34 seconds (f8e66e80859f9901205c6dbc3dd7bf2a462417307f445c483638130214b644cb)
2022-09-28T19:20:04.819863Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1410"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5db854064b2fd4632d21e361cefdf2502d99fee76d92d1fa8282ea55d7099ebb)
2022-09-28T19:20:07.073346Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:20:07.093015Z - running sql script pg/upsert_orders.sql
2022-09-28T19:20:07.093065Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:20:07.097900Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:20:07.102953Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:20:07.103982Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:20:07.108182Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:20:07.112332Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:20:07.117129Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:20:07.118526Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:20:07.120253Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:20:07.126826Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:20:07.315421Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:20:07.348249Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:20:07.352195Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:20:07.364780Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:20:07.439190Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:20:07.463114Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:20:07.463479Z - job completed in 2.64 seconds (5db854064b2fd4632d21e361cefdf2502d99fee76d92d1fa8282ea55d7099ebb)
2022-09-28T19:22:02.277596Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1412"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b19c8353edfe5895aa99b2f95d2eb5fe718be73d09e2479e7b0aa79d4724331f)
2022-09-28T19:22:04.675454Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:22:04.692778Z - running sql script pg/upsert_orders.sql
2022-09-28T19:22:04.692810Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:22:04.698170Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:22:04.702912Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:22:04.704107Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:22:04.708566Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:22:04.710197Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:22:04.714668Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:22:04.715911Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:22:04.717027Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:22:04.724496Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:22:04.941564Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:22:04.998822Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:22:05.002811Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:22:05.011151Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:22:05.080028Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:22:05.094733Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:22:05.095189Z - job completed in 2.82 seconds (b19c8353edfe5895aa99b2f95d2eb5fe718be73d09e2479e7b0aa79d4724331f)
2022-09-28T19:22:05.246592Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1412"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a9d0c79f58f6e94068dd34d38b9bb0b9ea03a26e2221a9ffbfc7d7c8f4b54f22)
2022-09-28T19:22:07.478737Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:22:07.495908Z - running sql script pg/insert_tenders.sql
2022-09-28T19:22:07.495940Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:22:07.500794Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:22:07.502351Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:22:07.507131Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:22:07.511353Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:22:07.517077Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:22:07.518154Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:22:07.565284Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:22:07.617744Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:22:07.621746Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:22:07.623223Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:22:07.842406Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:22:07.944610Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:22:07.952007Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:22:08.187464Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:22:08.377690Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:22:08.382970Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:22:08.383381Z - job completed in 3.14 seconds (a9d0c79f58f6e94068dd34d38b9bb0b9ea03a26e2221a9ffbfc7d7c8f4b54f22)
2022-09-28T19:24:02.047812Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1414"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c1dc652dbf4b5bbf4f35bd3fc77c3730b01a3226ff2de4a1071b20078d76c39f)
2022-09-28T19:24:03.609813Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:24:03.627798Z - running sql script pg/insert_tenders.sql
2022-09-28T19:24:03.627834Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:24:03.632767Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:24:03.634223Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:24:03.638607Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:24:03.642714Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:24:03.647874Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:24:03.648989Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:24:03.695601Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:24:03.729280Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:24:03.733659Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:24:03.735096Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:24:03.953061Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:24:04.052176Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:24:04.058525Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:24:04.292333Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:24:04.486680Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:24:04.492948Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:24:04.493579Z - job completed in 2.45 seconds (c1dc652dbf4b5bbf4f35bd3fc77c3730b01a3226ff2de4a1071b20078d76c39f)
2022-09-28T19:24:04.516705Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1414"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d2ca471198ff5a030ae480eb4d1c355605473d9c92b18e84f6b3471e264a7b4a)
2022-09-28T19:24:06.592829Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:24:06.609505Z - running sql script pg/upsert_orders.sql
2022-09-28T19:24:06.609535Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:24:06.614307Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:24:06.619484Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:24:06.620664Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:24:06.627351Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:24:06.628956Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:24:06.634464Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:24:06.635610Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:24:06.636514Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:24:06.643507Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:24:06.860119Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:24:06.922650Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:24:06.926445Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:24:06.933607Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:24:06.998411Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:24:07.010584Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:24:07.010895Z - job completed in 2.49 seconds (d2ca471198ff5a030ae480eb4d1c355605473d9c92b18e84f6b3471e264a7b4a)
2022-09-28T19:26:02.052605Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1416"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b77e70ab201f31d50e7b57d4e84153395e6b51f14d97c48a7dec6d1e92316aa2)
2022-09-28T19:26:04.728675Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:26:04.745037Z - running sql script pg/upsert_orders.sql
2022-09-28T19:26:04.745069Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:26:04.750148Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:26:04.754958Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:26:04.755901Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:26:04.760061Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:26:04.761626Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:26:04.765625Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:26:04.766581Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:26:04.767425Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:26:04.774528Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:26:05.024682Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:26:05.140559Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:26:05.144516Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:26:05.156073Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:26:05.226782Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:26:05.240380Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:26:05.240763Z - job completed in 3.19 seconds (b77e70ab201f31d50e7b57d4e84153395e6b51f14d97c48a7dec6d1e92316aa2)
2022-09-28T19:26:05.331920Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1416"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d2eb4bc41b6566db451f891f607223ced1deff1aaff9e0b9e17ff3b672367877)
2022-09-28T19:26:06.466793Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:26:06.483417Z - running sql script pg/insert_tenders.sql
2022-09-28T19:26:06.483449Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:26:06.488278Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:26:06.489538Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:26:06.493477Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:26:06.497526Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:26:06.502308Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:26:06.503315Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:26:06.550765Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:26:06.617954Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:26:06.621847Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:26:06.623361Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:26:06.844168Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:26:06.945026Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:26:06.953292Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:26:07.184753Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:26:07.378613Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:26:07.386584Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:26:07.387122Z - job completed in 2.06 seconds (d2eb4bc41b6566db451f891f607223ced1deff1aaff9e0b9e17ff3b672367877)
2022-09-28T19:28:02.043217Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1408"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (5a123ac7773783be8a0150fca789a41f1cd3f7c45a3f86463f333236ec1201b0)
2022-09-28T19:28:08.047134Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:28:08.066254Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T19:28:08.066292Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:28:08.070851Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T19:28:08.076137Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T19:28:08.080595Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T19:28:08.081730Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T19:28:08.085634Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T19:28:08.089832Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T19:28:08.090873Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:28:08.091789Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T19:28:08.092727Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T19:28:08.098766Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T19:28:08.104208Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T19:28:08.105087Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T19:28:08.111606Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T19:28:08.115574Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T19:28:08.121803Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T19:28:08.128292Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T19:28:10.019252Z - called http://score/api/keyed and received back 200
2022-09-28T19:28:10.019353Z - job completed in 7.98 seconds (5a123ac7773783be8a0150fca789a41f1cd3f7c45a3f86463f333236ec1201b0)
2022-09-28T19:28:10.087090Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1418"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (665153a678afeaa4003f21324b6b1becdc3c897c53a7527a52753d799f16dbe1)
2022-09-28T19:28:11.986342Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:28:12.003173Z - running sql script pg/insert_tenders.sql
2022-09-28T19:28:12.003218Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:28:12.008400Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:28:12.010054Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:28:12.014616Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:28:12.019439Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:28:12.025065Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:28:12.026503Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:28:12.076352Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:28:12.262357Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:28:12.266309Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:28:12.267866Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:28:12.495891Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:28:12.597913Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:28:12.605969Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:28:12.843299Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:28:13.038687Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:28:13.043953Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:28:13.044412Z - job completed in 2.96 seconds (665153a678afeaa4003f21324b6b1becdc3c897c53a7527a52753d799f16dbe1)
2022-09-28T19:28:13.113750Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1418"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f904446c1a5a54c426243914b11f0f2457a63b4da908b9934ecb1e337b478853)
2022-09-28T19:28:15.341314Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:28:15.357916Z - running sql script pg/upsert_orders.sql
2022-09-28T19:28:15.357946Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:28:15.362344Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:28:15.368314Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:28:15.369608Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:28:15.374153Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:28:15.375652Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:28:15.380024Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:28:15.381199Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:28:15.382742Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:28:15.389823Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:28:15.637106Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:28:15.712568Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:28:15.717159Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:28:15.725029Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:28:15.792834Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:28:15.806216Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:28:15.806513Z - job completed in 2.69 seconds (f904446c1a5a54c426243914b11f0f2457a63b4da908b9934ecb1e337b478853)
2022-09-28T19:30:02.355817Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1420"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a4467677aea23fd7256c8e1ed89646f2203c68fa9efade7ab4de308b235d6546)
2022-09-28T19:30:04.022188Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:30:04.039970Z - running sql script pg/insert_tenders.sql
2022-09-28T19:30:04.040020Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:30:04.044980Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:30:04.046539Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:30:04.052581Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:30:04.057036Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:30:04.062148Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:30:04.063398Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:30:04.110271Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:30:04.290284Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:30:04.294531Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:30:04.296230Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:30:04.591465Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:30:04.691580Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:30:04.701505Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:30:04.938214Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:30:05.132025Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:30:05.137391Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:30:05.138175Z - job completed in 2.78 seconds (a4467677aea23fd7256c8e1ed89646f2203c68fa9efade7ab4de308b235d6546)
2022-09-28T19:30:05.233532Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1420"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e9725f8ed16522a09e055e42e44d3c50b0f07bdd9e961ece10ceb31be9d3f32e)
2022-09-28T19:30:07.697073Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:30:07.712622Z - running sql script pg/upsert_orders.sql
2022-09-28T19:30:07.712818Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:30:07.717954Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:30:07.722540Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:30:07.723509Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:30:07.727681Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:30:07.729199Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:30:07.733765Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:30:07.734777Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:30:07.735567Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:30:07.741795Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:30:07.950752Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:30:08.030291Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:30:08.033900Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:30:08.045962Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:30:08.114443Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:30:08.135056Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:30:08.135694Z - job completed in 2.90 seconds (e9725f8ed16522a09e055e42e44d3c50b0f07bdd9e961ece10ceb31be9d3f32e)
2022-09-28T19:32:02.074376Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1422"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (a8951f9e333c8f14adbb490ab62717f8dd12c454fc58c424190e54ddb8d63280)
2022-09-28T19:32:03.649698Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:32:03.666946Z - running sql script pg/insert_tenders.sql
2022-09-28T19:32:03.666982Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:32:03.672253Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:32:03.673868Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:32:03.678534Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:32:03.688059Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:32:03.693113Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:32:03.694346Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:32:03.741545Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:32:03.890074Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:32:03.894614Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:32:03.896424Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:32:04.118217Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:32:04.221230Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:32:04.234761Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:32:04.471190Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:32:04.683742Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:32:04.689971Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:32:04.690430Z - job completed in 2.62 seconds (a8951f9e333c8f14adbb490ab62717f8dd12c454fc58c424190e54ddb8d63280)
2022-09-28T19:32:04.798404Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1422"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b81053f8c9f2851e2ed7846e1d49e09363a086a00c9e7305cc1554459cca69f3)
2022-09-28T19:32:07.115166Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:32:07.130585Z - running sql script pg/upsert_orders.sql
2022-09-28T19:32:07.130615Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:32:07.135358Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:32:07.140308Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:32:07.141248Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:32:07.145123Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:32:07.146527Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:32:07.150743Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:32:07.151685Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:32:07.152576Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:32:07.158742Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:32:07.335470Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:32:07.426008Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:32:07.430042Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:32:07.437884Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:32:07.501810Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:32:07.514408Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:32:07.514864Z - job completed in 2.72 seconds (b81053f8c9f2851e2ed7846e1d49e09363a086a00c9e7305cc1554459cca69f3)
2022-09-28T19:34:01.951304Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1424"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c3e422cd96a58d3ea7c375b88c1ed4f514edf2c79000bcbccb66ccaf4b44e7cd)
2022-09-28T19:34:04.301544Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:34:04.319290Z - running sql script pg/upsert_orders.sql
2022-09-28T19:34:04.319320Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:34:04.324108Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:34:04.329027Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:34:04.330117Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:34:04.334576Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:34:04.336138Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:34:04.340380Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:34:04.341371Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:34:04.342355Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:34:04.348796Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:34:04.553779Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:34:04.660042Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:34:04.664357Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:34:04.672114Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:34:04.739774Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:34:04.749481Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:34:04.749725Z - job completed in 2.80 seconds (c3e422cd96a58d3ea7c375b88c1ed4f514edf2c79000bcbccb66ccaf4b44e7cd)
2022-09-28T19:34:04.801681Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1424"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (fc178703110032fc70b91b90a776553afa3955fb8f4264d673e05fed1fdea075)
2022-09-28T19:34:06.287175Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:34:06.302951Z - running sql script pg/insert_tenders.sql
2022-09-28T19:34:06.302981Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:34:06.307482Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:34:06.308948Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:34:06.313464Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:34:06.317924Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:34:06.323438Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:34:06.324270Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:34:06.373533Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:34:06.527437Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:34:06.531630Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:34:06.533231Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:34:06.773903Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:34:06.883330Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:34:06.893274Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:34:07.127407Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:34:07.324639Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:34:07.330421Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:34:07.330865Z - job completed in 2.53 seconds (fc178703110032fc70b91b90a776553afa3955fb8f4264d673e05fed1fdea075)
2022-09-28T19:36:02.028228Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1426"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (63dbbd203a416488ce9346f592e8f16e90344c62b626c7d907bd79df71ff702b)
2022-09-28T19:36:04.062700Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:36:04.080646Z - running sql script pg/insert_tenders.sql
2022-09-28T19:36:04.080709Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:36:04.088765Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:36:04.090191Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:36:04.094803Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:36:04.099732Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:36:04.104898Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:36:04.105972Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:36:04.152650Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:36:04.254438Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:36:04.259109Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:36:04.260726Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:36:04.503364Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:36:04.615662Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:36:04.634418Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:36:04.880547Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:36:05.075876Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:36:05.081584Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:36:05.082115Z - job completed in 3.05 seconds (63dbbd203a416488ce9346f592e8f16e90344c62b626c7d907bd79df71ff702b)
2022-09-28T19:36:05.148899Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1426"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1bc064b48b2fc8a93c0cd690da1967ce6702b2c0522f9b94b5dfacf7153dd1bd)
2022-09-28T19:36:07.589292Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:36:07.608276Z - running sql script pg/upsert_orders.sql
2022-09-28T19:36:07.608309Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:36:07.612777Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:36:07.617766Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:36:07.618870Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:36:07.628106Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:36:07.629967Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:36:07.634640Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:36:07.635702Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:36:07.636571Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:36:07.643366Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:36:07.820992Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:36:07.873281Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:36:07.877076Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:36:07.883826Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:36:07.948022Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:36:07.960564Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:36:07.961105Z - job completed in 2.81 seconds (1bc064b48b2fc8a93c0cd690da1967ce6702b2c0522f9b94b5dfacf7153dd1bd)
2022-09-28T19:38:02.013163Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1428"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (871552383bc55fa314ea8e7620cc2fc466963404994cb87a7653228b0c038032)
2022-09-28T19:38:04.224574Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:38:04.240988Z - running sql script pg/upsert_orders.sql
2022-09-28T19:38:04.241022Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:38:04.245120Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:38:04.250030Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:38:04.251378Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:38:04.255671Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:38:04.259956Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:38:04.264134Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:38:04.265033Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:38:04.265885Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:38:04.272618Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:38:04.433266Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:38:04.499315Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:38:04.503769Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:38:04.515621Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:38:04.586127Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:38:04.597585Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:38:04.598054Z - job completed in 2.58 seconds (871552383bc55fa314ea8e7620cc2fc466963404994cb87a7653228b0c038032)
2022-09-28T19:38:04.709266Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1418"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (615f8ff3146fd83accd8697b3528bd505910b7d531f7cdda70d5823546da5d1a)
2022-09-28T19:38:10.477157Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:38:10.494496Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T19:38:10.494550Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:38:10.499300Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T19:38:10.504638Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T19:38:10.505882Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T19:38:10.507094Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T19:38:10.508010Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T19:38:10.509334Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T19:38:10.510224Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:38:10.511236Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T19:38:10.512107Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T19:38:10.513823Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T19:38:10.515284Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T19:38:10.516300Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T19:38:10.518568Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T19:38:10.519422Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T19:38:10.521471Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T19:38:10.523064Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T19:38:10.606042Z - called http://score/api/keyed and received back 204
2022-09-28T19:38:10.606098Z - job completed in 5.90 seconds (615f8ff3146fd83accd8697b3528bd505910b7d531f7cdda70d5823546da5d1a)
2022-09-28T19:38:10.657849Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1428"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8176b245bd8a19baaa2d59da5f5ece3d5a9aa15b0d0d62f0797742205c972e2b)
2022-09-28T19:38:11.936642Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:38:11.954134Z - running sql script pg/insert_tenders.sql
2022-09-28T19:38:11.954192Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:38:11.958549Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:38:11.959989Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:38:11.964245Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:38:11.969940Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:38:11.975199Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:38:11.976354Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:38:12.027877Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:38:12.077869Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:38:12.081712Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:38:12.083698Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:38:12.331399Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:38:12.441666Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:38:12.454896Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:38:12.691819Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:38:12.884283Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:38:12.889369Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:38:12.889621Z - job completed in 2.23 seconds (8176b245bd8a19baaa2d59da5f5ece3d5a9aa15b0d0d62f0797742205c972e2b)
2022-09-28T19:40:02.830857Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1430"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (954e4960f71623ad99fa2b01203a710c983c566721a95a2f3f00c0f651379889)
2022-09-28T19:40:05.040219Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:40:05.057705Z - running sql script pg/upsert_orders.sql
2022-09-28T19:40:05.057733Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:40:05.062172Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:40:05.066986Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:40:05.068076Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:40:05.074033Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:40:05.079039Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:40:05.083292Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:40:05.084318Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:40:05.085301Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:40:05.092128Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:40:05.273821Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:40:05.347488Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:40:05.353046Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:40:05.368628Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:40:05.444948Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:40:05.465110Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:40:05.465588Z - job completed in 2.64 seconds (954e4960f71623ad99fa2b01203a710c983c566721a95a2f3f00c0f651379889)
2022-09-28T19:40:05.526303Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1430"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (938a02b65ea35bc55d98821bcd0ae25d7e77715879a840c2fea95a6e6a9f710d)
2022-09-28T19:40:07.062338Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:40:07.089242Z - running sql script pg/insert_tenders.sql
2022-09-28T19:40:07.089673Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:40:07.094603Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:40:07.096125Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:40:07.100721Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:40:07.104998Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:40:07.110307Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:40:07.111580Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:40:07.158893Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:40:07.246448Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:40:07.250866Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:40:07.252386Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:40:07.494149Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:40:07.604459Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:40:07.613796Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:40:07.886787Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:40:08.088703Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:40:08.095605Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:40:08.096045Z - job completed in 2.57 seconds (938a02b65ea35bc55d98821bcd0ae25d7e77715879a840c2fea95a6e6a9f710d)
2022-09-28T19:42:01.928204Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1432"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (38aa01e907a102060508e58cf91187698f340f546a27093497d26bb16ee16755)
2022-09-28T19:42:03.487790Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:42:03.505675Z - running sql script pg/insert_tenders.sql
2022-09-28T19:42:03.505768Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:42:03.511786Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:42:03.513422Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:42:03.518342Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:42:03.522892Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:42:03.527950Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:42:03.529174Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:42:03.579059Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:42:03.665007Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:42:03.669054Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:42:03.670839Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:42:03.913557Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:42:04.023635Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:42:04.032447Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:42:04.269294Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:42:04.467Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:42:04.472345Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:42:04.472719Z - job completed in 2.54 seconds (38aa01e907a102060508e58cf91187698f340f546a27093497d26bb16ee16755)
2022-09-28T19:42:04.566564Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1432"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9fbb74e84ff29f85f2e4c35088cbda9021cb53e4e6f38b8a1acb65fbe6344ddd)
2022-09-28T19:42:07.097090Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:42:07.115226Z - running sql script pg/upsert_orders.sql
2022-09-28T19:42:07.115263Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:42:07.120267Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:42:07.129577Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:42:07.131162Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:42:07.135639Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:42:07.140387Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:42:07.144532Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:42:07.145816Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:42:07.146840Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:42:07.153447Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:42:07.315423Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:42:07.388628Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:42:07.392687Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:42:07.401011Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:42:07.500335Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:42:07.517468Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:42:07.518116Z - job completed in 2.95 seconds (9fbb74e84ff29f85f2e4c35088cbda9021cb53e4e6f38b8a1acb65fbe6344ddd)
2022-09-28T19:44:01.902992Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1434"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f3c75ff1c93944f630eda175de76ae83a74e367113ecc0a1bf506c3eb4a8330e)
2022-09-28T19:44:03.953862Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:44:03.975142Z - running sql script pg/insert_tenders.sql
2022-09-28T19:44:03.975247Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:44:03.980147Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:44:03.981703Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:44:03.987847Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:44:03.992640Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:44:03.997666Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:44:03.999406Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:44:04.048752Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:44:04.203770Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:44:04.208178Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:44:04.209809Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:44:04.437667Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:44:04.541939Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:44:04.549839Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:44:04.789653Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:44:04.985980Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:44:04.998267Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:44:04.998696Z - job completed in 3.10 seconds (f3c75ff1c93944f630eda175de76ae83a74e367113ecc0a1bf506c3eb4a8330e)
2022-09-28T19:44:05.014198Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1434"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ca083faf1c0b3f10e13181a2f09c4ea6486294abd6d7740ebe0c54028124bfca)
2022-09-28T19:44:07.615126Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:44:07.633815Z - running sql script pg/upsert_orders.sql
2022-09-28T19:44:07.633860Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:44:07.639122Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:44:07.644201Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:44:07.645287Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:44:07.649661Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:44:07.656189Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:44:07.660451Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:44:07.661499Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:44:07.662412Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:44:07.669037Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:44:07.872447Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:44:07.979574Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:44:07.984221Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:44:07.995037Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:44:08.063841Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:44:08.079246Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:44:08.079706Z - job completed in 3.07 seconds (ca083faf1c0b3f10e13181a2f09c4ea6486294abd6d7740ebe0c54028124bfca)
2022-09-28T19:46:01.931064Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1436"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4b6aafd97a0186f71969f4a740ad76167c1bc55327014d1083991f8625fdc364)
2022-09-28T19:46:04.524565Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:46:04.548197Z - running sql script pg/upsert_orders.sql
2022-09-28T19:46:04.548237Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:46:04.554492Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:46:04.560120Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:46:04.561459Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:46:04.566851Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:46:04.572227Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:46:04.576367Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:46:04.577396Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:46:04.578331Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:46:04.585141Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:46:04.768122Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:46:04.855452Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:46:04.859249Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:46:04.866111Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:46:04.930832Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:46:04.941026Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:46:04.941651Z - job completed in 3.01 seconds (4b6aafd97a0186f71969f4a740ad76167c1bc55327014d1083991f8625fdc364)
2022-09-28T19:46:05.156095Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1436"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c824c6f52211a566ef45387ad07c928011b3af660029baadb854a95576e74461)
2022-09-28T19:46:06.669141Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:46:06.685749Z - running sql script pg/insert_tenders.sql
2022-09-28T19:46:06.685783Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:46:06.690194Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:46:06.691688Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:46:06.695671Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:46:06.699574Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:46:06.704697Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:46:06.705594Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:46:06.752021Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:46:06.850759Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:46:06.854556Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:46:06.856246Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:46:07.075879Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:46:07.178078Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:46:07.185452Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:46:07.419226Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:46:07.613784Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:46:07.618857Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:46:07.619373Z - job completed in 2.46 seconds (c824c6f52211a566ef45387ad07c928011b3af660029baadb854a95576e74461)
2022-09-28T19:48:01.892521Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1428"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (b55ff338d4efac41606a359cf56139d100b68c48d7fca5fbe789cf5e3ec9c396)
2022-09-28T19:48:08.555718Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:48:08.573864Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T19:48:08.573896Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:48:08.579036Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T19:48:08.583815Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T19:48:08.588082Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T19:48:08.589626Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T19:48:08.593741Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T19:48:08.597963Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T19:48:08.598866Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:48:08.599751Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T19:48:08.600648Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T19:48:08.606230Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T19:48:08.610570Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T19:48:08.613011Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T19:48:08.618922Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T19:48:08.623322Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T19:48:08.628769Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T19:48:08.633956Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T19:48:09.339761Z - called http://score/api/keyed and received back 200
2022-09-28T19:48:09.339882Z - job completed in 7.45 seconds (b55ff338d4efac41606a359cf56139d100b68c48d7fca5fbe789cf5e3ec9c396)
2022-09-28T19:48:09.390104Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1438"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5f8c8645f9ca67c1eee7f871a221007edbe153189e442f2cc8ec21f9123f3aec)
2022-09-28T19:48:11.014485Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:48:11.032241Z - running sql script pg/insert_tenders.sql
2022-09-28T19:48:11.032283Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:48:11.036458Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:48:11.037866Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:48:11.041820Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:48:11.046589Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:48:11.051754Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:48:11.053Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:48:11.107149Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:48:11.229334Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:48:11.233587Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:48:11.235187Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:48:11.508430Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:48:11.627271Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:48:11.633769Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:48:11.869152Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:48:12.064880Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:48:12.089980Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:48:12.090240Z - job completed in 2.70 seconds (5f8c8645f9ca67c1eee7f871a221007edbe153189e442f2cc8ec21f9123f3aec)
2022-09-28T19:48:12.214061Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1438"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6dbb82f3b3ea11d728ac0362083a93effbfa6d1e8894d591e8a540e22ca04949)
2022-09-28T19:48:14.711234Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:48:14.727961Z - running sql script pg/upsert_orders.sql
2022-09-28T19:48:14.728Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:48:14.732702Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:48:14.737295Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:48:14.738349Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:48:14.742456Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:48:14.746867Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:48:14.752341Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:48:14.753357Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:48:14.754324Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:48:14.761818Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:48:14.938935Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:48:15.015942Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:48:15.019996Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:48:15.027429Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:48:15.093069Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:48:15.105139Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:48:15.105594Z - job completed in 2.89 seconds (6dbb82f3b3ea11d728ac0362083a93effbfa6d1e8894d591e8a540e22ca04949)
2022-09-28T19:50:02.410669Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1440"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7f77014da37cd2ff14ee83701ebf427cbcbbffc5193d61cf26129e5095e9d30e)
2022-09-28T19:50:05.085870Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:50:05.101276Z - running sql script pg/upsert_orders.sql
2022-09-28T19:50:05.101316Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:50:05.106603Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:50:05.111394Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:50:05.112350Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:50:05.116892Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:50:05.121299Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:50:05.125592Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:50:05.126611Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:50:05.127510Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:50:05.134553Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:50:05.315793Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:50:05.402047Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:50:05.406434Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:50:05.417501Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:50:05.489961Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:50:05.504695Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:50:05.504991Z - job completed in 3.09 seconds (7f77014da37cd2ff14ee83701ebf427cbcbbffc5193d61cf26129e5095e9d30e)
2022-09-28T19:50:05.626166Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1440"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f95ca63c14e5431639595c7572a43d2a044341f56e0a4e475117dbe720ad1f18)
2022-09-28T19:50:06.948202Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:50:06.964530Z - running sql script pg/insert_tenders.sql
2022-09-28T19:50:06.964562Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:50:06.970124Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:50:06.971511Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:50:06.976342Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:50:06.982794Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:50:06.988274Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:50:06.989270Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:50:07.037421Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:50:07.136858Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:50:07.141120Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:50:07.142675Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:50:07.363828Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:50:07.465230Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:50:07.474176Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:50:07.709490Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:50:07.900608Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:50:07.905527Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:50:07.906050Z - job completed in 2.28 seconds (f95ca63c14e5431639595c7572a43d2a044341f56e0a4e475117dbe720ad1f18)
2022-09-28T19:52:01.974461Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1442"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (4f8607c541178af6eb238c0b64bc129f34827a0f96fa1b1b861513a02a8ff673)
2022-09-28T19:52:03.722939Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:52:03.743247Z - running sql script pg/insert_tenders.sql
2022-09-28T19:52:03.743772Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:52:03.749058Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:52:03.750522Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:52:03.754968Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:52:03.759037Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:52:03.764076Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:52:03.765115Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:52:03.813586Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:52:03.853159Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:52:03.857316Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:52:03.858792Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:52:04.089441Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:52:04.192936Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:52:04.199895Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:52:04.449050Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:52:04.643977Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:52:04.649676Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:52:04.650258Z - job completed in 2.68 seconds (4f8607c541178af6eb238c0b64bc129f34827a0f96fa1b1b861513a02a8ff673)
2022-09-28T19:52:04.706703Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1442"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4b01a431cf09b68caab99c68222e941091c60d5b9bf0c56838265f21d22be87b)
2022-09-28T19:52:07.388528Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:52:07.405984Z - running sql script pg/upsert_orders.sql
2022-09-28T19:52:07.406016Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:52:07.411310Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:52:07.416351Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:52:07.417466Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:52:07.421645Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:52:07.427102Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:52:07.431262Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:52:07.432365Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:52:07.433587Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:52:07.440432Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:52:07.596254Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:52:07.648092Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:52:07.651979Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:52:07.658671Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:52:07.727341Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:52:07.741206Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:52:07.741583Z - job completed in 3.04 seconds (4b01a431cf09b68caab99c68222e941091c60d5b9bf0c56838265f21d22be87b)
2022-09-28T19:54:02.002089Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1444"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1ef3c0d78c9bb6dbcb920744617c3f45cc95bdba236e2a2c4bd2d7d7eb34c992)
2022-09-28T19:54:04.506105Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:54:04.552389Z - running sql script pg/upsert_orders.sql
2022-09-28T19:54:04.552423Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:54:04.557835Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:54:04.565889Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:54:04.567724Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:54:04.573300Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:54:04.579746Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:54:04.586268Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:54:04.588376Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:54:04.589532Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:54:04.597653Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:54:04.704318Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:54:04.735844Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:54:04.740391Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:54:04.746718Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:54:04.813191Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:54:04.824045Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:54:04.824538Z - job completed in 2.82 seconds (1ef3c0d78c9bb6dbcb920744617c3f45cc95bdba236e2a2c4bd2d7d7eb34c992)
2022-09-28T19:54:04.855430Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1444"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9302d6c5af32199c7bdf811cebd38aa27fb52c88d1abfa10eabec75afeefa5fa)
2022-09-28T19:54:06.361924Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:54:06.378376Z - running sql script pg/insert_tenders.sql
2022-09-28T19:54:06.378407Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:54:06.383408Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:54:06.384903Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:54:06.389338Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:54:06.393794Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:54:06.398713Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:54:06.399950Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:54:06.446294Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:54:06.470298Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:54:06.474742Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:54:06.476310Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:54:06.694373Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:54:06.793541Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:54:06.801532Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:54:07.038513Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:54:07.233433Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:54:07.239459Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:54:07.239949Z - job completed in 2.38 seconds (9302d6c5af32199c7bdf811cebd38aa27fb52c88d1abfa10eabec75afeefa5fa)
2022-09-28T19:56:01.973680Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1446"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (47b2e1fd1f3584ac12228c17d5cc176509aad029d08a3dffddc9ea78798ca8bc)
2022-09-28T19:56:03.501860Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:56:03.518719Z - running sql script pg/insert_tenders.sql
2022-09-28T19:56:03.518746Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:56:03.523673Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:56:03.525181Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:56:03.529632Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:56:03.533864Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:56:03.538889Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:56:03.539948Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:56:03.604416Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:56:03.646862Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:56:03.651958Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:56:03.654687Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:56:03.855334Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:56:03.946719Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:56:03.952641Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:56:04.183493Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:56:04.377640Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:56:04.383850Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:56:04.384301Z - job completed in 2.41 seconds (47b2e1fd1f3584ac12228c17d5cc176509aad029d08a3dffddc9ea78798ca8bc)
2022-09-28T19:56:04.498201Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1446"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (06d4481f7c44b00f01495cad37f33b6844568f1266c825695f3576753061c5d8)
2022-09-28T19:56:06.446405Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:56:06.462699Z - running sql script pg/upsert_orders.sql
2022-09-28T19:56:06.462742Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:56:06.467642Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:56:06.471768Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:56:06.472725Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:56:06.477014Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:56:06.478444Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:56:06.482739Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:56:06.483806Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:56:06.484640Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:56:06.491013Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:56:06.575601Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:56:06.609264Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:56:06.613621Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:56:06.620436Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:56:06.685979Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:56:06.694962Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:56:06.695372Z - job completed in 2.20 seconds (06d4481f7c44b00f01495cad37f33b6844568f1266c825695f3576753061c5d8)
2022-09-28T19:58:02.004490Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1448"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9815c8a43a9454e48d19da573f58faea3ff7286236bececbc5e8b00c4abec480)
2022-09-28T19:58:03.849908Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:58:03.866746Z - running sql script pg/insert_tenders.sql
2022-09-28T19:58:03.867376Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T19:58:03.872227Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T19:58:03.873573Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T19:58:03.877690Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T19:58:03.881991Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T19:58:03.888096Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T19:58:03.889217Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T19:58:03.935869Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T19:58:03.979615Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T19:58:03.983887Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T19:58:03.985595Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T19:58:04.202661Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T19:58:04.303405Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T19:58:04.309616Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T19:58:04.535911Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T19:58:04.724273Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T19:58:04.729572Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T19:58:04.729832Z - job completed in 2.73 seconds (9815c8a43a9454e48d19da573f58faea3ff7286236bececbc5e8b00c4abec480)
2022-09-28T19:58:04.750291Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1438"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (933b78ad62fa1b5d3ca65e51bb54864c4a72ec2ecce096525add3e28b02087c2)
2022-09-28T19:58:11.456218Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:58:11.473377Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T19:58:11.473411Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:58:11.478505Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T19:58:11.483296Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T19:58:11.486790Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T19:58:11.487752Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T19:58:11.491640Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T19:58:11.495717Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T19:58:11.499576Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:58:11.500990Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T19:58:11.502183Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T19:58:11.507813Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T19:58:11.512958Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T19:58:11.513809Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T19:58:11.520117Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T19:58:11.524322Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T19:58:11.528172Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T19:58:11.533465Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T19:58:12.102493Z - called http://score/api/keyed and received back 200
2022-09-28T19:58:12.102780Z - job completed in 7.35 seconds (933b78ad62fa1b5d3ca65e51bb54864c4a72ec2ecce096525add3e28b02087c2)
2022-09-28T19:58:12.153880Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1448"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2a37cf39f8ea00d1ae83cdbaaab0f4c40c93ff1e9e29875c22317a94fefeb7e7)
2022-09-28T19:58:14.237507Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T19:58:14.254316Z - running sql script pg/upsert_orders.sql
2022-09-28T19:58:14.254348Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T19:58:14.259116Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T19:58:14.263392Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T19:58:14.264247Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T19:58:14.268342Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T19:58:14.269700Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T19:58:14.273791Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T19:58:14.274702Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T19:58:14.275610Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T19:58:14.281499Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T19:58:14.364258Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T19:58:14.390678Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T19:58:14.394395Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T19:58:14.402440Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T19:58:14.471502Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T19:58:14.483136Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T19:58:14.483614Z - job completed in 2.33 seconds (2a37cf39f8ea00d1ae83cdbaaab0f4c40c93ff1e9e29875c22317a94fefeb7e7)
2022-09-28T20:00:02.859835Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1450"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (217347d070a164b43faa00ff90b2136568dc75090cc9ccd8b3d0901bf9939b5e)
2022-09-28T20:00:04.406304Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:00:04.423965Z - running sql script pg/insert_tenders.sql
2022-09-28T20:00:04.423997Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:00:04.429048Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:00:04.430601Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:00:04.434850Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:00:04.438652Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:00:04.443721Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:00:04.444966Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:00:04.493442Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:00:04.540038Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:00:04.544648Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:00:04.546283Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:00:04.774205Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:00:04.880563Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:00:04.890046Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:00:05.127403Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:00:05.321205Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:00:05.326875Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:00:05.327123Z - job completed in 2.47 seconds (217347d070a164b43faa00ff90b2136568dc75090cc9ccd8b3d0901bf9939b5e)
2022-09-28T20:00:05.606242Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1450"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a8c900ce3623c670339f741f5adbeaba73998622866385a5473859a9421fcfdc)
2022-09-28T20:00:07.701669Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:00:07.718834Z - running sql script pg/upsert_orders.sql
2022-09-28T20:00:07.718868Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:00:07.724225Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:00:07.728613Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:00:07.729907Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:00:07.734082Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:00:07.735593Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:00:07.739999Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:00:07.741505Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:00:07.742857Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:00:07.751591Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:00:07.854413Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:00:07.902762Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:00:07.906755Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:00:07.921011Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:00:07.999394Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:00:08.016457Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:00:08.016813Z - job completed in 2.41 seconds (a8c900ce3623c670339f741f5adbeaba73998622866385a5473859a9421fcfdc)
2022-09-28T20:02:01.923981Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1452"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (b080070055002c9d405231f5443d24e6c5e41f64dd1a0f8d73f366043798cff8)
2022-09-28T20:02:04.487148Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:02:04.504259Z - running sql script pg/upsert_orders.sql
2022-09-28T20:02:04.504290Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:02:04.509330Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:02:04.513934Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:02:04.515080Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:02:04.519354Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:02:04.523230Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:02:04.527805Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:02:04.529260Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:02:04.530666Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:02:04.537638Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:02:04.692367Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:02:04.738869Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:02:04.742762Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:02:04.755591Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:02:04.843051Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:02:04.860539Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:02:04.860857Z - job completed in 2.94 seconds (b080070055002c9d405231f5443d24e6c5e41f64dd1a0f8d73f366043798cff8)
2022-09-28T20:02:04.973413Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1452"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5f3fa28010bd4e8f012ee54c8a68c10acc9e0d67ba8709a8eb7c03c998cab439)
2022-09-28T20:02:06.398800Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:02:06.415864Z - running sql script pg/insert_tenders.sql
2022-09-28T20:02:06.415917Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:02:06.421612Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:02:06.423032Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:02:06.427629Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:02:06.432444Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:02:06.437691Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:02:06.438676Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:02:06.485767Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:02:06.523234Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:02:06.526814Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:02:06.528472Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:02:06.756573Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:02:06.856955Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:02:06.863767Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:02:07.111814Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:02:07.349698Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:02:07.355680Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:02:07.356621Z - job completed in 2.38 seconds (5f3fa28010bd4e8f012ee54c8a68c10acc9e0d67ba8709a8eb7c03c998cab439)
2022-09-28T20:04:01.897771Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1454"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7428e03492a3136aba80aeb643d808256e8744be24969250b6fa3f86c8842c36)
2022-09-28T20:04:07.232600Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:04:07.248605Z - running sql script pg/upsert_orders.sql
2022-09-28T20:04:07.248648Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:04:07.254133Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:04:07.259295Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:04:07.260472Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:04:07.266670Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:04:07.268379Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:04:07.272851Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:04:07.274121Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:04:07.275181Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:04:07.286456Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:04:07.458790Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:04:07.507631Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:04:07.512917Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:04:07.524259Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:04:07.595816Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:04:07.610363Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:04:07.610903Z - job completed in 5.71 seconds (7428e03492a3136aba80aeb643d808256e8744be24969250b6fa3f86c8842c36)
2022-09-28T20:04:07.674506Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1454"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c4d45a07e27ccb3dc03726492603bf127ae11eadd9302104060736cb14b6cc33)
2022-09-28T20:04:08.789641Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:04:08.806242Z - running sql script pg/insert_tenders.sql
2022-09-28T20:04:08.806297Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:04:08.811266Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:04:08.812799Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:04:08.818081Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:04:08.822117Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:04:08.827245Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:04:08.828210Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:04:08.876007Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:04:08.910481Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:04:08.914567Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:04:08.916090Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:04:09.140139Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:04:09.242710Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:04:09.249822Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:04:09.484368Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:04:09.678832Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:04:09.684208Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:04:09.684835Z - job completed in 2.01 seconds (c4d45a07e27ccb3dc03726492603bf127ae11eadd9302104060736cb14b6cc33)
2022-09-28T20:06:01.958621Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1456"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4e8afabefafa07675aed81b35ecb4c155c7daf90c462294c1ebc028916c3854a)
2022-09-28T20:06:04.229314Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:06:04.250852Z - running sql script pg/upsert_orders.sql
2022-09-28T20:06:04.250899Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:06:04.255628Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:06:04.260741Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:06:04.261910Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:06:04.265913Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:06:04.267428Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:06:04.271573Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:06:04.272581Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:06:04.273398Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:06:04.280015Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:06:04.477945Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:06:04.513749Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:06:04.517564Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:06:04.527215Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:06:04.596936Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:06:04.609647Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:06:04.610010Z - job completed in 2.65 seconds (4e8afabefafa07675aed81b35ecb4c155c7daf90c462294c1ebc028916c3854a)
2022-09-28T20:06:04.640693Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1456"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d8ff8d82dc09cb6d7e09b7290648131a1ef925eaf076e7ce86110ab306be9eff)
2022-09-28T20:06:05.970850Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:06:05.988889Z - running sql script pg/insert_tenders.sql
2022-09-28T20:06:05.989210Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:06:05.994310Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:06:05.996103Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:06:06.000884Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:06:06.005652Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:06:06.010954Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:06:06.012276Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:06:06.062057Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:06:06.083656Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:06:06.087997Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:06:06.089905Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:06:06.319363Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:06:06.425033Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:06:06.434730Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:06:06.674726Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:06:06.873829Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:06:06.879359Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:06:06.879817Z - job completed in 2.24 seconds (d8ff8d82dc09cb6d7e09b7290648131a1ef925eaf076e7ce86110ab306be9eff)
2022-09-28T20:08:02.203032Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1458"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2b08e06a3a854df6d4b501c44821b08cc5be76c12566e7ed2d9766e8e24f1394)
2022-09-28T20:08:04.443820Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:08:04.460784Z - running sql script pg/upsert_orders.sql
2022-09-28T20:08:04.460822Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:08:04.465610Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:08:04.470796Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:08:04.471916Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:08:04.476730Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:08:04.478229Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:08:04.482315Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:08:04.483286Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:08:04.484198Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:08:04.491689Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:08:04.680507Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:08:04.731210Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:08:04.735368Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:08:04.747106Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:08:04.817368Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:08:04.829176Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:08:04.829550Z - job completed in 2.63 seconds (2b08e06a3a854df6d4b501c44821b08cc5be76c12566e7ed2d9766e8e24f1394)
2022-09-28T20:08:04.856657Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1448"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (efab750a72c6a18a90ad66f8006bd3da442b0c199ac6540790d0962804a6d108)
2022-09-28T20:08:10.541496Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:08:10.564323Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T20:08:10.564362Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:08:10.570580Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T20:08:10.577224Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T20:08:10.581815Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T20:08:10.582769Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T20:08:10.587107Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T20:08:10.591625Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T20:08:10.592842Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:08:10.593928Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T20:08:10.595503Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T20:08:10.601230Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T20:08:10.605990Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T20:08:10.607170Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T20:08:10.614293Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T20:08:10.618292Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T20:08:10.622865Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T20:08:10.628498Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T20:08:11.573453Z - called http://score/api/keyed and received back 200
2022-09-28T20:08:11.573672Z - job completed in 6.72 seconds (efab750a72c6a18a90ad66f8006bd3da442b0c199ac6540790d0962804a6d108)
2022-09-28T20:08:11.795448Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1458"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (814a0d43449b3fb9ec80fc07e11a5a18c96031930fb9e902d703fc086cf0fea4)
2022-09-28T20:08:13.146643Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:08:13.162910Z - running sql script pg/insert_tenders.sql
2022-09-28T20:08:13.162942Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:08:13.169186Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:08:13.170830Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:08:13.175308Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:08:13.179614Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:08:13.184287Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:08:13.185254Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:08:13.233627Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:08:13.247334Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:08:13.251573Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:08:13.253143Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:08:13.483216Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:08:13.591763Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:08:13.597915Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:08:13.835893Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:08:14.075086Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:08:14.080213Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:08:14.080579Z - job completed in 2.29 seconds (814a0d43449b3fb9ec80fc07e11a5a18c96031930fb9e902d703fc086cf0fea4)
2022-09-28T20:10:02.340093Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1500"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d29287fc98b33a868978479c3ad00d195b61e581d048a3bf8fc59ce365ac32d3)
2022-09-28T20:10:03.849757Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:10:03.867752Z - running sql script pg/insert_tenders.sql
2022-09-28T20:10:03.867783Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:10:03.874250Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:10:03.875744Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:10:03.880319Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:10:03.884773Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:10:03.889764Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:10:03.890855Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:10:03.942004Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:10:03.995993Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:10:04.001845Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:10:04.003501Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:10:04.224817Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:10:04.324364Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:10:04.334602Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:10:04.576015Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:10:04.772096Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:10:04.777508Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:10:04.777961Z - job completed in 2.44 seconds (d29287fc98b33a868978479c3ad00d195b61e581d048a3bf8fc59ce365ac32d3)
2022-09-28T20:10:04.895318Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1500"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3a1b5e74ba6e4cf0362bb7fe160389ae5327e9873aea6c8b06960543c87c4bf9)
2022-09-28T20:10:07.571735Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:10:07.589255Z - running sql script pg/upsert_orders.sql
2022-09-28T20:10:07.589290Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:10:07.595121Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:10:07.600620Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:10:07.601720Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:10:07.606277Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:10:07.607743Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:10:07.612351Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:10:07.613403Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:10:07.614329Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:10:07.620845Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:10:07.800911Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:10:07.846513Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:10:07.850820Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:10:07.869996Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:10:07.941297Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:10:07.962392Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:10:07.963046Z - job completed in 3.07 seconds (3a1b5e74ba6e4cf0362bb7fe160389ae5327e9873aea6c8b06960543c87c4bf9)
2022-09-28T20:12:01.958737Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1502"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c0eaa01a1f5fe510c3843d2edd28c95acda44d4a3c0ef7e8e0e256313bec4edf)
2022-09-28T20:12:04.644551Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:12:04.679165Z - running sql script pg/upsert_orders.sql
2022-09-28T20:12:04.679204Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:12:04.684437Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:12:04.690703Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:12:04.692138Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:12:04.698017Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:12:04.699792Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:12:04.704544Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:12:04.705730Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:12:04.707009Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:12:04.714383Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:12:04.838781Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:12:04.861840Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:12:04.866493Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:12:04.881790Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:12:04.948476Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:12:04.963240Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:12:04.963588Z - job completed in 3.01 seconds (c0eaa01a1f5fe510c3843d2edd28c95acda44d4a3c0ef7e8e0e256313bec4edf)
2022-09-28T20:12:05.014415Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1502"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2587a7a33465b30dbdd3c366da1733a64b622824524bb7b2545553b39d51ce4c)
2022-09-28T20:12:06.513286Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:12:06.530115Z - running sql script pg/insert_tenders.sql
2022-09-28T20:12:06.530298Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:12:06.535386Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:12:06.536861Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:12:06.541220Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:12:06.545662Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:12:06.550575Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:12:06.551598Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:12:06.603264Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:12:06.616951Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:12:06.621159Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:12:06.622784Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:12:06.853767Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:12:06.957183Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:12:06.963892Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:12:07.203519Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:12:07.396597Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:12:07.401747Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:12:07.402252Z - job completed in 2.39 seconds (2587a7a33465b30dbdd3c366da1733a64b622824524bb7b2545553b39d51ce4c)
2022-09-28T20:14:01.917225Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1504"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8de127d57bc135df908e041ee10e394742fe9c5211f3bb5c3591e758af626213)
2022-09-28T20:14:04.389976Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:14:04.407939Z - running sql script pg/upsert_orders.sql
2022-09-28T20:14:04.407981Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:14:04.412730Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:14:04.420684Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:14:04.422061Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:14:04.427183Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:14:04.429424Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:14:04.433769Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:14:04.434800Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:14:04.435764Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:14:04.442970Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:14:04.560418Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:14:04.595589Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:14:04.603586Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:14:04.612935Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:14:04.678003Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:14:04.688438Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:14:04.688756Z - job completed in 2.77 seconds (8de127d57bc135df908e041ee10e394742fe9c5211f3bb5c3591e758af626213)
2022-09-28T20:14:04.815395Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1504"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (81555a4285bf0d1ab68d40c879c15ba56d9ae94007f44d67e4a4abe713dd94a7)
2022-09-28T20:14:06.236508Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:14:06.266472Z - running sql script pg/insert_tenders.sql
2022-09-28T20:14:06.266574Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:14:06.271958Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:14:06.273462Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:14:06.277679Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:14:06.281751Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:14:06.286822Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:14:06.288002Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:14:06.335516Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:14:06.389413Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:14:06.393565Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:14:06.395122Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:14:06.604331Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:14:06.701283Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:14:06.719047Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:14:06.981487Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:14:07.171728Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:14:07.178553Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:14:07.178828Z - job completed in 2.36 seconds (81555a4285bf0d1ab68d40c879c15ba56d9ae94007f44d67e4a4abe713dd94a7)
2022-09-28T20:16:02.088862Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1506"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (bd59b41986feccbff653932ae01999fcc18d92b9e09f571cfe31af0463124897)
2022-09-28T20:16:03.476878Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:16:03.494245Z - running sql script pg/insert_tenders.sql
2022-09-28T20:16:03.494292Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:16:03.498817Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:16:03.500445Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:16:03.505176Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:16:03.512614Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:16:03.517682Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:16:03.519119Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:16:03.568203Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:16:03.601879Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:16:03.605972Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:16:03.607674Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:16:03.826649Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:16:03.924080Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:16:03.930594Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:16:04.162357Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:16:04.353894Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:16:04.359169Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:16:04.359596Z - job completed in 2.27 seconds (bd59b41986feccbff653932ae01999fcc18d92b9e09f571cfe31af0463124897)
2022-09-28T20:16:04.375591Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1506"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (66815e438be7ea9e2314b5a9eab4b9bc177dd0b79958349be82adc46c67cc704)
2022-09-28T20:16:06.818297Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:16:06.844540Z - running sql script pg/upsert_orders.sql
2022-09-28T20:16:06.845337Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:16:06.851131Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:16:06.859348Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:16:06.860927Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:16:06.865120Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:16:06.875672Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:16:06.883287Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:16:06.887426Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:16:06.889526Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:16:06.896325Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:16:07.012166Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:16:07.061562Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:16:07.065604Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:16:07.071768Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:16:07.137800Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:16:07.146218Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:16:07.146613Z - job completed in 2.77 seconds (66815e438be7ea9e2314b5a9eab4b9bc177dd0b79958349be82adc46c67cc704)
2022-09-28T20:18:01.992629Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1508"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7a23aba6c5ba50c9254b7d503e5532d5292cdffe7a47a0e525952a83e19a8658)
2022-09-28T20:18:04.149013Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:18:04.165881Z - running sql script pg/upsert_orders.sql
2022-09-28T20:18:04.165907Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:18:04.170555Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:18:04.174791Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:18:04.175693Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:18:04.180131Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:18:04.181587Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:18:04.188445Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:18:04.191336Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:18:04.192455Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:18:04.198768Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:18:04.304807Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:18:04.349361Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:18:04.353799Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:18:04.361027Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:18:04.426270Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:18:04.435709Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:18:04.436088Z - job completed in 2.44 seconds (7a23aba6c5ba50c9254b7d503e5532d5292cdffe7a47a0e525952a83e19a8658)
2022-09-28T20:18:04.529320Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1508"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2afe1ece5463e192af5353d23d90203479930db36e32da9b353358f0e11caf1c)
2022-09-28T20:18:06.026980Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:18:06.043041Z - running sql script pg/insert_tenders.sql
2022-09-28T20:18:06.043082Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:18:06.048241Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:18:06.049498Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:18:06.053615Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:18:06.057635Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:18:06.063411Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:18:06.064396Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:18:06.112825Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:18:06.161055Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:18:06.165447Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:18:06.167110Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:18:06.394260Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:18:06.497985Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:18:06.506142Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:18:06.741178Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:18:06.993491Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:18:06.999154Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:18:06.999833Z - job completed in 2.47 seconds (2afe1ece5463e192af5353d23d90203479930db36e32da9b353358f0e11caf1c)
2022-09-28T20:18:07.029890Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1458"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (f65940cc8ba4bb53bacdef8863ae83177bd0decc7457be9799f526b56a79092a)
2022-09-28T20:18:13.916787Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:18:13.935911Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T20:18:13.935945Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:18:13.940604Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T20:18:13.945565Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T20:18:13.949552Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T20:18:13.950826Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T20:18:13.955007Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T20:18:13.960813Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T20:18:13.962233Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:18:13.963283Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T20:18:13.964313Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T20:18:13.971664Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T20:18:13.977076Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T20:18:13.978178Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T20:18:13.986152Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T20:18:13.990370Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T20:18:13.994454Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T20:18:14.003028Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T20:18:14.871650Z - called http://score/api/keyed and received back 200
2022-09-28T20:18:14.875638Z - job completed in 7.85 seconds (f65940cc8ba4bb53bacdef8863ae83177bd0decc7457be9799f526b56a79092a)
2022-09-28T20:20:02.593901Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1510"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d0651320de153091e2bb1545495992b9807b7f1202943cbb0cc451d9c2809ca7)
2022-09-28T20:20:04.203631Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:20:04.220859Z - running sql script pg/insert_tenders.sql
2022-09-28T20:20:04.220906Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:20:04.225897Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:20:04.227313Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:20:04.231352Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:20:04.235082Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:20:04.239747Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:20:04.240887Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:20:04.290523Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:20:04.339925Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:20:04.343972Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:20:04.345802Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:20:04.574618Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:20:04.677488Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:20:04.686835Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:20:04.925393Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:20:05.118258Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:20:05.123507Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:20:05.123942Z - job completed in 2.53 seconds (d0651320de153091e2bb1545495992b9807b7f1202943cbb0cc451d9c2809ca7)
2022-09-28T20:20:05.208269Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1510"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (ed863e53926d93f7a77d5f564afbd5505b27768278b10afea521db9c6a3e2b23)
2022-09-28T20:20:07.184448Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:20:07.200571Z - running sql script pg/upsert_orders.sql
2022-09-28T20:20:07.200615Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:20:07.206598Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:20:07.211277Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:20:07.212228Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:20:07.216767Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:20:07.218270Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:20:07.222692Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:20:07.223758Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:20:07.224576Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:20:07.230882Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:20:07.325303Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:20:07.353602Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:20:07.357947Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:20:07.369694Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:20:07.448195Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:20:07.463846Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:20:07.464273Z - job completed in 2.26 seconds (ed863e53926d93f7a77d5f564afbd5505b27768278b10afea521db9c6a3e2b23)
2022-09-28T20:22:01.965639Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1512"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5249cca7fe680d44e835fed113d8e0a7c5b30a87a7964d1f3e397d283ef1ca60)
2022-09-28T20:22:03.446761Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:22:03.466140Z - running sql script pg/insert_tenders.sql
2022-09-28T20:22:03.466283Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:22:03.471353Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:22:03.472816Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:22:03.477367Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:22:03.481574Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:22:03.486148Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:22:03.487142Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:22:03.534895Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:22:03.570820Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:22:03.575014Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:22:03.576524Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:22:03.796349Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:22:03.895677Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:22:03.902573Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:22:04.134573Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:22:04.324752Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:22:04.329957Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:22:04.330372Z - job completed in 2.37 seconds (5249cca7fe680d44e835fed113d8e0a7c5b30a87a7964d1f3e397d283ef1ca60)
2022-09-28T20:22:04.352290Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1512"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (cb1034343e6149c5f16c8a5bac3162e41a3907bf2b2c8b67e254e65c7caefc94)
2022-09-28T20:22:06.548825Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:22:06.565637Z - running sql script pg/upsert_orders.sql
2022-09-28T20:22:06.565675Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:22:06.570546Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:22:06.575267Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:22:06.576150Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:22:06.580522Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:22:06.581935Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:22:06.589030Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:22:06.590061Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:22:06.590949Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:22:06.597045Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:22:06.682342Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:22:06.701641Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:22:06.705766Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:22:06.713548Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:22:06.779173Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:22:06.790942Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:22:06.791279Z - job completed in 2.44 seconds (cb1034343e6149c5f16c8a5bac3162e41a3907bf2b2c8b67e254e65c7caefc94)
2022-09-28T20:24:01.946817Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1514"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (13b5dee788817828a18c04051721637426536137402c4e0717409d059e1177df)
2022-09-28T20:24:03.827882Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:24:03.844146Z - running sql script pg/upsert_orders.sql
2022-09-28T20:24:03.844177Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:24:03.848714Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:24:03.852618Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:24:03.853592Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:24:03.857662Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:24:03.863620Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:24:03.869093Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:24:03.870790Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:24:03.871979Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:24:03.878167Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:24:03.981653Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:24:04.023088Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:24:04.027841Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:24:04.038221Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:24:04.106631Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:24:04.116759Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:24:04.117071Z - job completed in 2.17 seconds (13b5dee788817828a18c04051721637426536137402c4e0717409d059e1177df)
2022-09-28T20:24:04.167664Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1514"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (55c35d413e48be6a4f1ecb6bd65f393fae4947fe08b89c1ba4c4688a695b302b)
2022-09-28T20:24:05.177845Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:24:05.194064Z - running sql script pg/insert_tenders.sql
2022-09-28T20:24:05.194106Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:24:05.198610Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:24:05.200040Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:24:05.206571Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:24:05.212520Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:24:05.220522Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:24:05.221783Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:24:05.270898Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:24:05.299608Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:24:05.303918Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:24:05.308230Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:24:05.534984Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:24:05.639693Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:24:05.648720Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:24:05.958133Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:24:06.151266Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:24:06.156851Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:24:06.157488Z - job completed in 1.99 seconds (55c35d413e48be6a4f1ecb6bd65f393fae4947fe08b89c1ba4c4688a695b302b)
2022-09-28T20:26:02.088912Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1516"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1f458f68476687011e306c2f3f7c3463ebd765f1213cb85d1171f52f5492a506)
2022-09-28T20:26:03.384383Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:26:03.400739Z - running sql script pg/insert_tenders.sql
2022-09-28T20:26:03.400792Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:26:03.409580Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:26:03.411341Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:26:03.415596Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:26:03.422009Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:26:03.427155Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:26:03.428198Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:26:03.478147Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:26:03.496986Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:26:03.501479Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:26:03.503061Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:26:03.727656Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:26:03.828657Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:26:03.835205Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:26:04.119851Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:26:04.314686Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:26:04.320286Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:26:04.320649Z - job completed in 2.23 seconds (1f458f68476687011e306c2f3f7c3463ebd765f1213cb85d1171f52f5492a506)
2022-09-28T20:26:04.361455Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1516"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0a89616bf7cdf4cec2d5a917373d682e9de4a3e919b448022634f5a95dde3c4c)
2022-09-28T20:26:06.462201Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:26:06.479855Z - running sql script pg/upsert_orders.sql
2022-09-28T20:26:06.479884Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:26:06.485117Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:26:06.490011Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:26:06.491044Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:26:06.496036Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:26:06.497648Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:26:06.501969Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:26:06.503007Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:26:06.503917Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:26:06.510632Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:26:06.732470Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:26:06.784041Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:26:06.788417Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:26:06.796655Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:26:06.862190Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:26:06.875276Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:26:06.875763Z - job completed in 2.51 seconds (0a89616bf7cdf4cec2d5a917373d682e9de4a3e919b448022634f5a95dde3c4c)
2022-09-28T20:28:01.876356Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1518"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7657844904ce0b36b3b9c7dccb24e69e40d1706c34458509ff4b98e51ed96df8)
2022-09-28T20:28:04.181068Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:28:04.202900Z - running sql script pg/upsert_orders.sql
2022-09-28T20:28:04.202944Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:28:04.207877Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:28:04.214215Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:28:04.215478Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:28:04.219643Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:28:04.221454Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:28:04.225762Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:28:04.226798Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:28:04.228622Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:28:04.237459Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:28:04.516603Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:28:04.608216Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:28:04.613370Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:28:04.622455Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:28:04.688799Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:28:04.698440Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:28:04.698712Z - job completed in 2.82 seconds (7657844904ce0b36b3b9c7dccb24e69e40d1706c34458509ff4b98e51ed96df8)
2022-09-28T20:28:04.773693Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1518"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (184868646481b78821b0734a2b6eb8ee89b54abe9a63a8aae9fbc4c163634ccc)
2022-09-28T20:28:05.955090Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:28:05.974529Z - running sql script pg/insert_tenders.sql
2022-09-28T20:28:05.974557Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:28:05.979641Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:28:05.981033Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:28:05.985097Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:28:05.989297Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:28:05.995133Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:28:05.997719Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:28:06.045775Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:28:06.065364Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:28:06.069759Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:28:06.071318Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:28:06.298759Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:28:06.403303Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:28:06.409987Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:28:06.649931Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:28:06.846090Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:28:06.851438Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:28:06.851741Z - job completed in 2.08 seconds (184868646481b78821b0734a2b6eb8ee89b54abe9a63a8aae9fbc4c163634ccc)
2022-09-28T20:28:06.927514Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1508"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (3709e2b5faf1e42ea9ae8316dad2d101ca42101c15035d7ac788061b40979ce2)
2022-09-28T20:28:12.117244Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:28:12.134027Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T20:28:12.134068Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:28:12.140295Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T20:28:12.150459Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T20:28:12.155424Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T20:28:12.156573Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T20:28:12.160885Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T20:28:12.165588Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T20:28:12.166778Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:28:12.167731Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T20:28:12.168724Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T20:28:12.174769Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T20:28:12.179720Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T20:28:12.180828Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T20:28:12.187857Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T20:28:12.192196Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T20:28:12.196728Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T20:28:12.202922Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T20:28:12.933077Z - called http://score/api/keyed and received back 200
2022-09-28T20:28:12.933161Z - job completed in 6.01 seconds (3709e2b5faf1e42ea9ae8316dad2d101ca42101c15035d7ac788061b40979ce2)
2022-09-28T20:30:02.205863Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1520"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (167cc1e574fb3022d150646cb705211385b9937b74cc59a14f7459a3a203ecad)
2022-09-28T20:30:04.804138Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:30:04.820440Z - running sql script pg/upsert_orders.sql
2022-09-28T20:30:04.820472Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:30:04.825585Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:30:04.831021Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:30:04.832152Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:30:04.836167Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:30:04.837767Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:30:04.842628Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:30:04.847479Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:30:04.848446Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:30:04.854736Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:30:05.014297Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:30:05.097333Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:30:05.101239Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:30:05.115624Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:30:05.187377Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:30:05.205807Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:30:05.206308Z - job completed in 3.00 seconds (167cc1e574fb3022d150646cb705211385b9937b74cc59a14f7459a3a203ecad)
2022-09-28T20:30:05.285106Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1520"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (82bb3d307b741997dc7edfdbe3256135fafb48e359f3a5652b2ba29b579b5dc2)
2022-09-28T20:30:06.331175Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:30:06.347941Z - running sql script pg/insert_tenders.sql
2022-09-28T20:30:06.347992Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:30:06.352831Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:30:06.354492Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:30:06.358607Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:30:06.362725Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:30:06.367717Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:30:06.368662Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:30:06.419582Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:30:06.437663Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:30:06.442136Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:30:06.443676Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:30:06.670623Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:30:06.771916Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:30:06.781666Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:30:07.013368Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:30:07.206972Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:30:07.212148Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:30:07.212639Z - job completed in 1.93 seconds (82bb3d307b741997dc7edfdbe3256135fafb48e359f3a5652b2ba29b579b5dc2)
2022-09-28T20:32:02.006654Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1522"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d81edc1dd0bed98b86e5a1e172ae7b35cdc725ff731243393f029a29c657d8ad)
2022-09-28T20:32:04.169997Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:32:04.185811Z - running sql script pg/upsert_orders.sql
2022-09-28T20:32:04.185839Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:32:04.190744Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:32:04.195692Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:32:04.196701Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:32:04.203223Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:32:04.208353Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:32:04.212753Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:32:04.214029Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:32:04.214972Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:32:04.221474Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:32:04.383043Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:32:04.477366Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:32:04.481895Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:32:04.490372Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:32:04.560062Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:32:04.574138Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:32:04.574424Z - job completed in 2.57 seconds (d81edc1dd0bed98b86e5a1e172ae7b35cdc725ff731243393f029a29c657d8ad)
2022-09-28T20:32:04.652928Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1522"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (92f384b3afb16244ea3f4bbea6a9ec4e89b8d15c14c85980654018a46dfefffa)
2022-09-28T20:32:05.932388Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:32:05.949513Z - running sql script pg/insert_tenders.sql
2022-09-28T20:32:05.949755Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:32:05.955885Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:32:05.958666Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:32:05.963648Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:32:05.968373Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:32:05.976633Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:32:05.978212Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:32:06.025847Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:32:06.045075Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:32:06.049837Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:32:06.051894Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:32:06.273163Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:32:06.373783Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:32:06.379950Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:32:06.606966Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:32:06.800784Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:32:06.807039Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:32:06.807513Z - job completed in 2.16 seconds (92f384b3afb16244ea3f4bbea6a9ec4e89b8d15c14c85980654018a46dfefffa)
2022-09-28T20:34:02.135268Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1524"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (96415bf27773abf82311f58a289637537ad7065fa70cebf1ea91c9ebcdb0e944)
2022-09-28T20:34:04.259077Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:34:04.275948Z - running sql script pg/upsert_orders.sql
2022-09-28T20:34:04.275976Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:34:04.281017Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:34:04.287652Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:34:04.291758Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:34:04.299255Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:34:04.305345Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:34:04.309586Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:34:04.310635Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:34:04.311604Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:34:04.318509Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:34:04.470342Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:34:04.546367Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:34:04.552136Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:34:04.562126Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:34:04.632918Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:34:04.657269Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:34:04.657777Z - job completed in 2.52 seconds (96415bf27773abf82311f58a289637537ad7065fa70cebf1ea91c9ebcdb0e944)
2022-09-28T20:34:04.688600Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1524"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (36d0fc4a5ef3c55e3c822d3c3e69425fc5b6ed26a6888340265949ff1687c095)
2022-09-28T20:34:06.108668Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:34:06.127703Z - running sql script pg/insert_tenders.sql
2022-09-28T20:34:06.127738Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:34:06.132628Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:34:06.133934Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:34:06.138107Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:34:06.142347Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:34:06.146983Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:34:06.147883Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:34:06.195292Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:34:06.240316Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:34:06.244326Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:34:06.246249Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:34:06.469439Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:34:06.572078Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:34:06.579225Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:34:06.815621Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:34:07.010249Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:34:07.016096Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:34:07.016599Z - job completed in 2.33 seconds (36d0fc4a5ef3c55e3c822d3c3e69425fc5b6ed26a6888340265949ff1687c095)
2022-09-28T20:36:01.942232Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1526"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3632e3300e6be1950ed35b90aedf3f147a73540abe65b13f518dff265f888793)
2022-09-28T20:36:04.523391Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:36:04.543269Z - running sql script pg/upsert_orders.sql
2022-09-28T20:36:04.543298Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:36:04.548246Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:36:04.553413Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:36:04.554431Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:36:04.558815Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:36:04.563342Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:36:04.567833Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:36:04.568925Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:36:04.569737Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:36:04.576377Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:36:04.734869Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:36:04.809295Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:36:04.813293Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:36:04.823956Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:36:04.903671Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:36:04.932800Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:36:04.933190Z - job completed in 2.99 seconds (3632e3300e6be1950ed35b90aedf3f147a73540abe65b13f518dff265f888793)
2022-09-28T20:36:04.985225Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1526"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c09d8aa58a3f64438d48310d3c948d2accbd22098417763af677c2e5fad9a91d)
2022-09-28T20:36:06.474563Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:36:06.490983Z - running sql script pg/insert_tenders.sql
2022-09-28T20:36:06.491014Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:36:06.496073Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:36:06.497502Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:36:06.501353Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:36:06.505430Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:36:06.510047Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:36:06.511426Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:36:06.558814Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:36:06.581264Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:36:06.585553Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:36:06.587093Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:36:06.857091Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:36:06.961434Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:36:06.967957Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:36:07.225074Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:36:07.413623Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:36:07.418848Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:36:07.419340Z - job completed in 2.43 seconds (c09d8aa58a3f64438d48310d3c948d2accbd22098417763af677c2e5fad9a91d)
2022-09-28T20:38:01.924668Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1518"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (9a431a891dcc9e48a26c9aa7f80b5e998a8658fc52cbb4be664275271727f5ea)
2022-09-28T20:38:10.385503Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:38:10.401765Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T20:38:10.401797Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:38:10.406884Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T20:38:10.411524Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T20:38:10.415114Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T20:38:10.416025Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T20:38:10.420145Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T20:38:10.424277Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T20:38:10.428066Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:38:10.428980Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T20:38:10.429913Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T20:38:10.435681Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T20:38:10.440813Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T20:38:10.441819Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T20:38:10.449026Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T20:38:10.452832Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T20:38:10.457052Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T20:38:10.463470Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T20:38:11.474864Z - called http://score/api/keyed and received back 200
2022-09-28T20:38:11.475076Z - job completed in 9.55 seconds (9a431a891dcc9e48a26c9aa7f80b5e998a8658fc52cbb4be664275271727f5ea)
2022-09-28T20:38:11.586986Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1528"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (75eadd48afd59448d8636cc40a3c4c8b646e76d5f1625826340e809d17c9ac0e)
2022-09-28T20:38:13.728697Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:38:13.746425Z - running sql script pg/upsert_orders.sql
2022-09-28T20:38:13.746467Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:38:13.751467Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:38:13.756276Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:38:13.757561Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:38:13.761567Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:38:13.765658Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:38:13.769686Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:38:13.770630Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:38:13.771588Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:38:13.777735Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:38:13.904630Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:38:13.970096Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:38:13.974204Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:38:13.986752Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:38:14.065527Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:38:14.077146Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:38:14.077574Z - job completed in 2.49 seconds (75eadd48afd59448d8636cc40a3c4c8b646e76d5f1625826340e809d17c9ac0e)
2022-09-28T20:38:14.156688Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1528"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3eb0a642629c093bb10c62906c76ff45e5149ce5ca4a423aec3100479fa8f7b4)
2022-09-28T20:38:17.282876Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:38:17.300427Z - running sql script pg/insert_tenders.sql
2022-09-28T20:38:17.300468Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:38:17.305914Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:38:17.307651Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:38:17.312292Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:38:17.320657Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:38:17.327317Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:38:17.328932Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:38:17.376567Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:38:17.435802Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:38:17.440236Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:38:17.441941Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:38:17.671705Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:38:17.773434Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:38:17.780428Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:38:18.009499Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:38:18.199790Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:38:18.204665Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:38:18.205126Z - job completed in 4.05 seconds (3eb0a642629c093bb10c62906c76ff45e5149ce5ca4a423aec3100479fa8f7b4)
2022-09-28T20:40:02.197475Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1530"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ce467ddb30b1fa1788fa66723dec705b250fbdbc2b2d8976c888c647bc320e19)
2022-09-28T20:40:03.854926Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:40:03.872716Z - running sql script pg/insert_tenders.sql
2022-09-28T20:40:03.872749Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:40:03.878024Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:40:03.879559Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:40:03.883986Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:40:03.891505Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:40:03.896651Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:40:03.897649Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:40:03.948467Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:40:03.985070Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:40:03.989871Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:40:03.991671Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:40:04.222639Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:40:04.328443Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:40:04.337923Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:40:04.574842Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:40:04.766805Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:40:04.772281Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:40:04.772791Z - job completed in 2.58 seconds (ce467ddb30b1fa1788fa66723dec705b250fbdbc2b2d8976c888c647bc320e19)
2022-09-28T20:40:04.845844Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1530"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9000cb8be99e3e7a964bb9bfc652ce2597d151ec64e292273358df9e367fe3e3)
2022-09-28T20:40:07.158553Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:40:07.175805Z - running sql script pg/upsert_orders.sql
2022-09-28T20:40:07.175837Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:40:07.183709Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:40:07.188692Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:40:07.189682Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:40:07.194023Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:40:07.198812Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:40:07.203304Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:40:07.204290Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:40:07.205099Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:40:07.211572Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:40:07.327769Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:40:07.358977Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:40:07.363047Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:40:07.376677Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:40:07.453603Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:40:07.470399Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:40:07.470872Z - job completed in 2.63 seconds (9000cb8be99e3e7a964bb9bfc652ce2597d151ec64e292273358df9e367fe3e3)
2022-09-28T20:42:02.035876Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1532"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (454f0d95b4f568e9e2bc6de8537b8291075d9c7e825f2c2c9133fa8bccdfe163)
2022-09-28T20:42:03.605393Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:42:03.621415Z - running sql script pg/insert_tenders.sql
2022-09-28T20:42:03.621463Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:42:03.626335Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:42:03.627975Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:42:03.632026Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:42:03.636110Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:42:03.640791Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:42:03.641762Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:42:03.688435Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:42:03.713675Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:42:03.718208Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:42:03.720578Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:42:03.947292Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:42:04.055388Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:42:04.062246Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:42:04.317163Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:42:04.511290Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:42:04.516287Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:42:04.516741Z - job completed in 2.48 seconds (454f0d95b4f568e9e2bc6de8537b8291075d9c7e825f2c2c9133fa8bccdfe163)
2022-09-28T20:42:04.569362Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1532"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (bfdb334f191190c5bab06fc8c69c241d3a34342721498d334d5afa9492fa8b7e)
2022-09-28T20:42:07.176115Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:42:07.192919Z - running sql script pg/upsert_orders.sql
2022-09-28T20:42:07.192949Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:42:07.197774Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:42:07.202372Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:42:07.203479Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:42:07.207455Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:42:07.211611Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:42:07.215650Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:42:07.216653Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:42:07.218358Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:42:07.224347Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:42:07.359173Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:42:07.409710Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:42:07.413499Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:42:07.422086Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:42:07.502238Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:42:07.523972Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:42:07.524429Z - job completed in 2.96 seconds (bfdb334f191190c5bab06fc8c69c241d3a34342721498d334d5afa9492fa8b7e)
2022-09-28T20:44:02.110248Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1534"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (1a210b066b5b221d04d7dd121d7475eccb78c4495973cee5d85ec81e6175e978)
2022-09-28T20:44:04.520267Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:44:04.548422Z - running sql script pg/upsert_orders.sql
2022-09-28T20:44:04.548485Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:44:04.554209Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:44:04.559653Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:44:04.560804Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:44:04.566973Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:44:04.571657Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:44:04.581937Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:44:04.583226Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:44:04.584720Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:44:04.591166Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:44:04.721139Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:44:04.781239Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:44:04.785499Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:44:04.793451Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:44:04.858341Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:44:04.867010Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:44:04.867258Z - job completed in 2.76 seconds (1a210b066b5b221d04d7dd121d7475eccb78c4495973cee5d85ec81e6175e978)
2022-09-28T20:44:04.952295Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1534"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (1ef070b7b644099d2f13b308aed022c828a4d81bc53224b453550decbaf3bdd9)
2022-09-28T20:44:06.490159Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:44:06.508154Z - running sql script pg/insert_tenders.sql
2022-09-28T20:44:06.508204Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:44:06.512827Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:44:06.514420Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:44:06.518498Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:44:06.522711Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:44:06.529135Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:44:06.530270Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:44:06.578822Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:44:06.605259Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:44:06.609479Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:44:06.611153Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:44:06.841473Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:44:06.946055Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:44:06.962344Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:44:07.201628Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:44:07.395620Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:44:07.451627Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:44:07.455174Z - job completed in 2.50 seconds (1ef070b7b644099d2f13b308aed022c828a4d81bc53224b453550decbaf3bdd9)
2022-09-28T20:46:02.037766Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1536"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (53c3b16e7ce83ed064e248578231aeba121587dd60295fce0fc9a0c85b83ceec)
2022-09-28T20:46:03.482674Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:46:03.500460Z - running sql script pg/insert_tenders.sql
2022-09-28T20:46:03.500489Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:46:03.506334Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:46:03.508153Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:46:03.513240Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:46:03.518196Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:46:03.522975Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:46:03.524184Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:46:03.610364Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:46:03.628029Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:46:03.631916Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:46:03.633336Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:46:03.856970Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:46:03.958232Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:46:03.964585Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:46:04.195113Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:46:04.388001Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:46:04.393014Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:46:04.393581Z - job completed in 2.36 seconds (53c3b16e7ce83ed064e248578231aeba121587dd60295fce0fc9a0c85b83ceec)
2022-09-28T20:46:04.495768Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1536"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (a9db98ae7780956b68083b8575a63782817deb9b2e8e0ad2d28faaa43864d305)
2022-09-28T20:46:06.751403Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:46:06.769164Z - running sql script pg/upsert_orders.sql
2022-09-28T20:46:06.769207Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:46:06.774378Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:46:06.779634Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:46:06.780651Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:46:06.786565Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:46:06.790710Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:46:06.795008Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:46:06.796169Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:46:06.797570Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:46:06.803732Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:46:06.917094Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:46:06.959724Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:46:06.964120Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:46:06.973974Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:46:07.038914Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:46:07.050800Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:46:07.051461Z - job completed in 2.56 seconds (a9db98ae7780956b68083b8575a63782817deb9b2e8e0ad2d28faaa43864d305)
2022-09-28T20:48:01.892207Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1528"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (be7bed0fae65c8225b8050485d008cbfdc0a5993f9d86f743138ca23ed6155e0)
2022-09-28T20:48:08.617490Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:48:08.633490Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T20:48:08.633530Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:48:08.637998Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T20:48:08.642728Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T20:48:08.646165Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T20:48:08.647193Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T20:48:08.650754Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T20:48:08.655089Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T20:48:08.659209Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:48:08.660807Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T20:48:08.661784Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T20:48:08.667662Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T20:48:08.672518Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T20:48:08.673513Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T20:48:08.680041Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T20:48:08.683915Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T20:48:08.688023Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T20:48:08.693872Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T20:48:09.589375Z - called http://score/api/keyed and received back 200
2022-09-28T20:48:09.589451Z - job completed in 7.70 seconds (be7bed0fae65c8225b8050485d008cbfdc0a5993f9d86f743138ca23ed6155e0)
2022-09-28T20:48:09.625109Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1538"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8fc73727b6a1abeb3c4039c9262708c7e08698110ee4f76ecc7d464c4e4c8fb0)
2022-09-28T20:48:10.908199Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:48:10.941581Z - running sql script pg/insert_tenders.sql
2022-09-28T20:48:10.941614Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:48:10.946025Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:48:10.947288Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:48:10.951394Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:48:10.955777Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:48:10.960451Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:48:10.961398Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:48:11.007990Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:48:11.040993Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:48:11.044585Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:48:11.046062Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:48:11.275743Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:48:11.377282Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:48:11.383173Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:48:11.612984Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:48:11.809535Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:48:11.814511Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:48:11.814932Z - job completed in 2.19 seconds (8fc73727b6a1abeb3c4039c9262708c7e08698110ee4f76ecc7d464c4e4c8fb0)
2022-09-28T20:48:11.845909Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1538"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (286a3f220c2b43899ffa4aec7f4dd26557f84ebe6c669ba5ea855c49d91fdff5)
2022-09-28T20:48:14.408745Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:48:14.426685Z - running sql script pg/upsert_orders.sql
2022-09-28T20:48:14.426867Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:48:14.431778Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:48:14.436601Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:48:14.437604Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:48:14.441458Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:48:14.442784Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:48:14.446896Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:48:14.448756Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:48:14.449878Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:48:14.456699Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:48:14.569651Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:48:14.579738Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:48:14.585355Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:48:14.606511Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:48:14.674612Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:48:14.691070Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:48:14.691498Z - job completed in 2.85 seconds (286a3f220c2b43899ffa4aec7f4dd26557f84ebe6c669ba5ea855c49d91fdff5)
2022-09-28T20:50:02.430464Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1540"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8a2af1bc10e2b6c61a83f27840c4ecc0e9770f399affe7170df43d253f1e10af)
2022-09-28T20:50:03.673056Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:50:03.691785Z - running sql script pg/insert_tenders.sql
2022-09-28T20:50:03.691817Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:50:03.697477Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:50:03.698974Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:50:03.703818Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:50:03.707764Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:50:03.712865Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:50:03.714580Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:50:03.802102Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:50:03.867402Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:50:03.871393Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:50:03.873302Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:50:04.296762Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:50:04.446889Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:50:04.459635Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:50:04.728922Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:50:04.919286Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:50:04.924777Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:50:04.925245Z - job completed in 2.50 seconds (8a2af1bc10e2b6c61a83f27840c4ecc0e9770f399affe7170df43d253f1e10af)
2022-09-28T20:50:04.976218Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1540"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e83f19689c53a84a0d5bc2978e56d4c61ca1ab5142e34597c025268f757f4b79)
2022-09-28T20:50:07.344130Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:50:07.360270Z - running sql script pg/upsert_orders.sql
2022-09-28T20:50:07.360309Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:50:07.365081Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:50:07.369754Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:50:07.370869Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:50:07.374692Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:50:07.376155Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:50:07.380566Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:50:07.381649Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:50:07.382552Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:50:07.388491Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:50:07.555764Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:50:07.579652Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:50:07.583912Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:50:07.601189Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:50:07.669684Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:50:07.703013Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:50:07.703566Z - job completed in 2.73 seconds (e83f19689c53a84a0d5bc2978e56d4c61ca1ab5142e34597c025268f757f4b79)
2022-09-28T20:52:02.078717Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1542"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (78663e6b21035c8d0c54679ee95472ecad40748f0624ea887e37872d23a95591)
2022-09-28T20:52:04.302735Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:52:04.326974Z - running sql script pg/insert_tenders.sql
2022-09-28T20:52:04.327005Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:52:04.332632Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:52:04.334786Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:52:04.339762Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:52:04.345645Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:52:04.350839Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:52:04.355723Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:52:04.456648Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:52:04.558451Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:52:04.562629Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:52:04.565504Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:52:04.922243Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:52:05.030459Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:52:05.040508Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:52:05.282951Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:52:05.482783Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:52:05.488799Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:52:05.489279Z - job completed in 3.41 seconds (78663e6b21035c8d0c54679ee95472ecad40748f0624ea887e37872d23a95591)
2022-09-28T20:52:05.546617Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1542"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7bab1996b1c07aeeb4d970e6d94c9e5e0d16b683b84e0795aadf76620462ebc9)
2022-09-28T20:52:07.860721Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:52:07.878198Z - running sql script pg/upsert_orders.sql
2022-09-28T20:52:07.878250Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:52:07.882832Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:52:07.887374Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:52:07.888313Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:52:07.892518Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:52:07.894058Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:52:07.902669Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:52:07.903613Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:52:07.904573Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:52:07.910936Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:52:08.002164Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:52:08.008616Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:52:08.012941Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:52:08.021346Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:52:08.086548Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:52:08.096623Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:52:08.096912Z - job completed in 2.55 seconds (7bab1996b1c07aeeb4d970e6d94c9e5e0d16b683b84e0795aadf76620462ebc9)
2022-09-28T20:54:02.108224Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1544"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d9a1968b0721a231891b9c52f8c4fb43df41b425f6d8ca7b5ddaf2f7d79ae17d)
2022-09-28T20:54:04.618018Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:54:04.648744Z - running sql script pg/upsert_orders.sql
2022-09-28T20:54:04.648777Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:54:04.654155Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:54:04.661469Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:54:04.662836Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:54:04.667186Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:54:04.669067Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:54:04.675920Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:54:04.677301Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:54:04.678401Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:54:04.689446Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:54:04.926330Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:54:04.955744Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:54:04.960317Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:54:04.970686Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:54:05.039061Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:54:05.051259Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:54:05.051663Z - job completed in 2.94 seconds (d9a1968b0721a231891b9c52f8c4fb43df41b425f6d8ca7b5ddaf2f7d79ae17d)
2022-09-28T20:54:05.145864Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1544"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (2dfe16c01ba8379a4c3c591a46b692c085464cc2cead5f11b7ddce549bd37563)
2022-09-28T20:54:06.652365Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:54:06.670678Z - running sql script pg/insert_tenders.sql
2022-09-28T20:54:06.670726Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:54:06.675866Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:54:06.679175Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:54:06.686881Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:54:06.691676Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:54:06.696009Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:54:06.697144Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:54:06.757319Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:54:06.806045Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:54:06.809951Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:54:06.811412Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:54:07.038706Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:54:07.145083Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:54:07.154090Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:54:07.386782Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:54:07.583865Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:54:07.589379Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:54:07.589933Z - job completed in 2.44 seconds (2dfe16c01ba8379a4c3c591a46b692c085464cc2cead5f11b7ddce549bd37563)
2022-09-28T20:56:01.983336Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1546"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (f15c7d86b88bf604dd3edaa7844d44a1c800cadd6e16ade35659c286f9ec6e90)
2022-09-28T20:56:03.336088Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:56:03.352324Z - running sql script pg/insert_tenders.sql
2022-09-28T20:56:03.352376Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:56:03.357097Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:56:03.358400Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:56:03.362339Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:56:03.366070Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:56:03.370889Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:56:03.371834Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:56:03.417669Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:56:03.445294Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:56:03.449425Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:56:03.450795Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:56:03.673526Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:56:03.773001Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:56:03.779671Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:56:04.007369Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:56:04.199184Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:56:04.203954Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:56:04.204484Z - job completed in 2.22 seconds (f15c7d86b88bf604dd3edaa7844d44a1c800cadd6e16ade35659c286f9ec6e90)
2022-09-28T20:56:04.229040Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1546"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7b75968b1b1847438cbe7414351016bef184f6f66c25362eb9f4fe97b4212e38)
2022-09-28T20:56:06.546660Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:56:06.562648Z - running sql script pg/upsert_orders.sql
2022-09-28T20:56:06.562688Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:56:06.567472Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:56:06.573448Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:56:06.574398Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:56:06.579783Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:56:06.584081Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:56:06.588433Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:56:06.589442Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:56:06.590602Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:56:06.596707Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:56:06.744084Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:56:06.797877Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:56:06.802776Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:56:06.813102Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:56:06.880039Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:56:06.891178Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:56:06.891707Z - job completed in 2.66 seconds (7b75968b1b1847438cbe7414351016bef184f6f66c25362eb9f4fe97b4212e38)
2022-09-28T20:58:01.946037Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1538"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (281108ad759ed255f2eb4b3ba34193e5fb51935a66cbc0e9eb7b29aa74d47bb9)
2022-09-28T20:58:07.430738Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:58:07.448156Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T20:58:07.448573Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:58:07.453329Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T20:58:07.458175Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T20:58:07.462515Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T20:58:07.463623Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T20:58:07.467903Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T20:58:07.472414Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T20:58:07.476375Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:58:07.477467Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T20:58:07.478367Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T20:58:07.483827Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T20:58:07.489448Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T20:58:07.490709Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T20:58:07.497493Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T20:58:07.501361Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T20:58:07.505295Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T20:58:07.511764Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T20:58:08.353674Z - called http://score/api/keyed and received back 200
2022-09-28T20:58:08.354118Z - job completed in 6.41 seconds (281108ad759ed255f2eb4b3ba34193e5fb51935a66cbc0e9eb7b29aa74d47bb9)
2022-09-28T20:58:08.380580Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1548"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0f35b59f16d4d3fb59c1f6aa63b67cdff0b77f0c97d1a7c25ccfd1120b6069a3)
2022-09-28T20:58:10.459006Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:58:10.476095Z - running sql script pg/upsert_orders.sql
2022-09-28T20:58:10.476139Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T20:58:10.480765Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T20:58:10.485634Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T20:58:10.487045Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T20:58:10.491619Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T20:58:10.496518Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T20:58:10.502579Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T20:58:10.504590Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T20:58:10.505570Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T20:58:10.512378Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T20:58:10.644512Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T20:58:10.667065Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T20:58:10.671209Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T20:58:10.684671Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T20:58:10.753921Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T20:58:10.774380Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T20:58:10.774835Z - job completed in 2.39 seconds (0f35b59f16d4d3fb59c1f6aa63b67cdff0b77f0c97d1a7c25ccfd1120b6069a3)
2022-09-28T20:58:10.840159Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1548"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (806f1e4785901675b3d581cd98208afe89e88229952c3aae6e6ed27d6de1b7d4)
2022-09-28T20:58:12.359991Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T20:58:12.375524Z - running sql script pg/insert_tenders.sql
2022-09-28T20:58:12.375732Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T20:58:12.380718Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T20:58:12.381964Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T20:58:12.388910Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T20:58:12.393194Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T20:58:12.398012Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T20:58:12.398984Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T20:58:12.445858Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T20:58:12.458928Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T20:58:12.466751Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T20:58:12.468119Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T20:58:12.687272Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T20:58:12.812752Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T20:58:12.819452Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T20:58:13.045442Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T20:58:13.237251Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T20:58:13.242263Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T20:58:13.242603Z - job completed in 2.40 seconds (806f1e4785901675b3d581cd98208afe89e88229952c3aae6e6ed27d6de1b7d4)
2022-09-28T21:00:02.450534Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1550"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (26bcb7dd25bf56a5af44d0d232db76fb1f0b7344391b6ccca80c3dba0375e7e4)
2022-09-28T21:00:04.088470Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:00:04.106039Z - running sql script pg/insert_tenders.sql
2022-09-28T21:00:04.106605Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:00:04.113066Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:00:04.114330Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:00:04.118979Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:00:04.124432Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:00:04.139593Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:00:04.141624Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:00:04.190148Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:00:04.320259Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:00:04.325187Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:00:04.327151Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:00:04.547618Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:00:04.653772Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:00:04.667338Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:00:04.906264Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:00:05.103034Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:00:05.109004Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:00:05.109274Z - job completed in 2.66 seconds (26bcb7dd25bf56a5af44d0d232db76fb1f0b7344391b6ccca80c3dba0375e7e4)
2022-09-28T21:00:05.152530Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1550"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8ba8803bb7ebd16682590c9066e69b1eb9f1edb9112897440a55fa7d031f8092)
2022-09-28T21:00:07.302221Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:00:07.319282Z - running sql script pg/upsert_orders.sql
2022-09-28T21:00:07.319314Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:00:07.328735Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:00:07.333654Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:00:07.334707Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:00:07.338984Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:00:07.343169Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:00:07.347612Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:00:07.348556Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:00:07.349420Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:00:07.356069Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:00:07.513497Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:00:07.551242Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:00:07.555676Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:00:07.574763Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:00:07.640609Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:00:07.657876Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:00:07.658352Z - job completed in 2.51 seconds (8ba8803bb7ebd16682590c9066e69b1eb9f1edb9112897440a55fa7d031f8092)
2022-09-28T21:02:02.008233Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1552"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c2631956ba3ab07ba16e1293fc9e73d7cd0f04dd53e5af2e228988c3bf036392)
2022-09-28T21:02:03.555981Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:02:03.573233Z - running sql script pg/insert_tenders.sql
2022-09-28T21:02:03.573273Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:02:03.578620Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:02:03.580130Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:02:03.584779Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:02:03.589360Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:02:03.593993Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:02:03.596399Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:02:03.662404Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:02:03.770690Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:02:03.776043Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:02:03.777863Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:02:04.005669Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:02:04.111046Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:02:04.118845Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:02:04.353813Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:02:04.557251Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:02:04.562884Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:02:04.563887Z - job completed in 2.56 seconds (c2631956ba3ab07ba16e1293fc9e73d7cd0f04dd53e5af2e228988c3bf036392)
2022-09-28T21:02:04.663838Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1552"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0ba05ac0eed3c5059e6be2cb86cd4e7247e776f8fac57fe61c23098e69be3f26)
2022-09-28T21:02:07.114580Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:02:07.131867Z - running sql script pg/upsert_orders.sql
2022-09-28T21:02:07.131921Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:02:07.136588Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:02:07.141165Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:02:07.142097Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:02:07.145807Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:02:07.149780Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:02:07.153887Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:02:07.154883Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:02:07.155729Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:02:07.162701Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:02:07.324976Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:02:07.366462Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:02:07.370589Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:02:07.379763Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:02:07.454505Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:02:07.471772Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:02:07.472177Z - job completed in 2.81 seconds (0ba05ac0eed3c5059e6be2cb86cd4e7247e776f8fac57fe61c23098e69be3f26)
2022-09-28T21:04:02.332123Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1554"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b3b1ed863025168a30b0d8a1f01c630e7174bfc409823ec334317ee55600640e)
2022-09-28T21:04:03.775888Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:04:03.793580Z - running sql script pg/insert_tenders.sql
2022-09-28T21:04:03.793630Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:04:03.800399Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:04:03.802083Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:04:03.806521Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:04:03.810709Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:04:03.815627Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:04:03.816776Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:04:03.865269Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:04:03.945600Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:04:03.949587Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:04:03.951270Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:04:04.172195Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:04:04.274037Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:04:04.280317Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:04:04.506077Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:04:04.703593Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:04:04.708730Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:04:04.709318Z - job completed in 2.38 seconds (b3b1ed863025168a30b0d8a1f01c630e7174bfc409823ec334317ee55600640e)
2022-09-28T21:04:04.762292Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1554"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f2985645e842422c1c6597f268034207b6d27665ea666dd93e1975a291a61c3a)
2022-09-28T21:04:07.949055Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:04:07.971631Z - running sql script pg/upsert_orders.sql
2022-09-28T21:04:07.971665Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:04:07.976370Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:04:07.981101Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:04:07.982461Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:04:07.986249Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:04:07.990432Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:04:07.994683Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:04:07.995666Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:04:07.996742Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:04:08.003175Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:04:08.152777Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:04:08.197740Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:04:08.201995Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:04:08.212236Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:04:08.276911Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:04:08.289013Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:04:08.289399Z - job completed in 3.53 seconds (f2985645e842422c1c6597f268034207b6d27665ea666dd93e1975a291a61c3a)
2022-09-28T21:06:01.896021Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1556"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e89035b93bb1237ac18447d5bdc35dda2bae5f656e3eea766674702ccb603e78)
2022-09-28T21:06:04.434744Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:06:04.451637Z - running sql script pg/upsert_orders.sql
2022-09-28T21:06:04.451672Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:06:04.457146Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:06:04.462330Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:06:04.463429Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:06:04.469993Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:06:04.474361Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:06:04.478861Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:06:04.479916Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:06:04.480779Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:06:04.487493Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:06:04.671210Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:06:04.704776Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:06:04.709496Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:06:04.722428Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:06:04.792467Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:06:04.810793Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:06:04.811232Z - job completed in 2.92 seconds (e89035b93bb1237ac18447d5bdc35dda2bae5f656e3eea766674702ccb603e78)
2022-09-28T21:06:04.912723Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1556"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (549014dfa7c59953752c56dc151c273a852f892cd14384ed54d2ed43f2444361)
2022-09-28T21:06:06.025535Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:06:06.041632Z - running sql script pg/insert_tenders.sql
2022-09-28T21:06:06.041672Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:06:06.047077Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:06:06.048614Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:06:06.053754Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:06:06.058795Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:06:06.064774Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:06:06.065780Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:06:06.115408Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:06:06.213370Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:06:06.217514Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:06:06.219415Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:06:06.633470Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:06:06.841613Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:06:06.853242Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:06:07.234146Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:06:07.429845Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:06:07.438022Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:06:07.438487Z - job completed in 2.53 seconds (549014dfa7c59953752c56dc151c273a852f892cd14384ed54d2ed43f2444361)
2022-09-28T21:08:01.910927Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1558"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (75a7c4b4b0842345439c0df8878eacece70d700d18b15248c7dcd41b1e7d6c2c)
2022-09-28T21:08:04.163204Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:08:04.179714Z - running sql script pg/upsert_orders.sql
2022-09-28T21:08:04.179745Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:08:04.184831Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:08:04.189847Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:08:04.191074Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:08:04.195674Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:08:04.204053Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:08:04.210424Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:08:04.211609Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:08:04.212765Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:08:04.222774Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:08:04.459377Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:08:04.514261Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:08:04.519737Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:08:04.532459Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:08:04.601768Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:08:04.618439Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:08:04.618798Z - job completed in 2.71 seconds (75a7c4b4b0842345439c0df8878eacece70d700d18b15248c7dcd41b1e7d6c2c)
2022-09-28T21:08:04.672712Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1558"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (00b71187fa54555e18e7c6b7d39ba4fb2c2fcc3519994d72e2b443876239d7a2)
2022-09-28T21:08:05.938543Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:08:05.955710Z - running sql script pg/insert_tenders.sql
2022-09-28T21:08:05.955747Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:08:05.960230Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:08:05.962001Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:08:05.967089Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:08:05.971886Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:08:05.977520Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:08:05.978649Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:08:06.026261Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:08:06.158621Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:08:06.162725Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:08:06.164282Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:08:06.374752Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:08:06.528939Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:08:06.538711Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:08:06.976325Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:08:07.372088Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:08:07.377843Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:08:07.378171Z - job completed in 2.71 seconds (00b71187fa54555e18e7c6b7d39ba4fb2c2fcc3519994d72e2b443876239d7a2)
2022-09-28T21:08:07.446278Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1548"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (cb9673c487d995ce39a4e038d08b522e77737d2ec77468f0deaa0acf342141ec)
2022-09-28T21:08:13.372498Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:08:13.388463Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T21:08:13.388495Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:08:13.393473Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T21:08:13.400585Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T21:08:13.404981Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T21:08:13.405963Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T21:08:13.410256Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T21:08:13.414347Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T21:08:13.418242Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:08:13.419210Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T21:08:13.420032Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T21:08:13.425970Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T21:08:13.431227Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T21:08:13.432195Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T21:08:13.439797Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T21:08:13.444194Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T21:08:13.448736Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T21:08:13.460866Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T21:08:14.358420Z - called http://score/api/keyed and received back 200
2022-09-28T21:08:14.358640Z - job completed in 6.91 seconds (cb9673c487d995ce39a4e038d08b522e77737d2ec77468f0deaa0acf342141ec)
2022-09-28T21:10:02.148955Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1600"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ee436003924f62f242c9b858dc0578f8b4c22529aad797417db26ba9a813ccd5)
2022-09-28T21:10:05.474344Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:10:05.490220Z - running sql script pg/insert_tenders.sql
2022-09-28T21:10:05.490262Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:10:05.496780Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:10:05.498194Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:10:05.503639Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:10:05.507717Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:10:05.512867Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:10:05.513979Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:10:05.567609Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:10:05.668418Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:10:05.679703Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:10:05.682437Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:10:05.895292Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:10:05.993197Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:10:06.006464Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:10:06.269644Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:10:06.462079Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:10:06.467722Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:10:06.468128Z - job completed in 4.32 seconds (ee436003924f62f242c9b858dc0578f8b4c22529aad797417db26ba9a813ccd5)
2022-09-28T21:10:06.493231Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1600"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f4a5973eef4e5523e6e318bd8cfd88c10a9912bf39c162e02c51c625f41383f0)
2022-09-28T21:10:08.719994Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:10:08.736616Z - running sql script pg/upsert_orders.sql
2022-09-28T21:10:08.736649Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:10:08.741500Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:10:08.748232Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:10:08.749545Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:10:08.759713Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:10:08.764476Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:10:08.769365Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:10:08.770457Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:10:08.771426Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:10:08.778290Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:10:09.004166Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:10:09.040224Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:10:09.044249Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:10:09.064588Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:10:09.147657Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:10:09.170556Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:10:09.170964Z - job completed in 2.68 seconds (f4a5973eef4e5523e6e318bd8cfd88c10a9912bf39c162e02c51c625f41383f0)
2022-09-28T21:12:01.940544Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1602"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c078407d810300138042f4771e9cfd9557a310947210687696b4498901a0c5ad)
2022-09-28T21:12:03.343932Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:12:03.362117Z - running sql script pg/insert_tenders.sql
2022-09-28T21:12:03.362151Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:12:03.369230Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:12:03.370774Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:12:03.376863Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:12:03.381160Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:12:03.387962Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:12:03.388978Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:12:03.436011Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:12:03.481701Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:12:03.489625Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:12:03.491361Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:12:03.704896Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:12:03.800465Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:12:03.809105Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:12:04.043851Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:12:04.242167Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:12:04.248639Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:12:04.249085Z - job completed in 2.31 seconds (c078407d810300138042f4771e9cfd9557a310947210687696b4498901a0c5ad)
2022-09-28T21:12:04.336030Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1602"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c82c6916b3301cf343b113cdb79ecc0e16998f1a120bfe5e6a055b17becabea5)
2022-09-28T21:12:06.948741Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:12:06.971906Z - running sql script pg/upsert_orders.sql
2022-09-28T21:12:06.971942Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:12:06.976632Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:12:06.981956Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:12:06.983441Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:12:06.987348Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:12:06.991829Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:12:06.996078Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:12:06.997233Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:12:06.998084Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:12:07.005648Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:12:07.352134Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:12:07.419822Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:12:07.424781Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:12:07.442075Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:12:07.569732Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:12:07.597584Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:12:07.598080Z - job completed in 3.26 seconds (c82c6916b3301cf343b113cdb79ecc0e16998f1a120bfe5e6a055b17becabea5)
2022-09-28T21:14:02.009299Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1604"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (3b83cec218df372cee501aea45cd13010900bdbe8d6170612d663261d64d18a1)
2022-09-28T21:14:03.511441Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:14:03.528989Z - running sql script pg/insert_tenders.sql
2022-09-28T21:14:03.529018Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:14:03.537585Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:14:03.538944Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:14:03.543385Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:14:03.547477Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:14:03.552687Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:14:03.553982Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:14:03.600688Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:14:03.727819Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:14:03.732694Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:14:03.734353Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:14:03.957234Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:14:04.061309Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:14:04.070411Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:14:04.309549Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:14:04.504028Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:14:04.509399Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:14:04.509946Z - job completed in 2.50 seconds (3b83cec218df372cee501aea45cd13010900bdbe8d6170612d663261d64d18a1)
2022-09-28T21:14:04.596448Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1604"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2154b39b3a178569993384fdfc56fb2d4f37748dcd9097985a0e1c915901e3f9)
2022-09-28T21:14:07.076402Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:14:07.096169Z - running sql script pg/upsert_orders.sql
2022-09-28T21:14:07.096209Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:14:07.102139Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:14:07.107082Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:14:07.109332Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:14:07.115375Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:14:07.122317Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:14:07.126935Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:14:07.128279Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:14:07.133793Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:14:07.144237Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:14:07.384040Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:14:07.403844Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:14:07.408143Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:14:07.422363Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:14:07.501593Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:14:07.520725Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:14:07.521507Z - job completed in 2.93 seconds (2154b39b3a178569993384fdfc56fb2d4f37748dcd9097985a0e1c915901e3f9)
2022-09-28T21:16:01.951909Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1606"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (288f8cb67600c024e989fac39a995f5998aacb98a48a61cbbc945a53fa4902ec)
2022-09-28T21:16:05.669790Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:16:05.690897Z - running sql script pg/insert_tenders.sql
2022-09-28T21:16:05.690947Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:16:05.695632Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:16:05.697166Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:16:05.701352Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:16:05.707752Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:16:05.713695Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:16:05.714932Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:16:05.762042Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:16:05.870966Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:16:05.876083Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:16:05.877628Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:16:06.101900Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:16:06.207592Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:16:06.215076Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:16:06.449056Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:16:06.644126Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:16:06.649285Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:16:06.649559Z - job completed in 4.70 seconds (288f8cb67600c024e989fac39a995f5998aacb98a48a61cbbc945a53fa4902ec)
2022-09-28T21:16:06.695145Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1606"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (41ab042ad67dd5537eee866a2e4d6f35fa6befbc0d86337dd71d79c9b68468af)
2022-09-28T21:16:09.033727Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:16:09.050511Z - running sql script pg/upsert_orders.sql
2022-09-28T21:16:09.050547Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:16:09.055622Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:16:09.060544Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:16:09.061703Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:16:09.065998Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:16:09.070312Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:16:09.075964Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:16:09.077169Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:16:09.078125Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:16:09.085240Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:16:09.326076Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:16:09.391788Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:16:09.396141Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:16:09.411178Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:16:09.479993Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:16:09.491143Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:16:09.491614Z - job completed in 2.80 seconds (41ab042ad67dd5537eee866a2e4d6f35fa6befbc0d86337dd71d79c9b68468af)
2022-09-28T21:18:01.984831Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1558"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (b8e2cefd6acfc7f7e07c78abb97292b6528a63c20fa43d3209a0a3a74b46c0d2)
2022-09-28T21:18:08.427637Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:18:08.447065Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T21:18:08.447093Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:18:08.452604Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T21:18:08.458275Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T21:18:08.462431Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T21:18:08.463515Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T21:18:08.467485Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T21:18:08.474660Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T21:18:08.479260Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:18:08.480394Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T21:18:08.481390Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T21:18:08.489549Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T21:18:08.494134Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T21:18:08.495008Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T21:18:08.503294Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T21:18:08.507362Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T21:18:08.522554Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T21:18:08.535418Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T21:18:09.374414Z - called http://score/api/keyed and received back 200
2022-09-28T21:18:09.374495Z - job completed in 7.39 seconds (b8e2cefd6acfc7f7e07c78abb97292b6528a63c20fa43d3209a0a3a74b46c0d2)
2022-09-28T21:18:09.429378Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1608"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6643a50d9d121dbd76d308d04fab8a9efebf81ba39298d4b42e9c4ebd5075f33)
2022-09-28T21:18:10.835100Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:18:10.852302Z - running sql script pg/insert_tenders.sql
2022-09-28T21:18:10.852342Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:18:10.859378Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:18:10.861045Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:18:10.871503Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:18:10.879735Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:18:10.885454Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:18:10.886713Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:18:10.935230Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:18:11.058749Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:18:11.064294Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:18:11.065864Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:18:11.304059Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:18:11.417676Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:18:11.428954Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:18:11.667562Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:18:11.862316Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:18:11.868413Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:18:11.868849Z - job completed in 2.44 seconds (6643a50d9d121dbd76d308d04fab8a9efebf81ba39298d4b42e9c4ebd5075f33)
2022-09-28T21:18:11.906659Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1608"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (95ca285d3dd4497f7eba5d326230b6921fe42add58fe827b499ad85218c735af)
2022-09-28T21:18:14.154245Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:18:14.169942Z - running sql script pg/upsert_orders.sql
2022-09-28T21:18:14.169973Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:18:14.174881Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:18:14.179675Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:18:14.180536Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:18:14.184846Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:18:14.188972Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:18:14.193065Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:18:14.194012Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:18:14.194805Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:18:14.201149Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:18:14.409354Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:18:14.498282Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:18:14.502004Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:18:14.511094Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:18:14.576300Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:18:14.586072Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:18:14.587297Z - job completed in 2.68 seconds (95ca285d3dd4497f7eba5d326230b6921fe42add58fe827b499ad85218c735af)
2022-09-28T21:20:02.386714Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1610"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (f79dfd177b0b4e40a2d169a4a81a1f6cc2db6f3124348593c9cb5fa7d79bc065)
2022-09-28T21:20:04.494322Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:20:04.513179Z - running sql script pg/upsert_orders.sql
2022-09-28T21:20:04.513403Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:20:04.518621Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:20:04.537378Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:20:04.538621Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:20:04.550501Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:20:04.556886Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:20:04.561363Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:20:04.562306Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:20:04.563180Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:20:04.570136Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:20:04.777187Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:20:04.891144Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:20:04.895479Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:20:04.908592Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:20:04.979904Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:20:04.996329Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:20:04.996735Z - job completed in 2.61 seconds (f79dfd177b0b4e40a2d169a4a81a1f6cc2db6f3124348593c9cb5fa7d79bc065)
2022-09-28T21:20:05.065438Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1610"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (0f9dd2f3a7e3efb10de982eeacc3e2b004f21efb06b0d7e7b23d288fecc4a5c1)
2022-09-28T21:20:06.135334Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:20:06.151477Z - running sql script pg/insert_tenders.sql
2022-09-28T21:20:06.151516Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:20:06.156753Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:20:06.158264Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:20:06.162485Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:20:06.167055Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:20:06.172129Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:20:06.173164Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:20:06.220906Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:20:06.349912Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:20:06.353705Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:20:06.355234Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:20:06.590063Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:20:06.697833Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:20:06.707855Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:20:06.944061Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:20:07.138543Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:20:07.144048Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:20:07.144523Z - job completed in 2.08 seconds (0f9dd2f3a7e3efb10de982eeacc3e2b004f21efb06b0d7e7b23d288fecc4a5c1)
2022-09-28T21:22:01.969740Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1612"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (8b46d8e14f0190eb8fd11a6b5f0517a9d143d8aef068f61edda505b1db155cbe)
2022-09-28T21:22:04.367715Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:22:04.384154Z - running sql script pg/upsert_orders.sql
2022-09-28T21:22:04.384188Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:22:04.388771Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:22:04.393266Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:22:04.394257Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:22:04.398198Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:22:04.402577Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:22:04.406561Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:22:04.407507Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:22:04.408645Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:22:04.415075Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:22:04.603965Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:22:04.705597Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:22:04.710008Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:22:04.720506Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:22:04.791295Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:22:04.802571Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:22:04.803111Z - job completed in 2.83 seconds (8b46d8e14f0190eb8fd11a6b5f0517a9d143d8aef068f61edda505b1db155cbe)
2022-09-28T21:22:04.831405Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1612"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7dc8cd92ff80fe31c54a85c564820d106ed357fad79c195f4b5a368d377cf9b1)
2022-09-28T21:22:06.195522Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:22:06.211768Z - running sql script pg/insert_tenders.sql
2022-09-28T21:22:06.211804Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:22:06.216510Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:22:06.217822Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:22:06.221800Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:22:06.229761Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:22:06.238070Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:22:06.239650Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:22:06.287503Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:22:06.493912Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:22:06.499616Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:22:06.501329Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:22:06.733997Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:22:06.841791Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:22:06.848125Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:22:07.080069Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:22:07.272685Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:22:07.277768Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:22:07.278289Z - job completed in 2.45 seconds (7dc8cd92ff80fe31c54a85c564820d106ed357fad79c195f4b5a368d377cf9b1)
2022-09-28T21:24:01.952068Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1614"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5a984699be2c278f462a27b03ef3e3af687ea0fac7eff16ccfcb43d5b2c3dc05)
2022-09-28T21:24:03.363031Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:24:03.379484Z - running sql script pg/insert_tenders.sql
2022-09-28T21:24:03.379513Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:24:03.384276Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:24:03.385687Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:24:03.391987Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:24:03.396141Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:24:03.400922Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:24:03.401819Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:24:03.448948Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:24:03.633154Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:24:03.639280Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:24:03.640867Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:24:03.872762Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:24:03.982959Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:24:03.992862Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:24:04.219905Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:24:04.409329Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:24:04.414615Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:24:04.414962Z - job completed in 2.46 seconds (5a984699be2c278f462a27b03ef3e3af687ea0fac7eff16ccfcb43d5b2c3dc05)
2022-09-28T21:24:04.603214Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1614"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (e1e68c7fd15d5bdff25ee580cc7c042231eb2fd608da9a5ff66c023d960dd583)
2022-09-28T21:24:06.703802Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:24:06.720382Z - running sql script pg/upsert_orders.sql
2022-09-28T21:24:06.720413Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:24:06.725294Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:24:06.730289Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:24:06.731254Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:24:06.735609Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:24:06.740190Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:24:06.744723Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:24:06.745627Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:24:06.746543Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:24:06.756799Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:24:06.955659Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:24:07.092347Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:24:07.096604Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:24:07.105283Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:24:07.172225Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:24:07.180979Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:24:07.181616Z - job completed in 2.58 seconds (e1e68c7fd15d5bdff25ee580cc7c042231eb2fd608da9a5ff66c023d960dd583)
2022-09-28T21:26:02.120464Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1616"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (38858569284e0007f3969f3e9aa3448e7303f7e9354aaa681871ab4cd389bd50)
2022-09-28T21:26:03.840761Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:26:03.857747Z - running sql script pg/insert_tenders.sql
2022-09-28T21:26:03.857803Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:26:03.864476Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:26:03.865952Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:26:03.870699Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:26:03.876674Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:26:03.881452Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:26:03.882300Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:26:03.939676Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:26:04.015327Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:26:04.019632Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:26:04.021070Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:26:04.252925Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:26:04.361791Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:26:04.371421Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:26:04.611842Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:26:04.807488Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:26:04.815219Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:26:04.815604Z - job completed in 2.70 seconds (38858569284e0007f3969f3e9aa3448e7303f7e9354aaa681871ab4cd389bd50)
2022-09-28T21:26:04.842047Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1616"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (46a4de80fd3b898230a4ebab4c831169f57eee11ddaa5bc019cc7e6ea42f3e41)
2022-09-28T21:26:07.112938Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:26:07.131164Z - running sql script pg/upsert_orders.sql
2022-09-28T21:26:07.131201Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:26:07.136200Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:26:07.141678Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:26:07.142748Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:26:07.146704Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:26:07.150855Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:26:07.156363Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:26:07.157453Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:26:07.158346Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:26:07.165633Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:26:07.345782Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:26:07.433175Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:26:07.436981Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:26:07.449013Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:26:07.539179Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:26:07.553301Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:26:07.553781Z - job completed in 2.71 seconds (46a4de80fd3b898230a4ebab4c831169f57eee11ddaa5bc019cc7e6ea42f3e41)
2022-09-28T21:28:01.898104Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1618"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (8ab219fd25cd14c9b0229cfb49ea31e38a72281acb06f50be5ef69e1fd398eac)
2022-09-28T21:28:03.148363Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:28:03.164847Z - running sql script pg/insert_tenders.sql
2022-09-28T21:28:03.164883Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:28:03.169711Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:28:03.171222Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:28:03.175739Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:28:03.179782Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:28:03.184493Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:28:03.185560Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:28:03.234363Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:28:03.260748Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:28:03.264796Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:28:03.266396Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:28:03.504394Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:28:03.612361Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:28:03.620986Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:28:03.878982Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:28:04.294895Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:28:04.300331Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:28:04.300730Z - job completed in 2.40 seconds (8ab219fd25cd14c9b0229cfb49ea31e38a72281acb06f50be5ef69e1fd398eac)
2022-09-28T21:28:04.367386Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1618"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2d63c4e10e9224fae7f99712dd56de67ea84aa14071f4362b797b0196ab7036d)
2022-09-28T21:28:07.372326Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:28:07.388524Z - running sql script pg/upsert_orders.sql
2022-09-28T21:28:07.388550Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:28:07.393342Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:28:07.397930Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:28:07.398917Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:28:07.402768Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:28:07.407289Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:28:07.411439Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:28:07.413006Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:28:07.413828Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:28:07.420517Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:28:07.553976Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:28:07.608641Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:28:07.612940Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:28:07.624241Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:28:07.688579Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:28:07.697970Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:28:07.698321Z - job completed in 3.33 seconds (2d63c4e10e9224fae7f99712dd56de67ea84aa14071f4362b797b0196ab7036d)
2022-09-28T21:28:07.802499Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1608"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (6d1be51e14ee13321c70cc1437d4642b0bef3911c1cb5e4684b44a0cad719e53)
2022-09-28T21:28:14.270897Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:28:14.286973Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T21:28:14.287005Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:28:14.291663Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T21:28:14.296323Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T21:28:14.300261Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T21:28:14.301186Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T21:28:14.305196Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T21:28:14.309667Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T21:28:14.310671Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:28:14.311624Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T21:28:14.312523Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T21:28:14.318500Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T21:28:14.323581Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T21:28:14.324723Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T21:28:14.330871Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T21:28:14.339745Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T21:28:14.344853Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T21:28:14.350827Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T21:28:15.162969Z - called http://score/api/keyed and received back 200
2022-09-28T21:28:15.164746Z - job completed in 7.36 seconds (6d1be51e14ee13321c70cc1437d4642b0bef3911c1cb5e4684b44a0cad719e53)
2022-09-28T21:30:02.318768Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1620"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (6ba85e48f4e2fa431063021bfe6c3572fa33ecf6bea495793b29686cd42a6c3b)
2022-09-28T21:30:04.699873Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:30:04.717375Z - running sql script pg/upsert_orders.sql
2022-09-28T21:30:04.717995Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:30:04.723653Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:30:04.728873Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:30:04.730303Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:30:04.734443Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:30:04.738576Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:30:04.743196Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:30:04.744540Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:30:04.746140Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:30:04.752824Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:30:04.914950Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:30:04.946325Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:30:04.950355Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:30:04.968367Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:30:05.044741Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:30:05.062238Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:30:05.062953Z - job completed in 2.74 seconds (6ba85e48f4e2fa431063021bfe6c3572fa33ecf6bea495793b29686cd42a6c3b)
2022-09-28T21:30:05.177903Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1620"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6d525502fb6707fc62d632a218d5212e6be8f20983a64806ac416c6acc0fa3d4)
2022-09-28T21:30:06.617416Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:30:06.634346Z - running sql script pg/insert_tenders.sql
2022-09-28T21:30:06.634395Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:30:06.638969Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:30:06.640365Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:30:06.648358Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:30:06.654153Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:30:06.659126Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:30:06.660202Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:30:06.710933Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:30:06.729955Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:30:06.734210Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:30:06.736352Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:30:06.969452Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:30:07.079315Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:30:07.094419Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:30:07.329500Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:30:07.521464Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:30:07.531918Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:30:07.532474Z - job completed in 2.36 seconds (6d525502fb6707fc62d632a218d5212e6be8f20983a64806ac416c6acc0fa3d4)
2022-09-28T21:32:01.886030Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1622"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9b19520de6fef9d25edf56a8fc66b043344d799316e49b728dcf2598877f323d)
2022-09-28T21:32:03.415893Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:32:03.432493Z - running sql script pg/insert_tenders.sql
2022-09-28T21:32:03.432526Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:32:03.439359Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:32:03.440805Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:32:03.445632Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:32:03.451584Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:32:03.456401Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:32:03.457452Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:32:03.504498Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:32:03.518404Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:32:03.522570Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:32:03.524536Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:32:03.760197Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:32:03.864832Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:32:03.871582Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:32:04.111405Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:32:04.293813Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:32:04.299306Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:32:04.299925Z - job completed in 2.41 seconds (9b19520de6fef9d25edf56a8fc66b043344d799316e49b728dcf2598877f323d)
2022-09-28T21:32:04.405197Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1622"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (9abe292009b782c360fe49955a5be89cdee005eee3b40873ffcf9128137f7b3a)
2022-09-28T21:32:06.818810Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:32:06.836219Z - running sql script pg/upsert_orders.sql
2022-09-28T21:32:06.836776Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:32:06.841794Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:32:06.847098Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:32:06.848555Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:32:06.853181Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:32:06.857611Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:32:06.862283Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:32:06.863880Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:32:06.865356Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:32:06.875571Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:32:07.014743Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:32:07.046556Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:32:07.050697Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:32:07.060597Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:32:07.125101Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:32:07.138084Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:32:07.138481Z - job completed in 2.73 seconds (9abe292009b782c360fe49955a5be89cdee005eee3b40873ffcf9128137f7b3a)
2022-09-28T21:34:02.090385Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1624"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (7fa33b169e70c31e6568bf2358b865d9e0e1a706d6430ad498a58c90bd5a0b02)
2022-09-28T21:34:03.586702Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:34:03.603256Z - running sql script pg/insert_tenders.sql
2022-09-28T21:34:03.603289Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:34:03.607771Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:34:03.609030Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:34:03.613208Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:34:03.617319Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:34:03.621864Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:34:03.622958Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:34:03.670651Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:34:03.683836Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:34:03.688480Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:34:03.690085Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:34:03.928539Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:34:04.083500Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:34:04.099322Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:34:04.359471Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:34:04.570765Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:34:04.580444Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:34:04.580726Z - job completed in 2.49 seconds (7fa33b169e70c31e6568bf2358b865d9e0e1a706d6430ad498a58c90bd5a0b02)
2022-09-28T21:34:04.633392Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1624"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (af2eba8cb041bf7ccd30a3681be101a5e4eeabd947dfe490729a8200e3c9313f)
2022-09-28T21:34:06.845222Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:34:06.886405Z - running sql script pg/upsert_orders.sql
2022-09-28T21:34:06.886472Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:34:06.891772Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:34:06.903626Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:34:06.905118Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:34:06.911373Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:34:06.917219Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:34:06.922108Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:34:06.923233Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:34:06.924369Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:34:06.930601Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:34:07.054096Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:34:07.086668Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:34:07.090889Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:34:07.099516Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:34:07.165095Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:34:07.175643Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:34:07.175975Z - job completed in 2.54 seconds (af2eba8cb041bf7ccd30a3681be101a5e4eeabd947dfe490729a8200e3c9313f)
2022-09-28T21:36:01.926776Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1626"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (c30dac664b94bd235a92a75fb4ff914d0adf5e9195b0994671cd852750f78878)
2022-09-28T21:36:03.068123Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:36:03.090798Z - running sql script pg/insert_tenders.sql
2022-09-28T21:36:03.090831Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:36:03.095510Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:36:03.097271Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:36:03.103378Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:36:03.107446Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:36:03.112021Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:36:03.112913Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:36:03.160059Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:36:03.161857Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:36:03.162944Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:36:03.164545Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:36:03.408375Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:36:03.521115Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:36:03.531082Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:36:03.767843Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:36:03.962497Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:36:03.970952Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:36:03.971479Z - job completed in 2.05 seconds (c30dac664b94bd235a92a75fb4ff914d0adf5e9195b0994671cd852750f78878)
2022-09-28T21:36:04.080018Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1626"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (601d09358f99d3d646ae776dfc052252695f6beee0b09dfb458baaa0c6690df6)
2022-09-28T21:36:06.349157Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:36:06.367300Z - running sql script pg/upsert_orders.sql
2022-09-28T21:36:06.367333Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:36:06.371980Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:36:06.377127Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:36:06.378213Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:36:06.382766Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:36:06.387019Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:36:06.393159Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:36:06.394233Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:36:06.395205Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:36:06.403141Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:36:06.501365Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:36:06.523991Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:36:06.527811Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:36:06.535643Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:36:06.600864Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:36:06.612524Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:36:06.612768Z - job completed in 2.53 seconds (601d09358f99d3d646ae776dfc052252695f6beee0b09dfb458baaa0c6690df6)
2022-09-28T21:38:01.944211Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1628"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d0b6154b8e7c52fb63d06bb131b1dfaa3891d145d76a5b9f776e9b8c312a8bd9)
2022-09-28T21:38:03.463337Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:38:03.495116Z - running sql script pg/insert_tenders.sql
2022-09-28T21:38:03.495249Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:38:03.500415Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:38:03.502096Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:38:03.507852Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:38:03.513151Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:38:03.518265Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:38:03.519387Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:38:03.575597Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:38:03.594274Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:38:03.599581Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:38:03.601572Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:38:03.853944Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:38:03.970818Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:38:03.979669Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:38:04.231061Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:38:04.434528Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:38:04.443105Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:38:04.444909Z - job completed in 2.50 seconds (d0b6154b8e7c52fb63d06bb131b1dfaa3891d145d76a5b9f776e9b8c312a8bd9)
2022-09-28T21:38:04.487197Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1628"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d22cd173f5479446145b02889c70d588fca6c32926b1bb8ab1af3030aa52e848)
2022-09-28T21:38:06.659373Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:38:06.677302Z - running sql script pg/upsert_orders.sql
2022-09-28T21:38:06.677337Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:38:06.682337Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:38:06.689240Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:38:06.690719Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:38:06.698320Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:38:06.704320Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:38:06.708631Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:38:06.709636Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:38:06.710481Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:38:06.716869Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:38:06.853545Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:38:06.887192Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:38:06.891089Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:38:06.899367Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:38:06.977011Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:38:06.989057Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:38:06.989416Z - job completed in 2.50 seconds (d22cd173f5479446145b02889c70d588fca6c32926b1bb8ab1af3030aa52e848)
2022-09-28T21:38:07.086430Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1618"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (0652d40de121fe0736f661bf85c6aa33c1debb5e6c1f4fcdc0288830ca8d3f33)
2022-09-28T21:38:12.797985Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:38:12.816584Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T21:38:12.816619Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:38:12.821315Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T21:38:12.825947Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T21:38:12.827009Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T21:38:12.828321Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T21:38:12.829404Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T21:38:12.830541Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T21:38:12.833166Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:38:12.834038Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T21:38:12.834899Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T21:38:12.836447Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T21:38:12.837950Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T21:38:12.838991Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T21:38:12.841281Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T21:38:12.842057Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T21:38:12.843084Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T21:38:12.844678Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T21:38:12.938746Z - called http://score/api/keyed and received back 204
2022-09-28T21:38:12.938831Z - job completed in 5.85 seconds (0652d40de121fe0736f661bf85c6aa33c1debb5e6c1f4fcdc0288830ca8d3f33)
2022-09-28T21:40:02.380713Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1630"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (d497ba24d91fb088ee911606ea0a06b8ac099716a89faa8fee7c0fda137ff2a1)
2022-09-28T21:40:03.734432Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:40:03.752410Z - running sql script pg/insert_tenders.sql
2022-09-28T21:40:03.752444Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:40:03.756874Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:40:03.758357Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:40:03.763580Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:40:03.767655Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:40:03.779574Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:40:03.789839Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:40:03.840353Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:40:03.857966Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:40:03.862776Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:40:03.864742Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:40:04.101668Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:40:04.213747Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:40:04.230088Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:40:04.474610Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:40:04.678706Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:40:04.686952Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:40:04.687277Z - job completed in 2.31 seconds (d497ba24d91fb088ee911606ea0a06b8ac099716a89faa8fee7c0fda137ff2a1)
2022-09-28T21:40:04.780971Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1630"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (7fc8604d334f1f32acabbb424118105d63917fea90a8697d1a21eb6c4ba9fa93)
2022-09-28T21:40:07.244347Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:40:07.262124Z - running sql script pg/upsert_orders.sql
2022-09-28T21:40:07.262156Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:40:07.266554Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:40:07.270826Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:40:07.271759Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:40:07.275793Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:40:07.277249Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:40:07.281584Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:40:07.282571Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:40:07.283460Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:40:07.290873Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:40:07.370653Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:40:07.389630Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:40:07.393634Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:40:07.407310Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:40:07.475910Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:40:07.494590Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:40:07.495078Z - job completed in 2.72 seconds (7fc8604d334f1f32acabbb424118105d63917fea90a8697d1a21eb6c4ba9fa93)
2022-09-28T21:42:01.933608Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1632"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (003f0e68196a725d766304765fba31c3f9ac531b553335612d7fe16d21fe18c8)
2022-09-28T21:42:04.445207Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:42:04.461142Z - running sql script pg/upsert_orders.sql
2022-09-28T21:42:04.461166Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:42:04.466931Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:42:04.471023Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:42:04.472009Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:42:04.476589Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:42:04.478022Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:42:04.483596Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:42:04.484804Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:42:04.485742Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:42:04.491206Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:42:04.572763Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:42:04.592514Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:42:04.596596Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:42:04.605468Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:42:04.671602Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:42:04.685949Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:42:04.686225Z - job completed in 2.75 seconds (003f0e68196a725d766304765fba31c3f9ac531b553335612d7fe16d21fe18c8)
2022-09-28T21:42:04.748188Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1632"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ad23e9b9389ad041f4cc5153f085e920c0cda7e2d9b95b455aab1373560fa6fd)
2022-09-28T21:42:06.334371Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:42:06.350281Z - running sql script pg/insert_tenders.sql
2022-09-28T21:42:06.350329Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:42:06.356988Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:42:06.358250Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:42:06.363274Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:42:06.367465Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:42:06.372004Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:42:06.372900Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:42:06.419341Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:42:06.420876Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:42:06.421979Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:42:06.423300Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:42:06.660449Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:42:06.770411Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:42:06.781443Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:42:07.048736Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:42:07.246113Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:42:07.252248Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:42:07.252631Z - job completed in 2.50 seconds (ad23e9b9389ad041f4cc5153f085e920c0cda7e2d9b95b455aab1373560fa6fd)
2022-09-28T21:44:02.289632Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1634"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (5da99586646aa700daed7a0943e6aeaa719891ebf3b6e0193a535b8e57c1cb81)
2022-09-28T21:44:03.604481Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:44:03.620721Z - running sql script pg/insert_tenders.sql
2022-09-28T21:44:03.620781Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:44:03.625687Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:44:03.627099Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:44:03.636796Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:44:03.641901Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:44:03.647409Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:44:03.648936Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:44:03.696278Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:44:03.722324Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:44:03.726687Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:44:03.728271Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:44:03.948106Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:44:04.051212Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:44:04.058439Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:44:04.295759Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:44:04.494020Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:44:04.499251Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:44:04.499576Z - job completed in 2.21 seconds (5da99586646aa700daed7a0943e6aeaa719891ebf3b6e0193a535b8e57c1cb81)
2022-09-28T21:44:04.604421Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1634"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (d4bb6cb691b5a3b8fdd395364c84291567bd4de2c523ccfbf2f619dbc52cd53c)
2022-09-28T21:44:06.430181Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:44:06.446631Z - running sql script pg/upsert_orders.sql
2022-09-28T21:44:06.446658Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:44:06.451337Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:44:06.457255Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:44:06.458178Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:44:06.462124Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:44:06.463635Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:44:06.468020Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:44:06.469105Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:44:06.470015Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:44:06.476535Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:44:06.611137Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:44:06.635205Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:44:06.639963Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:44:06.654147Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:44:06.720592Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:44:06.734470Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:44:06.734895Z - job completed in 2.13 seconds (d4bb6cb691b5a3b8fdd395364c84291567bd4de2c523ccfbf2f619dbc52cd53c)
2022-09-28T21:46:01.973814Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1636"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (0c08d5b2e13b5127640423d93fae96260341976685b7dee650a090fc73602f63)
2022-09-28T21:46:04.479814Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:46:04.496581Z - running sql script pg/upsert_orders.sql
2022-09-28T21:46:04.496862Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:46:04.504771Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:46:04.509745Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:46:04.510909Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:46:04.515063Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:46:04.516691Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:46:04.520898Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:46:04.522724Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:46:04.527652Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:46:04.534935Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:46:04.692419Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:46:04.711974Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:46:04.716407Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:46:04.726564Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:46:04.794736Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:46:04.805909Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:46:04.806353Z - job completed in 2.83 seconds (0c08d5b2e13b5127640423d93fae96260341976685b7dee650a090fc73602f63)
2022-09-28T21:46:04.842308Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1636"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (ce7b70a408efb1da66852eeca60fd35a91d08c09d218259df447db8f7f4d498d)
2022-09-28T21:46:06.152780Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:46:06.171682Z - running sql script pg/insert_tenders.sql
2022-09-28T21:46:06.171726Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:46:06.176571Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:46:06.178163Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:46:06.182449Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:46:06.186681Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:46:06.191853Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:46:06.193226Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:46:06.241055Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:46:06.242988Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:46:06.244081Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:46:06.245833Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:46:06.473665Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:46:06.582550Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:46:06.591156Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:46:06.826975Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:46:07.030723Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:46:07.036759Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:46:07.037367Z - job completed in 2.20 seconds (ce7b70a408efb1da66852eeca60fd35a91d08c09d218259df447db8f7f4d498d)
2022-09-28T21:48:01.932046Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1638"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (fd7457a2465e7311c15b2ca1d260d59d6c4d9d6c7d61f378835495b8d5394038)
2022-09-28T21:48:04.239046Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:48:04.256984Z - running sql script pg/upsert_orders.sql
2022-09-28T21:48:04.257021Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:48:04.264238Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:48:04.268932Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:48:04.269994Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:48:04.274866Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:48:04.276335Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:48:04.281665Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:48:04.282646Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:48:04.283688Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:48:04.290776Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:48:04.464465Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:48:04.492719Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:48:04.498208Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:48:04.510265Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:48:04.591650Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:48:04.606532Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:48:04.606812Z - job completed in 2.67 seconds (fd7457a2465e7311c15b2ca1d260d59d6c4d9d6c7d61f378835495b8d5394038)
2022-09-28T21:48:04.707881Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1628"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (0366bcff6d42985d6a4541850f771371261e36f63a73f1b9950e25c1dee7b135)
2022-09-28T21:48:11.073115Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:48:11.103299Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T21:48:11.103345Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:48:11.109572Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T21:48:11.116432Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T21:48:11.122423Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T21:48:11.123386Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T21:48:11.129981Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T21:48:11.137432Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T21:48:11.141879Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:48:11.142964Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T21:48:11.143893Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T21:48:11.151513Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T21:48:11.162188Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T21:48:11.163341Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T21:48:11.174137Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T21:48:11.178393Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T21:48:11.182483Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T21:48:11.190423Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T21:48:12.211282Z - called http://score/api/keyed and received back 200
2022-09-28T21:48:12.211432Z - job completed in 7.50 seconds (0366bcff6d42985d6a4541850f771371261e36f63a73f1b9950e25c1dee7b135)
2022-09-28T21:48:12.257537Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1638"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (b70fdca39eda7e87f75d1ffadcdfd1b364404b7786acfbfcc25163ca49687075)
2022-09-28T21:48:13.536689Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:48:13.559224Z - running sql script pg/insert_tenders.sql
2022-09-28T21:48:13.559257Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:48:13.564379Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:48:13.565713Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:48:13.570601Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:48:13.576764Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:48:13.582978Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:48:13.583952Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:48:13.676126Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:48:13.755752Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:48:13.760269Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:48:13.762354Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:48:14.228317Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:48:14.333963Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:48:14.341625Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:48:14.583832Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:48:14.791917Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:48:14.797513Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:48:14.823146Z - job completed in 2.57 seconds (b70fdca39eda7e87f75d1ffadcdfd1b364404b7786acfbfcc25163ca49687075)
2022-09-28T21:50:01.894562Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1640"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (904af4b890ee06902695473077c7da83a744e697f34ba5c9157dc3fd7f1dd97c)
2022-09-28T21:50:03.417998Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:50:03.435439Z - running sql script pg/insert_tenders.sql
2022-09-28T21:50:03.435466Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:50:03.440416Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:50:03.441926Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:50:03.446085Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:50:03.450049Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:50:03.455101Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:50:03.456096Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:50:03.505760Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:50:03.535056Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:50:03.542114Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:50:03.543733Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:50:03.770279Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:50:03.874771Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:50:03.884444Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:50:04.128950Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:50:04.320038Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:50:04.329119Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:50:04.329457Z - job completed in 2.44 seconds (904af4b890ee06902695473077c7da83a744e697f34ba5c9157dc3fd7f1dd97c)
2022-09-28T21:50:04.434175Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1640"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (4f5abb0c67afade610d9a95137ae6e86192df1d6201ecac67aace7a53d189434)
2022-09-28T21:50:06.703276Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:50:06.720136Z - running sql script pg/upsert_orders.sql
2022-09-28T21:50:06.720169Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:50:06.725493Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:50:06.730321Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:50:06.731620Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:50:06.735809Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:50:06.737216Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:50:06.741629Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:50:06.742764Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:50:06.743967Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:50:06.758441Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:50:06.927810Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:50:06.956592Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:50:06.961035Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:50:06.979944Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:50:07.051703Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:50:07.070972Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:50:07.071487Z - job completed in 2.64 seconds (4f5abb0c67afade610d9a95137ae6e86192df1d6201ecac67aace7a53d189434)
2022-09-28T21:52:02.256867Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1642"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (66ee57edee664fd4b87abffa1bdacd9f5ea49de33f73117c34c9be7c45f272bc)
2022-09-28T21:52:03.606998Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:52:03.622651Z - running sql script pg/insert_tenders.sql
2022-09-28T21:52:03.622681Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:52:03.628978Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:52:03.630662Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:52:03.635230Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:52:03.639137Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:52:03.643862Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:52:03.644922Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:52:03.692792Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:52:03.706638Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:52:03.710862Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:52:03.712364Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:52:03.933476Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:52:04.037372Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:52:04.045528Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:52:04.304349Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:52:04.500143Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:52:04.505682Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:52:04.506231Z - job completed in 2.25 seconds (66ee57edee664fd4b87abffa1bdacd9f5ea49de33f73117c34c9be7c45f272bc)
2022-09-28T21:52:04.587769Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1642"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (089b721deaf7fa1d9251fcc6607c8b4d1e19abb1f31961ed27bd4407f42f71cc)
2022-09-28T21:52:06.711323Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:52:06.729758Z - running sql script pg/upsert_orders.sql
2022-09-28T21:52:06.729788Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:52:06.734769Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:52:06.740240Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:52:06.741133Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:52:06.744863Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:52:06.746673Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:52:06.751160Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:52:06.752389Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:52:06.753362Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:52:06.760241Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:52:06.925158Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:52:06.947975Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:52:06.952361Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:52:06.963755Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:52:07.028248Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:52:07.038280Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:52:07.038947Z - job completed in 2.45 seconds (089b721deaf7fa1d9251fcc6607c8b4d1e19abb1f31961ed27bd4407f42f71cc)
2022-09-28T21:54:02.240625Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1644"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (82dfc1dbfcbb6bcbd56861418b94a6fc2dba38741af0dfff1a4f3f7d66da8c64)
2022-09-28T21:54:03.870334Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:54:03.886644Z - running sql script pg/insert_tenders.sql
2022-09-28T21:54:03.886674Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:54:03.891647Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:54:03.893035Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:54:03.897434Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:54:03.901456Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:54:03.906443Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:54:03.907652Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:54:03.955367Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:54:03.983445Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:54:03.987675Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:54:03.989393Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:54:04.214915Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:54:04.341327Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:54:04.349348Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:54:04.602259Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:54:04.813708Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:54:04.819103Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:54:04.819670Z - job completed in 2.58 seconds (82dfc1dbfcbb6bcbd56861418b94a6fc2dba38741af0dfff1a4f3f7d66da8c64)
2022-09-28T21:54:04.892165Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1644"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (3b64a470a0ad874995d25a166f12c99993694de606e37e334f9ab96e9a7a62ed)
2022-09-28T21:54:07.181979Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:54:07.202444Z - running sql script pg/upsert_orders.sql
2022-09-28T21:54:07.202489Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:54:07.207483Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:54:07.214452Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:54:07.215559Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:54:07.220381Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:54:07.221824Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:54:07.226056Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:54:07.226975Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:54:07.227870Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:54:07.236931Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:54:07.371566Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:54:07.407416Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:54:07.415139Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:54:07.425164Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:54:07.494207Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:54:07.507565Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:54:07.507976Z - job completed in 2.62 seconds (3b64a470a0ad874995d25a166f12c99993694de606e37e334f9ab96e9a7a62ed)
2022-09-28T21:56:02.029622Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1646"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (54ce65d838a775ab43623f2f99f934edac33d5f0a5363f5d1dec3668f2dd2eaf)
2022-09-28T21:56:03.821933Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:56:03.838520Z - running sql script pg/upsert_orders.sql
2022-09-28T21:56:03.838549Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:56:03.842908Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:56:03.847534Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:56:03.848605Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:56:03.852488Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:56:03.853812Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:56:03.858006Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:56:03.858981Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:56:03.859821Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:56:03.865693Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:56:03.979025Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:56:04.019258Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:56:04.023223Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:56:04.034876Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:56:04.100011Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:56:04.112864Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:56:04.114958Z - job completed in 2.09 seconds (54ce65d838a775ab43623f2f99f934edac33d5f0a5363f5d1dec3668f2dd2eaf)
2022-09-28T21:56:04.176546Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1646"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (80ea8a8c407a0a7222d837404f03bdd779d5b06bfd6073fe1ce55562897ddd6f)
2022-09-28T21:56:05.187751Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:56:05.203915Z - running sql script pg/insert_tenders.sql
2022-09-28T21:56:05.203955Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:56:05.208252Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:56:05.209590Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:56:05.213635Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:56:05.218587Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:56:05.226762Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:56:05.227751Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:56:05.278495Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:56:05.291745Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:56:05.299158Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:56:05.300711Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:56:05.517960Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:56:05.623100Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:56:05.629330Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:56:05.854185Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:56:06.046128Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:56:06.051320Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:56:06.051864Z - job completed in 1.88 seconds (80ea8a8c407a0a7222d837404f03bdd779d5b06bfd6073fe1ce55562897ddd6f)
2022-09-28T21:58:01.963183Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1648"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (9976b5ea5f319b528a6c8957d1f639d6c4f6af7224e6ec22e4d167c9ec13fadd)
2022-09-28T21:58:03.204485Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:58:03.222080Z - running sql script pg/insert_tenders.sql
2022-09-28T21:58:03.222117Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T21:58:03.227216Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T21:58:03.228738Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T21:58:03.232934Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T21:58:03.237295Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T21:58:03.243760Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T21:58:03.244868Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T21:58:03.292557Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T21:58:03.294834Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T21:58:03.297183Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T21:58:03.298720Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T21:58:03.512818Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T21:58:03.612738Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T21:58:03.618378Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T21:58:04.058849Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T21:58:04.482417Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T21:58:04.488150Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T21:58:04.488795Z - job completed in 2.53 seconds (9976b5ea5f319b528a6c8957d1f639d6c4f6af7224e6ec22e4d167c9ec13fadd)
2022-09-28T21:58:04.573155Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_keyed_in_orders.sql","queryParameters":{"date":"2022271","time":"1638"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_keyed"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_keyed_in_orders.sql"}},{"name":"HttpPostJson","args":{"url":"http://score/api/keyed"}}]} (89180b3cc97cbf96f754f76013d3033f13251b95fd631159a59515490b43a156)
2022-09-28T21:58:09.888826Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:58:09.911289Z - running sql script pg/upsert_keyed_in_orders.sql
2022-09-28T21:58:09.911321Z - (statement 1 of 16) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:58:09.916542Z - (statement 2 of 16) -  -- Delete any rows that we've already seen. DELET
2022-09-28T21:58:09.921480Z - (statement 3 of 16) -  -- Update status to be our enumeration. UPDATE st
2022-09-28T21:58:09.925328Z - (statement 4 of 16) -  -- Delete any in an unknown status. DELETE FROM s
2022-09-28T21:58:09.926344Z - (statement 5 of 16) -  -- Update equipment type. UPDATE stage.raw_keyed
2022-09-28T21:58:09.930168Z - (statement 6 of 16) -  -- Set equipment length of zero to null. UPDATE s
2022-09-28T21:58:09.934282Z - (statement 7 of 16) -  -- Clean up any zeroed rates. UPDATE stage.raw_ke
2022-09-28T21:58:09.938284Z - (statement 8 of 16) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:58:09.939229Z - (statement 9 of 16) -  UPDATE stage.raw_keyed SET rate_type = NULL WHERE
2022-09-28T21:58:09.940199Z - (statement 10 of 16) -  -- clean up any invalid date/times UPDATE stage.r
2022-09-28T21:58:09.946417Z - (statement 11 of 16) -  -- Update the FS order ID on those source orders
2022-09-28T21:58:09.954670Z - (statement 12 of 16) -  -- Delete any keyed-in orders we don't know about
2022-09-28T21:58:09.955663Z - (statement 13 of 16) -  -- Insert the new order records. INSERT INTO keye
2022-09-28T21:58:09.962776Z - (statement 14 of 16) -  -- Update the stop event. UPDATE stage.raw_keyed
2022-09-28T21:58:09.969594Z - (statement 15 of 16) -  -- Update stop numbers to be sequential. UPDATE s
2022-09-28T21:58:09.973664Z - (statement 16 of 16) -  -- Insert new keyed-in stops. INSERT INTO keyed_i
2022-09-28T21:58:09.987595Z - sql script pg/upsert_keyed_in_orders.sql ran successfully
2022-09-28T21:58:11.379938Z - called http://score/api/keyed and received back 200
2022-09-28T21:58:11.380147Z - job completed in 6.81 seconds (89180b3cc97cbf96f754f76013d3033f13251b95fd631159a59515490b43a156)
2022-09-28T21:58:11.432067Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1648"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (c83eafb3a4f61f115edfc52ca5f8e701d3710a211c99a37b0fd711a18677a06b)
2022-09-28T21:58:13.198464Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T21:58:13.215489Z - running sql script pg/upsert_orders.sql
2022-09-28T21:58:13.215554Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T21:58:13.223179Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T21:58:13.227777Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T21:58:13.228806Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T21:58:13.232800Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T21:58:13.234464Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T21:58:13.239090Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T21:58:13.240493Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T21:58:13.241559Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T21:58:13.248172Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T21:58:13.329162Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T21:58:13.331197Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T21:58:13.332359Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T21:58:13.341305Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T21:58:13.406745Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T21:58:13.418765Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T21:58:13.419444Z - job completed in 1.99 seconds (c83eafb3a4f61f115edfc52ca5f8e701d3710a211c99a37b0fd711a18677a06b)
2022-09-28T22:00:01.899760Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1650"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (03a1ff50e0846243851d3e377bc7e82d06023e99f65aabfc9f47e6f7691ae311)
2022-09-28T22:00:03.760595Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T22:00:03.779335Z - running sql script pg/insert_tenders.sql
2022-09-28T22:00:03.779390Z - (statement 1 of 16) - -- Add order FK column. ALTER TABLE stage.raw_tend
2022-09-28T22:00:03.784240Z - (statement 2 of 16) -  -- null out unknown billtos. UPDATE stage.raw_ten
2022-09-28T22:00:03.785567Z - (statement 3 of 16) -  -- Map divisions to business_segment. UPDATE stag
2022-09-28T22:00:03.789390Z - (statement 4 of 16) -  -- Update status column. UPDATE stage.raw_tenders
2022-09-28T22:00:03.794999Z - (statement 5 of 16) -  -- Update timezone on update_date. UPDATE stage.r
2022-09-28T22:00:03.800674Z - (statement 6 of 16) -  -- TODO(pat): maybe eventually remove this. -- De
2022-09-28T22:00:03.801610Z - (statement 7 of 16) -  -- Find order based on company/shipment id. UPDAT
2022-09-28T22:00:03.848199Z - (statement 8 of 16) -  -- Find order based on shipment id and date. UPDA
2022-09-28T22:00:03.850152Z - (statement 9 of 16) -  -- Delete any unknown tenders. DELETE FROM stage.
2022-09-28T22:00:03.850954Z - (statement 10 of 16) -  -- Delete all but the latest record of TID/SEQ co
2022-09-28T22:00:03.852439Z - (statement 11 of 16) -  -- Delete any raw_tender row that are ald or alre
2022-09-28T22:00:04.066425Z - (statement 12 of 16) -  -- Update tender_sequence to be 1 more than exist
2022-09-28T22:00:04.169731Z - (statement 13 of 16) -  -- upsert INSERT INTO source_tender(   source_id,
2022-09-28T22:00:04.176113Z - (statement 14 of 16) -  -- Update any accepted/rejected tenders. UPDATE "
2022-09-28T22:00:04.403273Z - (statement 15 of 16) -  -- Update any primary tenders. UPDATE "order" o S
2022-09-28T22:00:04.627989Z - (statement 16 of 16) -  -- Catch all for things already accepted. UPDATE
2022-09-28T22:00:04.630261Z - sql script pg/insert_tenders.sql ran successfully
2022-09-28T22:00:04.630683Z - job completed in 2.73 seconds (03a1ff50e0846243851d3e377bc7e82d06023e99f65aabfc9f47e6f7691ae311)
2022-09-28T22:00:04.659937Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1650"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (2cf004f41930312b2094704b260cf5a7b1c61d73fdf6d8e908db95b55a45df8b)
2022-09-28T22:00:06.736164Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T22:00:06.755770Z - running sql script pg/upsert_orders.sql
2022-09-28T22:00:06.755800Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T22:00:06.760540Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T22:00:06.764785Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T22:00:06.765758Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T22:00:06.769763Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T22:00:06.774049Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T22:00:06.780155Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T22:00:06.781114Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T22:00:06.781985Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T22:00:06.788333Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T22:00:06.856339Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T22:00:06.862307Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T22:00:06.866391Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T22:00:06.881377Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T22:00:06.971978Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T22:00:06.987615Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T22:00:06.987947Z - job completed in 2.33 seconds (2cf004f41930312b2094704b260cf5a7b1c61d73fdf6d8e908db95b55a45df8b)
2022-09-28T22:02:02.064934Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_orders.sql","queryParameters":{"date":"2022271","time":"1652"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_orders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/upsert_orders.sql"}}]} (5026fbe6115f1230ef78c08df6a7ff7d727961cb41d58bdab980deb8b1e95d79)
2022-09-28T22:02:04.288843Z - Map(url -> jdbc:postgresql://fs-hirschbach.postgres.database.azure.com/postgres, driver -> org.postgresql.Driver, sslmode -> require, user -> postgres)
2022-09-28T22:02:04.306434Z - running sql script pg/upsert_orders.sql
2022-09-28T22:02:04.306467Z - (statement 1 of 15) - -- Add column to hold FS ID. ALTER TABLE stage.raw
2022-09-28T22:02:04.311315Z - (statement 2 of 15) -  -- Update the status. UPDATE stage.raw_orders SET
2022-09-28T22:02:04.316027Z - (statement 3 of 15) -  -- Remove test division delete from stage.raw_ord
2022-09-28T22:02:04.317298Z - (statement 4 of 15) -  -- Map divisions to business_segment UPDATE stage
2022-09-28T22:02:04.322122Z - (statement 5 of 15) -  -- Clear out any unknown commodities. UPDATE stag
2022-09-28T22:02:04.326354Z - (statement 6 of 15) -  -- Clean up any zeroed rates. UPDATE stage.raw_or
2022-09-28T22:02:04.330805Z - (statement 7 of 15) -  -- Clean up any rates without types and vice-vers
2022-09-28T22:02:04.332056Z - (statement 8 of 15) -  UPDATE stage.raw_orders SET rate_type = NULL WHER
2022-09-28T22:02:04.333059Z - (statement 9 of 15) -  -- Clean up invalid times (dates are numeric, so
2022-09-28T22:02:04.340156Z - (statement 10 of 15) -  -- Update the FS order ID on those source orders
2022-09-28T22:02:04.427113Z - (statement 11 of 15) -  -- For the remaining orders, match on the shipmen
2022-09-28T22:02:04.434398Z - (statement 12 of 15) -  -- Remove orders we don't know about. DELETE FROM
2022-09-28T22:02:04.438414Z - (statement 13 of 15) -  -- Upsert source orders. INSERT INTO source_order
2022-09-28T22:02:04.450136Z - (statement 14 of 15) -  -- Update actual orders from the new/updated sour
2022-09-28T22:02:04.524281Z - (statement 15 of 15) -  -- Update the scheduled dates with those from the
2022-09-28T22:02:04.557784Z - sql script pg/upsert_orders.sql ran successfully
2022-09-28T22:02:04.558077Z - job completed in 2.49 seconds (5026fbe6115f1230ef78c08df6a7ff7d727961cb41d58bdab980deb8b1e95d79)
2022-09-28T22:02:04.561032Z - (idle timer) Timeout of 600 seconds reached
2022-09-28T22:02:04.598097Z - received message {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1652"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6ca0668388b75a05f52528f24f4e1726307e2e19911fb6df0a97b799cfde136b)
2022-09-28T22:02:05.430127Z - job failed after 0.83 seconds - Job 1164 cancelled because SparkContext was shut down - {"source":{"kind":"jdbc","connectionName":"db2_as400.conf","queryName":"ies/query_tenders.sql","queryParameters":{"date":"2022271","time":"1652"}},"sink":{"kind":"jdbc","connectionName":"pg.conf","connectionParameters":{"dbtable":"stage.raw_tenders"},"mode":"overwrite"},"postProcessors":[{"name":"JdbcSqlScript","args":{"connectionName":"pg.conf","scriptName":"pg/insert_tenders.sql"}}]} (6ca0668388b75a05f52528f24f4e1726307e2e19911fb6df0a97b799cfde136b)
org.apache.spark.SparkException: Job 1164 cancelled because SparkContext was shut down
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1(DAGScheduler.scala:1188)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1$adapted(DAGScheduler.scala:1186)
	at scala.collection.mutable.HashSet.foreach(HashSet.scala:79)
	at org.apache.spark.scheduler.DAGScheduler.cleanUpAfterSchedulerStop(DAGScheduler.scala:1186)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onStop(DAGScheduler.scala:2887)
	at org.apache.spark.util.EventLoop.stop(EventLoop.scala:84)
	at org.apache.spark.scheduler.DAGScheduler.stop(DAGScheduler.scala:2784)
	at org.apache.spark.SparkContext.$anonfun$stop$11(SparkContext.scala:2095)
	at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1484)
	at org.apache.spark.SparkContext.stop(SparkContext.scala:2095)
	at org.apache.spark.SparkContext.$anonfun$new$35(SparkContext.scala:660)
	at org.apache.spark.util.SparkShutdownHook.run(ShutdownHookManager.scala:214)
	at org.apache.spark.util.SparkShutdownHookManager.$anonfun$runAll$2(ShutdownHookManager.scala:188)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:2066)
	at org.apache.spark.util.SparkShutdownHookManager.$anonfun$runAll$1(ShutdownHookManager.scala:188)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at scala.util.Try$.apply(Try.scala:213)
	at org.apache.spark.util.SparkShutdownHookManager.runAll(ShutdownHookManager.scala:188)
	at org.apache.spark.util.SparkShutdownHookManager$$anon$2.run(ShutdownHookManager.scala:178)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:952)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2228)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2249)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2268)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2293)
	at org.apache.spark.rdd.RDD.$anonfun$foreachPartition$1(RDD.scala:1011)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:406)
	at org.apache.spark.rdd.RDD.foreachPartition(RDD.scala:1009)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.saveTable(JdbcUtils.scala:867)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:65)
	at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:75)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:73)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:84)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:109)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:169)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:95)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:94)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:584)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:176)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:584)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:560)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:94)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:81)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:79)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:116)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:860)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:390)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:363)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:247)
	at science.freight.etl.sink.GenericSink.apply(GenericSink.scala:21)
	at science.freight.etl.Runner.apply(Runner.scala:29)
	at science.freight.etl.EtlMessageHandler.handle(EtlMessageHandler.scala:97)
	at science.freight.etl.EtlMessageHandler.$anonfun$onMessageAsync$2(EtlMessageHandler.scala:68)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
